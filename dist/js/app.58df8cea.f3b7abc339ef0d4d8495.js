(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app.58df8cea"],{"053c":function(t,e,a){"use strict";a("b2f8")},"1b5b":function(t,e,a){},"1eaa":function(t,e,a){},"317e":function(t,e,a){},"35d3":function(t,e,a){},"3dbb":function(t,e,a){"use strict";a("ee28")},"4dc0":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"rendimientos-container"},[e("div",{staticClass:"header-container"},[e("button",{staticClass:"btn-volver",on:{click:t.volverAEmbarque}},[e("i",{staticClass:"fas fa-arrow-left"}),t._v(" Volver al Embarque ")]),e("h2",[t._v("Rendimientos por Medida")]),e("button",{staticClass:"btn-nota",on:{click:t.abrirModalNota}},[e("i",{staticClass:"fas fa-sticky-note"}),t._v(" Agregar Nota ")]),e("button",{staticClass:"btn-costos",on:{click:t.abrirModalCostos}},[e("i",{staticClass:"fas fa-dollar-sign"}),t._v(" Costos ")]),e("button",{staticClass:"btn-pdf",on:{click:t.generarPDF}},[e("i",{staticClass:"fas fa-file-pdf"}),t._v(" Generar PDF ")])]),t.embarqueData?e("div",{staticClass:"rendimientos-grid"},t._l(t.medidasUnicas,(function(a,r){return e("div",{key:r,staticClass:"rendimiento-card"},[e("div",{staticClass:"medida-info"},[e("div",{staticClass:"medida-header"},[e("span",{staticClass:"medida-label editable-label",on:{click:function(e){return t.editarNombreMedida(a)}}},[t._v(" "+t._s(t.obtenerNombreMedidaPersonalizado(a))+" ")]),e("div",{staticClass:"ocultar-control"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.medidaOculta[a],expression:"medidaOculta[medida]"}],attrs:{type:"checkbox",id:"ocultar-"+r},domProps:{checked:Array.isArray(t.medidaOculta[a])?t._i(t.medidaOculta[a],null)>-1:t.medidaOculta[a]},on:{change:[function(e){var r=t.medidaOculta[a],o=e.target,s=!!o.checked;if(Array.isArray(r)){var i=null,n=t._i(r,i);o.checked?n<0&&t.$set(t.medidaOculta,a,r.concat([i])):n>-1&&t.$set(t.medidaOculta,a,r.slice(0,n).concat(r.slice(n+1)))}else t.$set(t.medidaOculta,a,s)},t.guardarEstadoOculto]}}),e("label",{attrs:{for:"ocultar-"+r}},[t._v("Ocultar en PDF")])])]),e("div",{staticClass:"costo-input"},[e("div",{staticClass:"costo-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.costosPorMedida[a],expression:"costosPorMedida[medida]"}],attrs:{type:"number",placeholder:"Precio",step:"0.01"},domProps:{value:t.costosPorMedida[a]},on:{input:[function(e){e.target.composing||t.$set(t.costosPorMedida,a,e.target.value)},t.guardarCostos]}}),t.costosPorMedida[a]?e("span",{staticClass:"costo-final"},[t._v(" Costo Final: $"+t._s(t.calcularCostoFinal(a))+" ")]):t._e()])]),e("div",{staticClass:"input-group"},[t.esMedidaMix(a)?[e("div",{staticClass:"mix-inputs"},[e("div",{staticClass:"mix-input"},[e("label",{staticClass:"editable-label",on:{click:function(e){return t.editarEtiqueta(a,"medida1")}}},[t._v(" "+t._s(t.obtenerEtiqueta(a,"medida1"))+": ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.kilosCrudos[a].medida1,expression:"kilosCrudos[medida].medida1"}],attrs:{type:"number",placeholder:"Kilos medida 1"},domProps:{value:t.kilosCrudos[a].medida1},on:{input:[function(e){e.target.composing||t.$set(t.kilosCrudos[a],"medida1",e.target.value)},function(e){return t.calcularRendimiento(a)}]}})]),e("div",{staticClass:"mix-input"},[e("label",{staticClass:"editable-label",on:{click:function(e){return t.editarEtiqueta(a,"medida2")}}},[t._v(" "+t._s(t.obtenerEtiqueta(a,"medida2"))+": ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.kilosCrudos[a].medida2,expression:"kilosCrudos[medida].medida2"}],attrs:{type:"number",placeholder:"Kilos medida 2"},domProps:{value:t.kilosCrudos[a].medida2},on:{input:[function(e){e.target.composing||t.$set(t.kilosCrudos[a],"medida2",e.target.value)},function(e){return t.calcularRendimiento(a)}]}})])])]:[e("label",[t._v("Kilos en crudo:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.kilosCrudos[a],expression:"kilosCrudos[medida]"}],attrs:{type:"number",placeholder:"Ingrese kilos"},domProps:{value:t.kilosCrudos[a]},on:{input:[function(e){e.target.composing||t.$set(t.kilosCrudos,a,e.target.value)},function(e){return t.calcularRendimiento(a)}]}})]],2),e("div",{staticClass:"resultados"},[e("p",[t._v("Total embarcado: "+t._s(t.obtenerTotalEmbarcado(a).toFixed(1))+" kg")]),e("p",{staticClass:"rendimiento"},[t._v(" Rendimiento: "),e("span",{class:{"rendimiento-alto":t.getRendimiento(a)>1}},[t._v(" "+t._s(t.getRendimiento(a).toFixed(2))+" ")])])])])])})),0):e("div",[e("p",[t._v("Cargando datos del embarque...")])]),t.mostrarModal?e("div",{staticClass:"modal-overlay"},[e("div",{staticClass:"modal-content"},[e("h3",[t._v("Agregar Nota")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.nota,expression:"nota"}],attrs:{placeholder:"Escriba su nota aquí...",rows:"4"},domProps:{value:t.nota},on:{input:function(e){e.target.composing||(t.nota=e.target.value)}}}),e("div",{staticClass:"modal-buttons"},[e("button",{staticClass:"btn-guardar",on:{click:t.guardarNota}},[t._v("Guardar")]),e("button",{staticClass:"btn-cancelar",on:{click:t.cerrarModal}},[t._v("Cancelar")])])])]):t._e(),e("CostosModal",{attrs:{showModal:t.showCostosModal,costosPorMedida:t.costosPorMedida,rendimientos:t.rendimientosPorMedida},on:{"update:showModal":function(e){t.showCostosModal=e},guardar:t.guardarCostos}})],1)},o=[],s=(a("14d9"),a("13d5"),a("1494")),i=a("2ef0"),n=a("6d4d"),c=a("2729"),l={name:"Rendimientos",components:{CostosModal:c["a"]},data(){return{kilosCrudos:{},medidasUnicas:[],embarqueData:null,guardadoAutomaticoActivo:!1,nombresMedidasPersonalizados:{},mostrarModal:!1,nota:"",medidaOculta:{},costosPorMedida:{},showCostosModal:!1,unsubscribePreciosGlobales:null}},async created(){await this.cargarEmbarque(),await this.iniciarEscuchaPreciosGlobales(),this.guardarCambiosEnTiempoReal=Object(i["debounce"])(this.guardarCambiosEnTiempoReal,300)},methods:{obtenerNombreCliente(t){if(!this.embarqueData||!this.embarqueData.clientes)return"";const e=this.embarqueData.clientes.find(e=>e.id.toString()===t.toString());return e?e.nombre:""},async cargarEmbarque(){try{const t=Object(s["h"])(),e=this.$route.params.id,a=Object(s["e"])(t,"embarques",e),r=await Object(s["f"])(a);if(r.exists()){this.embarqueData=r.data(),this.nombresMedidasPersonalizados=this.embarqueData.nombresMedidasPersonalizados||{},this.obtenerMedidasUnicas(),this.medidaOculta=this.embarqueData.medidaOculta||{},this.costosPorMedida=this.embarqueData.costosPorMedida||{};const t=this.embarqueData.kilosCrudos||{};this.kilosCrudos={...t},this.medidasUnicas.forEach(t=>{this.kilosCrudos[t]||(this.esMedidaMix(t)?this.$set(this.kilosCrudos,t,{medida1:0,medida2:0,etiqueta1:"Kilos en crudo (Medida 1)",etiqueta2:"Kilos en crudo (Medida 2)"}):this.$set(this.kilosCrudos,t,0))}),console.log("Datos cargados:",this.kilosCrudos),this.guardadoAutomaticoActivo=!0}else console.error("No se encontró el embarque")}catch(t){console.error("Error al cargar el embarque:",t)}},async guardarCambiosEnTiempoReal(){if(this.guardadoAutomaticoActivo)try{const t=Object(s["h"])(),e=this.$route.params.id,a=Object(s["e"])(t,"embarques",e);await Object(s["r"])(a,{kilosCrudos:this.kilosCrudos}),console.log("Rendimientos guardados:",this.kilosCrudos)}catch(t){console.error("Error al guardar los rendimientos:",t)}},obtenerMedidasUnicas(){if(!this.embarqueData||!this.embarqueData.clientes)return;const t=new Map,e=new Map;this.embarqueData.clientes.forEach(a=>{a.productos.forEach(r=>{if(r.medida){const o=r.medida.toLowerCase().trim();let s=r.medida;if("Ozuna"!==a.nombre||r.esVenta||(s=r.medida+" Maquila Ozuna"),o.endsWith("mix")){const t=o.split(" ")[0];e.set(t,s)}else t.has(s)||t.set(s,s)}})});const a=Array.from(e.keys()).sort();if(a.length>=2)for(let r=0;r<a.length;r+=2)if(r+1<a.length){const e=`${a[r]}-${a[r+1]} mix`;t.set(e,e),this.kilosCrudos[e]||this.$set(this.kilosCrudos,e,{medida1:0,medida2:0,etiqueta1:`Kilos en crudo (${a[r]})`,etiqueta2:`Kilos en crudo (${a[r+1]})`})}this.medidasUnicas=Array.from(t.values())},obtenerTotalEmbarcado(t){if(!this.embarqueData||!this.embarqueData.clientes)return 0;if(t.includes("-")&&t.endsWith("mix")){const[e,a]=t.split("-").map(t=>t.trim()),r=this.calcularTotalParaMedida(e+" mix"),o=this.calcularTotalParaMedida(a.replace(" mix","")+" mix");return r+o}return this.calcularTotalParaMedida(t)},calcularTotalParaMedida(t){const e=t.includes("Maquila Ozuna"),a=t.replace(" Maquila Ozuna","").toLowerCase().trim();return this.embarqueData.clientes.reduce((t,r)=>t+r.productos.filter(t=>!!t.medida&&(e?t.medida.toLowerCase().trim()===a&&"Ozuna"===r.nombre&&!t.esVenta:t.medida.toLowerCase().trim()===a&&("Ozuna"!==r.nombre||t.esVenta))).reduce((t,e)=>{if("c/h20"===e.tipo){const a=this.calcularTotalBolsas(e),r=parseFloat(e.camaronNeto)||.65;return t+a*r}{const a=e.kilos.reduce((t,e)=>t+(Number(e)||0),0),r=this.calcularTotalTaras(e),o=e.restarTaras?3*r:0;return t+(a-o)}},0),0)},obtenerTotalParaRendimiento(t){if(!this.embarqueData||!this.embarqueData.clientes)return 0;const e=t.toLowerCase(),a=this.embarqueData.clientes.flatMap(t=>t.productos.filter(t=>t.medida&&t.medida.toLowerCase()===e)),r=a.some(t=>"c/h20"===t.tipo);return r?this.obtenerTotalEmbarcado(t):this.obtenerTotalReal(t)},obtenerTotalReal(t){if(!this.embarqueData||!this.embarqueData.clientes)return 0;const e=t.includes("Maquila Ozuna"),a=t.replace(" Maquila Ozuna","").toLowerCase().trim();return this.embarqueData.clientes.reduce((t,r)=>t+r.productos.filter(t=>!!t.medida&&(e?t.medida.toLowerCase().trim()===a&&"Ozuna"===r.nombre&&!t.esVenta:t.medida.toLowerCase().trim()===a&&("Ozuna"!==r.nombre||t.esVenta))).reduce((t,e)=>t+this.calcularTotalKilos(e),0),0)},calcularTotalKilos(t){if(!t.kilos)return 0;const e=t.kilos.reduce((t,e)=>t+(Number(e)||0),0),a=(t.taras||[]).reduce((t,e)=>t+(Number(e)||0),0),r=t.restarTaras?3*a:0;return e-r},calcularTotalTaras(t){const e=(t.taras||[]).reduce((t,e)=>t+(Number(e)||0),0),a=(t.tarasExtra||[]).reduce((t,e)=>t+(Number(e)||0),0);return e+a},calcularTotalBolsas(t){const e=t.reporteTaras||[],a=t.reporteBolsas||[];let r=0;for(let o=0;o<e.length;o++){const t=parseInt(e[o])||0,s=parseInt(a[o])||0;r+=t*s}return r},calcularRendimiento(t){const e=this.obtenerTotalEmbarcado(t);if(0===e)return 0;let a;var r,o;this.esMedidaMix(t)?a=Number((null===(r=this.kilosCrudos[t])||void 0===r?void 0:r.medida1)||0)+Number((null===(o=this.kilosCrudos[t])||void 0===o?void 0:o.medida2)||0):a=Number(this.kilosCrudos[t]||0);const s=a/e;return this.guardarCambiosEnTiempoReal(),s},getRendimiento(t){return this.calcularRendimiento(t)||0},volverAEmbarque(){this.$router.push({name:"EditarEmbarque",params:{id:this.$route.params.id}})},esMedidaMix(t){return t.toLowerCase().includes("mix")},obtenerEtiqueta(t,e){return this.kilosCrudos[t]?"medida1"===e?this.kilosCrudos[t].etiqueta1||"Kilos en crudo (Medida 1)":this.kilosCrudos[t].etiqueta2||"Kilos en crudo (Medida 2)":"medida1"===e?"Kilos en crudo (Medida 1)":"Kilos en crudo (Medida 2)"},editarEtiqueta(t,e){this.kilosCrudos[t]||this.$set(this.kilosCrudos,t,{medida1:0,medida2:0,etiqueta1:"Kilos en crudo (Medida 1)",etiqueta2:"Kilos en crudo (Medida 2)"});const a="medida1"===e?this.kilosCrudos[t].etiqueta1:this.kilosCrudos[t].etiqueta2,r=prompt("Ingrese el nuevo nombre para la medida:",a);null!==r&&("medida1"===e?this.$set(this.kilosCrudos[t],"etiqueta1",r):this.$set(this.kilosCrudos[t],"etiqueta2",r),this.guardarCambiosEnTiempoReal())},generarPDF(){var t;const e=Object.values(this.costosPorMedida).some(t=>Number(t)>0),a=this.medidasUnicas.filter(t=>!this.medidaOculta[t]).map(t=>{let e;var a,r;this.esMedidaMix(t)?e={medida1:Number((null===(a=this.kilosCrudos[t])||void 0===a?void 0:a.medida1)||0),medida2:Number((null===(r=this.kilosCrudos[t])||void 0===r?void 0:r.medida2)||0)}:e=Number(this.kilosCrudos[t]||0);const o=Number(this.costosPorMedida[t])||0,s=this.getRendimiento(t),i=o>0?(o*s+20).toFixed(1):null;return{medida:t,kilosCrudos:e,totalEmbarcado:this.obtenerTotalEmbarcado(t),rendimiento:s,costo:o,costoFinal:i}}),r={...this.embarqueData,notaRendimientos:(null===(t=this.embarqueData)||void 0===t?void 0:t.notaRendimientos)||"",mostrarColumnaCosto:e};Object(n["a"])(a,r)},obtenerNombreMedidaPersonalizado(t){return this.nombresMedidasPersonalizados[t]||t},async editarNombreMedida(t){const e=this.obtenerNombreMedidaPersonalizado(t),a=prompt("Ingrese el nuevo nombre para la medida:",e);if(null!==a&&""!==a.trim()){this.$set(this.nombresMedidasPersonalizados,t,a.trim());try{const t=Object(s["h"])(),e=this.$route.params.id,a=Object(s["e"])(t,"embarques",e);await Object(s["r"])(a,{nombresMedidasPersonalizados:this.nombresMedidasPersonalizados}),console.log("Nombre de medida actualizado correctamente")}catch(r){console.error("Error al guardar el nuevo nombre:",r)}}},abrirModalNota(){var t;this.nota=(null===(t=this.embarqueData)||void 0===t?void 0:t.notaRendimientos)||"",this.mostrarModal=!0},async guardarNota(){try{const t=Object(s["h"])(),e=this.$route.params.id,a=Object(s["e"])(t,"embarques",e);await Object(s["r"])(a,{notaRendimientos:this.nota}),this.embarqueData.notaRendimientos=this.nota,this.cerrarModal(),console.log("Nota guardada correctamente")}catch(t){console.error("Error al guardar la nota:",t)}},cerrarModal(){this.mostrarModal=!1,this.nota=""},async guardarEstadoOculto(){try{const t=Object(s["h"])(),e=this.$route.params.id,a=Object(s["e"])(t,"embarques",e);await Object(s["r"])(a,{medidaOculta:this.medidaOculta}),console.log("Estado de ocultación guardado correctamente")}catch(t){console.error("Error al guardar estado de ocultación:",t)}},abrirModalCostos(){this.showCostosModal=!0},async guardarCostos(t){try{const e=Object(s["h"])(),a=this.$route.params.id;Object(s["e"])(e,"embarques",a);this.costosPorMedida=t,console.log("Costos actualizados correctamente")}catch(e){console.error("Error al actualizar los costos:",e)}},calcularCostoFinal(t){const e=Number(this.costosPorMedida[t])||0,a=Number(this.getRendimiento(t).toFixed(2)),r=e*a+20;return r.toFixed(1)},rendimientosPorMedida(){return this.medidasUnicas.reduce((t,e)=>(t[e]=this.getRendimiento(e),t),{})},async iniciarEscuchaPreciosGlobales(){try{const t=Object(s["h"])(),e=Object(s["c"])(t,"precios_globales"),a=Object(s["o"])(e,Object(s["l"])("timestamp","desc"));this.unsubscribePreciosGlobales=Object(s["k"])(a,t=>{const e={};t.forEach(t=>{const a=t.data();(!e[a.medida]||new Date(a.fecha)>new Date(e[a.medida].fecha))&&(e[a.medida]=a.costoBase)}),this.costosPorMedida=e})}catch(t){console.error("Error al iniciar escucha de precios globales:",t)}}},watch:{kilosCrudos:{handler(){this.guardarCambiosEnTiempoReal()},deep:!0}},beforeDestroy(){this.unsubscribePreciosGlobales&&this.unsubscribePreciosGlobales(),this.guardarCambiosEnTiempoReal.cancel&&this.guardarCambiosEnTiempoReal.cancel()}},d=l,u=(a("dc98"),a("2877")),m=Object(u["a"])(d,r,o,!1,null,"7e5e8ec2",null);e["default"]=m.exports},"57d4":function(t,e,a){"use strict";var r=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Nombre para PDF"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarNombre}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"nombreAlternativoPDF"}},[t._v("Nombre que aparecerá en el PDF:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nombreLocal,expression:"nombreLocal"}],ref:"nombreInput",staticClass:"form-control",attrs:{type:"text",id:"nombreAlternativoPDF",placeholder:"Ingrese el nombre para el PDF"},domProps:{value:t.nombreLocal},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardarNombre.apply(null,arguments)},input:function(e){e.target.composing||(t.nombreLocal=e.target.value)}}}),e("small",{staticClass:"form-text text-muted"},[t._v(" Este nombre solo se mostrará en el PDF generado. El nombre original se mantendrá en la aplicación. ")])])])},o=[],s=a("ff7a"),i={name:"NombreAlternativoModal",components:{BaseModal:s["a"]},props:{mostrar:{type:Boolean,required:!0},nombreOriginal:{type:String,default:""},nombreAlternativo:{type:String,default:""}},data(){return{nombreLocal:""}},watch:{mostrar(t){t&&(this.nombreLocal=this.nombreAlternativo||this.nombreOriginal,this.$nextTick(()=>{this.$refs.nombreInput&&(this.$refs.nombreInput.focus(),this.$refs.nombreInput.select())}))},nombreAlternativo(t){this.mostrar&&(this.nombreLocal=t||this.nombreOriginal)}},methods:{guardarNombre(){this.$emit("guardar",this.nombreLocal.trim())}}},n=i,c=(a("f005"),a("2877")),l=Object(c["a"])(n,r,o,!1,null,"78f4b72c",null);e["a"]=l.exports},6123:function(t,e,a){"use strict";var r=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Establecer Precio"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarPrecio}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"precioInput"}},[t._v("Precio:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.precioLocal,expression:"precioLocal"}],ref:"precioInput",staticClass:"form-control",attrs:{type:"number",id:"precioInput",placeholder:"Ingrese el precio"},domProps:{value:t.precioLocal},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardarPrecio.apply(null,arguments)},input:function(e){e.target.composing||(t.precioLocal=e.target.value)}}})])])},o=[],s=a("ff7a"),i={name:"PrecioModal",components:{BaseModal:s["a"]},props:{mostrar:{type:Boolean,required:!0},precio:{type:[Number,String],default:""}},data(){return{precioLocal:""}},watch:{mostrar(t){t&&(this.precioLocal=this.precio,this.$nextTick(()=>{var t;null===(t=this.$refs.precioInput)||void 0===t||t.focus()}))},precio(t){this.precioLocal=t}},methods:{guardarPrecio(){const t=parseFloat(this.precioLocal);isNaN(t)?""===this.precioLocal&&this.$emit("guardar",null):this.$emit("guardar",t)}}},n=i,c=(a("6925"),a("2877")),l=Object(c["a"])(n,r,o,!1,null,"8c3ce724",null);e["a"]=l.exports},6925:function(t,e,a){"use strict";a("1b5b")},"6d00":function(t,e,a){"use strict";var r=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Establecer Nota"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarNota}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"notaInput"}},[t._v("Nota:")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.notaLocal,expression:"notaLocal"}],ref:"notaInput",staticClass:"form-control",attrs:{id:"notaInput",placeholder:"Ingrese la nota",rows:"4"},domProps:{value:t.notaLocal},on:{input:function(e){e.target.composing||(t.notaLocal=e.target.value)}}})])])},o=[],s=a("ff7a"),i={name:"NotaModal",components:{BaseModal:s["a"]},props:{mostrar:{type:Boolean,required:!0},nota:{type:String,default:""}},data(){return{notaLocal:""}},watch:{mostrar(t){t&&(this.notaLocal=this.nota,this.$nextTick(()=>{var t;null===(t=this.$refs.notaInput)||void 0===t||t.focus()}))},nota(t){this.notaLocal=t}},methods:{guardarNota(){this.$emit("guardar",this.notaLocal.trim())}}},n=i,c=(a("79e0"),a("2877")),l=Object(c["a"])(n,r,o,!1,null,"6b2e9aee",null);e["a"]=l.exports},"6f30":function(t,e,a){"use strict";a("7e0c")},"79e0":function(t,e,a){"use strict";a("317e")},"7c84":function(t,e,a){},"7e0c":function(t,e,a){},9321:function(t,e,a){},"9fa0":function(t,e,a){},a712:function(t,e,a){"use strict";a("e9de")},ad72:function(t,e,a){"use strict";a("13d5");e["a"]={methods:{totalTaras(t){const e=(t.taras||[]).reduce((t,e)=>t+(e||0),0),a=(t.tarasExtra||[]).reduce((t,e)=>t+(e||0),0);return e+a},totalKilos(t){const e=(t.kilos||[]).reduce((t,e)=>t+(e||0),0),a=(t.taras||[]).reduce((t,e)=>t+(e||0),0),r=t.restarTaras?3*a:0,o=Number((e-r).toFixed(1));return o},calcularKilosProductoCH20(t){const e=t.reporteTaras||[],a=t.reporteBolsas||[];let r=0;if(e.length>0&&a.length>0){for(let t=0;t<e.length;t++){const o=parseInt(e[t])||0,s=parseInt(a[t])||0;r+=o*s}const o=t.camaronNeto&&t.camaronNeto>0?t.camaronNeto:.65;return r*o}{const e=(t.kilos||[]).reduce((t,e)=>t+(Number(e)||0),0),a=t.camaronNeto&&t.camaronNeto>0?t.camaronNeto:.65;return e*a}},calcularKilosCrudos(t){let e=0;if(t.taras){const a=/^(\d+)-(\d+)$/.exec(t.taras);if(a){const t=parseInt(a[1])||0;let r=parseInt(a[2])||0;19===r&&(r=20),e+=t*r}else{const[a,r]=t.taras.split("-").map(Number);e+=a*r}}if(t.sobrante){const a=/^(\d+)-(\d+)$/.exec(t.sobrante);if(a){const t=parseInt(a[1])||0;let r=parseInt(a[2])||0;19===r&&(r=20),e+=t*r}else{const[a,r]=t.sobrante.split("-").map(Number);e+=a*r}}return e},calcularTarasCrudos(t){let e=0;if(t.taras){const[a]=t.taras.split("-").map(Number);e+=a}if(t.sobrante){const[a]=t.sobrante.split("-").map(Number);e+=a}return e},combinarTarasBolsas(t,e){const a={};return t.forEach((t,r)=>{const o=e[r]||"",s=o;a[s]=(a[s]||0)+parseInt(t||1)}),Object.entries(a).map(([t,e])=>`(${e}-${t})`).join(" ")},totalTarasReportadas(t){return(t.reporteTaras||[]).reduce((t,e)=>t+(parseInt(e)||0),0)},totalBolsasReportadas(t){return(t.reporteTaras||[]).reduce((e,a,r)=>{const o=parseInt(a)||0,s=parseInt(t.reporteBolsas[r])||0;return e+o*s},0)},coincideTaras(t){const e=this.totalTarasReportadas(t),a=this.totalTaras(t);return e===a},coincideTarasYBolsas(t){const e=this.totalTaras(t),a=this.totalTarasReportadas(t);return(0!==e||0!==a)&&e===a},tieneAlgunReporte(t){return(t.reporteTaras||[]).some(t=>t)||(t.reporteBolsas||[]).some(t=>t)},formatearKilos(t){return t.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:1})},compararMedidas(t,e){if(!t)return 1;if(!e)return-1;const a=t=>{const e=t.match(/\d+/g);return e?1===e.length?[parseInt(e[0]),parseInt(e[0])]:[parseInt(e[0]),parseInt(e[1])]:[0,0]},[r,o]=a(t),[s,i]=a(e);return r&&s?r-s:t.localeCompare(e)},formatearTallaCrudo(t){const e={"Med c/c":"Med","Med-Esp c/c":"Esp","Med-gde c/c":"M-G","Gde c/c":"Gde","Extra c/c":"Ext","Jumbo c/c":"Jbo",Linea:"Lin",Rechazo:"Rch"};return e[t]||t}}}},b2f8:function(t,e,a){},b7c0:function(t,e,a){"use strict";a("9fa0")},b9b6:function(t,e,a){"use strict";var r=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.clienteActivo===t.clienteId||null===t.clienteActivo,expression:"clienteActivo === clienteId || clienteActivo === null"}],staticClass:"cliente-grupo"},[e("div",{staticClass:"cliente-header sticky-header",attrs:{"data-cliente":t.nombreCliente}},[e("div",{staticClass:"cliente-info"},[e("h3",[t._v(" "+t._s(t.nombreCliente)+" "),e("button",{staticClass:"btn-pdf-mini",attrs:{title:"Vista previa PDF"},on:{click:function(e){return e.stopPropagation(),t.$emit("generar-pdf","cliente",t.clienteId)}}},[e("i",{staticClass:"fas fa-eye"})])]),e("div",{staticClass:"cliente-totales"},[e("span",[t._v("Limpio: "+t._s(t.calcularTotalLimpioCliente)+"T / "+t._s(t.formatearKilos(t.calcularKilosLimpioCliente))+"Kg")]),e("span",[t._v("Crudo: "+t._s(t.calcularTotalCrudoCliente)+"T / "+t._s(t.formatearKilos(t.calcularKilosCrudoCliente))+"Kg")])])]),e("div",{staticClass:"cliente-header-controls"},[e("div",{staticClass:"juntar-medidas-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.clientesJuntarMedidas[t.clienteId],expression:"clientesJuntarMedidas[clienteId]"}],attrs:{type:"checkbox",id:"juntar-medidas-"+t.clienteId,disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.clientesJuntarMedidas[t.clienteId])?t._i(t.clientesJuntarMedidas[t.clienteId],null)>-1:t.clientesJuntarMedidas[t.clienteId]},on:{change:[function(e){var a=t.clientesJuntarMedidas[t.clienteId],r=e.target,o=!!r.checked;if(Array.isArray(a)){var s=null,i=t._i(a,s);r.checked?i<0&&t.$set(t.clientesJuntarMedidas,t.clienteId,a.concat([s])):i>-1&&t.$set(t.clientesJuntarMedidas,t.clienteId,a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.clientesJuntarMedidas,t.clienteId,o)},t.handleJuntarMedidasChange],click:function(t){t.stopPropagation()}}}),e("label",{attrs:{for:"juntar-medidas-"+t.clienteId},on:{click:function(t){t.stopPropagation()}}},[t._v("Juntar medidas")])]),e("button",{staticClass:"btn btn-primary btn-sm generar-pdf-cliente",attrs:{type:"button",title:"Generar Nota de Venta PDF (incluye página sin precios)",disabled:t.isGeneratingPdf},on:{click:function(e){return e.stopPropagation(),t.$emit("generar-pdf","cliente",t.clienteId)}}},[t.isGeneratingPdf&&t.pdfType==="cliente-"+t.clienteId?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-file-pdf"}),t._v(" Generar Nota PDF ")]),t.esClienteJoselito?e("button",{staticClass:"btn btn-success btn-sm crear-cuenta-joselito",attrs:{type:"button",title:"Crear Cuenta para Joselito",disabled:t.isCreatingAccount},on:{click:function(e){return e.stopPropagation(),t.crearCuentaJoselito.apply(null,arguments)}}},[t.isCreatingAccount?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-plus-circle"}),t._v(" Crear Cuenta ")]):t._e(),t.esClienteCatarro?e("button",{staticClass:"btn btn-success btn-sm crear-cuenta-catarro",attrs:{type:"button",title:"Crear Cuenta para Catarro",disabled:t.isCreatingAccount},on:{click:function(e){return e.stopPropagation(),t.crearCuentaCatarro.apply(null,arguments)}}},[t.isCreatingAccount?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-plus-circle"}),t._v(" Crear Cuenta ")]):t._e(),t.esClienteOzuna?e("button",{staticClass:"btn btn-success btn-sm crear-cuenta-ozuna",attrs:{type:"button",title:"Crear Cuenta para Ozuna",disabled:t.isCreatingAccount},on:{click:function(e){return e.stopPropagation(),t.crearCuentaOzuna.apply(null,arguments)}}},[t.isCreatingAccount?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-plus-circle"}),t._v(" Crear Cuenta ")]):t._e(),e("button",{staticClass:"btn btn-danger btn-sm eliminar-cliente",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return e.stopPropagation(),t.$emit("eliminar-cliente",t.clienteId)}}},[t._v("Eliminar Cliente")])])]),e("div",{staticClass:"productos-container"},[t._l(t.productos,(function(a,r){return e("ProductoItem",{key:r,attrs:{producto:a,"embarque-bloqueado":t.embarqueBloqueado,"medidas-usadas":t.medidasUsadas,"nombre-cliente":t.nombreCliente},on:{"update:producto":t.actualizarProducto,"eliminar-producto":function(e){return t.$emit("eliminar-producto",a)},"mostrar-modal-precio":function(e){return t.$emit("mostrar-modal-precio",e)},"mostrar-modal-hilos":function(e){return t.$emit("mostrar-modal-hilos",e)},"mostrar-modal-nota":function(e){return t.$emit("mostrar-modal-nota",e)},"mostrar-modal-nombre-alternativo":function(e){return t.$emit("mostrar-modal-nombre-alternativo",e)},"mostrar-modal-alt":function(e){return t.$emit("mostrar-modal-alt",e)},"seleccionar-medida":t.seleccionarMedida,"consultar-precio-reciente":function(e){return t.$emit("consultar-precio-reciente",e)}}})})),t._l(t.crudos,(function(a,r){return e("CrudoItem",{key:"crudo-"+r,attrs:{crudo:a,"embarque-bloqueado":t.embarqueBloqueado,"cliente-id":t.clienteId,"crudo-index":r},on:{"update:crudo":function(e){return t.actualizarCrudo(r,e)},"eliminar-crudo":function(e){return t.$emit("eliminar-crudo",e,t.clienteId)},"eliminar-crudo-item":function(e){return t.$emit("eliminar-crudo-item",t.clienteId,...e)},"agregar-crudo-item":function(e){return t.$emit("agregar-crudo-item",t.clienteId,e)},"toggle-sobrante":function(e){return t.$emit("toggle-sobrante",t.clienteId,...e)},"mostrar-modal-precio":function(e){return t.$emit("mostrar-modal-precio",e)}}})}))],2),e("div",{staticClass:"botones-agregar"},[e("button",{staticClass:"btn btn-primary btn-sm agregar-producto",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.$emit("agregar-producto",t.clienteId)}}},[t._v("Agregar Producto")]),e("button",{staticClass:"btn btn-info btn-sm agregar-crudo",attrs:{type:"button",s:"",disabled:t.embarqueBloqueado},on:{click:function(e){return t.$emit("agregar-crudo",t.clienteId)}}},[t._v("Agregar Crudos")])])])},o=[],s=(a("13d5"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"producto",class:{"reporte-completo":t.coincideTarasYBolsas,"reporte-incompleto":!t.coincideTarasYBolsas&&t.tieneAlgunReporte,"taras-reportadas":t.coincideTaras,"taras-no-reportadas":t.totalTaras>0&&!t.coincideTaras,"medida-vacia":!t.producto.medida},attrs:{"data-es-venta":t.producto.esVenta}},[e("h2",{staticClass:"encabezado-medida"},[e("div",{staticClass:"botones-encabezado"},[e("div",{staticClass:"botones-fila-superior"},[e("button",{staticClass:"btn-precio",class:{"tiene-precio":t.producto.precio},on:{click:t.abrirModalPrecio}},[t._v(" $ ")]),e("button",{staticClass:"btn-hilos",class:{"tiene-hilos":t.producto.hilos},on:{click:t.abrirModalHilos}},[t._v(" H ")])]),e("div",{staticClass:"botones-fila-inferior"},[e("button",{staticClass:"btn-nota",class:{"tiene-nota":t.producto.nota},on:{click:t.abrirModalNota}},[t._v(" N ")]),e("div",{staticClass:"kg-radio"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.noSumarKilos,expression:"producto.noSumarKilos"}],staticClass:"kg-checkbox",attrs:{type:"checkbox",id:"kg-"+t.producto.id,disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.producto.noSumarKilos)?t._i(t.producto.noSumarKilos,null)>-1:t.producto.noSumarKilos},on:{change:function(e){var a=t.producto.noSumarKilos,r=e.target,o=!!r.checked;if(Array.isArray(a)){var s=null,i=t._i(a,s);r.checked?i<0&&t.$set(t.producto,"noSumarKilos",a.concat([s])):i>-1&&t.$set(t.producto,"noSumarKilos",a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.producto,"noSumarKilos",o)}}}),e("label",{attrs:{for:"kg-"+t.producto.id}},[t._v("kg")])])])]),e("span",{staticClass:"medida-texto",class:{disabled:t.embarqueBloqueado,"tiene-nombre-alternativo":t.producto.nombreAlternativoPDF},on:{click:t.handleNombreAlternativoClick}},["c/h20"===t.producto.tipo?[t._v(" "+t._s(t.producto.nombreAlternativoPDF||t.producto.medida||"Sin Medida")+" "),e("span",{staticClass:"ch20-text"},[t._v("c/h20")]),t.producto.nombreAlternativoPDF?e("span",{staticClass:"pdf-badge",attrs:{title:"Nombre personalizado para PDF"}},[t._v("PDF")]):t._e()]:[t._v(" "+t._s(t.producto.nombreAlternativoPDF||t.producto.medida||"Sin Medida")+" - "+t._s(t.obtenerTipoProducto)+" "),t.producto.nombreAlternativoPDF?e("span",{staticClass:"pdf-badge",attrs:{title:"Nombre personalizado para PDF"}},[t._v("PDF")]):t._e()]],2),t.producto.precio?e("span",{staticClass:"precio-tag"},[t._v("$"+t._s(t.producto.precio))]):t._e()]),e("div",{staticClass:"producto-header"},[e("div",{staticClass:"medida-input-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.medida,expression:"producto.medida"}],staticClass:"medida-input",attrs:{type:"text",placeholder:"Medida",disabled:t.embarqueBloqueado},domProps:{value:t.producto.medida},on:{input:[function(e){e.target.composing||t.$set(t.producto,"medida",e.target.value)},t.onMedidaInput],blur:t.onMedidaBlur}}),e("button",{staticClass:"btn-alt",class:{"tiene-alt":t.producto.textoAlternativo},attrs:{disabled:t.embarqueBloqueado},on:{click:t.abrirModalAlt}},[t._v(" Alt ")]),t.editandoMedida&&t.sugerenciasMedidas.length>0?e("div",{staticClass:"sugerencias-container"},t._l(t.sugerenciasMedidas,(function(a){return e("div",{key:a,staticClass:"sugerencia-item",on:{mousedown:function(e){return t.seleccionarMedida(a)}}},[t._v(" "+t._s(a)+" ")])})),0):t._e()]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.producto.tipo,expression:"producto.tipo"}],staticClass:"form-control tipo-select",class:{"tipo-azul":"c/h20"===t.producto.tipo,"tipo-verde":"s/h20"===t.producto.tipo},attrs:{disabled:t.embarqueBloqueado},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.producto,"tipo",e.target.multiple?a:a[0])},t.onTipoChange]}},[e("option",{attrs:{value:""}},[t._v("Seleccionar")]),e("option",{attrs:{value:"s/h20"}},[t._v("S/H20")]),e("option",{attrs:{value:"c/h20"}},[t._v("C/H20")]),e("option",{attrs:{value:"otro"}},[t._v("Otro")])]),t.isClienteOzuna?e("div",{staticClass:"venta-checkbox-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.esVenta,expression:"producto.esVenta"}],staticClass:"form-check-input venta-checkbox",attrs:{type:"checkbox",id:"ventaCheck-"+t.producto.id,disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.producto.esVenta)?t._i(t.producto.esVenta,null)>-1:t.producto.esVenta},on:{change:function(e){var a=t.producto.esVenta,r=e.target,o=!!r.checked;if(Array.isArray(a)){var s=null,i=t._i(a,s);r.checked?i<0&&t.$set(t.producto,"esVenta",a.concat([s])):i>-1&&t.$set(t.producto,"esVenta",a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.producto,"esVenta",o)}}}),e("label",{attrs:{for:"ventaCheck-"+t.producto.id}},[t._v("Venta")])]):t._e(),"otro"===t.producto.tipo?e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.tipoPersonalizado,expression:"producto.tipoPersonalizado"}],staticClass:"form-control tipo-input",attrs:{type:"text",placeholder:"Especificar",disabled:t.embarqueBloqueado},domProps:{value:t.producto.tipoPersonalizado},on:{input:function(e){e.target.composing||t.$set(t.producto,"tipoPersonalizado",e.target.value)}}}):t._e(),e("button",{staticClass:"btn btn-danger btn-sm eliminar-producto",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.eliminarProducto}},[t._v("X")])]),"c/h20"===t.producto.tipo?e("div",{staticClass:"valores-container-debajo"},[e("div",{staticClass:"valor-neto-container"},[e("label",[t._v("Valor neto:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.camaronNeto,expression:"producto.camaronNeto"}],staticClass:"camaron-neto-input ios-numeric",attrs:{type:"number",step:"0.01",min:"0",max:"1",inputmode:"numeric",pattern:"[0-9]*",disabled:t.embarqueBloqueado},domProps:{value:t.producto.camaronNeto},on:{input:function(e){e.target.composing||t.$set(t.producto,"camaronNeto",e.target.value)}}})])]):t._e(),e("div",{staticClass:"sumas-verticales"},[e("div",{staticClass:"columna"},[e("div",{staticClass:"taras-header"},[e("h5",[t._v("Taras")]),e("div",{staticClass:"checkbox-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.restarTaras,expression:"producto.restarTaras"}],attrs:{type:"checkbox",disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.producto.restarTaras)?t._i(t.producto.restarTaras,null)>-1:t.producto.restarTaras},on:{change:function(e){var a=t.producto.restarTaras,r=e.target,o=!!r.checked;if(Array.isArray(a)){var s=null,i=t._i(a,s);r.checked?i<0&&t.$set(t.producto,"restarTaras",a.concat([s])):i>-1&&t.$set(t.producto,"restarTaras",a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.producto,"restarTaras",o)}}}),e("label",[t._v("-3")])])]),t._l(t.producto.taras,(function(a,r){return e("div",{key:r,staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.producto.taras[r],expression:"producto.taras[taraIndex]",modifiers:{number:!0}}],staticClass:"form-control tara-input",attrs:{type:"tel",placeholder:"Tara",size:String(t.producto.taras[r]||"").length||1,disabled:t.embarqueBloqueado},domProps:{value:t.producto.taras[r]},on:{focus:function(t){return t.target.select()},input:function(e){e.target.composing||t.$set(t.producto.taras,r,t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),e("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.eliminarTara(r)}}},[t._v("-")])])})),t._l(t.producto.tarasExtra,(function(a,r){return e("div",{key:"extra-"+r,staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.producto.tarasExtra[r],expression:"producto.tarasExtra[taraExtraIndex]",modifiers:{number:!0}}],staticClass:"form-control tara-input",attrs:{type:"tel",placeholder:"Tara Extra",size:String(t.producto.tarasExtra[r]||"").length||1,disabled:t.embarqueBloqueado},domProps:{value:t.producto.tarasExtra[r]},on:{focus:function(t){return t.target.select()},input:function(e){e.target.composing||t.$set(t.producto.tarasExtra,r,t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),e("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.eliminarTaraExtra(r)}}},[t._v("-")])])})),e("div",{staticClass:"botones-tara"},[e("button",{staticClass:"btn btn-success btn-sm agregar-tara",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.agregarTara}},[t._v("+")]),e("button",{staticClass:"btn btn-warning btn-sm agregar-tara-extra",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.agregarTaraExtra}},[t._v("+ Extra")])]),e("div",{staticClass:"total"},[t._v("Total: "+t._s(t.totalTaras))])],2),e("div",{staticClass:"columna"},[e("h5",[t._v("Kilos")]),t._l(t.producto.kilos,(function(a,r){return e("div",{key:r,staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.producto.kilos[r],expression:"producto.kilos[kiloIndex]",modifiers:{number:!0}}],staticClass:"form-control kilo-input",attrs:{type:"tel",placeholder:"Kilos",size:String(t.producto.kilos[r]||"").length||1,disabled:t.embarqueBloqueado},domProps:{value:t.producto.kilos[r]},on:{focus:function(t){return t.target.select()},input:[function(e){e.target.composing||t.$set(t.producto.kilos,r,t._n(e.target.value))},t.actualizarProducto],blur:function(e){return t.$forceUpdate()}}})])})),e("div",{staticStyle:{height:"38px"}}),e("div",{staticClass:"total"},[t._v("Total: "+t._s(t.totalKilos))])],2)]),e("div",{staticClass:"reporte-taras-bolsas"},[e("div",{staticClass:"reporte-item"},[e("h5",[t._v("Taras")]),t._l(t.producto.reporteTaras,(function(a,r){return e("div",{key:r,staticClass:"input-group mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.reporteTaras[r],expression:"producto.reporteTaras[index]"}],staticClass:"form-control reporte-input",attrs:{type:"tel",disabled:t.embarqueBloqueado},domProps:{value:t.producto.reporteTaras[r]},on:{focus:function(t){return t.target.select()},input:[function(e){e.target.composing||t.$set(t.producto.reporteTaras,r,e.target.value)},t.actualizarProducto]}}),e("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.eliminarReporteTara(r)}}},[t._v("-")])])})),e("button",{staticClass:"btn btn-success btn-sm",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.agregarReporteTara}},[t._v("+")]),e("div",{staticClass:"total-taras-reporte",class:{coincide:t.coincideTaras,"no-coincide":!t.coincideTaras}},[t._v(" Reportadas: "+t._s(t.totalTarasReportadas)+" ")])],2),e("div",{staticClass:"reporte-item"},[e("h5",[t._v("Bolsas")]),t._l(t.producto.reporteBolsas,(function(a,r){return e("div",{key:r,staticClass:"input-group mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.reporteBolsas[r],expression:"producto.reporteBolsas[index]"}],staticClass:"form-control reporte-input",attrs:{type:"tel",disabled:t.embarqueBloqueado},domProps:{value:t.producto.reporteBolsas[r]},on:{focus:function(t){return t.target.select()},input:[function(e){e.target.composing||t.$set(t.producto.reporteBolsas,r,e.target.value)},t.actualizarProducto]}})])})),e("div",{staticStyle:{height:"31px"}}),e("div",{staticClass:"total-bolsas-reporte"},[t._v(" Bolsas: "+t._s(t.totalBolsasReportadas)+" ")])],2)]),t.reporteExcedeTresParentesis?e("div",{staticClass:"reporte-extenso"},[t._v(" "+t._s(t.generarReporteExtenso)+" ")]):t._e(),e("div",{staticClass:"producto-precio-container"},[t.isClienteOzuna?e("div",{staticClass:"maquila-switch"},[e("label",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.esMaquila,expression:"producto.esMaquila"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.producto.esMaquila)?t._i(t.producto.esMaquila,null)>-1:t.producto.esMaquila},on:{change:[function(e){var a=t.producto.esMaquila,r=e.target,o=!!r.checked;if(Array.isArray(a)){var s=null,i=t._i(a,s);r.checked?i<0&&t.$set(t.producto,"esMaquila",a.concat([s])):i>-1&&t.$set(t.producto,"esMaquila",a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.producto,"esMaquila",o)},t.onMaquilaChanged]}}),e("span",[t._v("Maquila")])])]):t._e(),e("div",{staticClass:"producto-precio"},[e("label",[t._v("Precio:")]),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.producto.precio,expression:"producto.precio",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"Precio",disabled:t.producto.esMaquila},domProps:{value:t.producto.precio},on:{input:function(e){e.target.composing||t.$set(t.producto,"precio",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])])])}),i=[],n=(a("14d9"),{name:"ProductoItem",props:{producto:{type:Object,required:!0},embarqueBloqueado:{type:Boolean,default:!1},medidasUsadas:{type:Array,default:()=>[]},nombreCliente:{type:String,default:""}},data(){return{editandoMedida:!1,sugerenciasMedidas:[],showSobranteModal:!1,sobranteTemp:"",lastSobrante:"",esItemModificado:!1}},emits:["update:producto","eliminar-producto","mostrar-modal-precio","mostrar-modal-hilos","mostrar-modal-nota","mostrar-modal-nombre-alternativo","mostrar-modal-alt","actualizar-medidas-usadas","seleccionar-medida","consultar-precio-reciente"],computed:{isClienteOzuna(){return"ozuna"===this.nombreCliente.toLowerCase()},totalTaras(){const t=(this.producto.taras||[]).reduce((t,e)=>t+(e||0),0),e=(this.producto.tarasExtra||[]).reduce((t,e)=>t+(e||0),0);return t+e},totalKilos(){const t=(this.producto.kilos||[]).reduce((t,e)=>t+(e||0),0),e=(this.producto.taras||[]).reduce((t,e)=>t+(e||0),0),a=this.producto.restarTaras?3*e:0,r=Number((t-a).toFixed(1));return r},obtenerTipoProducto(){return"otro"===this.producto.tipo?this.producto.tipoPersonalizado||"Otro":this.producto.tipo||"Sin Tipo"},totalTarasReportadas(){return(this.producto.reporteTaras||[]).reduce((t,e)=>t+(parseInt(e)||0),0)},totalBolsasReportadas(){return(this.producto.reporteTaras||[]).reduce((t,e,a)=>{const r=parseInt(e)||0,o=parseInt(this.producto.reporteBolsas[a])||0;return t+r*o},0)},coincideTaras(){return this.totalTarasReportadas===this.totalTaras},coincideTarasYBolsas(){const t=this.totalTaras,e=this.totalTarasReportadas;return(0!==t||0!==e)&&t===e},tieneAlgunReporte(){return(this.producto.reporteTaras||[]).some(t=>t)||(this.producto.reporteBolsas||[]).some(t=>t)},reporteExcedeTresParentesis(){const t=this.combinarTarasBolsas();return(t.match(/\(/g)||[]).length>3},generarReporteExtenso(){const t=this.combinarTarasBolsas();return t.replace(/\) /g,")\n")}},methods:{actualizarProducto(){!this.isClienteOzuna||this.producto.esMaquila||this.producto.precio&&0!==this.producto.precio||(this.producto.precio=60),this.$emit("update:producto",this.producto)},handleNombreAlternativoClick(){this.embarqueBloqueado||this.abrirModalNombreAlternativo()},agregarTara(){this.producto.taras.push(null),this.producto.kilos.push(null),this.actualizarProducto()},eliminarTara(t){this.producto.taras.splice(t,1),this.producto.kilos.splice(t,1),this.actualizarProducto()},agregarTaraExtra(){Array.isArray(this.producto.tarasExtra)||this.$set(this.producto,"tarasExtra",[]),this.producto.tarasExtra.push(null),this.actualizarProducto()},eliminarTaraExtra(t){this.producto.tarasExtra.splice(t,1),this.actualizarProducto()},agregarReporteTara(){Array.isArray(this.producto.reporteTaras)||this.$set(this.producto,"reporteTaras",[]),Array.isArray(this.producto.reporteBolsas)||this.$set(this.producto,"reporteBolsas",[]),this.producto.reporteTaras.push(null),this.producto.reporteBolsas.push(null),this.actualizarProducto()},eliminarReporteTara(t){this.producto.reporteTaras.splice(t,1),this.producto.reporteBolsas.splice(t,1),this.actualizarProducto()},combinarTarasBolsas(){const t={},e=this.producto.reporteTaras||[],a=this.producto.reporteBolsas||[];return e.forEach((e,r)=>{const o=a[r]||"",s=o;t[s]=(t[s]||0)+parseInt(e||1)}),Object.entries(t).map(([t,e])=>`(${e}-${t})`).join(" ")},onMedidaInput(t){const e=t.target.value.toLowerCase();this.editandoMedida=!0,this.sugerenciasMedidas=e?this.medidasUsadas.filter(t=>t.toLowerCase().includes(e)&&t.toLowerCase()!==e):[],this.producto.isEditing=!0,this.actualizarProducto()},onMedidaBlur(){setTimeout(()=>{this.editandoMedida=!1},200),this.actualizarProducto()},seleccionarMedida(t){this.producto.medida=t,this.editandoMedida=!1,this.$emit("seleccionar-medida",this.producto,t)},onTipoChange(){"otro"!==this.producto.tipo&&(this.producto.tipoPersonalizado=""),"c/h20"!==this.producto.tipo||this.producto.camaronNeto||(this.producto.camaronNeto=.65),this.actualizarProducto()},abrirModalPrecio(){this.$emit("mostrar-modal-precio",this.producto)},abrirModalHilos(){this.$emit("mostrar-modal-hilos",this.producto)},abrirModalNota(){this.$emit("mostrar-modal-nota",this.producto)},abrirModalNombreAlternativo(){this.$emit("mostrar-modal-nombre-alternativo",this.producto)},abrirModalAlt(){this.$emit("mostrar-modal-alt",this.producto)},eliminarProducto(){this.$emit("eliminar-producto",this.producto)},onMaquilaChanged(){this.producto.esMaquila?this.producto.precio=20:this.producto.precio&&0!==this.producto.precio&&20!==this.producto.precio||(this.$emit("consultar-precio-reciente",this.producto),this.producto.precio=60),this.$emit("update:producto",this.producto)}}}),c=n,l=(a("3dbb"),a("2877")),d=Object(l["a"])(c,s,i,!1,null,"01f9ec7a",null),u=d.exports,m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"producto crudo"},[e("h2",{staticClass:"crudo-header"},[t._v("Crudos")]),e("div",{staticClass:"crudo-items"},t._l(t.crudoData.items||[],(function(a,r){return e("div",{key:"item-"+r,staticClass:"crudo-item"},[e("div",{staticClass:"crudo-talla-container"},[e("button",{staticClass:"btn-precio",class:{"tiene-precio":a.precio},attrs:{disabled:t.embarqueBloqueado},on:{click:function(e){return t.abrirModalPrecio(a)}}},[t._v(" $ ")]),e("select",{directives:[{name:"model",rawName:"v-model",value:a.talla,expression:"item.talla"}],staticClass:"form-control talla-select",attrs:{disabled:t.embarqueBloqueado},on:{change:[function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"talla",e.target.multiple?r:r[0])},function(e){return t.onTallaCrudoChange(a)}]}},[e("option",{attrs:{value:""}},[t._v("Elige talla")]),e("option",{attrs:{value:"Med c/c"}},[t._v("Med c/c")]),e("option",{attrs:{value:"Med-Esp c/c"}},[t._v("Med-Esp c/c")]),e("option",{attrs:{value:"Med-gde c/c"}},[t._v("Med-gde c/c")]),e("option",{attrs:{value:"Gde c/c"}},[t._v("Gde c/c")]),e("option",{attrs:{value:"Gde c/ Extra"}},[t._v("Gde c/ Extra c/c")]),e("option",{attrs:{value:"Extra c/c"}},[t._v("Extra c/c")]),e("option",{attrs:{value:"Jumbo c/c"}},[t._v("Jumbo c/c")]),e("option",{attrs:{value:"Linea"}},[t._v("Linea")]),e("option",{attrs:{value:"Lag gde c/c"}},[t._v("Lag gde c/c")]),e("option",{attrs:{value:"Rechazo"}},[t._v("Rechazo")])]),a.precio?e("span",{staticClass:"precio-tag"},[t._v("$"+t._s(a.precio))]):t._e(),e("input",{directives:[{name:"model",rawName:"v-model",value:a.barco,expression:"item.barco"}],staticClass:"form-control barco-input",attrs:{type:"text",placeholder:"Barco",disabled:t.embarqueBloqueado},domProps:{value:a.barco},on:{input:[function(e){e.target.composing||t.$set(a,"barco",e.target.value)},t.actualizarCrudo]}})]),e("div",{staticClass:"crudo-taras-container"},[e("div",{staticClass:"taras-wrapper"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.taras,expression:"item.taras"}],staticClass:"form-control taras-input",attrs:{type:"text",placeholder:"Taras",disabled:t.embarqueBloqueado},domProps:{value:a.taras},on:{input:[function(e){e.target.composing||t.$set(a,"taras",e.target.value)},t.actualizarCrudo]}}),a.mostrarSobrante?e("input",{directives:[{name:"model",rawName:"v-model",value:a.sobrante,expression:"item.sobrante"}],staticClass:"form-control taras-input",attrs:{type:"text",placeholder:"Sbrte",disabled:t.embarqueBloqueado},domProps:{value:a.sobrante},on:{input:[function(e){e.target.composing||t.$set(a,"sobrante",e.target.value)},t.actualizarCrudo]}}):t._e()]),e("div",{staticClass:"buttons-wrapper"},[e("button",{staticClass:"btn btn-danger btn-sm eliminar-crudo-item",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.eliminarCrudoItem(r)}}},[t._v("-")]),e("button",{staticClass:"btn btn-success btn-sm agregar-sobrante",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.toggleSobrante(r)}}},[t._v("+")])])])])})),0),e("div",{staticClass:"crudo-footer"},[e("button",{staticClass:"btn btn-primary btn-sm agregar-crudo-item",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.agregarCrudoItem}},[t._v("+ Agregar Talla/Taras")]),e("button",{staticClass:"btn btn-danger btn-sm eliminar-crudo",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.eliminarCrudo}},[t._v("Eliminar Crudo")]),e("div",{staticClass:"total-crudos"},[t._v("Total de taras: "+t._s(t.calcularTotalCrudos))])])])},p=[],b={name:"CrudoItem",props:{crudo:{type:Object,default:()=>({items:[]})},embarqueBloqueado:{type:Boolean,default:!1},clienteId:{type:[String,Number],required:!0},crudoIndex:{type:Number,required:!0}},emits:["update:crudo","eliminar-crudo","eliminar-crudo-item","agregar-crudo-item","toggle-sobrante","mostrar-modal-precio"],data(){return{crudoData:this.crudo||{items:[]}}},watch:{crudo:{handler(t){this.crudoData=t||{items:[]}},immediate:!0}},computed:{calcularTotalCrudos(){return this.crudoData&&this.crudoData.items&&Array.isArray(this.crudoData.items)?this.crudoData.items.reduce((t,e)=>{let a=this.extraerNumero(e.taras),r=this.extraerNumero(e.sobrante);return t+a+r},0):0}},methods:{extraerNumero(t){if(!t)return 0;const e=t.toString().match(/^(\d+)/);return e?parseInt(e[1]):0},actualizarCrudo(){this.$emit("update:crudo",this.crudoData)},abrirModalPrecio(t){this.$emit("mostrar-modal-precio",t)},onTallaCrudoChange(t){t.medida||(t.medida=t.talla),this.actualizarCrudo()},agregarCrudoItem(){this.crudoData.items||(this.crudoData.items=[]),this.crudoData.items.push({talla:"",barco:"",taras:"",sobrante:"",precio:null,mostrarSobrante:!1}),this.actualizarCrudo()},eliminarCrudoItem(t){this.crudoData.items&&this.crudoData.items.length>t&&(this.crudoData.items.splice(t,1),this.actualizarCrudo())},eliminarCrudo(){this.$emit("eliminar-crudo",this.crudoIndex,this.clienteId)},toggleSobrante(t){this.crudoData.items&&this.crudoData.items.length>t&&(this.crudoData.items[t].mostrarSobrante=!this.crudoData.items[t].mostrarSobrante,this.crudoData.items[t].mostrarSobrante||(this.crudoData.items[t].sobrante=""),this.actualizarCrudo())}}},h=b,v=(a("a712"),Object(l["a"])(h,m,p,!1,null,"69a3beb0",null)),f=v.exports,g={name:"ClienteProductos",components:{ProductoItem:u,CrudoItem:f},props:{clienteId:{type:[String,Number],required:!0},productos:{type:Array,default:()=>[]},crudos:{type:Array,default:()=>[]},clientesJuntarMedidas:{type:Object,default:()=>({})},nombreCliente:{type:String,required:!0},clienteActivo:{type:[String,Number,null],default:null},embarqueBloqueado:{type:Boolean,default:!1},medidasUsadas:{type:Array,default:()=>[]},isGeneratingPdf:{type:Boolean,default:!1},pdfType:{type:String,default:""},isCreatingAccount:{type:Boolean,default:!1}},emits:["update:productos","update:crudos","juntarMedidas-change","eliminar-cliente","eliminar-producto","eliminar-crudo","eliminar-crudo-item","agregar-producto","agregar-crudo","agregar-crudo-item","toggle-sobrante","mostrar-modal-precio","mostrar-modal-hilos","mostrar-modal-nota","mostrar-modal-nombre-alternativo","mostrar-modal-alt","seleccionar-medida","generar-pdf","crear-cuenta-joselito","crear-cuenta-catarro","crear-cuenta-ozuna","consultar-precio-reciente"],computed:{esClienteJoselito(){return this.nombreCliente.toLowerCase().includes("joselito")},esClienteCatarro(){return this.nombreCliente.toLowerCase().includes("catarro")},esClienteOzuna(){return this.nombreCliente.toLowerCase().includes("ozuna")},calcularTotalLimpioCliente(){return this.productos.reduce((t,e)=>{const a=(e.taras||[]).reduce((t,e)=>t+(e||0),0),r=(e.tarasExtra||[]).reduce((t,e)=>t+(e||0),0);return t+a+r},0)},calcularKilosLimpioCliente(){return this.productos.reduce((t,e)=>{if("c/h20"===e.tipo){const a=e.reporteTaras||[],r=e.reporteBolsas||[];let o=0;for(let t=0;t<a.length;t++){const e=parseInt(a[t])||0,s=parseInt(r[t])||0;o+=e*s}const s=o*(e.camaronNeto||.65);return t+s}{const a=(e.kilos||[]).reduce((t,e)=>t+(e||0),0),r=(e.taras||[]).reduce((t,e)=>t+(e||0),0),o=e.restarTaras?3*r:0,s=Number((a-o).toFixed(1));return t+s}},0)},calcularTotalCrudoCliente(){return this.crudos.reduce((t,e)=>e&&e.items&&Array.isArray(e.items)?t+e.items.reduce((t,e)=>{let a=this.extraerNumero(e.taras),r=this.extraerNumero(e.sobrante);return t+a+r},0):t,0)},calcularKilosCrudoCliente(){return this.crudos.reduce((t,e)=>e&&e.items&&Array.isArray(e.items)?t+e.items.reduce((t,e)=>t+this.calcularKilosCrudos(e),0):t,0)}},methods:{extraerNumero(t){if(!t)return 0;const e=t.toString().match(/^(\d+)/);return e?parseInt(e[1]):0},actualizarProducto(t){this.$emit("update:productos",this.productos.map(e=>e.id===t.id?t:e))},actualizarCrudo(t,e){const a=[...this.crudos];a[t]=e,this.$emit("update:crudos",a)},seleccionarMedida(t,e){t.medida=e,this.actualizarProducto(t),this.$emit("seleccionar-medida",t,e)},calcularKilosCrudos(t){let e=0;if(t.taras){const a=/^(\d+)-(\d+)$/.exec(t.taras);if(a){const t=parseInt(a[1])||0;let r=parseInt(a[2])||0;19===r&&(r=20),e+=t*r}else{const[a,r]=t.taras.split("-").map(Number);e+=a*r}}if(t.sobrante){const a=/^(\d+)-(\d+)$/.exec(t.sobrante);if(a){const t=parseInt(a[1])||0;let r=parseInt(a[2])||0;19===r&&(r=20),e+=t*r}else{const[a,r]=t.sobrante.split("-").map(Number);e+=a*r}}return e},formatearKilos(t){return t.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:1})},handleJuntarMedidasChange(t){this.$emit("juntarMedidas-change",this.clienteId,t.target.checked)},crearCuentaJoselito(){this.$emit("crear-cuenta-joselito",this.clienteId,this.productos,this.crudos)},crearCuentaCatarro(){this.$emit("crear-cuenta-catarro",this.clienteId,this.productos,this.crudos)},crearCuentaOzuna(){this.$emit("crear-cuenta-ozuna",this.clienteId,this.productos,this.crudos)}}},C=g,q=(a("b7c0"),Object(l["a"])(C,r,o,!1,null,"33d000e0",null));e["a"]=q.exports},bcb0:function(t,e,a){"use strict";a("9321")},bf5e:function(t,e,a){"use strict";a("7c84")},c005:function(t,e,a){"use strict";var r=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Establecer Hilos"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarHilos}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"hilosInput"}},[t._v("Hilos:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hilosLocal,expression:"hilosLocal"}],ref:"hilosInput",staticClass:"form-control",attrs:{type:"text",id:"hilosInput",placeholder:"Ingrese los hilos"},domProps:{value:t.hilosLocal},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardarHilos.apply(null,arguments)},input:function(e){e.target.composing||(t.hilosLocal=e.target.value)}}})])])},o=[],s=a("ff7a"),i={name:"HilosModal",components:{BaseModal:s["a"]},props:{mostrar:{type:Boolean,required:!0},hilos:{type:String,default:""}},data(){return{hilosLocal:""}},watch:{mostrar(t){t&&(this.hilosLocal=this.hilos,this.$nextTick(()=>{var t;null===(t=this.$refs.hilosInput)||void 0===t||t.focus()}))},hilos(t){this.hilosLocal=t}},methods:{guardarHilos(){this.$emit("guardar",this.hilosLocal.trim())}}},n=i,c=(a("bcb0"),a("2877")),l=Object(c["a"])(n,r,o,!1,null,"9fafdd8a",null);e["a"]=l.exports},c0b0:function(t,e,a){"use strict";var r=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Nombre Alternativo para PDF"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarAlt}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"altInput"}},[t._v("Nombre alternativo:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.altLocal,expression:"altLocal"}],ref:"altInput",staticClass:"form-control",attrs:{type:"text",id:"altInput",placeholder:"Ingrese el nombre alternativo para PDF"},domProps:{value:t.altLocal},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardarAlt.apply(null,arguments)},input:function(e){e.target.composing||(t.altLocal=e.target.value)}}}),e("small",{staticClass:"form-text text-muted"},[t._v(" Este nombre solo se mostrará en el PDF de resumen de embarque. ")])])])},o=[],s=a("ff7a"),i={name:"AltModal",components:{BaseModal:s["a"]},props:{mostrar:{type:Boolean,required:!0},alt:{type:String,default:""}},data(){return{altLocal:""}},watch:{mostrar(t){t&&(this.altLocal=this.alt,this.$nextTick(()=>{var t;null===(t=this.$refs.altInput)||void 0===t||t.focus()}))},alt(t){this.altLocal=t}},methods:{guardarAlt(){this.$emit("guardar",this.altLocal.trim())}}},n=i,c=(a("6f30"),a("2877")),l=Object(c["a"])(n,r,o,!1,null,"4a536e6c",null);e["a"]=l.exports},dc98:function(t,e,a){"use strict";a("ecde")},e066:function(t,e,a){"use strict";a("35d3")},e7ae:function(t,e,a){"use strict";a("d9e2"),a("14d9"),a("88e6"),a("70cc"),a("eb03"),a("22e5c"),a("c01e"),a("fa76"),a("8306");e["a"]={methods:{async generarPDF(t,e=null){this.$set(this,"isGeneratingPdf",!0),this.$set(this,"pdfType",e?`${t}-${e}`:t);try{switch(t){case"cliente":await this.generarPDFCliente(e);break;case"all":await this.generarPDFTodosClientes();break;case"taras":await this.generarPDFTaras();break;case"resumen":await this.generarPDFResumen();break;default:throw new Error("Tipo de PDF no soportado: "+t)}console.log(`PDF ${t} generado con éxito`)}catch(a){console.error(`Error al generar PDF ${t}:`,a),alert("Hubo un error al generar el PDF: "+a.message)}finally{this.$set(this,"isGeneratingPdf",!1),this.$set(this,"pdfType",null)}},async generarPDFCliente(t){const e=this.productosPorCliente[t],r=this.clienteCrudos[t];e&&e.forEach(t=>{t.medida&&t.tipo&&(t.isEditing=!1,t.isNew=!1)});const o={fecha:this.embarque.fecha,cargaCon:this.embarque.cargaCon,productos:e,clienteCrudos:{[t]:r},kilosCrudos:this.embarque.kilosCrudos||{}},{generarNotaVentaPDF:s}=await a.e("chunk-e0336d58").then(a.bind(null,"2fe3"));s(o,this.clientesDisponibles,this.clientesJuntarMedidas)},async generarPDFTodosClientes(){this.embarque.productos&&this.embarque.productos.forEach(t=>{t.medida&&t.tipo&&(t.isEditing=!1,t.isNew=!1)});const t={fecha:this.embarque.fecha,cargaCon:this.embarque.cargaCon,productos:this.embarque.productos,clienteCrudos:this.clienteCrudos,kilosCrudos:this.embarque.kilosCrudos||{}},{generarNotaVentaPDF:e}=await a.e("chunk-e0336d58").then(a.bind(null,"2fe3"));e(t,this.clientesDisponibles,this.clientesJuntarMedidas)},async generarPDFTaras(){const t={fecha:this.embarque.fecha,cargaCon:this.embarque.cargaCon,productos:this.embarque.productos,clienteCrudos:this.clienteCrudos},{generarResumenTarasPDF:e}=await a.e("chunk-683041fc").then(a.bind(null,"80ac"));e(t,this.clientesDisponibles)},async generarPDFResumen(){const t=new Set;Object.values(this.clienteCrudos).forEach(e=>{e.forEach(e=>{e&&e.items&&Array.isArray(e.items)&&e.items.forEach(e=>{e.talla&&t.add(e.talla)})})});const e=this.prepararDatosResumenEmbarque(t),{generarResumenEmbarquePDF:r}=await a.e("chunk-2d0d096d").then(a.bind(null,"692f"));r(e,this.productosPorCliente,this.obtenerNombreCliente,this.clientesDisponibles)},prepararDatosResumenEmbarque(t){return{...this.embarque,crudos:Object.entries(this.clienteCrudos).flatMap(([t,e])=>e.flatMap(e=>e&&e.items&&Array.isArray(e.items)?e.items.map(e=>{const a=[];return e.taras&&a.push(e.taras),e.sobrante&&a.push(e.sobrante),{clienteId:t,medida:e.talla,taras:a,barco:e.barco,textoAlternativo:e.textoAlternativo,precio:e.precio}}):[])),medidasCrudos:Array.from(t)}}}}},e9de:function(t,e,a){},eb99:function(t,e,a){"use strict";var r=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Agregar Nuevo Cliente","texto-boton-confirmar":"Agregar"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.agregarCliente}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"nombreCliente"}},[t._v("Nombre del Cliente:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nombreCliente,expression:"nombreCliente"}],ref:"nombreInput",staticClass:"form-control",attrs:{type:"text",id:"nombreCliente",placeholder:"Ingrese el nombre del cliente"},domProps:{value:t.nombreCliente},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.agregarCliente.apply(null,arguments)},input:function(e){e.target.composing||(t.nombreCliente=e.target.value)}}})])])},o=[],s=a("ff7a"),i={name:"NuevoClienteModal",components:{BaseModal:s["a"]},props:{mostrar:{type:Boolean,required:!0}},data(){return{nombreCliente:"",colorCliente:"#007bff"}},watch:{mostrar(t){t&&(this.nombreCliente="",this.$nextTick(()=>{var t;null===(t=this.$refs.nombreInput)||void 0===t||t.focus()}))}},methods:{agregarCliente(){""!==this.nombreCliente.trim()?(this.$emit("agregar",{nombre:this.nombreCliente,color:this.colorCliente}),this.nombreCliente=""):alert("Por favor, ingrese un nombre para el nuevo cliente.")}}},n=i,c=(a("053c"),a("2877")),l=Object(c["a"])(n,r,o,!1,null,"091821fc",null);e["a"]=l.exports},ecde:function(t,e,a){},ee28:function(t,e,a){},f005:function(t,e,a){"use strict";a("1eaa")},fdb2:function(t,e,a){"use strict";var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"header-embarque"},[e("h1",[t._v(t._s(t.modoEdicion?"Embarque":"Nuevo Embarque"))]),e("div",{staticClass:"botones"},[e("button",{staticClass:"btn-volver",on:{click:t.volverAEmbarquesMenu}},[e("i",{staticClass:"fas fa-arrow-left"}),t._v(" Volver a Menu ")]),e("button",{class:["btn-bloqueo",{bloqueado:t.embarqueBloqueado}],on:{click:t.toggleBloqueo}},[e("i",{class:["fas",t.embarqueBloqueado?"fa-lock":"fa-lock-open"]}),t._v(" "+t._s(t.embarqueBloqueado?"Desbloquear":"Bloquear")+" Embarque ")])]),e("div",{staticClass:"botones-accion"},[e("button",{staticClass:"btn btn-info",attrs:{disabled:t.isGeneratingPdf},on:{click:function(e){return t.$emit("generar-taras")}}},[t.isGeneratingPdf&&"taras"===t.pdfType?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-file-pdf"}),t._v(" PDF Taras ")]),e("button",{staticClass:"btn btn-info",attrs:{disabled:t.isGeneratingPdf},on:{click:function(e){return t.$emit("generar-resumen")}}},[t.isGeneratingPdf&&"resumen"===t.pdfType?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-file-pdf"}),t._v(" Resumen Embarque ")]),t.embarqueId&&""!==t.embarqueId?e("router-link",{staticClass:"btn btn-warning",class:{disabled:t.isGeneratingPdf},attrs:{to:{name:"Rendimientos",params:{id:t.embarqueId}}}},[e("i",{staticClass:"fas fa-chart-line"}),t._v(" Rendimientos ")]):t._e(),e("precios-historial-modal",{attrs:{clienteActual:t.clienteEmbarque}})],1),e("div",{staticClass:"header"},[e("div",{staticClass:"header-row"},[e("div",{staticClass:"fecha-selector"},[e("label",{attrs:{for:"fecha"}},[t._v("Fecha de Embarque:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.fechaLocal,expression:"fechaLocal"}],staticClass:"form-control",attrs:{type:"date",id:"fecha",required:"",disabled:t.embarqueBloqueado},domProps:{value:t.fechaLocal},on:{change:t.actualizarFecha,input:function(e){e.target.composing||(t.fechaLocal=e.target.value)}}})]),e("div",{staticClass:"carga-selector"},[e("label",{attrs:{for:"cargaCon"}},[t._v("Carga con:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.cargaConLocal,expression:"cargaConLocal"}],staticClass:"form-control",attrs:{id:"cargaCon",required:"",disabled:t.embarqueBloqueado},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.cargaConLocal=e.target.multiple?a:a[0]},t.actualizarCargaCon]}},[e("option",{attrs:{value:""}},[t._v("Seleccionar")]),e("option",{attrs:{value:"Porro"}},[t._v("Porro")]),e("option",{attrs:{value:"Caminante"}},[t._v("Caminante")])])])])])])},o=[],s=a("666c"),i={name:"HeaderEmbarque",components:{PreciosHistorialModal:s["a"]},props:{modoEdicion:{type:Boolean,default:!1},embarqueBloqueado:{type:Boolean,default:!1},embarque:{type:Object,required:!0,validator:t=>"fecha"in t&&"cargaCon"in t},isGeneratingPdf:{type:Boolean,default:!1},pdfType:{type:String,default:""},embarqueId:{type:String,default:""},clienteEmbarque:{type:String,default:""}},data(){return{fechaLocal:this.embarque.fecha,cargaConLocal:this.embarque.cargaCon}},watch:{"embarque.fecha"(t){this.fechaLocal=t},"embarque.cargaCon"(t){this.cargaConLocal=t}},methods:{volverAEmbarquesMenu(){this.$emit("volver")},toggleBloqueo(){this.$emit("toggle-bloqueo")},actualizarFecha(){this.embarqueId&&localStorage.setItem("ultimoEmbarqueId",this.embarqueId),this.$emit("verificar-fecha",this.fechaLocal)},actualizarCargaCon(){this.$emit("update:cargaCon",this.cargaConLocal)}}},n=i,c=(a("e066"),a("2877")),l=Object(c["a"])(n,r,o,!1,null,"143b8123",null);e["a"]=l.exports},ff7a:function(t,e,a){"use strict";var r=function(){var t=this,e=t._self._c;return t.mostrar?e("div",{staticClass:"modal-overlay",on:{click:function(e){return e.target!==e.currentTarget?null:t.cerrar.apply(null,arguments)}}},[e("div",{staticClass:"modal-contenido",on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"modal-header"},[e("h3",[t._v(t._s(t.titulo))]),e("button",{staticClass:"btn-cerrar-modal",on:{click:function(e){return e.stopPropagation(),t.cerrar.apply(null,arguments)}}},[e("i",{staticClass:"fas fa-times"})])]),e("div",{staticClass:"modal-body"},[t._t("default")],2),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",on:{click:function(e){return e.stopPropagation(),t.cerrar.apply(null,arguments)}}},[t._v("Cancelar")]),e("button",{staticClass:"btn btn-primary",on:{click:function(e){return e.stopPropagation(),t.confirmar.apply(null,arguments)}}},[t._v(t._s(t.textoBotonConfirmar))])])])]):t._e()},o=[],s={name:"BaseModal",props:{mostrar:{type:Boolean,required:!0},titulo:{type:String,default:"Modal"},textoBotonConfirmar:{type:String,default:"Guardar"}},methods:{cerrar(){this.$emit("cerrar")},confirmar(){this.$emit("confirmar")}}},i=s,n=(a("bf5e"),a("2877")),c=Object(n["a"])(i,r,o,!1,null,"145be654",null);e["a"]=c.exports}}]);