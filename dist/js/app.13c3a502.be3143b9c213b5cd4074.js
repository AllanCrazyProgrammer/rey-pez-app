(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app.13c3a502"],{"053c":function(t,e,a){"use strict";a("b2f8")},"1b5b":function(t,e,a){},"1eaa":function(t,e,a){},"2d1f":function(t,e,a){},3069:function(t,e,a){"use strict";a("7a4d")},"317e":function(t,e,a){},"373f":function(t,e,a){},"57d4":function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Nombre para PDF"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarNombre}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"nombreAlternativoPDF"}},[t._v("Nombre que aparecerá en el PDF:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nombreLocal,expression:"nombreLocal"}],ref:"nombreInput",staticClass:"form-control",attrs:{type:"text",id:"nombreAlternativoPDF",placeholder:"Ingrese el nombre para el PDF"},domProps:{value:t.nombreLocal},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardarNombre.apply(null,arguments)},input:function(e){e.target.composing||(t.nombreLocal=e.target.value)}}}),e("small",{staticClass:"form-text text-muted"},[t._v(" Este nombre solo se mostrará en el PDF generado. El nombre original se mantendrá en la aplicación. ")])])])},r=[],i=a("ff7a"),s={name:"NombreAlternativoModal",components:{BaseModal:i["a"]},props:{mostrar:{type:Boolean,required:!0},nombreOriginal:{type:String,default:""},nombreAlternativo:{type:String,default:""}},data(){return{nombreLocal:""}},watch:{mostrar(t){t&&(this.nombreLocal=this.nombreAlternativo||this.nombreOriginal,this.$nextTick(()=>{this.$refs.nombreInput&&(this.$refs.nombreInput.focus(),this.$refs.nombreInput.select())}))},nombreAlternativo(t){this.mostrar&&(this.nombreLocal=t||this.nombreOriginal)}},methods:{guardarNombre(){this.$emit("guardar",this.nombreLocal.trim())}}},n=s,c=(a("f005"),a("2877")),l=Object(c["a"])(n,o,r,!1,null,"78f4b72c",null);e["a"]=l.exports},"5ba3":function(t,e,a){"use strict";a("85bd")},6123:function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Establecer Precio"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarPrecio}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"precioInput"}},[t._v("Precio:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.precioLocal,expression:"precioLocal"}],ref:"precioInput",staticClass:"form-control",attrs:{type:"number",id:"precioInput",placeholder:"Ingrese el precio"},domProps:{value:t.precioLocal},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardarPrecio.apply(null,arguments)},input:function(e){e.target.composing||(t.precioLocal=e.target.value)}}})])])},r=[],i=a("ff7a"),s={name:"PrecioModal",components:{BaseModal:i["a"]},props:{mostrar:{type:Boolean,required:!0},precio:{type:[Number,String],default:""}},data(){return{precioLocal:""}},watch:{mostrar(t){t&&(this.precioLocal=this.precio,this.$nextTick(()=>{var t;null===(t=this.$refs.precioInput)||void 0===t||t.focus()}))},precio(t){this.precioLocal=t}},methods:{guardarPrecio(){const t=parseFloat(this.precioLocal);isNaN(t)?""===this.precioLocal&&this.$emit("guardar",null):this.$emit("guardar",t)}}},n=s,c=(a("6925"),a("2877")),l=Object(c["a"])(n,o,r,!1,null,"8c3ce724",null);e["a"]=l.exports},6925:function(t,e,a){"use strict";a("1b5b")},"6d00":function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Establecer Nota"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarNota}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"notaInput"}},[t._v("Nota:")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.notaLocal,expression:"notaLocal"}],ref:"notaInput",staticClass:"form-control",attrs:{id:"notaInput",placeholder:"Ingrese la nota",rows:"4"},domProps:{value:t.notaLocal},on:{input:function(e){e.target.composing||(t.notaLocal=e.target.value)}}})])])},r=[],i=a("ff7a"),s={name:"NotaModal",components:{BaseModal:i["a"]},props:{mostrar:{type:Boolean,required:!0},nota:{type:String,default:""}},data(){return{notaLocal:""}},watch:{mostrar(t){t&&(this.notaLocal=this.nota,this.$nextTick(()=>{var t;null===(t=this.$refs.notaInput)||void 0===t||t.focus()}))},nota(t){this.notaLocal=t}},methods:{guardarNota(){this.$emit("guardar",this.notaLocal.trim())}}},n=s,c=(a("79e0"),a("2877")),l=Object(c["a"])(n,o,r,!1,null,"6b2e9aee",null);e["a"]=l.exports},"6f30":function(t,e,a){"use strict";a("7e0c")},7084:function(t,e,a){"use strict";a("2d1f")},"79e0":function(t,e,a){"use strict";a("317e")},"7a4d":function(t,e,a){},"7c84":function(t,e,a){},"7e0c":function(t,e,a){},"85bd":function(t,e,a){},9321:function(t,e,a){},ad72:function(t,e,a){"use strict";a("13d5");e["a"]={methods:{totalTaras(t){const e=(t.taras||[]).reduce((t,e)=>t+(e||0),0),a=(t.tarasExtra||[]).reduce((t,e)=>t+(e||0),0);return e+a},totalKilos(t){const e=(t.kilos||[]).reduce((t,e)=>t+(e||0),0),a=(t.taras||[]).reduce((t,e)=>t+(e||0),0),o=t.restarTaras?3*a:0,r=Number((e-o).toFixed(1));return r},calcularKilosProductoCH20(t){const e=t.reporteTaras||[],a=t.reporteBolsas||[];let o=0;if(e.length>0&&a.length>0){for(let t=0;t<e.length;t++){const r=parseInt(e[t])||0,i=parseInt(a[t])||0;o+=r*i}const r=t.camaronNeto&&t.camaronNeto>0?t.camaronNeto:.65;return o*r}{const e=(t.kilos||[]).reduce((t,e)=>t+(Number(e)||0),0),a=t.camaronNeto&&t.camaronNeto>0?t.camaronNeto:.65;return e*a}},calcularKilosCrudos(t){let e=0;if(t.taras){const a=/^(\d+)-(\d+)$/.exec(t.taras);if(a){const t=parseInt(a[1])||0;let o=parseInt(a[2])||0;19===o&&(o=20),e+=t*o}else{const[a,o]=t.taras.split("-").map(Number);e+=a*o}}if(t.sobrante){const a=/^(\d+)-(\d+)$/.exec(t.sobrante);if(a){const t=parseInt(a[1])||0;let o=parseInt(a[2])||0;19===o&&(o=20),e+=t*o}else{const[a,o]=t.sobrante.split("-").map(Number);e+=a*o}}return e},calcularTarasCrudos(t){let e=0;if(t.taras){const[a]=t.taras.split("-").map(Number);e+=a}if(t.sobrante){const[a]=t.sobrante.split("-").map(Number);e+=a}return e},combinarTarasBolsas(t,e){const a={};return t.forEach((t,o)=>{const r=e[o]||"",i=r;a[i]=(a[i]||0)+parseInt(t||1)}),Object.entries(a).map(([t,e])=>`(${e}-${t})`).join(" ")},totalTarasReportadas(t){return(t.reporteTaras||[]).reduce((t,e)=>t+(parseInt(e)||0),0)},totalBolsasReportadas(t){return(t.reporteTaras||[]).reduce((e,a,o)=>{const r=parseInt(a)||0,i=parseInt(t.reporteBolsas[o])||0;return e+r*i},0)},coincideTaras(t){const e=this.totalTarasReportadas(t),a=this.totalTaras(t);return e===a},coincideTarasYBolsas(t){const e=this.totalTaras(t),a=this.totalTarasReportadas(t);return(0!==e||0!==a)&&e===a},tieneAlgunReporte(t){return(t.reporteTaras||[]).some(t=>t)||(t.reporteBolsas||[]).some(t=>t)},formatearKilos(t){return t.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:1})},compararMedidas(t,e){if(!t)return 1;if(!e)return-1;const a=t=>{const e=t.match(/\d+/g);return e?1===e.length?[parseInt(e[0]),parseInt(e[0])]:[parseInt(e[0]),parseInt(e[1])]:[0,0]},[o,r]=a(t),[i,s]=a(e);return o&&i?o-i:t.localeCompare(e)},formatearTallaCrudo(t){const e={"Med c/c":"Med","Med-Esp c/c":"Esp","Med-gde c/c":"M-G","Gde c/c":"Gde","Extra c/c":"Ext","Jumbo c/c":"Jbo",Linea:"Lin",Rechazo:"Rch"};return e[t]||t}}}},b2f8:function(t,e,a){},b9b6:function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.clienteActivo===t.clienteId||null===t.clienteActivo,expression:"clienteActivo === clienteId || clienteActivo === null"}],staticClass:"cliente-grupo"},[e("div",{staticClass:"cliente-header sticky-header",attrs:{"data-cliente":t.nombreCliente}},[e("div",{staticClass:"cliente-info"},[e("h3",[t._v(" "+t._s(t.nombreCliente)+" "),e("button",{staticClass:"btn-pdf-mini",attrs:{title:"Vista previa PDF"},on:{click:function(e){return e.stopPropagation(),t.$emit("generar-pdf","cliente",t.clienteId)}}},[e("i",{staticClass:"fas fa-eye"})])]),e("div",{staticClass:"cliente-totales"},[e("span",[t._v("Limpio: "+t._s(t.calcularTotalLimpioCliente)+"T / "+t._s(t.formatearKilos(t.calcularKilosLimpioCliente))+"Kg")]),e("span",[t._v("Crudo: "+t._s(t.calcularTotalCrudoCliente)+"T / "+t._s(t.formatearKilos(t.calcularKilosCrudoCliente))+"Kg")])])]),e("div",{staticClass:"cliente-header-controls"},[e("div",{staticClass:"juntar-medidas-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.clientesJuntarMedidas[t.clienteId],expression:"clientesJuntarMedidas[clienteId]"}],attrs:{type:"checkbox",id:"juntar-medidas-"+t.clienteId,disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.clientesJuntarMedidas[t.clienteId])?t._i(t.clientesJuntarMedidas[t.clienteId],null)>-1:t.clientesJuntarMedidas[t.clienteId]},on:{change:[function(e){var a=t.clientesJuntarMedidas[t.clienteId],o=e.target,r=!!o.checked;if(Array.isArray(a)){var i=null,s=t._i(a,i);o.checked?s<0&&t.$set(t.clientesJuntarMedidas,t.clienteId,a.concat([i])):s>-1&&t.$set(t.clientesJuntarMedidas,t.clienteId,a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.clientesJuntarMedidas,t.clienteId,r)},t.handleJuntarMedidasChange],click:function(t){t.stopPropagation()}}}),e("label",{attrs:{for:"juntar-medidas-"+t.clienteId},on:{click:function(t){t.stopPropagation()}}},[t._v("Juntar medidas")])]),t.esClienteOtilio?e("div",{staticClass:"regla-otilio-checkbox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.clientesReglaOtilio[t.clienteId],expression:"clientesReglaOtilio[clienteId]"}],attrs:{type:"checkbox",id:"regla-otilio-"+t.clienteId,disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.clientesReglaOtilio[t.clienteId])?t._i(t.clientesReglaOtilio[t.clienteId],null)>-1:t.clientesReglaOtilio[t.clienteId]},on:{change:[function(e){var a=t.clientesReglaOtilio[t.clienteId],o=e.target,r=!!o.checked;if(Array.isArray(a)){var i=null,s=t._i(a,i);o.checked?s<0&&t.$set(t.clientesReglaOtilio,t.clienteId,a.concat([i])):s>-1&&t.$set(t.clientesReglaOtilio,t.clienteId,a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.clientesReglaOtilio,t.clienteId,r)},t.handleReglaOtilioChange],click:function(t){t.stopPropagation()}}}),e("label",{attrs:{for:"regla-otilio-"+t.clienteId},on:{click:function(t){t.stopPropagation()}}},[t._v("Sumar 1 kg por cada 100 kg")])]):t._e(),e("button",{staticClass:"btn btn-primary btn-sm generar-pdf-cliente",attrs:{type:"button",title:"Generar Nota de Venta PDF (incluye página sin precios)",disabled:t.isGeneratingPdf},on:{click:function(e){return e.stopPropagation(),t.$emit("generar-pdf","cliente",t.clienteId)}}},[t.isGeneratingPdf&&t.pdfType==="cliente-"+t.clienteId?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-file-pdf"}),t._v(" Generar Nota PDF ")]),t.esClienteJoselito?e("button",{staticClass:"btn btn-success btn-sm crear-cuenta-joselito",attrs:{type:"button",title:"Crear Cuenta para Joselito",disabled:t.isCreatingAccount},on:{click:function(e){return e.stopPropagation(),t.crearCuentaJoselito.apply(null,arguments)}}},[t.isCreatingAccount?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-plus-circle"}),t._v(" Crear Cuenta ")]):t._e(),t.esClienteCatarro?e("button",{staticClass:"btn btn-success btn-sm crear-cuenta-catarro",attrs:{type:"button",title:"Crear Cuenta para Catarro",disabled:t.isCreatingAccount},on:{click:function(e){return e.stopPropagation(),t.crearCuentaCatarro.apply(null,arguments)}}},[t.isCreatingAccount?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-plus-circle"}),t._v(" Crear Cuenta ")]):t._e(),t.esClienteOzuna?e("button",{staticClass:"btn btn-success btn-sm crear-cuenta-ozuna",attrs:{type:"button",title:"Crear Cuenta para Ozuna",disabled:t.isCreatingAccount},on:{click:function(e){return e.stopPropagation(),t.crearCuentaOzuna.apply(null,arguments)}}},[t.isCreatingAccount?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-plus-circle"}),t._v(" Crear Cuenta ")]):t._e(),t.esClienteOtilio?e("button",{staticClass:"btn btn-success btn-sm crear-cuenta-otilio",attrs:{type:"button",title:"Crear Cuenta para Otilio",disabled:t.isCreatingAccount},on:{click:function(e){return e.stopPropagation(),t.crearCuentaOtilio.apply(null,arguments)}}},[t.isCreatingAccount?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-plus-circle"}),t._v(" Crear Cuenta ")]):t._e(),e("button",{staticClass:"btn btn-danger btn-sm eliminar-cliente",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return e.stopPropagation(),t.$emit("eliminar-cliente",t.clienteId)}}},[t._v("Eliminar Cliente")])])]),e("div",{staticClass:"productos-container"},[t._l(t.productos,(function(a,o){return e("ProductoItem",{key:o,attrs:{producto:a,"embarque-bloqueado":t.embarqueBloqueado,"medidas-usadas":t.medidasUsadas,"nombre-cliente":t.nombreCliente},on:{"update:producto":t.actualizarProducto,"eliminar-producto":function(e){return t.$emit("eliminar-producto",a)},"mostrar-modal-precio":function(e){return t.$emit("mostrar-modal-precio",e)},"mostrar-modal-hilos":function(e){return t.$emit("mostrar-modal-hilos",e)},"mostrar-modal-nota":function(e){return t.$emit("mostrar-modal-nota",e)},"mostrar-modal-nombre-alternativo":function(e){return t.$emit("mostrar-modal-nombre-alternativo",e)},"mostrar-modal-alt":function(e){return t.$emit("mostrar-modal-alt",e)},"seleccionar-medida":t.seleccionarMedida}})})),t._l(t.crudos,(function(a,o){return e("CrudoItem",{key:"crudo-"+o,attrs:{crudo:a,"embarque-bloqueado":t.embarqueBloqueado,"cliente-id":t.clienteId,"crudo-index":o},on:{"update:crudo":function(e){return t.actualizarCrudo(o,e)},"eliminar-crudo":function(e){return t.$emit("eliminar-crudo",e,t.clienteId)},"eliminar-crudo-item":function(e){return t.$emit("eliminar-crudo-item",t.clienteId,...e)},"agregar-crudo-item":function(e){return t.$emit("agregar-crudo-item",t.clienteId,e)},"toggle-sobrante":function(e){return t.$emit("toggle-sobrante",t.clienteId,...e)},"mostrar-modal-precio":function(e){return t.$emit("mostrar-modal-precio",e)}}})}))],2),e("div",{staticClass:"botones-agregar"},[e("button",{staticClass:"btn btn-primary btn-sm agregar-producto",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.$emit("agregar-producto",t.clienteId)}}},[t._v("Agregar Producto")]),e("button",{staticClass:"btn btn-info btn-sm agregar-crudo",attrs:{type:"button",s:"",disabled:t.embarqueBloqueado},on:{click:function(e){return t.$emit("agregar-crudo",t.clienteId)}}},[t._v("Agregar Crudos")])])])},r=[],i=(a("13d5"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"producto",class:{"reporte-completo":t.coincideTarasYBolsas,"reporte-incompleto":!t.coincideTarasYBolsas&&t.tieneAlgunReporte,"taras-reportadas":t.coincideTaras,"taras-no-reportadas":t.totalTaras>0&&!t.coincideTaras,"medida-vacia":!t.producto.medida},attrs:{"data-es-venta":t.producto.esVenta}},[t.isClienteOzuna?e("div",{staticClass:"venta-checkbox-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.esVenta,expression:"producto.esVenta"}],staticClass:"form-check-input venta-checkbox",attrs:{type:"checkbox",id:"ventaCheck-"+t.producto.id,disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.producto.esVenta)?t._i(t.producto.esVenta,null)>-1:t.producto.esVenta},on:{change:function(e){var a=t.producto.esVenta,o=e.target,r=!!o.checked;if(Array.isArray(a)){var i=null,s=t._i(a,i);o.checked?s<0&&t.$set(t.producto,"esVenta",a.concat([i])):s>-1&&t.$set(t.producto,"esVenta",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.producto,"esVenta",r)}}}),e("label",{attrs:{for:"ventaCheck-"+t.producto.id}},[t._v("Venta")])]):t._e(),e("h2",{staticClass:"encabezado-medida"},[e("div",{staticClass:"botones-encabezado"},[e("div",{staticClass:"botones-fila-superior"},[e("button",{staticClass:"btn-precio",class:{"tiene-precio":t.producto.precio},on:{click:t.abrirModalPrecio}},[t._v(" $ ")]),e("button",{staticClass:"btn-hilos",class:{"tiene-hilos":t.producto.hilos},on:{click:t.abrirModalHilos}},[t._v(" H ")])]),e("div",{staticClass:"botones-fila-inferior"},[e("button",{staticClass:"btn-nota",class:{"tiene-nota":t.producto.nota},on:{click:t.abrirModalNota}},[t._v(" N ")]),e("div",{staticClass:"kg-radio"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.noSumarKilos,expression:"producto.noSumarKilos"}],staticClass:"kg-checkbox",attrs:{type:"checkbox",id:"kg-"+t.producto.id,disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.producto.noSumarKilos)?t._i(t.producto.noSumarKilos,null)>-1:t.producto.noSumarKilos},on:{change:function(e){var a=t.producto.noSumarKilos,o=e.target,r=!!o.checked;if(Array.isArray(a)){var i=null,s=t._i(a,i);o.checked?s<0&&t.$set(t.producto,"noSumarKilos",a.concat([i])):s>-1&&t.$set(t.producto,"noSumarKilos",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.producto,"noSumarKilos",r)}}}),e("label",{attrs:{for:"kg-"+t.producto.id}},[t._v("kg")])])])]),e("span",{staticClass:"medida-texto",class:{disabled:t.embarqueBloqueado,"tiene-nombre-alternativo":t.producto.nombreAlternativoPDF},on:{click:t.handleNombreAlternativoClick}},["c/h20"===t.producto.tipo?[t._v(" "+t._s(t.producto.nombreAlternativoPDF||t.producto.medida||"Sin Medida")+" "),e("span",{staticClass:"ch20-text"},[t._v("c/h20")]),t.producto.nombreAlternativoPDF?e("span",{staticClass:"pdf-badge",attrs:{title:"Nombre personalizado para PDF"}},[t._v("PDF")]):t._e()]:[t._v(" "+t._s(t.producto.nombreAlternativoPDF||t.producto.medida||"Sin Medida")+" - "+t._s(t.obtenerTipoProducto)+" "),t.producto.nombreAlternativoPDF?e("span",{staticClass:"pdf-badge",attrs:{title:"Nombre personalizado para PDF"}},[t._v("PDF")]):t._e()]],2),t.producto.precio?e("span",{staticClass:"precio-tag"},[t._v("$"+t._s(t.producto.precio))]):t._e()]),e("div",{staticClass:"producto-header"},[e("div",{staticClass:"medida-input-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.medida,expression:"producto.medida"}],staticClass:"medida-input",attrs:{type:"text",placeholder:"Medida",disabled:t.embarqueBloqueado},domProps:{value:t.producto.medida},on:{input:[function(e){e.target.composing||t.$set(t.producto,"medida",e.target.value)},t.onMedidaInput],blur:t.onMedidaBlur}}),e("button",{staticClass:"btn-alt",class:{"tiene-alt":t.producto.textoAlternativo},attrs:{disabled:t.embarqueBloqueado},on:{click:t.abrirModalAlt}},[t._v(" Alt ")]),t.editandoMedida&&t.sugerenciasMedidas.length>0?e("div",{staticClass:"sugerencias-container"},t._l(t.sugerenciasMedidas,(function(a){return e("div",{key:a,staticClass:"sugerencia-item",on:{mousedown:function(e){return t.seleccionarMedida(a)}}},[t._v(" "+t._s(a)+" ")])})),0):t._e()]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.producto.tipo,expression:"producto.tipo"}],staticClass:"form-control tipo-select",class:{"tipo-azul":"c/h20"===t.producto.tipo,"tipo-verde":"s/h20"===t.producto.tipo},attrs:{disabled:t.embarqueBloqueado},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.producto,"tipo",e.target.multiple?a:a[0])},t.onTipoChange]}},[e("option",{attrs:{value:""}},[t._v("Seleccionar")]),e("option",{attrs:{value:"s/h20"}},[t._v("S/H20")]),e("option",{attrs:{value:"c/h20"}},[t._v("C/H20")]),e("option",{attrs:{value:"otro"}},[t._v("Otro")])]),"otro"===t.producto.tipo?e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.tipoPersonalizado,expression:"producto.tipoPersonalizado"}],staticClass:"form-control tipo-input",attrs:{type:"text",placeholder:"Especificar",disabled:t.embarqueBloqueado},domProps:{value:t.producto.tipoPersonalizado},on:{input:function(e){e.target.composing||t.$set(t.producto,"tipoPersonalizado",e.target.value)}}}):t._e(),e("button",{staticClass:"btn btn-danger btn-sm eliminar-producto",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.eliminarProducto}},[t._v("X")])]),t.esClienteAgregado?e("div",{staticClass:"refrigeracion-checkbox-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.refrigerar,expression:"producto.refrigerar"}],staticClass:"form-check-input refrigeracion-checkbox",attrs:{type:"checkbox",id:"refrigerarCheck-"+t.producto.id,disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.producto.refrigerar)?t._i(t.producto.refrigerar,null)>-1:t.producto.refrigerar},on:{change:[function(e){var a=t.producto.refrigerar,o=e.target,r=!!o.checked;if(Array.isArray(a)){var i=null,s=t._i(a,i);o.checked?s<0&&t.$set(t.producto,"refrigerar",a.concat([i])):s>-1&&t.$set(t.producto,"refrigerar",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.producto,"refrigerar",r)},t.actualizarProducto]}}),e("label",{staticClass:"refrigeracion-label",attrs:{for:"refrigerarCheck-"+t.producto.id}},[t._v(" 🧊 Refrigerar ")])]):t._e(),"c/h20"===t.producto.tipo?e("div",{staticClass:"valores-container-debajo"},[e("div",{staticClass:"valor-neto-container"},[e("label",[t._v("Valor neto:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.camaronNeto,expression:"producto.camaronNeto"}],staticClass:"camaron-neto-input ios-numeric",attrs:{type:"number",step:"0.01",min:"0",max:"1",inputmode:"numeric",pattern:"[0-9]*",disabled:t.embarqueBloqueado},domProps:{value:t.producto.camaronNeto},on:{input:function(e){e.target.composing||t.$set(t.producto,"camaronNeto",e.target.value)}}})])]):t._e(),e("div",{staticClass:"sumas-verticales"},[e("div",{staticClass:"columna"},[e("div",{staticClass:"taras-header"},[e("h5",[t._v("Taras")]),e("div",{staticClass:"checkbox-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.restarTaras,expression:"producto.restarTaras"}],attrs:{type:"checkbox",disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.producto.restarTaras)?t._i(t.producto.restarTaras,null)>-1:t.producto.restarTaras},on:{change:function(e){var a=t.producto.restarTaras,o=e.target,r=!!o.checked;if(Array.isArray(a)){var i=null,s=t._i(a,i);o.checked?s<0&&t.$set(t.producto,"restarTaras",a.concat([i])):s>-1&&t.$set(t.producto,"restarTaras",a.slice(0,s).concat(a.slice(s+1)))}else t.$set(t.producto,"restarTaras",r)}}}),e("label",[t._v("-3")])])]),t._l(t.producto.taras,(function(a,o){return e("div",{key:o,staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.producto.taras[o],expression:"producto.taras[taraIndex]",modifiers:{number:!0}}],staticClass:"form-control tara-input",attrs:{type:"tel",placeholder:"Tara",size:String(t.producto.taras[o]||"").length||1,disabled:t.embarqueBloqueado},domProps:{value:t.producto.taras[o]},on:{focus:function(t){return t.target.select()},input:function(e){e.target.composing||t.$set(t.producto.taras,o,t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),e("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.eliminarTara(o)}}},[t._v("-")])])})),t._l(t.producto.tarasExtra,(function(a,o){return e("div",{key:"extra-"+o,staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.producto.tarasExtra[o],expression:"producto.tarasExtra[taraExtraIndex]",modifiers:{number:!0}}],staticClass:"form-control tara-input",attrs:{type:"tel",placeholder:"Tara Extra",size:String(t.producto.tarasExtra[o]||"").length||1,disabled:t.embarqueBloqueado},domProps:{value:t.producto.tarasExtra[o]},on:{focus:function(t){return t.target.select()},input:function(e){e.target.composing||t.$set(t.producto.tarasExtra,o,t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),e("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.eliminarTaraExtra(o)}}},[t._v("-")])])})),e("div",{staticClass:"botones-tara"},[e("button",{staticClass:"btn btn-success btn-sm agregar-tara",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.agregarTara}},[t._v("+")]),e("button",{staticClass:"btn btn-warning btn-sm agregar-tara-extra",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.agregarTaraExtra}},[t._v("+ Extra")])]),e("div",{staticClass:"total"},[t._v("Total: "+t._s(t.totalTaras))])],2),e("div",{staticClass:"columna"},[e("h5",[t._v("Kilos")]),t._l(t.producto.kilos,(function(a,o){return e("div",{key:o,staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.producto.kilos[o],expression:"producto.kilos[kiloIndex]",modifiers:{number:!0}}],staticClass:"form-control kilo-input",attrs:{type:"tel",placeholder:"Kilos",size:String(t.producto.kilos[o]||"").length||1,disabled:t.embarqueBloqueado},domProps:{value:t.producto.kilos[o]},on:{focus:function(t){return t.target.select()},input:[function(e){e.target.composing||t.$set(t.producto.kilos,o,t._n(e.target.value))},t.actualizarProducto],blur:function(e){return t.$forceUpdate()}}})])})),e("div",{staticStyle:{height:"38px"}}),e("div",{staticClass:"total"},[t._v("Total: "+t._s(t.totalKilos))])],2)]),e("div",{staticClass:"reporte-taras-bolsas"},[e("div",{staticClass:"reporte-item"},[e("h5",[t._v("Taras")]),t._l(t.producto.reporteTaras,(function(a,o){return e("div",{key:o,staticClass:"input-group mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.reporteTaras[o],expression:"producto.reporteTaras[index]"}],staticClass:"form-control reporte-input",attrs:{type:"tel",disabled:t.embarqueBloqueado},domProps:{value:t.producto.reporteTaras[o]},on:{focus:function(t){return t.target.select()},input:[function(e){e.target.composing||t.$set(t.producto.reporteTaras,o,e.target.value)},t.actualizarProducto]}}),e("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.eliminarReporteTara(o)}}},[t._v("-")])])})),e("button",{staticClass:"btn btn-success btn-sm",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.agregarReporteTara}},[t._v("+")]),e("div",{staticClass:"total-taras-reporte",class:{coincide:t.coincideTaras,"no-coincide":!t.coincideTaras}},[t._v(" Reportadas: "+t._s(t.totalTarasReportadas)+" ")])],2),e("div",{staticClass:"reporte-item"},[e("h5",[t._v("Bolsas")]),t._l(t.producto.reporteBolsas,(function(a,o){return e("div",{key:o,staticClass:"input-group mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.reporteBolsas[o],expression:"producto.reporteBolsas[index]"}],staticClass:"form-control reporte-input",attrs:{type:"tel",disabled:t.embarqueBloqueado},domProps:{value:t.producto.reporteBolsas[o]},on:{focus:function(t){return t.target.select()},input:[function(e){e.target.composing||t.$set(t.producto.reporteBolsas,o,e.target.value)},t.actualizarProducto]}})])})),e("div",{staticStyle:{height:"31px"}}),e("div",{staticClass:"total-bolsas-reporte"},[t._v(" Bolsas: "+t._s(t.totalBolsasReportadas)+" ")])],2)]),t.reporteExcedeTresParentesis?e("div",{staticClass:"reporte-extenso"},[t._v(" "+t._s(t.generarReporteExtenso)+" ")]):t._e()])}),s=[],n=(a("14d9"),{name:"ProductoItem",props:{producto:{type:Object,required:!0},embarqueBloqueado:{type:Boolean,default:!1},medidasUsadas:{type:Array,default:()=>[]},nombreCliente:{type:String,default:""}},data(){return{editandoMedida:!1,sugerenciasMedidas:[]}},emits:["update:producto","eliminar-producto","mostrar-modal-precio","mostrar-modal-hilos","mostrar-modal-nota","mostrar-modal-nombre-alternativo","mostrar-modal-alt","actualizar-medidas-usadas","seleccionar-medida"],computed:{isClienteOzuna(){return"ozuna"===this.nombreCliente.toLowerCase()},esClienteAgregado(){const t=["joselito","catarro","ozuna","otilio","elizabeth"];return!t.includes(this.nombreCliente.toLowerCase())},totalTaras(){const t=(this.producto.taras||[]).reduce((t,e)=>t+(e||0),0),e=(this.producto.tarasExtra||[]).reduce((t,e)=>t+(e||0),0);return t+e},totalKilos(){const t=(this.producto.kilos||[]).reduce((t,e)=>t+(e||0),0),e=(this.producto.taras||[]).reduce((t,e)=>t+(e||0),0),a=this.producto.restarTaras?3*e:0,o=Number((t-a).toFixed(1));return o},obtenerTipoProducto(){return"otro"===this.producto.tipo?this.producto.tipoPersonalizado||"Otro":this.producto.tipo||"Sin Tipo"},totalTarasReportadas(){return(this.producto.reporteTaras||[]).reduce((t,e)=>t+(parseInt(e)||0),0)},totalBolsasReportadas(){return(this.producto.reporteTaras||[]).reduce((t,e,a)=>{const o=parseInt(e)||0,r=parseInt(this.producto.reporteBolsas[a])||0;return t+o*r},0)},coincideTaras(){return this.totalTarasReportadas===this.totalTaras},coincideTarasYBolsas(){const t=this.totalTaras,e=this.totalTarasReportadas;return(0!==t||0!==e)&&t===e},tieneAlgunReporte(){return(this.producto.reporteTaras||[]).some(t=>t)||(this.producto.reporteBolsas||[]).some(t=>t)},reporteExcedeTresParentesis(){const t=this.combinarTarasBolsas();return(t.match(/\(/g)||[]).length>3},generarReporteExtenso(){const t=this.combinarTarasBolsas();return t.replace(/\) /g,")\n")}},methods:{actualizarProducto(){this.$emit("update:producto",this.producto)},handleNombreAlternativoClick(){this.embarqueBloqueado||this.abrirModalNombreAlternativo()},agregarTara(){this.producto.taras.push(null),this.producto.kilos.push(null),this.actualizarProducto()},eliminarTara(t){this.producto.taras.splice(t,1),this.producto.kilos.splice(t,1),this.actualizarProducto()},agregarTaraExtra(){Array.isArray(this.producto.tarasExtra)||this.$set(this.producto,"tarasExtra",[]),this.producto.tarasExtra.push(null),this.actualizarProducto()},eliminarTaraExtra(t){this.producto.tarasExtra.splice(t,1),this.actualizarProducto()},agregarReporteTara(){Array.isArray(this.producto.reporteTaras)||this.$set(this.producto,"reporteTaras",[]),Array.isArray(this.producto.reporteBolsas)||this.$set(this.producto,"reporteBolsas",[]),this.producto.reporteTaras.push(null),this.producto.reporteBolsas.push(null),this.actualizarProducto()},eliminarReporteTara(t){this.producto.reporteTaras.splice(t,1),this.producto.reporteBolsas.splice(t,1),this.actualizarProducto()},combinarTarasBolsas(){const t={},e=this.producto.reporteTaras||[],a=this.producto.reporteBolsas||[];return e.forEach((e,o)=>{const r=a[o]||"",i=r;t[i]=(t[i]||0)+parseInt(e||1)}),Object.entries(t).map(([t,e])=>`(${e}-${t})`).join(" ")},onMedidaInput(t){const e=t.target.value.toLowerCase();this.editandoMedida=!0,this.sugerenciasMedidas=e?this.medidasUsadas.filter(t=>t.toLowerCase().includes(e)&&t.toLowerCase()!==e):[],this.producto.isEditing=!0,this.actualizarProducto()},onMedidaBlur(){setTimeout(()=>{this.editandoMedida=!1},200),this.actualizarProducto()},seleccionarMedida(t){this.producto.medida=t,this.editandoMedida=!1,this.$emit("seleccionar-medida",this.producto,t)},onTipoChange(){"otro"!==this.producto.tipo&&(this.producto.tipoPersonalizado=""),"c/h20"!==this.producto.tipo||this.producto.camaronNeto||(this.producto.camaronNeto=.65),this.actualizarProducto()},abrirModalPrecio(){this.$emit("mostrar-modal-precio",this.producto)},abrirModalHilos(){this.$emit("mostrar-modal-hilos",this.producto)},abrirModalNota(){this.$emit("mostrar-modal-nota",this.producto)},abrirModalNombreAlternativo(){this.$emit("mostrar-modal-nombre-alternativo",this.producto)},abrirModalAlt(){this.$emit("mostrar-modal-alt",this.producto)},eliminarProducto(){this.$emit("eliminar-producto",this.producto)}}}),c=n,l=(a("3069"),a("2877")),d=Object(l["a"])(c,i,s,!1,null,"99d1c176",null),u=d.exports,p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"producto crudo",class:{"crudo-ozuna":t.isClienteOzuna}},[e("h2",{staticClass:"crudo-header"},[t._v("Crudos")]),e("div",{staticClass:"crudo-items"},t._l(t.crudoData.items||[],(function(a,o){return e("div",{key:"item-"+o,staticClass:"crudo-item",attrs:{"data-es-venta":a.esVenta}},[e("div",{staticClass:"crudo-talla-container"},[e("button",{staticClass:"btn-precio",class:{"tiene-precio":a.precio},attrs:{disabled:t.embarqueBloqueado},on:{click:function(e){return t.abrirModalPrecio(a)}}},[t._v(" $ ")]),e("select",{directives:[{name:"model",rawName:"v-model",value:a.talla,expression:"item.talla"}],staticClass:"form-control talla-select",attrs:{disabled:t.embarqueBloqueado},on:{change:[function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(a,"talla",e.target.multiple?o:o[0])},function(e){return t.onTallaCrudoChange(a)}]}},[e("option",{attrs:{value:""}},[t._v("Elige talla")]),e("option",{attrs:{value:"Med c/c"}},[t._v("Med c/c")]),e("option",{attrs:{value:"Med-Esp c/c"}},[t._v("Med-Esp c/c")]),e("option",{attrs:{value:"Med-Gde c/c"}},[t._v("Med-Gde c/c")]),e("option",{attrs:{value:"Gde c/c"}},[t._v("Gde c/c")]),e("option",{attrs:{value:"Gde c/ Extra"}},[t._v("Gde c/ Extra c/c")]),e("option",{attrs:{value:"Extra c/c"}},[t._v("Extra c/c")]),e("option",{attrs:{value:"Jumbo c/c"}},[t._v("Jumbo c/c")]),e("option",{attrs:{value:"Linea"}},[t._v("Linea")]),e("option",{attrs:{value:"Lag gde c/c"}},[t._v("Lag gde c/c")]),e("option",{attrs:{value:"Rechazo"}},[t._v("Rechazo")])]),a.precio?e("span",{staticClass:"precio-tag"},[t._v("$"+t._s(a.precio))]):t._e(),t.isClienteOzuna?e("div",{staticClass:"venta-checkbox-container",staticStyle:{display:"none"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.esVenta,expression:"item.esVenta"}],staticClass:"form-check-input venta-checkbox",attrs:{type:"checkbox",id:"ventaCrudo-"+t.crudoIndex+"-"+o,disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(a.esVenta)?t._i(a.esVenta,null)>-1:a.esVenta},on:{change:[function(e){var o=a.esVenta,r=e.target,i=!!r.checked;if(Array.isArray(o)){var s=null,n=t._i(o,s);r.checked?n<0&&t.$set(a,"esVenta",o.concat([s])):n>-1&&t.$set(a,"esVenta",o.slice(0,n).concat(o.slice(n+1)))}else t.$set(a,"esVenta",i)},t.actualizarCrudo]}}),e("label",{attrs:{for:"ventaCrudo-"+t.crudoIndex+"-"+o}},[t._v("Venta")])]):t._e(),e("input",{directives:[{name:"model",rawName:"v-model",value:a.barco,expression:"item.barco"}],staticClass:"form-control barco-input",attrs:{type:"text",placeholder:"Barco",disabled:t.embarqueBloqueado},domProps:{value:a.barco},on:{input:[function(e){e.target.composing||t.$set(a,"barco",e.target.value)},t.actualizarCrudo]}})]),e("div",{staticClass:"crudo-taras-container"},[e("div",{staticClass:"taras-wrapper"},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.taras,expression:"item.taras"}],staticClass:"form-control taras-input",attrs:{type:"text",placeholder:"Taras",disabled:t.embarqueBloqueado},domProps:{value:a.taras},on:{input:[function(e){e.target.composing||t.$set(a,"taras",e.target.value)},t.actualizarCrudo]}}),a.mostrarSobrante?e("input",{directives:[{name:"model",rawName:"v-model",value:a.sobrante,expression:"item.sobrante"}],staticClass:"form-control taras-input",attrs:{type:"text",placeholder:"Sbrte",disabled:t.embarqueBloqueado},domProps:{value:a.sobrante},on:{input:[function(e){e.target.composing||t.$set(a,"sobrante",e.target.value)},t.actualizarCrudo]}}):t._e()]),e("div",{staticClass:"buttons-wrapper"},[e("button",{staticClass:"btn btn-danger btn-sm eliminar-crudo-item",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.eliminarCrudoItem(o)}}},[t._v("-")]),e("button",{staticClass:"btn btn-success btn-sm agregar-sobrante",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.toggleSobrante(o)}}},[t._v("+")])])])])})),0),e("div",{staticClass:"crudo-footer"},[e("button",{staticClass:"btn btn-primary btn-sm agregar-crudo-item",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.agregarCrudoItem}},[t._v("+ Agregar Talla/Taras")]),e("button",{staticClass:"btn btn-danger btn-sm eliminar-crudo",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.eliminarCrudo}},[t._v("Eliminar Crudo")]),e("div",{staticClass:"total-crudos"},[t._v("Total de taras: "+t._s(t.calcularTotalCrudos))])])])},m=[],h={name:"CrudoItem",props:{crudo:{type:Object,default:()=>({items:[]})},embarqueBloqueado:{type:Boolean,default:!1},clienteId:{type:[String,Number],required:!0},crudoIndex:{type:Number,required:!0}},emits:["update:crudo","eliminar-crudo","eliminar-crudo-item","agregar-crudo-item","toggle-sobrante","mostrar-modal-precio"],data(){return{crudoData:this.crudo||{items:[]}}},watch:{crudo:{handler(t){this.crudoData=t||{items:[]},this.isClienteOzuna&&this.crudoData.items&&this.crudoData.items.forEach(t=>{t&&this.$set(t,"esVenta",!0)})},immediate:!0}},computed:{calcularTotalCrudos(){return this.crudoData&&this.crudoData.items&&Array.isArray(this.crudoData.items)?this.crudoData.items.reduce((t,e)=>{let a=this.extraerNumero(e.taras),o=this.extraerNumero(e.sobrante);return t+a+o},0):0},isClienteOzuna(){return"4"===this.clienteId||4===this.clienteId||this.$parent&&this.$parent.nombreCliente&&this.$parent.nombreCliente.toLowerCase().includes("ozuna")}},methods:{extraerNumero(t){if(!t)return 0;const e=t.toString().match(/^(\d+)/);return e?parseInt(e[1]):0},actualizarCrudo(){this.$emit("update:crudo",this.crudoData)},abrirModalPrecio(t){this.$emit("mostrar-modal-precio",t)},onTallaCrudoChange(t){t.medida||(t.medida=t.talla),this.actualizarCrudo()},agregarCrudoItem(){this.crudoData.items||(this.crudoData.items=[]);const t={talla:"",barco:"",taras:"",sobrante:"",precio:null,mostrarSobrante:!1,esVenta:this.isClienteOzuna};this.crudoData.items.push(t),this.actualizarCrudo()},eliminarCrudoItem(t){this.crudoData.items&&this.crudoData.items.length>t&&(this.crudoData.items.splice(t,1),this.actualizarCrudo())},eliminarCrudo(){this.$emit("eliminar-crudo",this.crudoIndex,this.clienteId)},toggleSobrante(t){this.crudoData.items&&this.crudoData.items.length>t&&(this.crudoData.items[t].mostrarSobrante=!this.crudoData.items[t].mostrarSobrante,this.crudoData.items[t].mostrarSobrante||(this.crudoData.items[t].sobrante=""),this.actualizarCrudo())}}},b=h,f=(a("5ba3"),Object(l["a"])(b,p,m,!1,null,"6296053c",null)),C=f.exports,g={name:"ClienteProductos",components:{ProductoItem:u,CrudoItem:C},props:{clienteId:{type:[String,Number],required:!0},productos:{type:Array,default:()=>[]},crudos:{type:Array,default:()=>[]},clientesJuntarMedidas:{type:Object,default:()=>({})},clientesReglaOtilio:{type:Object,default:()=>({})},nombreCliente:{type:String,required:!0},clienteActivo:{type:[String,Number,null],default:null},embarqueBloqueado:{type:Boolean,default:!1},medidasUsadas:{type:Array,default:()=>[]},isGeneratingPdf:{type:Boolean,default:!1},pdfType:{type:String,default:""},isCreatingAccount:{type:Boolean,default:!1}},emits:["update:productos","update:crudos","juntarMedidas-change","reglaOtilio-change","eliminar-cliente","eliminar-producto","eliminar-crudo","eliminar-crudo-item","agregar-producto","agregar-crudo","agregar-crudo-item","toggle-sobrante","mostrar-modal-precio","mostrar-modal-hilos","mostrar-modal-nota","mostrar-modal-nombre-alternativo","mostrar-modal-alt","seleccionar-medida","generar-pdf","crear-cuenta-joselito","crear-cuenta-catarro","crear-cuenta-ozuna","crear-cuenta-otilio"],computed:{esClienteJoselito(){return this.nombreCliente.toLowerCase().includes("joselito")},esClienteCatarro(){return this.nombreCliente.toLowerCase().includes("catarro")},esClienteOzuna(){return this.nombreCliente.toLowerCase().includes("ozuna")},esClienteOtilio(){return this.nombreCliente.toLowerCase().includes("otilio")},calcularTotalLimpioCliente(){return this.productos.reduce((t,e)=>{const a=(e.taras||[]).reduce((t,e)=>t+(e||0),0),o=(e.tarasExtra||[]).reduce((t,e)=>t+(e||0),0);return t+a+o},0)},calcularKilosLimpioCliente(){return this.productos.reduce((t,e)=>{if("c/h20"===e.tipo){const a=e.reporteTaras||[],o=e.reporteBolsas||[];let r=0;for(let t=0;t<a.length;t++){const e=parseInt(a[t])||0,i=parseInt(o[t])||0;r+=e*i}const i=r*(e.camaronNeto||.65);return t+i}{const a=(e.kilos||[]).reduce((t,e)=>t+(e||0),0),o=(e.taras||[]).reduce((t,e)=>t+(e||0),0),r=e.restarTaras?3*o:0,i=Number((a-r).toFixed(1));return t+i}},0)},calcularTotalCrudoCliente(){return this.crudos.reduce((t,e)=>e&&e.items&&Array.isArray(e.items)?t+e.items.reduce((t,e)=>{let a=this.extraerNumero(e.taras),o=this.extraerNumero(e.sobrante);return t+a+o},0):t,0)},calcularKilosCrudoCliente(){return this.crudos.reduce((t,e)=>e&&e.items&&Array.isArray(e.items)?t+e.items.reduce((t,e)=>t+this.calcularKilosCrudos(e),0):t,0)}},methods:{extraerNumero(t){if(!t)return 0;const e=t.toString().match(/^(\d+)/);return e?parseInt(e[1]):0},actualizarProducto(t){this.$emit("update:productos",this.productos.map(e=>e.id===t.id?t:e))},actualizarCrudo(t,e){const a=[...this.crudos];a[t]=e,this.$emit("update:crudos",a)},seleccionarMedida(t,e){t.medida=e,this.actualizarProducto(t),this.$emit("seleccionar-medida",t,e)},calcularKilosCrudos(t){let e=0;if(t.taras){const a=/^(\d+)-(\d+)$/.exec(t.taras);if(a){const t=parseInt(a[1])||0;let o=parseInt(a[2])||0;19===o&&(o=20),e+=t*o}else{const[a,o]=t.taras.split("-").map(Number);e+=a*o}}if(t.sobrante){const a=/^(\d+)-(\d+)$/.exec(t.sobrante);if(a){const t=parseInt(a[1])||0;let o=parseInt(a[2])||0;19===o&&(o=20),e+=t*o}else{const[a,o]=t.sobrante.split("-").map(Number);e+=a*o}}return e},formatearKilos(t){return t.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:1})},handleJuntarMedidasChange(t){this.$emit("juntarMedidas-change",this.clienteId,t.target.checked)},handleReglaOtilioChange(t){this.$emit("reglaOtilio-change",this.clienteId,t.target.checked)},crearCuentaJoselito(){this.$emit("crear-cuenta-joselito",this.clienteId,this.productos,this.crudos)},crearCuentaCatarro(){this.$emit("crear-cuenta-catarro",this.clienteId,this.productos,this.crudos)},crearCuentaOzuna(){this.$emit("crear-cuenta-ozuna",this.clienteId,this.productos,this.crudos)},crearCuentaOtilio(){this.$emit("crear-cuenta-otilio",this.clienteId,this.productos,this.crudos)}}},v=g,_=(a("d05c"),Object(l["a"])(v,o,r,!1,null,"17af96ec",null));e["a"]=_.exports},bcb0:function(t,e,a){"use strict";a("9321")},bded:function(t,e,a){"use strict";a("c6ce")},bf5e:function(t,e,a){"use strict";a("7c84")},c005:function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Establecer Hilos"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarHilos}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"hilosInput"}},[t._v("Hilos:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hilosLocal,expression:"hilosLocal"}],ref:"hilosInput",staticClass:"form-control",attrs:{type:"text",id:"hilosInput",placeholder:"Ingrese los hilos"},domProps:{value:t.hilosLocal},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardarHilos.apply(null,arguments)},input:function(e){e.target.composing||(t.hilosLocal=e.target.value)}}})])])},r=[],i=a("ff7a"),s={name:"HilosModal",components:{BaseModal:i["a"]},props:{mostrar:{type:Boolean,required:!0},hilos:{type:String,default:""}},data(){return{hilosLocal:""}},watch:{mostrar(t){t&&(this.hilosLocal=this.hilos,this.$nextTick(()=>{var t;null===(t=this.$refs.hilosInput)||void 0===t||t.focus()}))},hilos(t){this.hilosLocal=t}},methods:{guardarHilos(){this.$emit("guardar",this.hilosLocal.trim())}}},n=s,c=(a("bcb0"),a("2877")),l=Object(c["a"])(n,o,r,!1,null,"9fafdd8a",null);e["a"]=l.exports},c0b0:function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Nombre Alternativo para PDF"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarAlt}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"altInput"}},[t._v("Nombre alternativo:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.altLocal,expression:"altLocal"}],ref:"altInput",staticClass:"form-control",attrs:{type:"text",id:"altInput",placeholder:"Ingrese el nombre alternativo para PDF"},domProps:{value:t.altLocal},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardarAlt.apply(null,arguments)},input:function(e){e.target.composing||(t.altLocal=e.target.value)}}}),e("small",{staticClass:"form-text text-muted"},[t._v(" Este nombre solo se mostrará en el PDF de resumen de embarque. ")])])])},r=[],i=a("ff7a"),s={name:"AltModal",components:{BaseModal:i["a"]},props:{mostrar:{type:Boolean,required:!0},alt:{type:String,default:""}},data(){return{altLocal:""}},watch:{mostrar(t){t&&(this.altLocal=this.alt,this.$nextTick(()=>{var t;null===(t=this.$refs.altInput)||void 0===t||t.focus()}))},alt(t){this.altLocal=t}},methods:{guardarAlt(){this.$emit("guardar",this.altLocal.trim())}}},n=s,c=(a("6f30"),a("2877")),l=Object(c["a"])(n,o,r,!1,null,"4a536e6c",null);e["a"]=l.exports},c6ce:function(t,e,a){},d05c:function(t,e,a){"use strict";a("373f")},e7ae:function(t,e,a){"use strict";a("d9e2"),a("14d9"),a("88e6"),a("70cc"),a("eb03"),a("22e5c"),a("c01e"),a("fa76"),a("8306");var o=a("2fe3"),r=a("80ac"),i=a("692f");e["a"]={methods:{async generarPDF(t,e=null){this.$set(this,"isGeneratingPdf",!0),this.$set(this,"pdfType",e?`${t}-${e}`:t);try{switch(t){case"cliente":await this.generarPDFCliente(e);break;case"all":await this.generarPDFTodosClientes();break;case"taras":await this.generarPDFTaras();break;case"resumen":await this.generarPDFResumen();break;default:throw new Error("Tipo de PDF no soportado: "+t)}console.log(`PDF ${t} generado con éxito`)}catch(a){console.error(`Error al generar PDF ${t}:`,a),alert("Hubo un error al generar el PDF: "+a.message)}finally{this.$set(this,"isGeneratingPdf",!1),this.$set(this,"pdfType",null)}},async generarPDFCliente(t){const e=this.productosPorCliente[t],a=this.clienteCrudos[t];e&&e.forEach(t=>{t.medida&&t.tipo&&(t.isEditing=!1,t.isNew=!1)});const r={fecha:this.embarque.fecha,cargaCon:this.embarque.cargaCon,productos:e,clienteCrudos:{[t]:a},kilosCrudos:this.embarque.kilosCrudos||{}};Object(o["a"])(r,this.clientesDisponibles,this.clientesJuntarMedidas,this.clientesReglaOtilio)},async generarPDFTodosClientes(){this.embarque.productos&&this.embarque.productos.forEach(t=>{t.medida&&t.tipo&&(t.isEditing=!1,t.isNew=!1)});const t={fecha:this.embarque.fecha,cargaCon:this.embarque.cargaCon,productos:this.embarque.productos,clienteCrudos:this.clienteCrudos,kilosCrudos:this.embarque.kilosCrudos||{}};Object(o["a"])(t,this.clientesDisponibles,this.clientesJuntarMedidas,this.clientesReglaOtilio)},async generarPDFTaras(){const t={fecha:this.embarque.fecha,cargaCon:this.embarque.cargaCon,productos:this.embarque.productos,clienteCrudos:this.clienteCrudos};Object(r["a"])(t,this.clientesDisponibles)},async generarPDFResumen(t=100){const e=new Set;Object.values(this.clienteCrudos).forEach(t=>{t.forEach(t=>{t&&t.items&&Array.isArray(t.items)&&t.items.forEach(t=>{t.talla&&e.add(t.talla)})})});const a=this.prepararDatosResumenEmbarque(e);Object(i["a"])(a,this.productosPorCliente,this.obtenerNombreCliente,this.clientesDisponibles,t)},prepararDatosResumenEmbarque(t){return{...this.embarque,crudos:Object.entries(this.clienteCrudos).flatMap(([t,e])=>e.flatMap(e=>e&&e.items&&Array.isArray(e.items)?e.items.map(e=>{const a=[];return e.taras&&a.push(e.taras),e.sobrante&&a.push(e.sobrante),{clienteId:t,medida:e.talla,taras:a,barco:e.barco,textoAlternativo:e.textoAlternativo,precio:e.precio}}):[])),medidasCrudos:Array.from(t)}}}}},eb99:function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Agregar Nuevo Cliente","texto-boton-confirmar":"Agregar"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.agregarCliente}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"nombreCliente"}},[t._v("Nombre del Cliente:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nombreCliente,expression:"nombreCliente"}],ref:"nombreInput",staticClass:"form-control",attrs:{type:"text",id:"nombreCliente",placeholder:"Ingrese el nombre del cliente"},domProps:{value:t.nombreCliente},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.agregarCliente.apply(null,arguments)},input:function(e){e.target.composing||(t.nombreCliente=e.target.value)}}})])])},r=[],i=a("ff7a"),s={name:"NuevoClienteModal",components:{BaseModal:i["a"]},props:{mostrar:{type:Boolean,required:!0}},data(){return{nombreCliente:"",colorCliente:"#007bff"}},watch:{mostrar(t){t&&(this.nombreCliente="",this.$nextTick(()=>{var t;null===(t=this.$refs.nombreInput)||void 0===t||t.focus()}))}},methods:{agregarCliente(){""!==this.nombreCliente.trim()?(this.$emit("agregar",{nombre:this.nombreCliente,color:this.colorCliente}),this.nombreCliente=""):alert("Por favor, ingrese un nombre para el nuevo cliente.")}}},n=s,c=(a("053c"),a("2877")),l=Object(c["a"])(n,o,r,!1,null,"091821fc",null);e["a"]=l.exports},f005:function(t,e,a){"use strict";a("1eaa")},fdb2:function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"header-embarque"},[e("h1",[t._v(t._s(t.modoEdicion?"Embarque":"Nuevo Embarque"))]),e("div",{staticClass:"botones"},[e("button",{staticClass:"btn-volver",on:{click:t.volverAEmbarquesMenu}},[e("i",{staticClass:"fas fa-arrow-left"}),t._v(" Volver a Menu ")]),e("button",{class:["btn-bloqueo",{bloqueado:t.embarqueBloqueado}],on:{click:t.toggleBloqueo}},[e("i",{class:["fas",t.embarqueBloqueado?"fa-lock":"fa-lock-open"]}),t._v(" "+t._s(t.embarqueBloqueado?"Desbloquear":"Bloquear")+" Embarque ")])]),e("div",{staticClass:"botones-accion"},[e("button",{staticClass:"btn btn-success",attrs:{title:"Ver pedido del día de hoy"},on:{click:t.verPedidoDelDia}},[e("i",{staticClass:"fas fa-clipboard-list"}),t._v(" Pedido del Día ")]),e("button",{staticClass:"btn btn-info",attrs:{disabled:t.isGeneratingPdf},on:{click:function(e){return t.$emit("generar-taras")}}},[t.isGeneratingPdf&&"taras"===t.pdfType?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-file-pdf"}),t._v(" PDF Taras ")]),e("button",{staticClass:"btn btn-info",attrs:{disabled:t.isGeneratingPdf},on:{click:function(e){return t.$emit("generar-resumen")}}},[t.isGeneratingPdf&&"resumen"===t.pdfType?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-file-pdf"}),t._v(" Resumen Embarque ")]),t.embarqueId&&""!==t.embarqueId?e("router-link",{staticClass:"btn btn-warning",class:{disabled:t.isGeneratingPdf},attrs:{to:{name:"Rendimientos",params:{id:t.embarqueId}}}},[e("i",{staticClass:"fas fa-chart-line"}),t._v(" Rendimientos ")]):t._e(),e("precios-historial-modal",{attrs:{clienteActual:t.clienteEmbarque}})],1),e("div",{staticClass:"header"},[e("div",{staticClass:"header-row"},[e("div",{staticClass:"fecha-selector"},[e("label",{attrs:{for:"fecha"}},[t._v("Fecha de Embarque:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.fechaLocal,expression:"fechaLocal"}],staticClass:"form-control",attrs:{type:"date",id:"fecha",required:"",disabled:t.embarqueBloqueado},domProps:{value:t.fechaLocal},on:{change:t.actualizarFecha,input:function(e){e.target.composing||(t.fechaLocal=e.target.value)}}})]),e("div",{staticClass:"carga-selector"},[e("label",{attrs:{for:"cargaCon"}},[t._v("Carga con:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.cargaConLocal,expression:"cargaConLocal"}],staticClass:"form-control",attrs:{id:"cargaCon",required:"",disabled:t.embarqueBloqueado},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.cargaConLocal=e.target.multiple?a:a[0]},t.actualizarCargaCon]}},[e("option",{attrs:{value:""}},[t._v("Seleccionar")]),e("option",{attrs:{value:"Porro"}},[t._v("Porro")]),e("option",{attrs:{value:"Caminante"}},[t._v("Caminante")])])])])]),e("PedidoDelDiaModal",{attrs:{mostrar:t.mostrarModalPedido,fechaEmbarque:t.fechaLocal},on:{cerrar:t.cerrarModalPedido}})],1)},r=[],i=a("666c"),s=function(){var t=this,e=t._self._c;return t.mostrar?e("div",{staticClass:"modal-pedido-overlay",on:{click:t.cerrarModal}},[e("div",{staticClass:"modal-pedido-content",on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"modal-pedido-header"},[e("h2",[t._v("📋 Pedido del Día - "+t._s(t.fechaEmbarque))]),e("button",{staticClass:"btn-cerrar-modal",on:{click:t.cerrarModal}},[t._v("×")])]),e("div",{staticClass:"modal-pedido-body"},[t.cargandoPedidos?e("div",{staticClass:"cargando-pedidos"},[e("div",{staticClass:"spinner"}),e("p",[t._v("Cargando pedidos del día...")])]):0===t.pedidosDelDia.length?e("div",{staticClass:"sin-pedidos-dia"},[e("div",{staticClass:"icono-sin-pedidos"},[t._v("📄")]),e("p",[t._v("No hay pedidos registrados para el día "+t._s(t.fechaEmbarque))]),e("div",{staticClass:"acciones-sin-pedidos"},[e("button",{staticClass:"btn-crear-pedido crudo",on:{click:t.crearPedidoCrudo}},[t._v(" + Crear Pedido Crudo ")]),e("button",{staticClass:"btn-crear-pedido limpio",on:{click:t.crearPedidoLimpio}},[t._v(" + Crear Pedido Limpio ")])])]):e("div",{staticClass:"pedidos-dia-lista"},t._l(t.pedidosDelDia,(function(a){return e("div",{key:a.id,staticClass:"pedido-item"},[e("div",{staticClass:"pedido-header"},[e("div",{staticClass:"pedido-tipo"},[e("span",{staticClass:"tipo-badge"},[t._v(t._s(t.capitalizarPrimeraLetra(a.tipo)))]),e("div",{staticClass:"pedido-totales"},[e("span",[t._v(t._s(t.calcularKilosPedido(a))+" kg")]),e("span",[t._v(t._s(t.calcularTarasPedido(a))+" T")])])]),e("div",{staticClass:"pedido-acciones"},[e("button",{staticClass:"btn-ver-pedido",on:{click:function(e){return t.verDetallesPedido(a)}}},[t._v(" 👁️ Ver ")]),e("button",{staticClass:"btn-editar-pedido",on:{click:function(e){return t.editarPedido(a)}}},[t._v(" ✏️ Editar ")])])]),a.mostrarDetalles?e("div",{staticClass:"pedido-detalles"},["crudo"===a.tipo?e("div",{staticClass:"detalles-crudo"},[e("h4",[t._v("Detalle por Cliente:")]),e("div",{staticClass:"clientes-grid"},t._l(a.pedidos,(function(o,r){return e("div",{key:r,staticClass:"cliente-crudo"},[e("strong",[t._v(t._s(r)+":")]),e("div",{staticClass:"columnas-crudo"},t._l(o,(function(o,i){return o?e("div",{key:i,staticClass:"columna-item"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(a.id,"crudo",r,i)},on:{change:function(e){return t.toggleItemCompletado(a.id,"crudo",r,i,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"columna-texto",class:{completado:t.getItemCompletadoState(a.id,"crudo",r,i)}},[t._v(" "+t._s(i)+": "+t._s(o)+" ")])]):t._e()})),0)])})),0)]):e("div",{staticClass:"detalles-limpio"},[e("h4",[t._v("Detalle por Cliente:")]),e("div",{staticClass:"clientes-grid"},[a.otilio&&a.otilio.length>0?e("div",{staticClass:"cliente-limpio otilio"},[e("strong",[t._v("Otilio:")]),t._l(a.otilio,(function(o,r){return o.kilos?e("div",{key:r,staticClass:"item-limpio-container"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(a.id,"limpio","otilio",r)},on:{change:function(e){return t.toggleItemCompletado(a.id,"limpio","otilio",r,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"item-limpio",class:{completado:t.getItemCompletadoState(a.id,"limpio","otilio",r)}},[t._v(" "+t._s(o.kilos)+t._s(o.esTara?" T":" kg")+" - "+t._s(o.medida||"Sin medida")+" - "+t._s(o.tipo||"Sin tipo")+" ")])]):t._e()}))],2):t._e(),a.catarro&&a.catarro.length>0?e("div",{staticClass:"cliente-limpio catarro"},[e("strong",[t._v("Catarro:")]),t._l(a.catarro,(function(o,r){return o.kilos?e("div",{key:r,staticClass:"item-limpio-container"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(a.id,"limpio","catarro",r)},on:{change:function(e){return t.toggleItemCompletado(a.id,"limpio","catarro",r,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"item-limpio",class:{completado:t.getItemCompletadoState(a.id,"limpio","catarro",r)}},[t._v(" "+t._s(o.kilos)+t._s(o.esTara?" T":" kg")+" - "+t._s(o.medida||"Sin medida")+" - "+t._s(o.tipo||"Sin tipo")+" ")])]):t._e()}))],2):t._e(),a.joselito&&a.joselito.length>0?e("div",{staticClass:"cliente-limpio joselito"},[e("strong",[t._v("Joselito:")]),t._l(a.joselito,(function(o,r){return o.kilos?e("div",{key:r,staticClass:"item-limpio-container"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(a.id,"limpio","joselito",r)},on:{change:function(e){return t.toggleItemCompletado(a.id,"limpio","joselito",r,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"item-limpio",class:{completado:t.getItemCompletadoState(a.id,"limpio","joselito",r)}},[t._v(" "+t._s(o.kilos)+t._s(o.esTara?" T":" kg")+" - "+t._s(o.medida||"Sin medida")+" - "+t._s(o.tipo||"Sin tipo")+" ")])]):t._e()}))],2):t._e(),a.ozuna&&a.ozuna.length>0?e("div",{staticClass:"cliente-limpio ozuna"},[e("strong",[t._v("Ozuna:")]),t._l(a.ozuna,(function(o,r){return o.kilos?e("div",{key:r,staticClass:"item-limpio-container"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(a.id,"limpio","ozuna",r)},on:{change:function(e){return t.toggleItemCompletado(a.id,"limpio","ozuna",r,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"item-limpio",class:{completado:t.getItemCompletadoState(a.id,"limpio","ozuna",r)}},[t._v(" "+t._s(o.kilos)+t._s(o.esTara?" T":" kg")+" - "+t._s(o.medida||"Sin medida")+" - "+t._s(o.tipo||"Sin tipo")+" ")])]):t._e()}))],2):t._e(),t._l(a.clientesTemporales,(function(o,r){return o.pedidos&&o.pedidos.length>0?e("div",{key:r,staticClass:"cliente-limpio temporal"},[e("strong",[t._v(t._s(o.nombre)+":")]),t._l(o.pedidos,(function(o,i){return o.kilos?e("div",{key:i,staticClass:"item-limpio-container"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(a.id,"limpio",r,i)},on:{change:function(e){return t.toggleItemCompletado(a.id,"limpio",r,i,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"item-limpio",class:{completado:t.getItemCompletadoState(a.id,"limpio",r,i)}},[t._v(" "+t._s(o.kilos)+t._s(o.esTara?" T":" kg")+" - "+t._s(o.medida||"Sin medida")+" - "+t._s(o.tipo||"Sin tipo")+" ")])]):t._e()}))],2):t._e()}))],2)])]):t._e()])})),0)]),e("div",{staticClass:"modal-pedido-footer"},[e("button",{staticClass:"btn-cerrar-footer",on:{click:t.cerrarModal}},[t._v("Cerrar")])])])]):t._e()},n=[],c=(a("14d9"),a("1494")),l={name:"PedidoDelDiaModal",props:{mostrar:{type:Boolean,default:!1},fechaEmbarque:{type:String,required:!0}},data(){return{pedidosDelDia:[],cargandoPedidos:!1,itemsCompletados:{}}},watch:{mostrar(t){t&&this.cargarPedidosDelDia()}},methods:{async cargarPedidosDelDia(){this.cargandoPedidos=!0;try{const t=Object(c["h"])(),e=Object(c["c"])(t,"pedidos"),a=Object(c["o"])(e,Object(c["s"])("fecha","==",this.fechaEmbarque)),o=await Object(c["g"])(a);this.pedidosDelDia=[],this.itemsCompletados={},o.docs.forEach(t=>{const e=t.data();this.pedidosDelDia.push({id:t.id,...e,mostrarDetalles:!1}),this.cargarEstadosCompletados(t.id,e)})}catch(t){console.error("Error al cargar los pedidos del día:",t),alert("Hubo un error al cargar los pedidos del día. Por favor, intente de nuevo.")}finally{this.cargandoPedidos=!1}},cargarEstadosCompletados(t,e){if(this.$set(this.itemsCompletados,t,{}),"crudo"===e.tipo&&e.pedidos)for(const a in e.pedidos)for(const o in e.pedidos[a]){const r=`crudo-${a}-${o}`;e.itemsCompletados&&e.itemsCompletados[r]&&this.$set(this.itemsCompletados[t],r,e.itemsCompletados[r])}else if("limpio"===e.tipo&&(e.otilio&&e.otilio.forEach((a,o)=>{const r="limpio-otilio-"+o;e.itemsCompletados&&e.itemsCompletados[r]&&this.$set(this.itemsCompletados[t],r,e.itemsCompletados[r])}),e.catarro&&e.catarro.forEach((a,o)=>{const r="limpio-catarro-"+o;e.itemsCompletados&&e.itemsCompletados[r]&&this.$set(this.itemsCompletados[t],r,e.itemsCompletados[r])}),e.joselito&&e.joselito.forEach((a,o)=>{const r="limpio-joselito-"+o;e.itemsCompletados&&e.itemsCompletados[r]&&this.$set(this.itemsCompletados[t],r,e.itemsCompletados[r])}),e.ozuna&&e.ozuna.forEach((a,o)=>{const r="limpio-ozuna-"+o;e.itemsCompletados&&e.itemsCompletados[r]&&this.$set(this.itemsCompletados[t],r,e.itemsCompletados[r])}),e.clientesTemporales))for(const a in e.clientesTemporales){const o=e.clientesTemporales[a];o.pedidos&&o.pedidos.forEach((o,r)=>{const i=`limpio-${a}-${r}`;e.itemsCompletados&&e.itemsCompletados[i]&&this.$set(this.itemsCompletados[t],i,e.itemsCompletados[i])})}},async toggleItemCompletado(t,e,a,o,r){try{const i=`${e}-${a}-${o}`;this.itemsCompletados[t]||this.$set(this.itemsCompletados,t,{}),this.$set(this.itemsCompletados[t],i,r);const s=Object(c["h"])(),n=Object(c["e"])(s,"pedidos",t);await Object(c["r"])(n,{["itemsCompletados."+i]:r,[`itemsCompletados.${i}_fecha`]:r?(new Date).toISOString():null}),console.log(`Item ${i} en pedido ${t} marcado como ${r?"completado":"pendiente"}`)}catch(i){console.error("Error al actualizar estado del item:",i);const s=`${e}-${a}-${o}`;this.$set(this.itemsCompletados[t],s,!r),alert("Error al actualizar el estado del item. Por favor, intente de nuevo.")}},getItemCompletadoState(t,e,a,o){const r=`${e}-${a}-${o}`;return this.itemsCompletados[t]&&this.itemsCompletados[t][r]||!1},capitalizarPrimeraLetra(t){return t.charAt(0).toUpperCase()+t.slice(1)},calcularKilosPedido(t){if("crudo"===t.tipo){let e=0;if(t.pedidos)for(const a in t.pedidos)for(const o in t.pedidos[a]){const r=t.pedidos[a][o];r&&!isNaN(r)&&(e+=parseFloat(r))}return(19*e).toFixed(0)}{let e=0;if(t.otilio&&(e+=this.calcularKilosCliente(t.otilio)),t.catarro&&(e+=this.calcularKilosCliente(t.catarro)),t.joselito&&(e+=this.calcularKilosCliente(t.joselito)),t.ozuna&&(e+=this.calcularKilosCliente(t.ozuna)),t.clientesTemporales)for(const a in t.clientesTemporales){const o=t.clientesTemporales[a];o.pedidos&&(e+=this.calcularKilosCliente(o.pedidos))}return Math.round(e).toString()}},calcularTarasPedido(t){if("crudo"===t.tipo){const e=parseFloat(this.calcularKilosPedido(t));return Math.round(e/19).toString()}{let e=0;if(t.otilio&&(e+=this.calcularTarasCliente(t.otilio)),t.catarro&&(e+=this.calcularTarasCliente(t.catarro)),t.joselito&&(e+=this.calcularTarasCliente(t.joselito)),t.ozuna&&(e+=this.calcularTarasCliente(t.ozuna)),t.clientesTemporales)for(const a in t.clientesTemporales){const o=t.clientesTemporales[a];o.pedidos&&(e+=this.calcularTarasCliente(o.pedidos))}return Math.round(e).toString()}},calcularKilosCliente(t){let e=0,a=0,o=0,r=0,i=0,s=0;return t.forEach(t=>{t.kilos&&(t.esTara?"C/H20"===t.tipo?a+=30*Number(t.kilos)*.65:"1.35 y .15"===t.tipo?i+=30*Number(t.kilos):o+=30*Number(t.kilos):"S/H20"===t.tipo?e+=Number(t.kilos):"C/H20"===t.tipo?a+=Number(t.kilos):"1.35 y .15"===t.tipo?r+=1.35*Number(t.kilos):".7 y .3"===t.tipo&&(s+=.7*Number(t.kilos)))}),e+o+i+a+r+s},calcularTarasCliente(t){let e=0,a=0,o=0;t.forEach(t=>{t.kilos&&(t.esTara?e+=Number(t.kilos):"S/H20"===t.tipo?a+=Number(t.kilos):"1.35 y .15"===t.tipo&&(o+=Number(t.kilos)))});const r=a/25,i=o/33.75;return e+r+i},verDetallesPedido(t){this.$set(t,"mostrarDetalles",!t.mostrarDetalles)},editarPedido(t){const e="crudo"===t.tipo?"/procesos/pedidos/crudo":"/procesos/pedidos/limpio";this.$router.push({path:e,query:{edit:"true",id:t.id,fecha:t.fecha}}),this.cerrarModal()},crearPedidoCrudo(){this.$router.push({path:"/procesos/pedidos/crudo",query:{fecha:this.fechaEmbarque}}),this.cerrarModal()},crearPedidoLimpio(){this.$router.push({path:"/procesos/pedidos/limpio",query:{fecha:this.fechaEmbarque}}),this.cerrarModal()},cerrarModal(){this.$emit("cerrar"),this.pedidosDelDia=[],this.itemsCompletados={}}}},d=l,u=(a("7084"),a("2877")),p=Object(u["a"])(d,s,n,!1,null,"6fc71305",null),m=p.exports,h={name:"HeaderEmbarque",components:{PreciosHistorialModal:i["a"],PedidoDelDiaModal:m},props:{modoEdicion:{type:Boolean,default:!1},embarqueBloqueado:{type:Boolean,default:!1},embarque:{type:Object,required:!0,validator:t=>"fecha"in t&&"cargaCon"in t},isGeneratingPdf:{type:Boolean,default:!1},pdfType:{type:String,default:""},embarqueId:{type:String,default:""},clienteEmbarque:{type:String,default:""}},data(){return{fechaLocal:this.embarque.fecha,cargaConLocal:this.embarque.cargaCon,mostrarModalPedido:!1}},watch:{"embarque.fecha"(t){this.fechaLocal=t},"embarque.cargaCon"(t){this.cargaConLocal=t}},methods:{volverAEmbarquesMenu(){this.$emit("volver")},toggleBloqueo(){this.$emit("toggle-bloqueo")},actualizarFecha(){this.embarqueId&&localStorage.setItem("ultimoEmbarqueId",this.embarqueId),this.$emit("verificar-fecha",this.fechaLocal)},actualizarCargaCon(){this.$emit("update:cargaCon",this.cargaConLocal)},verPedidoDelDia(){this.mostrarModalPedido=!0},cerrarModalPedido(){this.mostrarModalPedido=!1}}},b=h,f=(a("bded"),Object(u["a"])(b,o,r,!1,null,"2e74b64a",null));e["a"]=f.exports},ff7a:function(t,e,a){"use strict";var o=function(){var t=this,e=t._self._c;return t.mostrar?e("div",{staticClass:"modal-overlay",on:{click:function(e){return e.target!==e.currentTarget?null:t.cerrar.apply(null,arguments)}}},[e("div",{staticClass:"modal-contenido",on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"modal-header"},[e("h3",[t._v(t._s(t.titulo))]),e("button",{staticClass:"btn-cerrar-modal",on:{click:function(e){return e.stopPropagation(),t.cerrar.apply(null,arguments)}}},[e("i",{staticClass:"fas fa-times"})])]),e("div",{staticClass:"modal-body"},[t._t("default")],2),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",on:{click:function(e){return e.stopPropagation(),t.cerrar.apply(null,arguments)}}},[t._v("Cancelar")]),e("button",{staticClass:"btn btn-primary",on:{click:function(e){return e.stopPropagation(),t.confirmar.apply(null,arguments)}}},[t._v(t._s(t.textoBotonConfirmar))])])])]):t._e()},r=[],i={name:"BaseModal",props:{mostrar:{type:Boolean,required:!0},titulo:{type:String,default:"Modal"},textoBotonConfirmar:{type:String,default:"Guardar"}},methods:{cerrar(){this.$emit("cerrar")},confirmar(){this.$emit("confirmar")}}},s=i,n=(a("bf5e"),a("2877")),c=Object(n["a"])(s,o,r,!1,null,"145be654",null);e["a"]=c.exports}}]);