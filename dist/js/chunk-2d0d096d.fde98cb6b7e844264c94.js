(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d096d"],{"692f":function(t,e,r){"use strict";r.r(e),r.d(e,"generarResumenEmbarquePDF",(function(){return A}));r("14d9"),r("13d5"),r("88e6"),r("70cc"),r("eb03"),r("22e5c"),r("c01e"),r("fa76"),r("8306");var n=r("e499"),o=r.n(n),a=r("4ebb"),i=r.n(a);function l(t){const e={1:"#3498db",2:"#e74c3c",3:"#f1c40f",4:"#2ecc71"};return e[t]||"#95a5a6"}function c(t,e,r=100,n=[]){const o=r/100,a=[{text:"",pageBreak:"before"}];let i=0,c=0;const f=120,x=25,y=[],C=[];Object.entries(t).forEach(([t,e])=>{["1","2","3","4"].includes(t)?y.push([t,e]):C.push([t,e])});for(let S=0;S<C.length;S+=3){const t=[];for(let e=0;e<3&&S+e<C.length;e++){const[r,a]=C[S+e],y=s(r,n),A=m(a),v=p(a);i+=A,c+=v,t.push({stack:[{columns:[{width:"auto",stack:[{canvas:[{type:"rect",x:0,y:0,w:.8*f,h:x,r:8,color:l(r)}]},{text:y,color:"white",fontSize:11*o,relativePosition:{x:10,y:-20}}]},{text:`${A}T|${h(v)}Kg`,style:"total",alignment:"right",color:l(r),fontSize:11*o}],margin:[0,3,0,3]},...a.map(t=>({stack:[{text:d(t),fontSize:11*o,bold:!0,margin:[0,0,0,1],alignment:"center"},{canvas:[{type:"line",x1:0,y1:1,x2:120,y2:1,lineWidth:.5,lineColor:"#000000"}],margin:[0,0,0,1]},{text:0===b(t)?[{text:""+h(u(t)),color:"red",bold:!0}]:[{text:b(t)+"-",bold:!0},{text:""+h(u(t)),color:"red",bold:!0}],fontSize:11*o,margin:[0,1,0,1],alignment:"center"},{text:g(t),fontSize:10*o,margin:[0,0,0,1],alignment:"center"}],margin:[0,0,0,5]}))],width:"32%"})}a.push({columns:t,columnGap:10,margin:[0,0,0,15]})}return y.forEach(([t,e])=>{const r=s(t,n),y=m(e),C=p(e);i+=y,c+=C;const S=e.length;let A=13,v=15;S>30?(A=9,v=6):S>24?(A=10,v=8):S>18?(A=11,v=10):S>12&&(A=12,v=12),a.push({columns:[{width:"auto",stack:[{canvas:[{type:"rect",x:0,y:0,w:f,h:x,r:8,color:l(t)}]},{text:r,color:"white",fontSize:A*o,relativePosition:{x:10,y:-20}}]},{text:`Total: ${y}T | ${h(C)}Kg`,style:"total",alignment:"right",color:l(t),fontSize:A*o}],margin:[0,3,0,3]});let w=3;S>30&&(w=4);const z=[];for(let n=0;n<e.length;n+=w)z.push(e.slice(n,n+w));z.forEach(t=>{a.push({columns:t.map(t=>({stack:[{text:d(t),fontSize:A*o,bold:!0,margin:[0,0,0,1],alignment:"center"},{canvas:[{type:"line",x1:0,y1:1,x2:150,y2:1,lineWidth:.5,lineColor:"#000000"}],margin:[0,0,0,1]},{text:0===b(t)?[{text:""+h(u(t)),color:"red",bold:!0}]:[{text:b(t)+"-",bold:!0},{text:""+h(u(t)),color:"red",bold:!0}],fontSize:A*o,margin:[0,1,0,1],alignment:"center"},{text:g(t),fontSize:(A-1)*o,margin:[0,0,0,1],alignment:"center"}],width:100/w+"%",alignment:"center"})),columnGap:5,margin:[0,0,0,v]})}),a.push({canvas:[{type:"line",x1:0,y1:2,x2:515,y2:2,lineWidth:.5,lineColor:"#CCCCCC"}],margin:[0,5,0,5]})}),a}function s(t,e=[]){const r=t.toString();if(Array.isArray(e)&&e.length>0){const t=e.find(t=>{var e,n;return(null===(e=t.id)||void 0===e?void 0:e.toString())===r||(null===(n=t.clienteId)||void 0===n?void 0:n.toString())===r});if(t)return t.nombre||t.nombreCliente}const n={1:"Joselito",2:"Catarro",3:"Otilio",4:"Ozuna"};return n[r]||"Cliente "+r}function d(t){let e="";return"c/h20"===t.tipo?[{text:`${t.textoAlternativo||t.medida||""} ${t.fecha||""} `,color:"black"},{text:`c/h20 (${t.camaronNeto||.65})`,color:"#3498db"},t.precio?{text:" $"+Number(t.precio).toLocaleString("en-US"),color:"red",bold:!0}:{}]:(e=t.textoAlternativo||t.medida||"",t.fecha&&(e+=" "+t.fecha),"3"===t.clienteId&&t.noSumarKilos&&(e+=" sellada"),"otro"===t.tipo?e+=" "+t.tipoPersonalizado:t.tipo&&(e+=" "+t.tipo),t.precio?[{text:e,color:"black"},{text:" $"+Number(t.precio).toLocaleString("en-US"),color:"red",bold:!0}]:e)}function u(t){if("c/h20"===t.tipo){const e=t.camaronNeto||.65,r=f(t);return r*e}const e=Array.isArray(t.kilos)?t.kilos.reduce((t,e)=>t+(parseFloat(e)||0),0):0;if(t.restarTaras){const r=3*(Array.isArray(t.taras)?t.taras.reduce((t,e)=>t+(parseInt(e)||0),0):0);return e-r}return e}function f(t){if(!Array.isArray(t.reporteTaras)||!Array.isArray(t.reporteBolsas))return 0;let e=0;for(let r=0;r<t.reporteTaras.length;r++){const n=parseInt(t.reporteTaras[r])||0,o=parseInt(t.reporteBolsas[r])||0;e+=n*o}return e}function p(t){return t.reduce((t,e)=>{if("c/h20"===e.tipo){const r=f(e);return t+r*(e.camaronNeto||.65)}{const r=e.kilos?e.kilos.reduce((t,e)=>t+(parseFloat(e)||0),0):0,n=e.taras?e.taras.reduce((t,e)=>t+(parseInt(e)||0),0):0;return e.restarTaras?t+(r-3*n):t+r}},0)}function m(t){return t.reduce((t,e)=>{const r=e.taras?e.taras.reduce((t,e)=>t+(parseInt(e)||0),0):0,n=e.tarasExtra?e.tarasExtra.reduce((t,e)=>t+(parseInt(e)||0),0):0;return t+r+n},0)}function h(t){return t.toLocaleString("en-US",{minimumFractionDigits:1,maximumFractionDigits:1})}function g(t){let e="";if(Array.isArray(t.reporteTaras)&&Array.isArray(t.reporteBolsas)){const r=[];let n=[],o=null;for(let e=0;e<t.reporteTaras.length;e++){const a=parseInt(t.reporteTaras[e]),i=parseInt(t.reporteBolsas[e]);isNaN(a)||isNaN(i)||(i===o?n.push(a):(n.length>0&&r.push(`(${n.join(",")}-${o})`),n=[a],o=i))}n.length>0&&null!==o&&r.push(`(${n.join(",")}-${o})`),e=r.join("")}return e}function b(t){const e=t.taras?t.taras.reduce((t,e)=>t+(parseInt(e)||0),0):0,r=t.tarasExtra?t.tarasExtra.reduce((t,e)=>t+(parseInt(e)||0),0):0;return e+r}"object"===typeof i.a&&i.a.hasOwnProperty("default")?o.a.vfs=i.a.default:"object"===typeof i.a&&i.a.pdfMake&&i.a.pdfMake.vfs?o.a.vfs=i.a.pdfMake.vfs:console.error("No se pudo inicializar vfs para pdfMake"),o.a.fonts={Roboto:{normal:"Roboto-Regular.ttf",bold:"Roboto-Medium.ttf",italics:"Roboto-Italic.ttf",bolditalics:"Roboto-MediumItalic.ttf"}};const x={Joselito:"#3498db",Catarro:"#e74c3c",Otilio:"#f1c40f",Ozuna:"#2ecc71",Canelo:"#9b59b6"},y=["Med","Med-Esp","Med-Gde","Gde","Extra","Jumbo"],C=t=>t.sort((t,e)=>{const r=t.toUpperCase(),n=e.toUpperCase(),o=y.findIndex(t=>t.toUpperCase()===r),a=y.findIndex(t=>t.toUpperCase()===n);return-1!==o&&-1!==a?o-a:-1!==o?-1:-1!==a?1:t.localeCompare(e)}),S=t=>{if(!Array.isArray(t)||0===t.length)return[];const e=t=>{if("string"===typeof t){const e=t.split("-");return e.length>1?Number(e[1]):0}return 0},r={};t.forEach(t=>{if(!t)return;const n=e(t);r[n]||(r[n]=[]),r[n].push(t)});const n=Object.keys(r).map(Number).sort((t,e)=>19===t?-1:19===e?1:t-e);return n.reduce((t,e)=>t.concat(r[e]),[])},A=(t,e,r,n=[])=>{let a=[];t.medidasCrudos&&Array.isArray(t.medidasCrudos)&&(a=t.medidasCrudos.map(t=>t.replace("c/c","").trim()),a=C([...new Set(a)])),console.log("Medidas de crudos encontradas:",a);const i={pageSize:"LETTER",pageOrientation:"portrait",content:[{table:{widths:["*","auto","*"],body:[[{text:"Carga: "+t.cargaCon,alignment:"left",fontSize:20,border:[!1,!1,!1,!0]},{text:"Embarque",alignment:"center",fontSize:25,bold:!0,border:[!1,!1,!1,!0]},{text:""+new Date(new Date(t.fecha).getTime()+864e5).toLocaleDateString("es-MX",{day:"2-digit",month:"short",year:"numeric",timeZone:"America/Mexico_City"}),alignment:"right",fontSize:20,border:[!1,!1,!1,!0]}]]},margin:[0,0,0,20]}],styles:{header:{fontSize:25,bold:!0,alignment:"center",margin:[0,0,0,0]},tableHeader:{bold:!0,fontSize:19,fillColor:"#eeeeee",alignment:"center"},clienteHeader:{fontSize:18,bold:!0,color:"white"},clienteCell:{bold:!0,fontSize:17,alignment:"left",color:"white"},dataCell:{fontSize:19,alignment:"center"},total:{fontSize:18,bold:!0,color:"white"}}},l=[{text:"Cliente",style:"tableHeader"},...a.map(e=>{const r=t.crudos.find(t=>t.medida.replace("c/c","").trim()===e&&t.textoAlternativo),n=r?r.textoAlternativo:e;return{text:n,style:"tableHeader"}})],s=[],d=new Set(t.crudos.map(t=>t.clienteId));d.forEach(e=>{const n=r(e),o="Joselito"===n?"8A":n,i=x[n]||"#95a5a6",l=[{text:o,style:"clienteCell",fillColor:i}];a.forEach(r=>{const n=t.crudos.filter(t=>t.clienteId===e&&t.medida.replace("c/c","").trim()===r);if(n.length>0){let t=[],e=!1,r=null;n.forEach(n=>{n.taras&&Array.isArray(n.taras)&&(t=t.concat(n.taras.filter(t=>t))),n.precio&&(e=!0,r=n.precio)});const o=S(t),a=[{text:o.join("\n"),style:"dataCell"}];e&&a.push({text:"$"+Number(r).toLocaleString("en-US"),color:"red",bold:!0,fontSize:16}),l.push({stack:a,style:"dataCell"})}else l.push({text:"",style:"dataCell"})}),s.push(l)}),i.content.push({table:{headerRows:1,widths:[60,...a.map(()=>{const t=Math.min(100,395/a.length);return t})],body:[l,...s]},layout:{hLineWidth:function(t,e){return 1},vLineWidth:function(t,e){return 1},hLineColor:function(t,e){return"#000000"},vLineColor:function(t,e){return"#000000"},paddingLeft:function(t){return 4},paddingRight:function(t){return 4},paddingTop:function(t){return 4},paddingBottom:function(t){return 4}}}),i.content.push({text:"\n\n"},{text:"Desglose por Medida",style:"header",margin:[0,0,0,10]});const u=[{text:"Medida",style:"tableHeader"},{text:"Cliente",style:"tableHeader"},{text:"Barco",style:"tableHeader"}],f=[];a.forEach(e=>{const n=t.crudos.filter(t=>t.medida.replace("c/c","").trim()===e);if(n.length>0){const t=n[0],o=r(t.clienteId),a="Joselito"===o?"8A":o,i=t.textoAlternativo||e;f.push([{text:i,style:"dataCell",rowSpan:n.length,alignment:"center",verticalAlignment:"middle"},{text:a,style:"clienteCell",fillColor:x[o]||"#95a5a6"},{text:t.barco||"-",style:"dataCell"}]);for(let e=1;e<n.length;e++){const t=n[e],o=r(t.clienteId),a="Joselito"===o?"8A":o;f.push(["",{text:a,style:"clienteCell",fillColor:x[o]||"#95a5a6"},{text:t.barco||"-",style:"dataCell"}])}}}),i.content.push({table:{headerRows:1,widths:["*",100,"*"],body:[u,...f]},layout:{hLineWidth:function(t,e){return 1},vLineWidth:function(t,e){return 1},hLineColor:function(t,e){return"#000000"},vLineColor:function(t,e){return"#000000"},paddingLeft:function(t){return 4},paddingRight:function(t){return 4},paddingTop:function(t){return 4},paddingBottom:function(t){return 4},fillColor:function(t,e){return null},defaultBorder:!0,vLineAlignment:function(t,e){return"center"}}}),f.forEach(t=>{t[0].text&&(t[0]={...t[0],alignment:"center",margin:[0,10,0,10]})}),i.content.push(...c(e,x,100,n)),o.a.createPdf(i).download("resumen-embarque-completo.pdf")}}}]);