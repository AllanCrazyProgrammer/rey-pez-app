(function(t){function e(e){for(var n,i,s=e[0],c=e[1],l=e[2],d=0,p=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(p.length)p.shift()();return a.push.apply(a,l||[]),o()}function o(){for(var t,e=0;e<a.length;e++){for(var o=a[e],n=!0,i=1;i<o.length;i++){var c=o[i];0!==r[c]&&(n=!1)}n&&(a.splice(e--,1),t=s(s.s=o[0]))}return t}var n={},r={app:0},a=[];function i(t){return s.p+"js/"+({}[t]||t)+"."+{"chunk-2d216214":"fe4bb11d","chunk-4cde69ab":"3d605eac"}[t]+".js"}function s(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.e=function(t){var e=[],o=r[t];if(0!==o)if(o)e.push(o[2]);else{var n=new Promise((function(e,n){o=r[t]=[e,n]}));e.push(o[2]=n);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=i(t);var l=new Error;a=function(e){c.onerror=c.onload=null,clearTimeout(d);var o=r[t];if(0!==o){if(o){var n=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+n+": "+a+")",l.name="ChunkLoadError",l.type=n,l.request=a,o[1](l)}r[t]=void 0}};var d=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(e)},s.m=t,s.c=n,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(o,n,function(e){return t[e]}.bind(null,n));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/",s.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var d=0;d<c.length;d++)e(c[d]);var u=l;a.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},"399e":function(t,e,o){},"3f4a":function(t,e,o){"use strict";o("b857")},"42e0":function(t,e,o){"use strict";o("7aa3")},"4e00":function(t,e,o){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("div",{staticClass:"add-client"},[e("div",{staticClass:"back-button-container"},[e("BackButton",{attrs:{to:"/NoteMenu"}})],1),t._m(0),e("form",{on:{submit:function(e){return e.preventDefault(),t.addClient.apply(null,arguments)}}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"name"}},[t._v("Nombre:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",required:""},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),e("button",{attrs:{type:"submit"}},[t._v("Agregar Cliente")])]),t._m(1),e("ul",t._l(t.clients,(function(o){return e("li",{key:o.id},[t._v(" "+t._s(o.name)+" "),e("button",{on:{click:function(e){return t.deleteClient(o.id)}}},[t._v("Eliminar")])])})),0)])])},r=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"add-client-form"},[e("h2",[t._v("Agregar Cliente")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"add-client-form"},[e("h2",[t._v("Lista de Clientes")])])}],a=(o("d9e2"),o("74c9")),i=o("dc59"),s=o("1494"),c={components:{BackButton:a["a"]},data(){return{name:"",clients:[]}},methods:{async addClient(){try{if(console.log("DB instance:",i["a"]),!i["a"])throw new Error("Firestore DB is not initialized");await Object(s["a"])(Object(s["b"])(i["a"],"clients"),{name:this.name}),this.name="",this.fetchClients()}catch(t){console.error("Error adding client: ",t)}},async fetchClients(){try{const t=await Object(s["f"])(Object(s["b"])(i["a"],"clients"));this.clients=t.docs.map(t=>({id:t.id,...t.data()}))}catch(t){console.error("Error fetching clients: ",t)}},deleteClient(t){window.confirm("¿Estás seguro de que deseas eliminar este cliente?")&&Object(s["c"])(Object(s["d"])(i["a"],"clients",t)).then(()=>{console.log("Cliente eliminado con éxito")}).catch(t=>{console.error("Error al eliminar el cliente: ",t)})}},async mounted(){this.fetchClients()}},l=c,d=(o("3f4a"),o("2877")),u=Object(d["a"])(l,n,r,!1,null,"5b08dd20",null);e["a"]=u.exports},"50ae":function(t,e,o){"use strict";o("f75f")},5355:function(t,e,o){},"56d7":function(t,e,o){"use strict";o.r(e);var n=o("2b0e"),r=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("Navbar")],1)},a=[],i=function(){var t=this,e=t._self._c;return e("div",[e("b-navbar",{staticClass:"sideBorder",attrs:{toggleable:"lg"}},[e("b-navbar-brand",{attrs:{href:"#"}},[e("b-img",{attrs:{src:"https://res.cloudinary.com/hwkcovsmr/image/upload/v1620946647/samples/REY_PEZ_LOGO_nsotww.png",width:"80",fluid:"",alt:"Fluid image"}})],1),e("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),e("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[e("h2",[t._v("Rey Pez")]),e("b-row",[e("b-navbar-nav",[e("b-col",[e("b-nav-item",[e("router-link",{attrs:{to:"/"}},[t._v("Home")])],1)],1),e("b-col",[e("b-nav-item",[e("router-link",{attrs:{to:"/noteMenu"}},[t._v("Notas")])],1)],1)],1)],1),e("b-navbar-nav",{staticClass:"ml-auto"},[e("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[e("em",[t._v("User")])]},proxy:!0}])},[e("b-dropdown-item",{attrs:{href:"#"}},[t._v("Profile")]),e("b-dropdown-item",{attrs:{href:"#"}},[t._v("Sign Out")])],1)],1)],1)],1),e("router-view")],1)},s=[],c={name:"Navbar",data(){return{}}},l=c,d=(o("ab85"),o("2877")),u=Object(d["a"])(l,i,s,!1,null,null,null),p=u.exports,m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mt-5"},[e("div",{staticClass:"fecha-actual"},[t._v(t._s(t.fechaActual))]),e("b-row",[e("b-col",{staticClass:"mb-3",attrs:{cols:"12",md:"5"}},[e("b-button",{staticClass:"mb-3",attrs:{variant:"primary"},on:{click:t.borrarDatos}},[t._v("Borrar datos")]),e("b-form-textarea",{staticClass:"text-center",attrs:{name:"dinero",id:"textarea-auto-height",placeholder:"Dinero",rows:"3","max-rows":"100"},model:{value:t.datos,callback:function(e){t.datos=e},expression:"datos"}})],1),e("b-col",{attrs:{cols:"7"}},[e("Cuentas",{attrs:{datos:t.datos}})],1)],1)],1)},f=[],h=function(){var t=this,e=t._self._c;return e("div",[e("b-row",[e("b-col",{staticClass:"mb-3",attrs:{cols:"12",md:"4",lg:"2"}},[e("Calcular",{attrs:{cantidad:"$2",datos:t.datos},on:{dataArray:t.getDatos}})],1),e("b-col",{staticClass:"mb-3",attrs:{cols:"12",md:"4",lg:"2"}},[e("Calcular",{attrs:{cantidad:"$1",datos:t.datos},on:{dataArray:t.getDatosPeso}})],1),e("b-col",{staticClass:"mb-3",attrs:{cols:"12",md:"4",lg:"2"}},[e("button",{staticClass:"btn btn-primary w-100",on:{click:t.printCuentas}},[t._v("Imprimir sección")])]),e("b-col",{staticClass:"mb-3",attrs:{cols:"12",lg:"6",id:"printSection"}},[e("h1",[t._v("Cuentas")]),e("h2",[t._v("500: "+t._s(t.din500))]),e("h2",[t._v("200: "+t._s(t.din200))]),e("h2",[t._v("100: "+t._s(t.din100))]),e("h2",[t._v("50: "+t._s(t.din50))]),e("h2",[t._v("20: "+t._s(t.din20))]),e("h2",[t._v("10: "+t._s(t.din10))]),e("h2",[t._v("5: "+t._s(t.din5))]),e("h2",[t._v("1: "+t._s(t.din1))]),e("h2",[t._v("2: "+t._s(t.din2))])])],1)],1)},v=[],b=function(){var t=this,e=t._self._c;return e("div",[e("b-col",[e("b-button",{on:{click:t.getArray}},[t._v(t._s(t.cantidad))])],1)],1)},_=[],g={name:"Calcular",props:["datos","cantidad"],components:{Datos:O,Cuentas:k},data:()=>({misDatos:misDatos}),methods:{getArray(){let t=this.datos;return t=t.split("\n").filter(t=>t),console.log(t),this.$emit("dataArray",t)}}},y=g,P=Object(d["a"])(y,b,_,!1,null,null,null),w=P.exports,C={name:"Cuentas",props:{datos:{type:Number}},components:{Datos:O,Calcular:w},data(){return{din500:0,din200:0,din100:0,din50:0,din20:0,din10:0,din5:0,din2:0,din1:0,din2:0}},methods:{printCuentas(){const t=document.getElementById("printSection").innerHTML,e=document.body.innerHTML,o=(new Date).toLocaleDateString(),n=`<div style="text-align: center; font-size: 30px; margin-bottom: 10px;">Fecha: ${o}</div>`,r=n+t;document.body.innerHTML=r,window.print(),document.body.innerHTML=e,window.location.reload()},getDatosPeso(t){for(let e=0;e<t.length;e++){const o=[500,200,100,50,20,10,5,1];for(const n of o)while(t[e]>=n)t[e]-=n,this["din"+n]+=1}},getDatos(t){console.log(t.value);const e=[500,200,100,50,20,10,5,2,1];for(let o=0;o<t.length;o++)for(let n=0;n<e.length;n++){let r=e[n];while(t[o]>=r)t[o]-=r,this["din"+r]+=1}}}},D=C,N=(o("5df8"),Object(d["a"])(D,h,v,!1,null,null,null)),k=N.exports,x={name:"Datos",components:{Cuentas:k},data(){return{datos:""}},methods:{borrarDatos(){this.datos=""}},computed:{fechaActual(){const t=new Date,e={year:"numeric",month:"long",day:"numeric"};return t.toLocaleDateString("es-ES",e)}}},S=x,A=(o("42e0"),Object(d["a"])(S,m,f,!1,null,null,null)),O=A.exports,j=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"home"}},[e("b-container",[e("Datos")],1)],1)},E=[],$={name:"home",components:{Navbar:p,Datos:O}},F=$,I=Object(d["a"])(F,j,E,!1,null,null,null),M=I.exports,K={name:"app",components:{Navbar:p,Datos:O,Home:M}},T=K,q=(o("8a87"),Object(d["a"])(T,r,a,!1,null,null,null)),B=q.exports,L=o("8c4f"),Y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"notes-wrapper"},[e("div",{staticClass:"button-container"},[e("div",{staticClass:"button-wrapper"},[e("button",{on:{click:t.goToSaleNote}},[t._v("Nueva nota")])]),e("div",{staticClass:"button-wrapper"},[e("button",{on:{click:t.goToAddClient}},[t._v("Agregar Cliente")])])]),e("div",{staticClass:"notes-container"},[e("div",{staticClass:"filter-container"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.paymentFilter,expression:"paymentFilter"}],on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.paymentFilter=e.target.multiple?o:o[0]}}},[e("option",{attrs:{value:"all"}},[t._v("Todas")]),e("option",{attrs:{value:"paid"}},[t._v("Pagadas")]),e("option",{attrs:{value:"unpaid"}},[t._v("No Pagadas")])])]),e("h2",[t._v("Notas por Cliente")]),t._l(t.filteredNotesByClient,(function(o,n){return e("div",{key:n},[e("details",[e("summary",[t._v(t._s(n))]),e("ul",t._l(o,(function(o){return e("li",{key:o.id},[e("button",{on:{click:function(e){return t.goToEditNote(o.id)}}},[t._v(" Nota "+t._s(o.folio)+" - "+t._s(o.currentDate)+" ")])])})),0)])])}))],2)])},R=[],z=(o("14d9"),o("13d5"),o("dc59")),H=o("1494"),U={name:"NoteMenu",data(){return{notesByClient:{},paymentFilter:"all"}},methods:{goToSaleNote(){this.$router.push({name:"SaleNote"})},goToAddClient(){this.$router.push({name:"AddClient"})},async fetchNotes(){try{const t=await Object(H["f"])(Object(H["b"])(z["a"],"notes")),e=t.docs.map(t=>({id:t.id,...t.data()}));this.notesByClient=e.reduce((t,e)=>(t[e.client]||(t[e.client]=[]),t[e.client].push(e),t),{})}catch(t){console.error("Error fetching notes: ",t)}},goToEditNote(t){this.$router.push({name:"editar-nota",params:{noteId:t}})}},async mounted(){this.fetchNotes()},computed:{filteredNotesByClient(){if("all"===this.paymentFilter)return this.notesByClient;const t={};for(const[e,o]of Object.entries(this.notesByClient))t[e]=o.filter(t=>"paid"===this.paymentFilter?t.isPaid:!t.isPaid);return t}}},G=U,J=(o("50ae"),Object(d["a"])(G,Y,R,!1,null,"e64fe2e0",null)),V=J.exports,X=o("98cf"),Z=o("4e00");n["default"].use(L["a"]);const Q=[{path:"/noteMenu",name:"NoteMenu",component:V},{path:"/",name:"home",component:M},{path:"/sale-note/:noteId?",name:"SaleNote",component:()=>Promise.resolve().then(o.bind(null,"98cf"))},{path:"/add-client",name:"AddClient",component:Z["a"]},{path:"/editar-nota/:noteId",name:"editar-nota",component:X["default"],props:!0}],W=new L["a"]({routes:Q});var tt=W,et=o("5f5b"),ot=o("b1e0");o("f9e3"),o("2dd8");n["default"].use(et["a"]),n["default"].use(ot["a"]),n["default"].config.productionTip=!1,new n["default"]({router:tt,render:t=>t(B)}).$mount("#app")},"5da0":function(t,e,o){},"5df8":function(t,e,o){"use strict";o("399e")},"74c9":function(t,e,o){"use strict";var n=function(){var t=this,e=t._self._c;return e("router-link",{staticClass:"btn-back",attrs:{to:t.to}},[t._v("Atrás")])},r=[],a={props:{to:{type:String,required:!0}}},i=a,s=(o("e0fe"),o("2877")),c=Object(s["a"])(i,n,r,!1,null,null,null);e["a"]=c.exports},"7aa3":function(t,e,o){},"836e":function(t,e,o){},"8a87":function(t,e,o){"use strict";o("5da0")},"98cf":function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"sale-note"},[e("div",{staticClass:"back-button-container"},[e("BackButton",{attrs:{to:"/NoteMenu"}})],1),e("h2",[t._v("Nota de Venta")]),e("div",{staticClass:"folio-date"},[e("p",[e("strong",[t._v("Folio:")]),t._v(" "+t._s(t.formattedFolio))]),e("p",[e("strong",[t._v("Fecha de Creación:")]),t._v(" "+t._s(t.formattedCreationDate))])]),e("form",{on:{submit:function(e){return e.preventDefault(),t.addProduct.apply(null,arguments)}}},[e("div",{staticClass:"form-row"},[e("div",[e("label",{attrs:{for:"client"}},[t._v("Cliente:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.client,expression:"client"}],attrs:{required:""},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.client=e.target.multiple?o:o[0]}}},t._l(t.clients,(function(o){return e("option",{key:o.id,domProps:{value:o.name}},[t._v(" "+t._s(o.name)+" ")])})),0)]),e("div",[e("label",{attrs:{for:"date"}},[t._v("Fecha:")]),e("DatePicker",{attrs:{"value-type":"format",format:"DD MMMM YYYY",placeholder:"Selecciona una fecha"},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)]),e("div",{staticClass:"form-row"},[e("div",[e("label",{attrs:{for:"product"}},[t._v("Producto:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.newProduct.product,expression:"newProduct.product"}],attrs:{type:"text",id:"product",required:""},domProps:{value:t.newProduct.product},on:{input:function(e){e.target.composing||t.$set(t.newProduct,"product",e.target.value)}}})]),e("div",[e("label",{attrs:{for:"kilos"}},[t._v("Kilos:")]),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.newProduct.kilos,expression:"newProduct.kilos",modifiers:{number:!0}}],attrs:{type:"number",step:"0.01",required:""},domProps:{value:t.newProduct.kilos},on:{input:function(e){e.target.composing||t.$set(t.newProduct,"kilos",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),e("div",[e("label",{attrs:{for:"pricePerKilo"}},[t._v("Precio por Kilo:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.newProduct.pricePerKilo,expression:"newProduct.pricePerKilo"}],attrs:{type:"number",id:"pricePerKilo",required:""},domProps:{value:t.newProduct.pricePerKilo},on:{input:function(e){e.target.composing||t.$set(t.newProduct,"pricePerKilo",e.target.value)}}})]),e("button",{attrs:{type:"submit"}},[t._v("Agregar Producto")])])]),t.products.length||t.abonos.length?e("div",[e("div",{ref:"printSection",staticClass:"print-section"},[e("div",{staticClass:"folio-date"},[e("p",[e("strong",[t._v("Folio:")]),t._v(" "+t._s(t.formattedFolio))]),e("p",[e("strong",[t._v("Fecha de Creación:")]),t._v(" "+t._s(t.formattedCreationDate))])]),t.products.length?e("div",[e("h3",[t._v("Resumen")]),e("table",[t._m(0),e("tbody",t._l(t.products,(function(o,n){return e("tr",{key:n},[t.editIndex===n?[e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.editProduct.product,expression:"editProduct.product"}],attrs:{type:"text"},domProps:{value:t.editProduct.product},on:{input:function(e){e.target.composing||t.$set(t.editProduct,"product",e.target.value)}}})]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.editProduct.kilos,expression:"editProduct.kilos",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.editProduct.kilos},on:{input:function(e){e.target.composing||t.$set(t.editProduct,"kilos",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.editProduct.pricePerKilo,expression:"editProduct.pricePerKilo",modifiers:{number:!0}}],attrs:{type:"number"},domProps:{value:t.editProduct.pricePerKilo},on:{input:function(e){e.target.composing||t.$set(t.editProduct,"pricePerKilo",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),e("td",[t._v("$"+t._s(t.formatNumber(t.editProduct.kilos*t.editProduct.pricePerKilo)))]),e("td",[e("button",{on:{click:t.confirmEdit}},[e("span",[t._v("✔")])]),e("button",{on:{click:t.cancelEdit}},[e("span",[t._v("❌")])])])]:[e("td",[t._v(t._s(o.product))]),e("td",[t._v(t._s(t.formatNumber(o.kilos)))]),e("td",[t._v("$"+t._s(t.formatNumber(o.pricePerKilo)))]),e("td",[t._v("$"+t._s(t.formatNumber(o.total)))]),e("td",[e("button",{on:{click:function(e){return t.editProductDetails(n)}}},[t._v("Editar")]),e("button",{on:{click:function(e){return t.removeProduct(n)}}},[e("span",[t._v("❌")])])])]],2)})),0)]),e("div",{staticClass:"total-general"},[e("h3",[t._v("Total General: $"+t._s(t.formatNumber(t.grandTotal)))])])]):t._e(),e("div",{staticClass:"abonos-container"},[e("div",{staticClass:"abonos-section"},[e("h3",[t._v("Registrar Abonos")]),e("form",{on:{submit:function(e){return e.preventDefault(),t.addAbono.apply(null,arguments)}}},[e("div",{staticClass:"form-row"},[e("div",[e("label",{attrs:{for:"abonoMonto"}},[t._v("Monto del Abono:")]),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.newAbono.monto,expression:"newAbono.monto",modifiers:{number:!0}}],attrs:{type:"number",id:"abonoMonto",required:""},domProps:{value:t.newAbono.monto},on:{input:function(e){e.target.composing||t.$set(t.newAbono,"monto",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),e("div",[e("label",{attrs:{for:"abonoFecha"}},[t._v("Fecha del Abono:")]),e("DatePicker",{attrs:{"value-type":"format",format:"DD MMMM YYYY",placeholder:"Selecciona una fecha"},model:{value:t.newAbono.fecha,callback:function(e){t.$set(t.newAbono,"fecha",e)},expression:"newAbono.fecha"}})],1),e("button",{attrs:{type:"submit"}},[t._v("Agregar Abono")])])]),t.abonos.length?e("div",[e("h3",[t._v("Abonos Realizados")]),e("table",[t._m(1),e("tbody",t._l(t.abonos,(function(o,n){return e("tr",{key:n},[e("td",[t._v("$"+t._s(t.formatNumber(o.monto)))]),e("td",[t._v(t._s(o.fecha))])])})),0)]),e("h3",[t._v("Total Abonado: $"+t._s(t.formatNumber(t.totalAbonado)))]),e("h3",[t._v("Saldo Restante: $"+t._s(t.formatNumber(t.saldoRestante)))]),t.isPaid?e("h3",{staticClass:"paid-status"},[t._v("Estado: Pagada")]):e("h3",{staticClass:"unpaid-status"},[t._v("Estado: No Pagada")])]):t._e()])])]),e("button",{on:{click:t.exportPDF}},[t._v("Exportar a PDF")]),e("button",{on:{click:t.printSection}},[t._v("Imprimir")]),e("button",{on:{click:t.saveNote}},[t._v("Guardar Nota")]),e("button",{staticClass:"delete-note-button",on:{click:t.deleteNote}},[t._v("Eliminar Nota")])]):t._e()])},r=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",[t._v("Producto")]),e("th",[t._v("Kilos")]),e("th",[t._v("Precio por Kilo")]),e("th",[t._v("Total")]),e("th",[t._v("Acciones")])])])},function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",[t._v("Monto")]),e("th",[t._v("Fecha")])])])}],a=(o("14d9"),o("13d5"),o("74c9")),i=o("ec45"),s=(o("411c"),o("d67e")),c=o.n(s),l=o("4e00"),d=o("dc59"),u=o("1494"),p={components:{DatePicker:i["a"],AddClient:l["a"],BackButton:a["a"]},data(){const t=new Date;return{folio:Math.floor(1e4*Math.random()),client:"",currentDate:t.toISOString().substr(0,10),newProduct:{product:"",kilos:null,pricePerKilo:null,total:0},editProduct:{product:"",kilos:0,pricePerKilo:0,total:0},products:[],clients:[],editIndex:-1,newAbono:{monto:null,fecha:t.toISOString().substr(0,10)},abonos:[],isPaid:!1,creationDate:t.toISOString().substr(0,10)}},computed:{grandTotal(){return this.products.reduce((t,e)=>t+e.total,0)},totalAbonado(){return this.abonos.reduce((t,e)=>t+Number(e.monto),0)},saldoRestante(){return this.grandTotal-this.totalAbonado},formattedFolio(){return"F-"+this.folio.toString().padStart(4,"0")},formattedCreationDate(){return this.formatDate(this.creationDate)}},watch:{saldoRestante(t){this.isPaid=t<=0}},methods:{async deleteNote(){if(this.noteId){if(confirm("¿Estás seguro de que quieres eliminar esta nota?"))try{await Object(u["c"])(Object(u["d"])(d["a"],"notes",this.noteId)),alert("Nota eliminada con éxito"),this.$router.push({name:"NoteMenu"})}catch(t){console.error("Error al eliminar la nota: ",t),alert("Error al eliminar la nota: "+t.message)}}else alert("El ID de la nota no está definido")},async saveNote(){try{const t={folio:this.folio,client:this.client,currentDate:this.currentDate,products:this.products,abonos:this.abonos,isPaid:this.isPaid,creationDate:this.creationDate};if(this.noteId)await Object(u["h"])(Object(u["d"])(d["a"],"notes",this.noteId),t);else{const e=await Object(u["a"])(Object(u["b"])(d["a"],"notes"),t);this.noteId=e.id}alert("Nota guardada exitosamente."),this.$router.push({name:"NoteMenu"})}catch(t){console.error("Error saving note: ",t),alert("Hubo un error al guardar la nota.")}},async addProduct(){this.newProduct.total=this.newProduct.kilos*this.newProduct.pricePerKilo,this.products.push({...this.newProduct}),this.resetForm()},resetForm(){this.newProduct={product:"",kilos:null,pricePerKilo:null,total:0}},removeProduct(t){this.products.splice(t,1)},editProductDetails(t){this.editIndex=t,this.editProduct={...this.products[t]}},confirmEdit(){this.editProduct.total=this.editProduct.kilos*this.editProduct.pricePerKilo,this.products[this.editIndex]={...this.editProduct},this.editIndex=-1},cancelEdit(){this.editIndex=-1},async fetchClients(){try{const t=await Object(u["f"])(Object(u["b"])(d["a"],"clients"));this.clients=t.docs.map(t=>({id:t.id,...t.data()}))}catch(t){console.error("Error fetching clients: ",t)}},async fetchNoteData(){try{const t=Object(u["d"])(d["a"],"notes",this.noteId),e=await Object(u["e"])(t);if(e.exists()){const t=e.data();this.folio=t.folio,this.client=t.client,this.currentDate=t.currentDate,this.products=t.products,this.abonos=t.abonos,this.isPaid=t.isPaid,this.creationDate=t.creationDate}else console.log("No such document!")}catch(t){console.error("Error fetching note: ",t)}},addAbono(){this.abonos.push({...this.newAbono}),this.resetAbonoForm()},resetAbonoForm(){this.newAbono={monto:null,fecha:(new Date).toISOString().substr(0,10)}},formatNumber(t){return t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},formatDate(t){const e={year:"numeric",month:"long",day:"numeric"};return new Date(t).toLocaleDateString("es-ES",e)},exportPDF(){const t=this.$refs.printSection,e={margin:.5,filename:`Nota_de_Venta_${this.formattedFolio}_${(new Date).toLocaleDateString()}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"in",format:"letter",orientation:"portrait"}},o=t.cloneNode(!0),n=o.querySelectorAll("button");n.forEach(t=>t.style.display="none");const r=o.querySelectorAll("td:nth-child(5), th:nth-child(5)");r.forEach(t=>t.style.display="none");const a=o.querySelector(".abonos-section form");a&&(a.style.display="none");const i=o.querySelector(".abonos-section h3:first-child");i&&(i.style.display="none"),c()().from(o).set(e).save()},printSection(){const t=this.$refs.printSection.cloneNode(!0),e=t.querySelectorAll("button");e.forEach(t=>t.style.display="none");const o=t.querySelectorAll("td:nth-child(5), th:nth-child(5)");o.forEach(t=>t.style.display="none");const n=t.querySelector(".abonos-section form");n&&(n.style.display="none");const r=t.querySelector(".abonos-section h3:first-child");r&&(r.style.display="none");const a=window.open("","","width=800,height=600");a.document.write("<html><head><title>Nota de Venta</title>"),a.document.write("</head><body >"),a.document.write(t.innerHTML),a.document.write("</body></html>"),a.document.close(),a.print()}},async mounted(){this.fetchClients(),this.$route.params.noteId&&(this.noteId=this.$route.params.noteId,await this.fetchNoteData())}},m=p,f=(o("f182"),o("2877")),h=Object(f["a"])(m,n,r,!1,null,"25ba24fe",null);e["default"]=h.exports},ab85:function(t,e,o){"use strict";o("fd45")},b857:function(t,e,o){},dc59:function(t,e,o){"use strict";o.d(e,"a",(function(){return s}));var n=o("bc7b"),r=o("1494");const a={apiKey:"AIzaSyDEXrriJ15Gg2IyPYh56gNktfGaSsP6KeE",authDomain:"reypezapp-1ced2.firebaseapp.com",projectId:"reypezapp-1ced2",storageBucket:"reypezapp-1ced2.appspot.com",messagingSenderId:"512757841511",appId:"1:512757841511:web:d15e6a6276e84c42959ec2"},i=Object(n["a"])(a),s=Object(r["g"])(i)},e0fe:function(t,e,o){"use strict";o("5355")},f182:function(t,e,o){"use strict";o("836e")},f75f:function(t,e,o){},fd45:function(t,e,o){}});
//# sourceMappingURL=app.7c5c847d.js.map