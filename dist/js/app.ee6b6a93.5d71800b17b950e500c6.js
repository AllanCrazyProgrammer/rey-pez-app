(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app.ee6b6a93"],{"320e":function(a,t,e){"use strict";var o=function(){var a=this,t=a._self._c;return t("div",{staticClass:"embarques-menu"},[t("h1",[a._v("Menú de Embarques")]),t("div",{staticClass:"menu-options"},[t("button",{staticClass:"btn-nuevo-embarque",on:{click:a.nuevoEmbarque}},[a._v("Nuevo Embarque")]),t("button",{staticClass:"btn-fletes",on:{click:a.mostrarFletes}},[a._v("Fletes")]),t("button",{staticClass:"btn-cuenta-fletes",on:{click:a.verCuentaFletes}},[a._v("Cuenta de Fletes")])]),t("ListaEmbarques"),a.modalFletesVisible?t("div",{staticClass:"modal-fletes",on:{click:a.cerrarModalFletes}},[t("div",{staticClass:"modal-contenido",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h2",[a._v("Fletes de Joselito")]),t("button",{staticClass:"btn-cerrar",on:{click:a.cerrarModalFletes}},[a._v("×")])]),t("div",{staticClass:"modal-body"},[a.cargandoFletes?t("div",{staticClass:"cargando"},[a._v("Cargando fletes...")]):0===a.fletes.length?t("div",{staticClass:"sin-fletes"},[a._v("No hay fletes registrados.")]):t("div",{staticClass:"tabla-fletes-container"},[t("table",{staticClass:"tabla-fletes"},[a._m(0),t("tbody",a._l(a.fletes,(function(e){return t("tr",{key:e.fecha},[t("td",[a._v(a._s(a.formatearFecha(e.fecha)))]),t("td",[a._v(a._s(e.tarasLimpio))]),t("td",[a._v(a._s(e.tarasCrudo))]),t("td",[a._v(a._s(e.tarasLimpio+e.tarasCrudo))]),t("td",[a._v(a._s(e.cargaCon))])])})),0)])])])])]):a._e()],1)},s=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Fecha")]),t("th",[a._v("Taras Limpio")]),t("th",[a._v("Taras Crudo")]),t("th",[a._v("Total Taras")]),t("th",[a._v("Cargó")])])])}],n=(e("14d9"),e("13d5"),e("b34e")),r=e("1494"),i={name:"EmbarquesMenu",components:{ListaEmbarques:n["a"]},data(){return{modalFletesVisible:!1,fletes:[],cargandoFletes:!1}},methods:{nuevoEmbarque(){this.$router.push({name:"NuevoEmbarque",params:{id:"nuevo"}})},mostrarFletes(){this.modalFletesVisible=!0,this.cargarFletes()},verCuentaFletes(){this.$router.push({name:"CuentaFletes"})},cerrarModalFletes(){this.modalFletesVisible=!1},async cargarFletes(){this.cargandoFletes=!0;try{const a=Object(r["h"])(),t=Object(r["c"])(a,"embarques"),e=await Object(r["g"])(t),o=e.docs.map(a=>{var t;const e=a.data();let o=e.fecha.toDate?e.fecha.toDate():new Date(e.fecha);const s=null===(t=e.clientes)||void 0===t?void 0:t.find(a=>"1"===a.id||1===a.id||"Joselito"===a.nombre);if(s){let a=0,t=0;return s.productos&&Array.isArray(s.productos)&&(a=s.productos.reduce((a,t)=>{let e=0;return Array.isArray(t.taras)&&(e+=t.taras.reduce((a,t)=>a+(parseInt(t)||0),0)),Array.isArray(t.tarasExtra)&&(e+=t.tarasExtra.reduce((a,t)=>a+(parseInt(t)||0),0)),a+e},0)),s.crudos&&Array.isArray(s.crudos)&&(t=s.crudos.reduce((a,t)=>t&&t.items&&Array.isArray(t.items)?a+t.items.reduce((a,t)=>{let e=0;if(t.taras){const[a]=t.taras.split("-");e+=parseInt(a)||0}if(t.sobrante){const[a]=t.sobrante.split("-");e+=parseInt(a)||0}return a+e},0):a,0)),{fecha:o,tarasLimpio:a,tarasCrudo:t,cargaCon:e.cargaCon||"No especificado"}}return null}).filter(a=>null!==a).sort((a,t)=>t.fecha-a.fecha);console.log("Fletes procesados:",o),this.fletes=o}catch(a){console.error("Error al cargar los fletes:",a)}finally{this.cargandoFletes=!1}},formatearFecha(a){const t=new Date(a);return t.setDate(t.getDate()+1),t.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})}}},l=i,d=(e("43c8"),e("2877")),c=Object(d["a"])(l,o,s,!1,null,"797699fc",null);t["a"]=c.exports},"3b6d":function(a,t,e){},"43c8":function(a,t,e){"use strict";e("3b6d")},"4a2e":function(a,t,e){},"784b":function(a,t,e){"use strict";e("4a2e")},"9aeb":function(a,t,e){"use strict";var o=function(){var a=this,t=a._self._c;return t("div",{staticClass:"cuenta-fletes"},[t("div",{staticClass:"header-section"},[t("button",{staticClass:"btn-volver",on:{click:a.volverMenu}},[a._v(" ← Volver al Menú ")]),t("h2",[a._v("Cuenta de Fletes")])]),t("div",{staticClass:"chofer-selector"},[t("button",{class:["btn-chofer",{active:"Caminante"===a.choferSeleccionado}],on:{click:function(t){a.choferSeleccionado="Caminante"}}},[a._v(" Caminante ")]),t("button",{class:["btn-chofer",{active:"Porro"===a.choferSeleccionado}],on:{click:function(t){a.choferSeleccionado="Porro"}}},[a._v(" Porro ")]),t("button",{staticClass:"btn-imprimir",on:{click:a.generarPDF}},[a._v(" Imprimir Cuenta Pendiente ")])]),t("div",{staticClass:"abonos-section"},[t("h3",[a._v("Registrar Abono")]),t("div",{staticClass:"abono-inputs"},[t("div",{staticClass:"input-group"},[t("label",[a._v("Monto del Abono:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.nuevoAbono.monto,expression:"nuevoAbono.monto"}],staticClass:"input-abono",attrs:{type:"number",placeholder:"Cantidad"},domProps:{value:a.nuevoAbono.monto},on:{input:function(t){t.target.composing||a.$set(a.nuevoAbono,"monto",t.target.value)}}})]),t("div",{staticClass:"input-group"},[t("label",[a._v("Fecha del Abono:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.nuevoAbono.fecha,expression:"nuevoAbono.fecha"}],staticClass:"input-fecha",attrs:{type:"date"},domProps:{value:a.nuevoAbono.fecha},on:{input:function(t){t.target.composing||a.$set(a.nuevoAbono,"fecha",t.target.value)}}})]),t("div",{staticClass:"input-group"},[t("label",[a._v("Descripción:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.nuevoAbono.descripcion,expression:"nuevoAbono.descripcion"}],staticClass:"input-descripcion",attrs:{type:"text",placeholder:"Descripción del abono"},domProps:{value:a.nuevoAbono.descripcion},on:{input:function(t){t.target.composing||a.$set(a.nuevoAbono,"descripcion",t.target.value)}}})]),t("button",{staticClass:"btn-agregar-abono",attrs:{disabled:!a.nuevoAbono.monto||!a.nuevoAbono.fecha},on:{click:a.agregarAbono}},[a._v(" Agregar Abono ")])])]),t("div",{staticClass:"tabla-container"},[t("div",{staticClass:"tabla-desktop"},[t("table",{staticClass:"tabla-fletes"},[a._m(0),t("tbody",[a._l(a.itemsOrdenados,(function(e,o){return[t("tr",{key:e.id,class:{"fila-abono":"abono"===e.tipo}},[t("td",[a._v(a._s(a.formatearFecha(e.fecha)))]),t("td",[a._v(a._s("abono"===e.tipo?"Abono":"Flete"))]),t("td",[a._v(a._s("abono"===e.tipo?"-":e.tarasLimpioJoselito))]),t("td",[a._v(a._s("abono"===e.tipo?"-":e.tarasCrudoJoselito))]),t("td",[a._v(a._s("abono"===e.tipo?"-":e.tarasLimpioCanelo))]),t("td",[a._v(a._s("abono"===e.tipo?"-":e.tarasCrudoCanelo))]),t("td",[a._v(a._s("abono"===e.tipo?"-":e.tarasLimpioJoselito+e.tarasCrudoJoselito+e.tarasLimpioCanelo+e.tarasCrudoCanelo))]),t("td",[a._v(a._s("abono"===e.tipo?a.formatearMonto(-e.monto):a.formatearMonto(a.calcularMontoDia(e))))]),t("td",[a._v(a._s(a.formatearMonto(a.calcularDeudaAcumulada(o))))]),t("td",["flete"===e.tipo?t("span",{class:["estado",e.pagado?"pagado":"pendiente"]},[a._v(" "+a._s(e.pagado?"Pagado":"Pendiente")+" ")]):t("span",{staticClass:"estado abono"},[a._v("Abono")])]),t("td",["flete"===e.tipo?t("button",{class:["btn-pago",e.pagado?"btn-marcar-pendiente":"btn-marcar-pagado"],on:{click:function(t){return a.togglePago(e)}}},[a._v(" "+a._s(e.pagado?"Marcar Pendiente":"Marcar Pagado")+" ")]):t("button",{staticClass:"btn-eliminar-abono",on:{click:function(t){return a.eliminarAbono(e)}}},[a._v(" Eliminar Abono ")])])])]}))],2)])]),t("div",{staticClass:"tabla-mobile"},a._l(a.itemsOrdenados,(function(e,o){return t("div",{key:e.id,staticClass:"flete-card",class:{pagado:e.pagado,abono:"abono"===e.tipo}},[t("div",{staticClass:"flete-header"},[t("span",{staticClass:"fecha"},[a._v(a._s(a.formatearFecha(e.fecha)))]),"flete"===e.tipo?t("span",{class:["estado",e.pagado?"pagado":"pendiente"]},[a._v(" "+a._s(e.pagado?"Pagado":"Pendiente")+" ")]):t("span",{staticClass:"estado abono"},[a._v("Abono")])]),t("div",{staticClass:"flete-body"},[t("div",{staticClass:"flete-row"},[t("span",{staticClass:"label"},[a._v("Tipo:")]),t("span",{staticClass:"value"},[a._v(a._s("abono"===e.tipo?"Abono":"Flete"))])]),"flete"===e.tipo?[t("div",{staticClass:"cliente-section"},[t("h4",{staticClass:"cliente-title"},[a._v("Joselito")]),t("div",{staticClass:"flete-row"},[t("span",{staticClass:"label"},[a._v("Taras Limpio:")]),t("span",{staticClass:"value"},[a._v(a._s(e.tarasLimpioJoselito))])]),t("div",{staticClass:"flete-row"},[t("span",{staticClass:"label"},[a._v("Taras Crudo:")]),t("span",{staticClass:"value"},[a._v(a._s(e.tarasCrudoJoselito))])]),t("div",{staticClass:"flete-row"},[t("span",{staticClass:"label"},[a._v("Subtotal Taras:")]),t("span",{staticClass:"value"},[a._v(a._s(e.tarasLimpioJoselito+e.tarasCrudoJoselito))])])]),t("div",{staticClass:"cliente-section"},[t("h4",{staticClass:"cliente-title"},[a._v("Canelo")]),t("div",{staticClass:"flete-row"},[t("span",{staticClass:"label"},[a._v("Taras Limpio:")]),t("span",{staticClass:"value"},[a._v(a._s(e.tarasLimpioCanelo))])]),t("div",{staticClass:"flete-row"},[t("span",{staticClass:"label"},[a._v("Taras Crudo:")]),t("span",{staticClass:"value"},[a._v(a._s(e.tarasCrudoCanelo))])]),t("div",{staticClass:"flete-row"},[t("span",{staticClass:"label"},[a._v("Subtotal Taras:")]),t("span",{staticClass:"value"},[a._v(a._s(e.tarasLimpioCanelo+e.tarasCrudoCanelo))])])]),t("div",{staticClass:"flete-row total-row"},[t("span",{staticClass:"label"},[a._v("Total Taras:")]),t("span",{staticClass:"value"},[a._v(a._s(e.tarasLimpioJoselito+e.tarasCrudoJoselito+e.tarasLimpioCanelo+e.tarasCrudoCanelo))])])]:a._e(),t("div",{staticClass:"flete-row"},[t("span",{staticClass:"label"},[a._v(a._s("abono"===e.tipo?"Monto Abonado:":"Monto del Día:"))]),t("span",{staticClass:"value"},[a._v(a._s("abono"===e.tipo?a.formatearMonto(-e.monto):a.formatearMonto(a.calcularMontoDia(e))))])]),t("div",{staticClass:"flete-row"},[t("span",{staticClass:"label"},[a._v("Deuda Acumulada:")]),t("span",{staticClass:"value"},[a._v(a._s(a.formatearMonto(a.calcularDeudaAcumulada(o))))])])],2),t("div",{staticClass:"flete-footer"},["flete"===e.tipo?t("button",{class:["btn-pago",e.pagado?"btn-marcar-pendiente":"btn-marcar-pagado"],on:{click:function(t){return a.togglePago(e)}}},[a._v(" "+a._s(e.pagado?"Marcar Pendiente":"Marcar Pagado")+" ")]):t("button",{staticClass:"btn-eliminar-abono",on:{click:function(t){return a.eliminarAbono(e)}}},[a._v(" Eliminar Abono ")])])])})),0)]),t("div",{staticClass:"resumen"},[t("h3",[a._v("Resumen de Cuenta")]),t("div",{staticClass:"resumen-detalles"},[t("div",{staticClass:"resumen-cliente"},[t("h4",[a._v("Cliente Joselito")]),t("div",{staticClass:"resumen-grid"},[t("div",{staticClass:"resumen-card"},[t("span",{staticClass:"resumen-label"},[a._v("Taras Limpio:")]),t("span",{staticClass:"resumen-value"},[a._v(a._s(a.totalTarasLimpioJoselito))])]),t("div",{staticClass:"resumen-card"},[t("span",{staticClass:"resumen-label"},[a._v("Taras Crudo:")]),t("span",{staticClass:"resumen-value"},[a._v(a._s(a.totalTarasCrudoJoselito))])]),t("div",{staticClass:"resumen-card"},[t("span",{staticClass:"resumen-label"},[a._v("Total:")]),t("span",{staticClass:"resumen-value"},[a._v(a._s(a.totalTarasLimpioJoselito+a.totalTarasCrudoJoselito))])])])]),t("div",{staticClass:"resumen-cliente"},[t("h4",[a._v("Cliente Canelo")]),t("div",{staticClass:"resumen-grid"},[t("div",{staticClass:"resumen-card"},[t("span",{staticClass:"resumen-label"},[a._v("Taras Limpio:")]),t("span",{staticClass:"resumen-value"},[a._v(a._s(a.totalTarasLimpioCanelo))])]),t("div",{staticClass:"resumen-card"},[t("span",{staticClass:"resumen-label"},[a._v("Taras Crudo:")]),t("span",{staticClass:"resumen-value"},[a._v(a._s(a.totalTarasCrudoCanelo))])]),t("div",{staticClass:"resumen-card"},[t("span",{staticClass:"resumen-label"},[a._v("Total:")]),t("span",{staticClass:"resumen-value"},[a._v(a._s(a.totalTarasLimpioCanelo+a.totalTarasCrudoCanelo))])])])]),t("div",{staticClass:"resumen-totales"},[t("h4",[a._v("Totales Generales")]),t("div",{staticClass:"resumen-grid"},[t("div",{staticClass:"resumen-card"},[t("span",{staticClass:"resumen-label"},[a._v("Deuda Total:")]),t("span",{staticClass:"resumen-value"},[a._v(a._s(a.formatearMonto(a.deudaTotal)))])]),t("div",{staticClass:"resumen-card"},[t("span",{staticClass:"resumen-label"},[a._v("Monto Pagado:")]),t("span",{staticClass:"resumen-value"},[a._v(a._s(a.formatearMonto(a.montoPagado)))])]),t("div",{staticClass:"resumen-card saldo-pendiente"},[t("span",{staticClass:"resumen-label"},[a._v("Saldo Pendiente:")]),t("span",{staticClass:"resumen-value"},[a._v(a._s(a.formatearMonto(a.saldoPendiente)))])])])])])])])},s=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Fecha")]),t("th",[a._v("Tipo")]),t("th",{attrs:{colspan:"2"}},[a._v("Joselito")]),t("th",{attrs:{colspan:"2"}},[a._v("Canelo")]),t("th",[a._v("Total Taras")]),t("th",[a._v("Monto del Día")]),t("th",[a._v("Deuda Acumulada")]),t("th",[a._v("Estado")]),t("th",[a._v("Acciones")])]),t("tr",[t("th"),t("th"),t("th",[a._v("Limpio")]),t("th",[a._v("Crudo")]),t("th",[a._v("Limpio")]),t("th",[a._v("Crudo")]),t("th"),t("th"),t("th"),t("th"),t("th")])])}],n=(e("14d9"),e("13d5"),e("1494")),r=e("d67e"),i=e.n(r),l={name:"CuentaFletes",data(){return{fletes:[],abonos:[],choferSeleccionado:"Caminante",costoTaraLimpio:70,costoTaraCrudo:60,cargando:!1,imprimiendo:!1,nuevoAbono:{monto:null,fecha:(new Date).toISOString().split("T")[0],descripcion:""}}},computed:{fletesFiltrados(){return this.fletes.filter(a=>{var t;return null===(t=a.cargaCon)||void 0===t?void 0:t.toLowerCase().includes(this.choferSeleccionado.toLowerCase())})},abonosFiltrados(){return this.abonos.filter(a=>a.chofer.toLowerCase()===this.choferSeleccionado.toLowerCase())},itemsOrdenados(){const a=[...this.fletesFiltrados.map(a=>({...a,tipo:"flete"})),...this.abonosFiltrados.map(a=>({...a,tipo:"abono"}))];return a.sort((a,t)=>t.fecha-a.fecha)},totalTarasLimpio(){return this.fletesFiltrados.reduce((a,t)=>a+(t.tarasLimpioJoselito+t.tarasLimpioCanelo),0)},totalTarasCrudo(){return this.fletesFiltrados.reduce((a,t)=>a+(t.tarasCrudoJoselito+t.tarasCrudoCanelo),0)},totalTarasLimpioJoselito(){return this.fletesFiltrados.reduce((a,t)=>a+t.tarasLimpioJoselito,0)},totalTarasCrudoJoselito(){return this.fletesFiltrados.reduce((a,t)=>a+t.tarasCrudoJoselito,0)},totalTarasLimpioCanelo(){return this.fletesFiltrados.reduce((a,t)=>a+t.tarasLimpioCanelo,0)},totalTarasCrudoCanelo(){return this.fletesFiltrados.reduce((a,t)=>a+t.tarasCrudoCanelo,0)},deudaTotal(){return this.fletesFiltrados.reduce((a,t)=>a+this.calcularMontoDia(t),0)},montoPagado(){return this.fletesFiltrados.reduce((a,t)=>a+(t.pagado?this.calcularMontoDia(t):0),0)},saldoPendiente(){return this.deudaTotal-this.montoPagado},fletesPendientes(){return this.fletesFiltrados.filter(a=>!a.pagado)}},methods:{async cargarFletes(){this.cargando=!0;try{const a=Object(n["h"])(),t=Object(n["c"])(a,"embarques"),e=await Object(n["g"])(t),o=e.docs.map(a=>{var t,e;const o=a.data();let s=o.fecha.toDate?o.fecha.toDate():new Date(o.fecha);const n=null===(t=o.clientes)||void 0===t?void 0:t.find(a=>"1"===a.id||1===a.id||"Joselito"===a.nombre),r=null===(e=o.clientes)||void 0===e?void 0:e.find(a=>"5"===a.id||5===a.id||"Canelo"===a.nombre);let i=0,l=0,d=0,c=0;return n&&(n.productos&&Array.isArray(n.productos)&&(i=n.productos.reduce((a,t)=>{let e=0;return Array.isArray(t.taras)&&(e+=t.taras.reduce((a,t)=>a+(parseInt(t)||0),0)),Array.isArray(t.tarasExtra)&&(e+=t.tarasExtra.reduce((a,t)=>a+(parseInt(t)||0),0)),a+e},0)),n.crudos&&Array.isArray(n.crudos)&&(l=n.crudos.reduce((a,t)=>Array.isArray(t.items)?a+t.items.reduce((a,t)=>{let e=0;if(t.taras){const[a]=t.taras.split("-");e+=parseInt(a)||0}if(t.sobrante){const[a]=t.sobrante.split("-");e+=parseInt(a)||0}return a+e},0):a,0))),r&&(r.productos&&Array.isArray(r.productos)&&(d=r.productos.reduce((a,t)=>{let e=0;return Array.isArray(t.taras)&&(e+=t.taras.reduce((a,t)=>a+(parseInt(t)||0),0)),Array.isArray(t.tarasExtra)&&(e+=t.tarasExtra.reduce((a,t)=>a+(parseInt(t)||0),0)),a+e},0)),r.crudos&&Array.isArray(r.crudos)&&(c=r.crudos.reduce((a,t)=>Array.isArray(t.items)?a+t.items.reduce((a,t)=>{let e=0;if(t.taras){const[a]=t.taras.split("-");e+=parseInt(a)||0}if(t.sobrante){const[a]=t.sobrante.split("-");e+=parseInt(a)||0}return a+e},0):a,0))),n||r?{id:a.id,fecha:s,tarasLimpioJoselito:i,tarasCrudoJoselito:l,tarasLimpioCanelo:d,tarasCrudoCanelo:c,tarasLimpio:i+d,tarasCrudo:l+c,cargaCon:o.cargaCon||"No especificado",pagado:o.fletePagado||!1}:null}).filter(a=>null!==a).sort((a,t)=>t.fecha-a.fecha);this.fletes=o;const s=Object(n["c"])(a,"abonos"),r=await Object(n["g"])(s);this.abonos=r.docs.map(a=>({id:a.id,...a.data(),fecha:a.data().fecha.toDate()}))}catch(a){console.error("Error al cargar los datos:",a)}finally{this.cargando=!1}},formatearFecha(a){const t=new Date(a);return t.setDate(t.getDate()+1),t.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})},formatearMonto(a){return new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(a)},calcularMontoDia(a){return(a.tarasLimpioJoselito+a.tarasLimpioCanelo)*this.costoTaraLimpio+(a.tarasCrudoJoselito+a.tarasCrudoCanelo)*this.costoTaraCrudo},calcularDeudaAcumulada(a){const t=[...this.itemsOrdenados].sort((a,t)=>a.fecha-t.fecha),e=this.itemsOrdenados[a];return t.filter(a=>a.fecha<=e.fecha).reduce((a,t)=>{if("abono"===t.tipo)return a-t.monto;{const e=this.calcularMontoDia(t);return a+(t.pagado?0:e)}},0)},async togglePago(a){try{const t=Object(n["h"])(),e=Object(n["e"])(t,"embarques",a.id);await Object(n["r"])(e,{fletePagado:!a.pagado});const o=this.fletes.find(t=>t.id===a.id);o&&(o.pagado=!o.pagado)}catch(t){console.error("Error al actualizar el estado de pago:",t),alert("Error al actualizar el estado de pago. Por favor, intente de nuevo.")}},async agregarAbono(){if(this.nuevoAbono.monto&&this.nuevoAbono.fecha)try{const a=Object(n["h"])(),t=Object(n["c"])(a,"abonos"),e={monto:Number(this.nuevoAbono.monto),fecha:new Date(this.nuevoAbono.fecha),chofer:this.choferSeleccionado,descripcion:this.nuevoAbono.descripcion||"Abono realizado",createdAt:new Date},o=await Object(n["b"])(t,e);this.abonos.push({id:o.id,...e}),this.nuevoAbono={monto:null,fecha:(new Date).toISOString().split("T")[0],descripcion:""},alert("Abono registrado correctamente")}catch(a){console.error("Error al agregar el abono:",a),alert("Error al registrar el abono")}else alert("Por favor complete todos los campos del abono")},async eliminarAbono(a){if(confirm("¿Está seguro de eliminar este abono?"))try{const t=Object(n["h"])();await Object(n["d"])(Object(n["e"])(t,"abonos",a.id)),this.abonos=this.abonos.filter(t=>t.id!==a.id),alert("Abono eliminado correctamente")}catch(t){console.error("Error al eliminar el abono:",t),alert("Error al eliminar el abono")}},async generarPDF(){this.imprimiendo=!0;const a=document.createElement("div");a.innerHTML=`\n        <div class="pdf-container">\n          <h2>Cuenta de Fletes - ${this.choferSeleccionado}</h2>\n          <p class="fecha-impresion">Fecha de impresión: ${(new Date).toLocaleDateString("es-ES")}</p>\n          \n          \x3c!-- Tabla de Fletes Pendientes --\x3e\n          <h3>Fletes Pendientes</h3>\n          <table class="tabla-pdf">\n            <thead>\n              <tr>\n                <th>Fecha</th>\n                <th colspan="2">Joselito</th>\n                <th colspan="2">Canelo</th>\n                <th>Total Taras</th>\n                <th>Monto</th>\n              </tr>\n              <tr>\n                <th></th>\n                <th>Limpio</th>\n                <th>Crudo</th>\n                <th>Limpio</th>\n                <th>Crudo</th>\n                <th></th>\n                <th></th>\n              </tr>\n            </thead>\n            <tbody>\n              ${this.fletesPendientes.map(a=>`\n                <tr>\n                  <td>${this.formatearFecha(a.fecha)}</td>\n                  <td>${a.tarasLimpioJoselito}</td>\n                  <td>${a.tarasCrudoJoselito}</td>\n                  <td>${a.tarasLimpioCanelo}</td>\n                  <td>${a.tarasCrudoCanelo}</td>\n                  <td>${a.tarasLimpioJoselito+a.tarasCrudoJoselito+a.tarasLimpioCanelo+a.tarasCrudoCanelo}</td>\n                  <td>${this.formatearMonto(this.calcularMontoDia(a))}</td>\n                </tr>\n              `).join("")}\n              <tr class="fila-total">\n                <td><strong>TOTAL</strong></td>\n                <td><strong>${this.fletesPendientes.reduce((a,t)=>a+t.tarasLimpioJoselito,0)}</strong></td>\n                <td><strong>${this.fletesPendientes.reduce((a,t)=>a+t.tarasCrudoJoselito,0)}</strong></td>\n                <td><strong>${this.fletesPendientes.reduce((a,t)=>a+t.tarasLimpioCanelo,0)}</strong></td>\n                <td><strong>${this.fletesPendientes.reduce((a,t)=>a+t.tarasCrudoCanelo,0)}</strong></td>\n                <td><strong>${this.fletesPendientes.reduce((a,t)=>a+t.tarasLimpioJoselito+t.tarasCrudoJoselito+t.tarasLimpioCanelo+t.tarasCrudoCanelo,0)}</strong></td>\n                <td><strong>${this.formatearMonto(this.fletesPendientes.reduce((a,t)=>a+this.calcularMontoDia(t),0))}</strong></td>\n              </tr>\n            </tbody>\n          </table>\n\n          ${this.abonosFiltrados.length>0?`\n            \x3c!-- Tabla de Abonos --\x3e\n            <h3>Abonos Realizados</h3>\n            <table class="tabla-pdf">\n              <thead>\n                <tr>\n                  <th>Fecha</th>\n                  <th colspan="5">Descripción</th>\n                  <th>Monto</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${this.abonosFiltrados.map(a=>`\n                  <tr class="fila-abono">\n                    <td>${this.formatearFecha(a.fecha)}</td>\n                    <td colspan="5">${a.descripcion||"Abono realizado"}</td>\n                    <td>${this.formatearMonto(a.monto)}</td>\n                  </tr>\n                `).join("")}\n                <tr class="fila-total">\n                  <td colspan="6"><strong>TOTAL ABONOS</strong></td>\n                  <td><strong>${this.formatearMonto(this.abonosFiltrados.reduce((a,t)=>a+t.monto,0))}</strong></td>\n                </tr>\n              </tbody>\n            </table>\n          `:""}\n\n          <div class="resumen-pdf">\n            <h3>Resumen de Cuenta</h3>\n            <div class="resumen-grid">\n              <div class="resumen-clientes">\n                <div class="cliente-column">\n                  <h4>Cliente Joselito</h4>\n                  <p><strong>Taras Limpio:</strong> ${this.fletesPendientes.reduce((a,t)=>a+t.tarasLimpioJoselito,0)}</p>\n                  <p><strong>Taras Crudo:</strong> ${this.fletesPendientes.reduce((a,t)=>a+t.tarasCrudoJoselito,0)}</p>\n                  <p><strong>Total Taras Joselito:</strong> ${this.fletesPendientes.reduce((a,t)=>a+t.tarasLimpioJoselito+t.tarasCrudoJoselito,0)}</p>\n                </div>\n                \n                <div class="cliente-column">\n                  <h4>Cliente Canelo</h4>\n                  <p><strong>Taras Limpio:</strong> ${this.fletesPendientes.reduce((a,t)=>a+t.tarasLimpioCanelo,0)}</p>\n                  <p><strong>Taras Crudo:</strong> ${this.fletesPendientes.reduce((a,t)=>a+t.tarasCrudoCanelo,0)}</p>\n                  <p><strong>Total Taras Canelo:</strong> ${this.fletesPendientes.reduce((a,t)=>a+t.tarasLimpioCanelo+t.tarasCrudoCanelo,0)}</p>\n                </div>\n              </div>\n              \n              <h4>Totales Generales</h4>\n              <p><strong>Total Taras Limpio:</strong> ${this.fletesPendientes.reduce((a,t)=>a+t.tarasLimpioJoselito+t.tarasLimpioCanelo,0)}</p>\n              <p><strong>Total Taras Crudo:</strong> ${this.fletesPendientes.reduce((a,t)=>a+t.tarasCrudoJoselito+t.tarasCrudoCanelo,0)}</p>\n              <p><strong>Monto Total Fletes:</strong> ${this.formatearMonto(this.fletesPendientes.reduce((a,t)=>a+this.calcularMontoDia(t),0))}</p>\n              ${this.abonosFiltrados.length>0?`\n                <p><strong>Total Abonado:</strong> ${this.formatearMonto(this.abonosFiltrados.reduce((a,t)=>a+t.monto,0))}</p>\n              `:""}\n              <p class="total-final"><strong>Saldo Pendiente:</strong> ${this.formatearMonto(this.fletesPendientes.reduce((a,t)=>a+this.calcularMontoDia(t),0)-this.abonosFiltrados.reduce((a,t)=>a+t.monto,0))}</p>\n            </div>\n          </div>\n        </div>\n      `;const t=document.createElement("style");t.textContent="\n        .pdf-container {\n          padding: 20px;\n          font-family: Arial, sans-serif;\n        }\n        .fecha-impresion {\n          color: #666;\n          margin-bottom: 20px;\n        }\n        h3 {\n          color: #333;\n          margin: 20px 0 10px 0;\n        }\n        h4 {\n          color: #333;\n          margin: 15px 0 5px 0;\n          border-bottom: 1px solid #ddd;\n          padding-bottom: 5px;\n        }\n        .tabla-pdf {\n          width: 100%;\n          border-collapse: collapse;\n          margin-bottom: 20px;\n        }\n        .tabla-pdf th, .tabla-pdf td {\n          border: 1px solid #ddd;\n          padding: 8px;\n          text-align: left;\n        }\n        .tabla-pdf th {\n          background-color: #f8f9fa;\n        }\n        .fila-total {\n          background-color: #f8f9fa;\n          border-top: 2px solid #ddd;\n        }\n        .fila-total td {\n          font-size: 1.1em;\n        }\n        .fila-abono {\n          background-color: #e8f5e9;\n        }\n        .resumen-pdf {\n          margin-top: 30px;\n          padding: 15px;\n          background-color: #f8f9fa;\n          border-radius: 5px;\n        }\n        .resumen-grid {\n          display: grid;\n          gap: 10px;\n        }\n        .total-final {\n          margin-top: 10px;\n          padding-top: 10px;\n          border-top: 2px solid #ddd;\n        }\n        .footer-pdf {\n          margin-top: 30px;\n          padding-top: 15px;\n          border-top: 1px solid #ddd;\n        }\n        .resumen-clientes {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 20px;\n          gap: 15px;\n        }\n        .cliente-column {\n          flex: 1;\n          padding: 10px;\n          background-color: #f9f9f9;\n          border-radius: 5px;\n          border: 1px solid #eee;\n        }\n        .cliente-column h4 {\n          text-align: center;\n          margin-top: 0;\n          border-bottom: 1px solid #ddd;\n          padding-bottom: 5px;\n        }\n      ",a.appendChild(t);const e={margin:10,filename:`cuenta_fletes_${this.choferSeleccionado.toLowerCase()}_${(new Date).toISOString().split("T")[0]}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};try{await i()().from(a).set(e).save()}catch(o){console.error("Error al generar el PDF:",o),alert("Error al generar el PDF. Por favor, intente de nuevo.")}finally{this.imprimiendo=!1}},volverMenu(){this.$router.push({name:"EmbarquesMenu"})}},mounted(){this.cargarFletes()}},d=l,c=(e("784b"),e("2877")),u=Object(c["a"])(d,o,s,!1,null,"2170f116",null);t["a"]=u.exports}}]);