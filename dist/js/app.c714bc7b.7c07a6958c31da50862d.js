(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app.c714bc7b"],{"0987":function(a,e,t){},"41cb":function(a,e,t){"use strict";var o=t("2b0e"),n=t("8c4f"),s=(t("f549"),t("bb51")),r=t("f411"),i=t("98cf"),c=t("4e00"),u=t("32e5"),d=t("9302"),l=t("1155"),m=t("2cc6"),p=t("4c52"),b=t("4c57"),h=t("505e"),f=t("f515"),g=t("fcb3"),v=function(){var a=this,e=a._self._c;return e("div",{staticClass:"catarro-cuentas-menu-container"},[e("h1",[a._v("Menú de Cuentas Catarro")]),e("div",{staticClass:"actions-container"},[e("router-link",{staticClass:"action-button back-btn",attrs:{to:"/cuentas-mexico"}},[a._v(" Cuentas México ")]),e("router-link",{staticClass:"action-button new-cuenta-btn",attrs:{to:"/cuentas-catarro/nueva"}},[a._v(" Nueva Cuenta ")]),e("router-link",{staticClass:"action-button ventas-ganancias-btn",attrs:{to:"/ventas-ganancias-catarro"}},[a._v(" Ventas y Ganancias ")]),e("PreciosHistorialModal"),e("StashModal",{attrs:{cliente:"catarro"}})],1),e("div",{staticClass:"filter-container"},[e("label",{attrs:{for:"filter-select"}},[a._v("Filtrar por estado:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroEstado,expression:"filtroEstado"}],attrs:{id:"filter-select"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(a){return a.selected})).map((function(a){var e="_value"in a?a._value:a.value;return e}));a.filtroEstado=e.target.multiple?t:t[0]}}},[e("option",{attrs:{value:"todas"}},[a._v("Todas")]),e("option",{attrs:{value:"pagadas"}},[a._v("Pagadas")]),e("option",{attrs:{value:"no-pagadas"}},[a._v("No Pagadas")])])]),e("div",{staticClass:"cuentas-list"},[e("h2",[a._v("Registros de Cuentas")]),a.isLoading?e("div",{staticClass:"loading"},[a._v("Cargando registros...")]):0===a.cuentasFiltradas.length?e("div",{staticClass:"no-records"},[a._v(" No hay registros de cuentas que coincidan con el filtro. ")]):e("ul",a._l(a.cuentasFiltradas,(function(t){return e("li",{key:t.id,staticClass:"cuenta-item",class:{"tiene-observacion":t.tieneObservacion}},[e("div",{staticClass:"cuenta-content"},[e("span",{staticClass:"cuenta-date"},[a._v(a._s(a.formatDate(t.fecha)))]),e("p",{staticClass:"cuenta-summary"},[e("span",[a._v("Saldo Hoy: $"+a._s(a.formatNumber(t.saldoHoy)))]),e("span",[a._v("Total Acumulado: $"+a._s(a.formatNumber(t.totalNota)))])]),t.tieneObservacion?e("div",{staticClass:"observacion-container"},[e("p",{staticClass:"observacion-texto"},[a._v(a._s(t.observacion))]),e("button",{staticClass:"delete-observacion-btn",attrs:{title:"Borrar observación"},on:{click:function(e){return a.borrarObservacion(t.id)}}},[a._v("×")])]):a._e(),t.abonos&&t.abonos.length>0?e("div",{staticClass:"abonos-info"},a._l(t.abonos,(function(t,o){return e("p",{key:o,staticClass:"abono-detail"},[e("span",{staticClass:"abono-label"},[a._v("Abono:")]),e("span",{staticClass:"abono-monto"},[a._v("$"+a._s(a.formatNumber(t.monto)))]),e("span",{staticClass:"abono-descripcion"},[a._v(a._s(t.descripcion||"Sin descripción"))])])})),0):a._e(),e("span",{class:["estado-cuenta",t.estadoPagado?"pagado":"no-pagado"]},[a._v(" "+a._s(t.estadoPagado?"Pagado":"No Pagado")+" ")])]),e("div",{staticClass:"cuenta-actions"},[e("button",{staticClass:"edit-btn",on:{click:function(e){return a.editarCuenta(t.id)}}},[a._v("Editar")]),e("button",{staticClass:"delete-btn",on:{click:function(e){return a.borrarCuenta(t.id)}}},[a._v("Borrar")])])])})),0)])])},C=[],y=(t("14d9"),t("13d5"),t("dc59")),w=t("1494"),x=t("74c9"),_=t("666c"),k=t("19aa"),M={name:"CatarroCuentasMenu",components:{BackButton:x["a"],PreciosHistorialModal:_["a"],StashModal:k["a"]},data(){return{cuentas:[],isLoading:!0,filtroEstado:"todas",unsubscribe:null}},computed:{cuentasFiltradas(){switch(this.filtroEstado){case"pagadas":return this.cuentas.filter(a=>a.estadoPagado);case"no-pagadas":return this.cuentas.filter(a=>!a.estadoPagado);default:return this.cuentas}}},methods:{async loadCuentas(){try{this.isLoading=!0;const a=Object(w["c"])(y["a"],"cuentasCatarro"),e=Object(w["o"])(a,Object(w["l"])("fecha","asc"));this.unsubscribe=Object(w["k"])(e,async a=>{const e=a.docs.map(a=>{const e=a.data(),t=(e.cobros||[]).reduce((a,e)=>a+(parseFloat(e.monto)||0),0),o=(e.abonos||[]).reduce((a,e)=>a+(parseFloat(e.monto)||0),0),n=(e.totalGeneralVenta||0)-t-o;return{id:a.id,fecha:e.fecha,saldoHoy:e.totalGeneralVenta||0,totalCobros:t,totalAbonos:o,totalNota:e.nuevoSaldoAcumulado||0,estadoPagado:0===n,nuevoSaldoAcumulado:e.nuevoSaldoAcumulado||0,saldoAcumuladoAnterior:e.saldoAcumuladoAnterior||0,abonos:e.abonos||[],tieneObservacion:e.tieneObservacion||!1,observacion:e.observacion||""}}),t=e.sort((a,e)=>new Date(a.fecha)-new Date(e.fecha));let o=0;const n=[];for(let s=0;s<t.length;s++){const a=t[s],e=a.saldoHoy-a.totalCobros-a.totalAbonos;o+=e;const r=0===s?0:t[s-1].nuevoSaldoAcumulado;a.saldoAcumuladoAnterior===r&&a.nuevoSaldoAcumulado===o||n.push({id:a.id,updates:{saldoAcumuladoAnterior:r,nuevoSaldoAcumulado:o,estadoPagado:0===e}}),a.totalNota=o,a.saldoAcumuladoAnterior=r,a.estadoPagado=0===e,o<=0&&(o=0)}n.length>0&&await Promise.all(n.map(({id:a,updates:e})=>Object(w["r"])(Object(w["e"])(y["a"],"cuentasCatarro",a),e))),this.cuentas=t.reverse(),this.isLoading=!1})}catch(a){console.error("Error al cargar cuentas: ",a),this.error=a.message,this.cuentas=[],this.isLoading=!1}},formatDate(a){const e=new Date(a);return e.setMinutes(e.getMinutes()+e.getTimezoneOffset()),e.toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})},formatNumber(a){return a.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})},editarCuenta(a){this.$router.push(`/cuentas-catarro/${a}?edit=true`)},async borrarCuenta(a){if(confirm("¿Estás seguro de que quieres borrar este registro de cuenta?"))try{await Object(w["d"])(Object(w["e"])(y["a"],"cuentasCatarro",a)),alert("Registro de cuenta borrado con éxito")}catch(e){console.error("Error al borrar el registro de cuenta: ",e),alert("Error al borrar el registro de cuenta")}},async borrarObservacion(a){if(confirm("¿Estás seguro de que quieres borrar esta observación?"))try{await Object(w["r"])(Object(w["e"])(y["a"],"cuentasCatarro",a),{tieneObservacion:!1,observacion:""}),alert("Observación borrada con éxito")}catch(e){console.error("Error al borrar la observación: ",e),alert("Error al borrar la observación")}}},mounted(){this.loadCuentas()},beforeUnmount(){this.unsubscribe&&this.unsubscribe()}},E=M,O=(t("6a76"),t("2877")),A=Object(O["a"])(E,v,C,!1,null,"4da548ba",null),F=A.exports,S=t("4786"),j=t("28ce"),P=t("74a9"),N=t("320e"),I=t("0ae9"),L=t("c8b7"),D=t("b34e"),z=t("f458"),q=t("4dc0"),R=t("9aeb"),H=t("a55b"),G=t("9f85"),T=t("85fe"),B=t("05af"),$=t("c5f5"),J=t("f125"),V=(t("0042"),t("cc98")),U=t("3420"),Y=t("d918"),W=t("92c9"),Z=t("e524");o["default"].use(n["a"]);const K=[{path:"/login",name:"Login",component:H["a"]},{path:"/noteMenu",name:"NoteMenu",component:r["a"]},{path:"/",name:"home",component:s["a"]},{path:"/sale-note/:noteId?",name:"SaleNote",component:()=>Promise.resolve().then(t.bind(null,"98cf"))},{path:"/add-client",name:"AddClient",component:c["a"]},{path:"/editar-nota/:noteId",name:"editar-nota",component:i["default"],props:!0},{path:"/sacadas",name:"SacadasMenu",component:d["a"]},{path:"/sacadas/new",name:"NuevaSacada",component:u["a"]},{path:"/sacadas/:id",name:"DetalleSacada",component:u["a"],props:!0},{path:"/gestionar-productos",name:"GestionarProductos",component:l["a"]},{path:"/gestionar-medidas",name:"GestionarMedidas",component:m["a"]},{path:"/gestionar-proveedores",name:"GestionarProveedores",component:p["a"]},{path:"/existencias",name:"Existencias",component:b["a"]},{path:"/cuentas-mexico",name:"CuentasMexico",component:h["a"]},{path:"/cuentas-ozuna",name:"ozuna-cuentas-menu",component:f["a"]},{path:"/cuentas-ozuna/nueva",name:"nueva-cuenta-ozuna",component:g["a"]},{path:"/cuentas-ozuna/:id",name:"ver-cuenta-ozuna",component:g["a"]},{path:"/cuentas-ozuna/:id?",name:"CuentasOzuna",component:g["a"]},{path:"/cuentas-catarro",name:"catarro-cuentas-menu",component:F},{path:"/cuentas-catarro/nueva",name:"nueva-cuenta-catarro",component:S["a"]},{path:"/cuentas-catarro/:id",name:"ver-cuenta-catarro",component:S["a"]},{path:"/cuentas-catarro/:id?",name:"CuentasCatarro",component:S["a"]},{path:"/cuentas-joselito",name:"joselito-cuentas-menu",component:j["a"]},{path:"/cuentas-joselito/nueva",name:"nueva-cuenta-joselito",component:P["a"]},{path:"/cuentas-joselito/:id",name:"ver-cuenta-joselito",component:P["a"]},{path:"/cuentas-joselito/:id?",name:"CuentasJoselito",component:P["a"]},{path:"/embarques-menu",name:"EmbarquesMenu",component:N["a"]},{path:"/ventas-ganancias-catarro",name:"VentasYGananciasCatarro",component:I["a"]},{path:"/ventas-ganancias-joselito",name:"VentasYGananciasJoselito",component:L["a"]},{path:"/embarques",name:"ListaEmbarques",component:D["a"]},{path:"/embarques/:id",name:"EditarEmbarque",component:z["a"]},{path:"/nuevo-embarque",name:"NuevoEmbarque",component:z["a"]},{path:"/embarques/:id/rendimientos",name:"Rendimientos",component:q["default"],props:!0},{path:"/cuenta-fletes",name:"CuentaFletes",component:R["a"]},{path:"/cuentas-otilio",name:"otilio-cuentas-menu",component:G["a"]},{path:"/cuentas-otilio/nueva",name:"nueva-cuenta-otilio",component:T["a"]},{path:"/cuentas-otilio/:id",name:"ver-cuenta-otilio",component:T["a"]},{path:"/cuentas-otilio/:id?",name:"CuentasOtilio",component:T["a"]},{path:"/procesos",name:"ProcesosMenu",component:B["a"]},{path:"/procesos/preparacion",name:"Preparacion",component:$["a"]},{path:"/procesos/pedidos",name:"PedidosMenu",component:J["a"]},{path:"/procesos/pedidos/nuevo",name:"NuevoPedido",component:Y["a"]},{path:"/procesos/pedidos/crudo",name:"PedidosCrudo",component:V["a"]},{path:"/procesos/pedidos/limpio",name:"PedidosLimpio",component:Y["a"]},{path:"/procesos/pedidos-crudos-impresion",name:"PedidoCrudosImpresion",component:U["a"],props:!0},{path:"/procesos/pedidos-limpio-impresion",name:"PedidoLimpioImpresion",component:W["a"],props:!0},{path:"/procesos/bitacoras",name:"Bitacoras",component:Z["a"]}],X=new n["a"]({mode:"history",base:"/",routes:K});X.beforeEach((a,e,t)=>{const o=localStorage.getItem("user"),n=!!o;"/login"===a.path&&n?t("/"):"/login"===a.path||n?t():t("/login")});e["a"]=X},"6a76":function(a,e,t){"use strict";t("0987")},"6d4d":function(a,e,t){"use strict";t.d(e,"a",(function(){return i}));t("14d9"),t("13d5");var o=t("e499"),n=t.n(o),s=t("4ebb"),r=t.n(s);"object"===typeof r.a&&(r.a.pdfMake&&r.a.pdfMake.vfs?n.a.vfs=r.a.pdfMake.vfs:r.a.vfs?n.a.vfs=r.a.vfs:n.a.vfs=r.a),"undefined"===typeof window||window.pdfMake||(window.pdfMake=n.a);const i=async(a,e)=>{try{const t=await l("https://res.cloudinary.com/hwkcovsmr/image/upload/v1620946647/samples/REY_PEZ_LOGO_nsotww.png"),o=(null===e||void 0===e?void 0:e.nombresMedidasPersonalizados)||{},s=a=>{if(!a)return"Sin fecha";let e;if(a&&"function"===typeof a.toDate?e=a.toDate():"string"===typeof a?e=new Date(a):a instanceof Date&&(e=a),isNaN(e.getTime()))return"Fecha inválida";const t=new Date(e.getTime()+6e4*e.getTimezoneOffset());return t.toLocaleDateString("es-MX",{year:"numeric",month:"2-digit",day:"2-digit",timeZone:"America/Mexico_City"})},r={content:[{columns:[{image:t,width:80,alignment:"left",margin:[0,0,0,5]},{text:"Reporte de Rendimientos",style:"header",alignment:"center",margin:[0,10,0,0]},{stack:[{text:"Fecha: "+s(e.fecha),alignment:"right",margin:[0,10,0,0]}]}]},{text:"\n",height:5},c(a,o,e)],styles:{header:{fontSize:24,bold:!0,color:"#3760b0",margin:[0,0,0,5]},tableHeader:{bold:!0,fontSize:20,color:"white",fillColor:"#3760b0"},rendimientoAlto:{color:"#27ae60",bold:!0},rendimientoBajo:{color:"#000000"},costoStyle:{color:"#e74c3c",bold:!0}},defaultStyle:{fontSize:18},footer:function(a,e){return{columns:[{text:"© 2024 Rey Pez - Tampico, Tamps.",alignment:"center",margin:[0,5,0,0],fontSize:8,color:"#3760b0"}]}}};e.notaRendimientos&&(r.content.push({text:"\n",height:5}),r.content.push({text:"Nota:",style:"header",color:"red",alignment:"center",margin:[0,10,0,0]}),r.content.push({text:" "+e.notaRendimientos,style:"header",alignment:"center",color:"black",margin:[0,10,0,0]})),n.a.createPdf(r).open()}catch(t){console.error("Error al generar el PDF de rendimientos:",t)}};function c(a,e,t){const o=a.reduce((a,t)=>{const o=e[t.medida]||t.medida;return o.includes("mixta")||o.includes("Mixta")?(a["Mixta"]||(a["Mixta"]={medida:"Mixta",kilosCrudos:0,totalEmbarcado:0,costoFinal:t.costoFinal}),t.kilosCrudos&&("object"===typeof t.kilosCrudos?a["Mixta"].kilosCrudos+=(parseFloat(t.kilosCrudos.medida1)||0)+(parseFloat(t.kilosCrudos.medida2)||0):a["Mixta"].kilosCrudos+=parseFloat(t.kilosCrudos)||0),a["Mixta"].totalEmbarcado+=parseFloat(t.totalEmbarcado)||0):a[o]={medida:o,kilosCrudos:parseFloat(t.kilosCrudos)||0,totalEmbarcado:parseFloat(t.totalEmbarcado)||0,costoFinal:t.costoFinal},a},{}),n=Object.values(o).some(a=>a.costoFinal&&"0"!==a.costoFinal&&0!==a.costoFinal),s=t.mostrarColumnaCosto&&n,r=[[{text:"Kilos en Crudo",style:"tableHeader"},{text:"Medida",style:"tableHeader"},{text:"Rendimiento",style:"tableHeader"},...s?[{text:"Costo Final",style:"tableHeader"}]:[]],...Object.values(o).map(a=>{const e=a.totalEmbarcado>0?a.kilosCrudos/a.totalEmbarcado:0,t=e>1?"rendimientoAlto":"rendimientoBajo";let o=a.medida;if(a.medidasIncluidas){const e=Array.from(a.medidasIncluidas);o=`Mixta (${e.join(", ")})`}return[u(a.kilosCrudos),o,{text:`(${d(e)})`,style:t},...s?[{text:a.costoFinal?"$"+Number(a.costoFinal).toFixed(1):"",style:"costoStyle"}]:[]]})];return{table:{headerRows:1,widths:s?["*","*","*","*"]:["*","*","*"],body:r},layout:{hLineWidth:function(a,e){return 0===a||a===e.table.body.length?1.5:.5},vLineWidth:function(a,e){return 0===a||a===e.table.widths.length?1.5:.5},hLineColor:function(a,e){return 0===a||a===e.table.body.length?"#3760b0":"#cccccc"},vLineColor:function(a,e){return 0===a||a===e.table.widths.length?"#3760b0":"#cccccc"},fillColor:function(a,e,t){return a%2===0?"#f8f9fa":null},paddingLeft:function(a){return 4},paddingRight:function(a){return 4},paddingTop:function(a){return 2},paddingBottom:function(a){return 2}}}}function u(a){if("number"===typeof a)return(a%1===0?Math.floor(a):a.toFixed(1))+" kg";if("object"===typeof a&&null!==a){const e=(Number(a.medida1)||0)+(Number(a.medida2)||0);return(e%1===0?Math.floor(e):e.toFixed(1))+" kg"}const e=Number(a);return(e%1===0?Math.floor(e):e.toFixed(1))+" kg"}function d(a){return Number(a).toFixed(2)}function l(a){return new Promise((e,t)=>{const o=new Image;o.crossOrigin="Anonymous",o.onload=function(){const a=document.createElement("canvas");a.width=o.width,a.height=o.height;const t=a.getContext("2d");t.drawImage(o,0,0);const n=a.toDataURL("image/png");e(n)},o.onerror=t,o.src=a})}},f549:function(a,e,t){"use strict";t.d(e,"a",(function(){return i}));var o=t("be92"),n=t("dc59"),s=t("e1bd");const r=[{username:"allan",password:"noseno"},{username:"edgar",password:"noseno"}],i=Object(o["c"])("auth",{state:()=>({user:null,isAuthenticated:!1,userId:null}),actions:{async login(a,e){try{const t=r.find(t=>t.username===a&&t.password===e);if(t){const a=Object(s["a"])();return this.userId=a,this.user={username:t.username},this.isAuthenticated=!0,Object(n["b"])(a,t.username),localStorage.setItem("user",JSON.stringify({...this.user,userId:a})),!0}return!1}catch(t){return console.error("Error en login:",t),!1}},logout(){this.user=null,this.isAuthenticated=!1,this.userId=null,localStorage.removeItem("user")},checkAuth(){try{const a=localStorage.getItem("user");if(a){const e=JSON.parse(a);this.user={username:e.username},this.userId=e.userId,this.isAuthenticated=!0,this.userId&&Object(n["b"])(this.userId,e.username)}}catch(a){console.error("Error al verificar autenticación:",a),this.logout()}}},getters:{isLoggedIn:a=>a.isAuthenticated,currentUser:a=>a.user}})},fa1c:function(a,e,t){"use strict";var o=t("c1df"),n=t.n(o);t("898b");n.a.locale("es")}}]);