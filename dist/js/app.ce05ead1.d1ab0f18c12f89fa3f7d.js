(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app.ce05ead1"],{"0ad4":function(a,t,e){},"4cbd":function(a,t,e){"use strict";e("0ad4")},"608e":function(a,t,e){},"6e99":function(a,t,e){"use strict";e("14d9");var o=function(){var a=this,t=a._self._c;return t("div",{staticClass:"lista-deudas-barcos"},[t("div",{staticClass:"back-button-container"},[t("BackButton",{attrs:{to:"/barcos"}})],1),t("div",{staticClass:"header-section",style:{background:a.gradientePrimario}},[t("div",{staticClass:"header-content"},[t("h1",{staticClass:"main-title"},[t("i",{staticClass:"icon-list"},[a._v("üìã")]),a._v(" Lista de Deudas - "+a._s(a.nombreBarco)+" ")]),t("p",{staticClass:"subtitle"},[a._v("Gestiona las deudas pendientes del barco "+a._s(a.nombreBarco))])])]),t("div",{staticClass:"resumen-cards"},[t("div",{staticClass:"resumen-card barco-card",style:{background:a.gradientePrimario}},[t("i",{staticClass:"card-icon"},[a._v(a._s("galileo"===a.barcoSeleccionado?"üö¢":"üõ•Ô∏è"))]),t("div",{staticClass:"card-content"},[t("h3",[a._v(a._s(a.nombreBarco))]),t("p",[a._v("Barco seleccionado")])])]),t("div",{staticClass:"resumen-card"},[t("i",{staticClass:"card-icon"},[a._v("‚úÖ")]),t("div",{staticClass:"card-content"},[t("h3",[a._v("$"+a._s(a.formatNumber(a.totalAbonado)))]),t("p",[a._v("Total Abonado")])])]),t("div",{staticClass:"resumen-card"},[t("i",{staticClass:"card-icon"},[a._v("‚è≥")]),t("div",{staticClass:"card-content"},[t("h3",[a._v("$"+a._s(a.formatNumber(a.totalPendiente)))]),t("p",[a._v("Total Pendiente")])])]),t("div",{staticClass:"resumen-card resumen-card-action",on:{click:a.crearNuevaDeuda}},[t("i",{staticClass:"card-icon"},[a._v("‚ûï")]),a._m(0)])]),t("div",{staticClass:"filtros-card"},[a._m(1),t("div",{staticClass:"filtros-container"},[t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroEstado,expression:"filtroEstado"}],staticClass:"filtro-select",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.filtroEstado=t.target.multiple?e:e[0]}}},[t("option",{attrs:{value:""}},[a._v("Con saldo pendiente")]),t("option",{attrs:{value:"pendiente"}},[a._v("Solo Pendientes")]),t("option",{attrs:{value:"parcial"}},[a._v("Solo Pago Parcial")]),t("option",{attrs:{value:"pagado"}},[a._v("Solo Pagadas")])]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroProveedor,expression:"filtroProveedor"}],staticClass:"filtro-select",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.filtroProveedor=t.target.multiple?e:e[0]}}},[t("option",{attrs:{value:""}},[a._v("Todos los proveedores")]),a._l(a.proveedoresUnicos,(function(e){return t("option",{key:e.id,domProps:{value:e.id}},[a._v(" "+a._s(e.nombre)+" ")])}))],2),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroFechaInicio,expression:"filtroFechaInicio"}],staticClass:"filtro-input",attrs:{type:"date",placeholder:"Fecha inicio"},domProps:{value:a.filtroFechaInicio},on:{input:function(t){t.target.composing||(a.filtroFechaInicio=t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroFechaFin,expression:"filtroFechaFin"}],staticClass:"filtro-input",attrs:{type:"date",placeholder:"Fecha fin"},domProps:{value:a.filtroFechaFin},on:{input:function(t){t.target.composing||(a.filtroFechaFin=t.target.value)}}}),t("button",{staticClass:"btn-limpiar",on:{click:a.limpiarFiltros}},[t("i",{staticClass:"icon"},[a._v("üóëÔ∏è")]),a._v(" Limpiar ")]),t("button",{staticClass:"btn-abono-general",on:{click:a.abrirModalAbonoGeneral}},[t("i",{staticClass:"icon"},[a._v("üíµ")]),a._v(" Abono General ")]),t("button",{staticClass:"btn-historial-completo",on:{click:a.verHistorialCompleto}},[t("i",{staticClass:"icon"},[a._v("üìä")]),a._v(" Historial Completo ")])])]),a.deudasFiltradas.length>0?t("div",{staticClass:"deudas-container"},[t("div",{staticClass:"paginacion-info"},[t("p",[a._v("Mostrando "+a._s(a.deudasFiltradas.length)+" deudas agrupadas por proveedor")])]),a._l(a.deudasAgrupadasPorProveedor,(function(e){return t("div",{key:e.proveedor.id,staticClass:"proveedor-grupo"},[t("div",{staticClass:"proveedor-header"},[t("div",{staticClass:"proveedor-title"},[t("div",{staticClass:"proveedor-color-circle",style:{backgroundColor:e.proveedor.color}}),t("h2",{class:["proveedor-nombre","clickeable",{filtrado:a.filtroProveedor===e.proveedor.id}],attrs:{title:a.filtroProveedor===e.proveedor.id?"Haz clic para quitar el filtro":"Haz clic para filtrar por este proveedor"},on:{click:function(t){return a.filtrarPorProveedor(e.proveedor.id)}}},[a._v(" "+a._s(e.proveedor.nombre)+" "),t("i",{class:["fas",a.filtroProveedor===e.proveedor.id?"fa-check-circle":"fa-filter","filter-icon"]})])]),t("div",{staticClass:"proveedor-resumen"},[t("div",{staticClass:"resumen-item"},[t("span",{staticClass:"label"},[a._v("Total Deuda:")]),t("span",{staticClass:"value"},[a._v("$"+a._s(a.formatNumber(e.totalDeuda)))])]),t("div",{staticClass:"resumen-item"},[t("span",{staticClass:"label"},[a._v("Saldo Pendiente:")]),t("span",{staticClass:"value pendiente"},[a._v("$"+a._s(a.formatNumber(e.totalPendiente)))])]),t("div",{staticClass:"resumen-item"},[t("span",{staticClass:"label"},[a._v("Deudas:")]),t("span",{staticClass:"value"},[a._v(a._s(e.deudas.length))])])])]),t("div",{staticClass:"tabla-container-proveedor"},[t("table",{staticClass:"tabla-deudas-proveedor"},[a._m(2,!0),t("tbody",a._l(e.deudas,(function(e){return t("tr",{key:e.id,class:{"deuda-pagada":"pagado"===e.estado}},[t("td",[a._v(a._s(a.formatDate(e.fecha)))]),t("td",[a._v("$"+a._s(a.formatNumber(e.totalDeuda)))]),t("td",[a._v("$"+a._s(a.formatNumber(e.saldoPendiente)))]),t("td",[t("span",{class:"estado-badge "+e.estado},[a._v(" "+a._s(a.getEstadoLabel(e.estado))+" ")])]),t("td",{staticClass:"acciones"},[t("button",{staticClass:"btn-detalle",attrs:{title:"Realizar abono",disabled:"pagado"===e.estado},on:{click:function(t){return a.abrirModalAbono(e)}}},[t("i",{staticClass:"fas fa-money-bill"},[a._v("üíµ")])]),t("button",{staticClass:"btn-abono",attrs:{title:"Ver detalle de la deuda"},on:{click:function(t){return a.verDetalleDeuda(e)}}},[t("i",{staticClass:"fas fa-eye"},[a._v("üëÅÔ∏è")])]),t("button",{staticClass:"btn-eliminar",attrs:{title:"Eliminar deuda"},on:{click:function(t){return a.eliminarDeuda(e)}}},[t("i",{staticClass:"fas fa-trash-alt"},[a._v("üóëÔ∏è")])])])])})),0)])])])}))],2):t("div",{staticClass:"no-deudas"},[t("i",{staticClass:"empty-icon"},[a._v("üì≠")]),t("h3",[a._v("No hay deudas registradas")]),0===a.deudas.length?t("p",[a._v("No se encontraron deudas para el barco "+a._s(a.nombreBarco))]):t("p",[a._v("No se encontraron deudas para los filtros seleccionados ("+a._s(a.deudas.length)+" deudas disponibles)")]),0===a.deudas.length?t("div",{staticClass:"debug-suggestions"},[t("h4",[a._v("üí° Posibles soluciones:")]),t("ul",[t("li",[a._v("Verifica que hayas creado deudas para el barco "),t("strong",[a._v(a._s(a.nombreBarco))])]),t("li",[a._v("Revisa la consola del navegador (F12) para ver mensajes de debug")]),t("li",[a._v("Aseg√∫rate de que las deudas se guardaron correctamente en Firebase")]),t("li",[a._v('Verifica que el campo "barco" en Firebase sea exactamente: '),t("strong",[a._v(a._s(a.barcoSeleccionado))])])]),t("div",{staticClass:"action-buttons"},[t("button",{staticClass:"btn-crear",on:{click:function(t){return a.$router.push("/barcos/deudas/nueva?barco="+a.barcoSeleccionado)}}},[a._v(" ‚ûï Crear Primera Deuda ")]),t("button",{staticClass:"btn-reload",on:{click:a.loadDeudas}},[a._v(" üîÑ Recargar Deudas ")])])]):a._e()]),a.showModalAbono?t("div",{staticClass:"modal-overlay",on:{click:a.closeModalOnOverlay}},[t("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h2",[a._v("Realizar Abono")]),t("button",{staticClass:"close-button",on:{click:function(t){a.showModalAbono=!1}}},[a._v("‚úï")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"deuda-info"},[t("h4",[a._v(a._s(a.deudaSeleccionada.nombreProveedor))]),t("p",[a._v("Saldo pendiente: $"+a._s(a.formatNumber(a.deudaSeleccionada.saldoPendiente)))])]),t("form",{on:{submit:function(t){return t.preventDefault(),a.guardarAbono.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",[a._v("Monto del abono")]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.nuevoAbono.monto,expression:"nuevoAbono.monto",modifiers:{number:!0}}],staticClass:"form-input",attrs:{type:"number",step:"0.01",required:"",max:a.deudaSeleccionada.saldoPendiente},domProps:{value:a.nuevoAbono.monto},on:{input:function(t){t.target.composing||a.$set(a.nuevoAbono,"monto",a._n(t.target.value))},blur:function(t){return a.$forceUpdate()}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Descripci√≥n (opcional)")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.nuevoAbono.descripcion,expression:"nuevoAbono.descripcion"}],staticClass:"form-input",attrs:{type:"text",placeholder:"Descripci√≥n del abono"},domProps:{value:a.nuevoAbono.descripcion},on:{input:function(t){t.target.composing||a.$set(a.nuevoAbono,"descripcion",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Fecha del abono")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.nuevoAbono.fecha,expression:"nuevoAbono.fecha"}],staticClass:"form-input",attrs:{type:"date",required:""},domProps:{value:a.nuevoAbono.fecha},on:{input:function(t){t.target.composing||a.$set(a.nuevoAbono,"fecha",t.target.value)}}})]),t("div",{staticClass:"modal-actions"},[t("button",{staticClass:"btn-cancelar",attrs:{type:"button"},on:{click:function(t){a.showModalAbono=!1}}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-guardar",attrs:{type:"submit"}},[a._v(" Guardar Abono ")])])])])])]):a._e(),a.showModalHistorial?t("div",{staticClass:"modal-overlay",on:{click:a.closeModalOnOverlay}},[t("div",{staticClass:"modal-content modal-detalle-deuda",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h2",[a._v("Detalle de Deuda")]),t("button",{staticClass:"close-button",on:{click:function(t){a.showModalHistorial=!1}}},[a._v("‚úï")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"deuda-info-completa"},[t("div",{staticClass:"info-header"},[t("div",{staticClass:"proveedor-info"},[t("div",{staticClass:"color-indicator-modal",style:{backgroundColor:a.getProveedorColor(a.deudaSeleccionada.proveedorId)}}),t("div",[t("h3",[a._v(a._s(a.deudaSeleccionada.nombreProveedor))]),t("p",{staticClass:"fecha-deuda"},[a._v(a._s(a.formatDate(a.deudaSeleccionada.fecha)))])])]),t("div",{staticClass:"estado-deuda"},[t("span",{class:"estado-badge "+a.deudaSeleccionada.estado},[a._v(" "+a._s(a.getEstadoLabel(a.deudaSeleccionada.estado))+" ")])])]),a.deudaSeleccionada.items&&a.deudaSeleccionada.items.length>0?t("div",{staticClass:"items-section"},[t("h4",[a._v("Productos/Items:")]),t("div",{staticClass:"items-list"},a._l(a.deudaSeleccionada.items,(function(e,o){return t("div",{key:o,staticClass:"item-detalle"},[t("div",{staticClass:"item-descripcion"},[a._v(a._s(e.descripcion))]),e.cantidad?t("div",{staticClass:"item-cantidad"},[a._v("Cantidad: "+a._s(a.formatNumber(e.cantidad)))]):a._e(),e.precioUnitario?t("div",{staticClass:"item-precio"},[a._v("Precio unitario: $"+a._s(a.formatNumber(e.precioUnitario)))]):a._e(),t("div",{staticClass:"item-total"},[a._v("Total: $"+a._s(a.formatNumber(e.total||e.costo||0)))])])})),0)]):a._e(),t("div",{staticClass:"resumen-financiero"},[t("div",{staticClass:"resumen-item"},[t("span",{staticClass:"label"},[a._v("Total de la Deuda:")]),t("span",{staticClass:"value total"},[a._v("$"+a._s(a.formatNumber(a.deudaSeleccionada.totalDeuda)))])]),t("div",{staticClass:"resumen-item"},[t("span",{staticClass:"label"},[a._v("Total Abonado:")]),t("span",{staticClass:"value abonado"},[a._v("$"+a._s(a.formatNumber(a.deudaSeleccionada.totalAbonado||0)))])]),t("div",{staticClass:"resumen-item"},[t("span",{staticClass:"label"},[a._v("Saldo Pendiente:")]),t("span",{staticClass:"value pendiente"},[a._v("$"+a._s(a.formatNumber(a.deudaSeleccionada.saldoPendiente)))])])])]),t("div",{staticClass:"historial-section"},[t("h4",[a._v("Historial de Abonos")]),a.historialAbonos.length>0?t("div",{staticClass:"abonos-list"},[a._l(a.historialAbonos,(function(e,o){return t("div",{key:e.id,staticClass:"abono-item"},[t("div",{staticClass:"abono-info"},[t("div",{staticClass:"abono-fecha"},[a._v(a._s(a.formatDate(e.fecha)))]),t("div",{staticClass:"abono-descripcion"},[a._v(a._s(e.descripcion||"Abono"))]),t("div",{staticClass:"abono-monto"},[a._v("$"+a._s(a.formatNumber(e.monto)))])]),t("div",{staticClass:"abono-acciones"},[t("button",{staticClass:"btn-eliminar-abono",attrs:{title:"Eliminar abono"},on:{click:function(t){return a.eliminarAbono(e,o)}}},[a._v(" üóëÔ∏è ")])])])})),t("div",{staticClass:"abonos-total"},[t("span",[a._v("Total abonado:")]),t("span",[a._v("$"+a._s(a.formatNumber(a.totalAbonosHistorial)))])])],2):t("div",{staticClass:"no-abonos"},[t("p",[a._v("No hay abonos registrados para esta deuda")])])])])])]):a._e(),a.showModalAbonoGeneral?t("div",{staticClass:"modal-overlay",on:{click:a.closeModalOnOverlay}},[t("div",{staticClass:"modal-content modal-abono-general",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h2",[a._v("Abono General - "+a._s(a.nombreBarco))]),t("button",{staticClass:"close-button",on:{click:function(t){a.showModalAbonoGeneral=!1}}},[a._v("‚úï")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"resumen-deudas"},[t("h3",[a._v("Resumen de Deudas")]),t("div",{staticClass:"resumen-cards-mini"},[t("div",{staticClass:"resumen-card-mini"},[t("span",{staticClass:"label"},[a._v("Deudas pendientes:")]),t("span",{staticClass:"valor"},[a._v(a._s(a.deudasParaAbono.length))])]),t("div",{staticClass:"resumen-card-mini"},[t("span",{staticClass:"label"},[a._v("Saldo total:")]),t("span",{staticClass:"valor"},[a._v("$"+a._s(a.formatNumber(a.saldoTotalParaAbono)))])])])]),t("form",{on:{submit:function(t){return t.preventDefault(),a.guardarAbonoGeneral.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",[a._v("Proveedor")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.abonoGeneral.proveedorId,expression:"abonoGeneral.proveedorId"}],staticClass:"form-input",on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.abonoGeneral,"proveedorId",t.target.multiple?e:e[0])},a.calcularDistribucion]}},[t("option",{attrs:{value:""}},[a._v("Todas las deudas del barco")]),a._l(a.proveedoresUnicos,(function(e){return t("option",{key:e.id,domProps:{value:e.id}},[a._v(" "+a._s(e.nombre)+" ")])}))],2),t("small",{staticClass:"form-help"},[a._v("Si selecciona un proveedor, el abono se aplicar√° solo a sus deudas")])]),t("div",{staticClass:"form-group"},[t("label",[a._v("Monto del abono")]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.abonoGeneral.monto,expression:"abonoGeneral.monto",modifiers:{number:!0}}],staticClass:"form-input",attrs:{type:"number",step:"0.01",min:"0.01",max:a.saldoTotalParaAbono,required:""},domProps:{value:a.abonoGeneral.monto},on:{input:[function(t){t.target.composing||a.$set(a.abonoGeneral,"monto",a._n(t.target.value))},a.calcularDistribucion],blur:function(t){return a.$forceUpdate()}}}),t("small",{staticClass:"form-help"},[a._v("M√°ximo disponible: $"+a._s(a.formatNumber(a.saldoTotalParaAbono)))])]),t("div",{staticClass:"form-group"},[t("label",[a._v("Descripci√≥n")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.abonoGeneral.descripcion,expression:"abonoGeneral.descripcion"}],staticClass:"form-input",attrs:{type:"text",required:"",placeholder:"Ej: Pago general, Transferencia, etc."},domProps:{value:a.abonoGeneral.descripcion},on:{input:function(t){t.target.composing||a.$set(a.abonoGeneral,"descripcion",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Fecha del abono")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.abonoGeneral.fecha,expression:"abonoGeneral.fecha"}],staticClass:"form-input",attrs:{type:"date",required:""},domProps:{value:a.abonoGeneral.fecha},on:{input:function(t){t.target.composing||a.$set(a.abonoGeneral,"fecha",t.target.value)}}})]),a.abonoGeneral.monto>0&&a.distribucionPreview.length>0?t("div",{staticClass:"distribucion-preview"},[t("h4",[a._v("üîÑ Vista previa de distribuci√≥n (por antig√ºedad):")]),t("div",{staticClass:"deudas-distribucion"},[a._l(a.distribucionPreview.slice(0,5),(function(e,o){return t("div",{key:e.deuda.id,staticClass:"deuda-distribucion-item"},[t("div",{staticClass:"deuda-info-dist"},[t("span",{staticClass:"fecha"},[a._v(a._s(a.formatDate(e.deuda.fecha)))]),t("span",{staticClass:"proveedor"},[a._v(a._s(e.deuda.nombreProveedor))]),t("span",{staticClass:"saldo-actual"},[a._v("$"+a._s(a.formatNumber(e.deuda.saldoPendiente)))])]),t("div",{staticClass:"abono-aplicado"},[t("span",{staticClass:"monto-abono"},[a._v("$"+a._s(a.formatNumber(e.montoAbono)))]),t("span",{staticClass:"saldo-restante",class:{pagado:0===e.saldoRestante}},[a._v(" "+a._s(0===e.saldoRestante?"¬°PAGADO!":"Resta: $"+a.formatNumber(e.saldoRestante))+" ")])])])})),a.distribucionPreview.length>5?t("div",{staticClass:"mas-deudas"},[a._v(" ... y "+a._s(a.distribucionPreview.length-5)+" deudas m√°s ")]):a._e()],2),t("div",{staticClass:"resumen-distribucion"},[t("div",{staticClass:"total-distribuido"},[t("span",[a._v("üí∞ Total a distribuir: $"+a._s(a.formatNumber(a.totalDistribuidoPreview)))])]),a.montoSobrantePreview>0?t("div",{staticClass:"monto-sobrante"},[t("span",[a._v("‚ö° Sobrante (se aplicar√° a la primera deuda): $"+a._s(a.formatNumber(a.montoSobrantePreview)))])]):a._e()])]):a._e(),t("div",{staticClass:"modal-actions"},[t("button",{staticClass:"btn-cancelar",attrs:{type:"button"},on:{click:function(t){a.showModalAbonoGeneral=!1}}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-guardar",attrs:{type:"submit",disabled:!a.abonoGeneral.monto||a.abonoGeneral.monto<=0||0===a.deudasParaAbono.length}},[a._v(" "+a._s(0===a.deudasParaAbono.length?"No hay deudas pendientes":"Aplicar Abono General")+" ")])])])])])]):a._e(),a.showModalHistorialCompleto?t("div",{staticClass:"modal-overlay",on:{click:a.closeModalOnOverlay}},[t("div",{staticClass:"modal-content modal-historial-completo",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h2",[a._v("Historial Completo de Abonos - "+a._s(a.nombreBarco))]),t("button",{staticClass:"close-button",on:{click:function(t){a.showModalHistorialCompleto=!1}}},[a._v("‚úï")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"filtros-historial"},[t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroHistorialTipo,expression:"filtroHistorialTipo"}],staticClass:"form-input",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.filtroHistorialTipo=t.target.multiple?e:e[0]}}},[t("option",{attrs:{value:""}},[a._v("Todos los tipos")]),t("option",{attrs:{value:"general"}},[a._v("Abonos Generales")]),t("option",{attrs:{value:"deuda"}},[a._v("Abonos a Deudas")])]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroHistorialProveedor,expression:"filtroHistorialProveedor"}],staticClass:"form-input",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.filtroHistorialProveedor=t.target.multiple?e:e[0]}}},[t("option",{attrs:{value:""}},[a._v("Todos los proveedores")]),a._l(a.proveedoresUnicos,(function(e){return t("option",{key:e.id,domProps:{value:e.id}},[a._v(" "+a._s(e.nombre)+" ")])}))],2)]),a.historialCompletoFiltrado.length>0?t("div",{staticClass:"abonos-list-completo"},[a._l(a.historialCompletoFiltrado,(function(e,o){return t("div",{key:e.id,staticClass:"abono-item-completo"},[t("div",{staticClass:"abono-fecha"},[a._v(a._s(a.formatDate(e.fecha)))]),t("div",{staticClass:"abono-info"},[t("div",{staticClass:"abono-descripcion"},[a._v(" "+a._s(e.descripcion)+" "),"general"===e.tipo?t("span",{staticClass:"badge-general"},[a._v("General")]):t("span",{staticClass:"badge-deuda"},[a._v("Deuda")])]),t("div",{staticClass:"abono-proveedor"},[a._v(a._s(e.nombreProveedor))])]),t("div",{staticClass:"abono-monto"},[a._v("$"+a._s(a.formatNumber(e.monto)))]),t("div",{staticClass:"abono-acciones-completo"},[t("button",{staticClass:"btn-eliminar-abono",attrs:{title:"Eliminar abono"},on:{click:function(t){return a.eliminarAbonoCompleto(e,o)}}},[a._v(" üóëÔ∏è ")])])])})),t("div",{staticClass:"abonos-total-completo"},[t("span",[a._v("Total de abonos:")]),t("span",[a._v("$"+a._s(a.formatNumber(a.totalHistorialCompleto)))])])],2):t("div",{staticClass:"no-abonos"},[t("p",[a._v("No hay abonos registrados para los filtros seleccionados")])])])])]):a._e(),t("BotonReporteMensual")],1)},s=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"card-content"},[t("h3",[a._v("Nueva Deuda")]),t("p",[a._v("Agregar deuda")])])},function(){var a=this,t=a._self._c;return t("h3",{staticClass:"section-title"},[t("i",{staticClass:"icon-filter"},[a._v("üîç")]),a._v(" Filtros y Acciones ")])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Fecha")]),t("th",[a._v("Monto Total")]),t("th",[a._v("Saldo Pendiente")]),t("th",[a._v("Estado")]),t("th",[a._v("Acciones")])])])}],i=(e("13d5"),e("88a7"),e("271a"),e("5494"),e("dc59")),r=e("1494"),n=e("74c9"),c=e("232e"),l={name:"ListaDeudasBarcos",components:{BackButton:n["a"],BotonReporteMensual:c["a"]},data(){return{barcoSeleccionado:"",deudas:[],proveedores:[],loading:!0,detalleDeudaVisible:!1,deudaSeleccionada:null,modalAbonoVisible:!1,abonoModalTitle:"",abonoModalSaldoActual:0,abonoModalSaldoPendiente:0,montoAbono:0,filtroEstado:"",filtroProveedor:"",filtroFechaInicio:"",filtroFechaFin:"",modalAbonoGeneralVisible:!1,abonos:[],showModalAbono:!1,showModalHistorial:!1,showModalAbonoGeneral:!1,showModalHistorialCompleto:!1,nuevoAbono:{monto:null,descripcion:"",fecha:""},abonoGeneral:{monto:null,descripcion:"",fecha:"",proveedorId:""},historialAbonos:[],historialCompleto:[],filtroHistorialTipo:"",filtroHistorialProveedor:""}},computed:{colorPrimario(){return"maria-guadalupe"===this.barcoSeleccionado?"#27ae60":"#3498db"},colorSecundario(){return"maria-guadalupe"===this.barcoSeleccionado?"#2ecc71":"#2980b9"},gradientePrimario(){return"maria-guadalupe"===this.barcoSeleccionado?"linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)":"linear-gradient(135deg, #3498db 0%, #2980b9 100%)"},nombreBarco(){return"galileo"===this.barcoSeleccionado?"El Galileo":"Mar√≠a Guadalupe"},deudasFiltradas(){return this.deudas.filter(a=>{if(this.filtroEstado){if(a.estado!==this.filtroEstado)return!1}else if("pagado"===a.estado)return!1;if(this.filtroProveedor&&a.proveedorId!==this.filtroProveedor)return!1;if(this.filtroFechaInicio||this.filtroFechaFin){const t=new Date(a.fecha);if(this.filtroFechaInicio&&t<new Date(this.filtroFechaInicio))return!1;if(this.filtroFechaFin&&t>new Date(this.filtroFechaFin))return!1}return!0})},proveedoresUnicos(){const a=new Map;return this.deudas.forEach(t=>{a.has(t.proveedorId)||a.set(t.proveedorId,{id:t.proveedorId,nombre:t.nombreProveedor})}),Array.from(a.values())},totalAbonado(){return this.deudasFiltradas.reduce((a,t)=>a+t.totalAbonado,0)},totalPendiente(){return this.deudasFiltradas.reduce((a,t)=>a+t.saldoPendiente,0)},totalAbonosHistorial(){return this.historialAbonos.reduce((a,t)=>a+t.monto,0)},historialCompletoFiltrado(){return this.historialCompleto.filter(a=>{if(this.filtroHistorialTipo){if("general"===this.filtroHistorialTipo&&"general"!==a.tipo)return!1;if("deuda"===this.filtroHistorialTipo&&"general"===a.tipo)return!1}return!this.filtroHistorialProveedor||a.proveedorId===this.filtroHistorialProveedor}).sort((a,t)=>new Date(t.fecha)-new Date(a.fecha))},totalHistorialCompleto(){return this.historialCompletoFiltrado.reduce((a,t)=>a+t.monto,0)},deudasParaAbono(){return this.abonoGeneral.proveedorId?this.deudas.filter(a=>a.proveedorId===this.abonoGeneral.proveedorId&&"pagado"!==a.estado&&a.saldoPendiente>0):this.deudas.filter(a=>"pagado"!==a.estado&&a.saldoPendiente>0)},saldoTotalParaAbono(){return this.deudasParaAbono.reduce((a,t)=>a+t.saldoPendiente,0)},distribucionPreview(){if(!this.abonoGeneral.monto||0===this.deudasParaAbono.length)return[];const a=[...this.deudasParaAbono].sort((a,t)=>new Date(a.fecha)-new Date(t.fecha));let t=this.abonoGeneral.monto;const e=[];for(const o of a){if(t<=0)break;const a=Math.min(t,o.saldoPendiente),s=o.saldoPendiente-a;e.push({deuda:o,montoAbono:a,saldoRestante:s}),t-=a}return e},totalDistribuidoPreview(){return this.distribucionPreview.reduce((a,t)=>a+t.montoAbono,0)},montoSobrantePreview(){return this.abonoGeneral.monto-this.totalDistribuidoPreview},deudasAgrupadasPorProveedor(){const a={};return this.deudasFiltradas.forEach(t=>{const e=t.proveedorId,o=t.nombreProveedor||"Proveedor sin nombre";a[e]||(a[e]={proveedor:{id:e,nombre:o,color:this.getProveedorColor(e)},deudas:[],totalDeuda:0,totalPendiente:0}),a[e].deudas.push(t),a[e].totalDeuda+=t.totalDeuda,a[e].totalPendiente+=t.saldoPendiente}),Object.values(a).sort((a,t)=>a.proveedor.nombre.localeCompare(t.proveedor.nombre))}},mounted(){const a=new URLSearchParams(window.location.search);this.barcoSeleccionado=a.get("barco")||localStorage.getItem("barcoSeleccionado")||"galileo",console.log("üö¢ Cargando deudas para:",this.nombreBarco),this.loadDeudas(),this.loadProveedores()},methods:{async loadDeudas(){try{const a=Object(r["o"])(Object(r["c"])(i["a"],"deudasBarcos"),Object(r["t"])("barco","==",this.barcoSeleccionado)),t=await Object(r["g"])(a);this.deudas=t.docs.map(a=>({id:a.id,...a.data()})).sort((a,t)=>new Date(t.fecha)-new Date(a.fecha)),console.log(`‚úÖ ${this.deudas.length} deudas cargadas para ${this.nombreBarco}`)}catch(a){console.error("‚ùå Error al cargar deudas:",a),alert("Error al cargar las deudas: "+a.message)}},async loadProveedores(){try{const a=await Object(r["g"])(Object(r["c"])(i["a"],"proveedoresBarcos"));this.proveedores=a.docs.map(a=>({id:a.id,...a.data()}))}catch(a){console.error("Error al cargar proveedores:",a)}},getProveedorColor(a){const t=this.proveedores.find(t=>t.id===a);return(null===t||void 0===t?void 0:t.color)||"#6c757d"},formatNumber(a){return new Intl.NumberFormat("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a||0)},formatDate(a){if(!a)return"";const t=new Date(a+"T00:00:00"),e={year:"numeric",month:"long",day:"numeric"};return t.toLocaleDateString("es-ES",e)},getEstadoLabel(a){const t={pendiente:"Pendiente",pagado:"Pagado",parcial:"Pago Parcial"};return t[a]||a},crearNuevaDeuda(){this.$router.push("/barcos/deudas/nueva?barco="+this.barcoSeleccionado)},limpiarFiltros(){this.filtroEstado="",this.filtroProveedor="",this.filtroFechaInicio="",this.filtroFechaFin=""},filtrarPorProveedor(a){this.filtroProveedor===a?this.filtroProveedor="":this.filtroProveedor=a,window.scrollTo({top:0,behavior:"smooth"})},abrirModalAbono(a){this.deudaSeleccionada=a,this.nuevoAbono={monto:null,descripcion:"",fecha:(new Date).toISOString().split("T")[0]},this.showModalAbono=!0},async guardarAbono(){if(!this.nuevoAbono.monto||this.nuevoAbono.monto<=0)alert("Por favor ingrese un monto v√°lido");else if(this.nuevoAbono.monto>this.deudaSeleccionada.saldoPendiente)alert("El monto del abono no puede ser mayor al saldo pendiente");else try{await Object(r["b"])(Object(r["c"])(i["a"],"abonosBarcos"),{deudaId:this.deudaSeleccionada.id,barco:this.barcoSeleccionado,nombreBarco:this.nombreBarco,proveedorId:this.deudaSeleccionada.proveedorId,nombreProveedor:this.deudaSeleccionada.nombreProveedor,monto:this.nuevoAbono.monto,descripcion:this.nuevoAbono.descripcion||"Abono",fecha:this.nuevoAbono.fecha,createdAt:new Date});const a=this.deudaSeleccionada.totalAbonado+this.nuevoAbono.monto,t=this.deudaSeleccionada.totalDeuda-a,e=t<=0?"pagado":a>0?"parcial":"pendiente";await Object(r["s"])(Object(r["e"])(i["a"],"deudasBarcos",this.deudaSeleccionada.id),{totalAbonado:a,saldoPendiente:t,estado:e,updatedAt:new Date}),this.showModalAbono=!1,await this.loadDeudas(),alert("Abono registrado exitosamente")}catch(a){console.error("Error al guardar abono:",a),alert("Error al guardar el abono")}},async verDetalleDeuda(a){this.deudaSeleccionada=a;try{const t=Object(r["o"])(Object(r["c"])(i["a"],"abonosBarcos"),Object(r["t"])("deudaId","==",a.id)),e=await Object(r["g"])(t);this.historialAbonos=e.docs.map(a=>({id:a.id,...a.data()})).sort((a,t)=>new Date(t.fecha)-new Date(a.fecha)),this.showModalHistorial=!0}catch(t){console.error("Error al cargar detalle de la deuda:",t),alert("Error al cargar el detalle de la deuda")}},async eliminarDeuda(a){if(confirm("¬øEst√° seguro de eliminar esta deuda? Esta acci√≥n no se puede deshacer."))try{const t=Object(r["o"])(Object(r["c"])(i["a"],"abonosBarcos"),Object(r["t"])("deudaId","==",a.id)),e=await Object(r["g"])(t),o=e.docs.map(a=>Object(r["d"])(a.ref));await Promise.all(o),await Object(r["d"])(Object(r["e"])(i["a"],"deudasBarcos",a.id)),await this.loadDeudas(),alert("Deuda eliminada exitosamente")}catch(t){console.error("Error al eliminar deuda:",t),alert("Error al eliminar la deuda")}},abrirModalAbonoGeneral(){this.abonoGeneral={monto:null,descripcion:"",fecha:(new Date).toISOString().split("T")[0],proveedorId:""},this.showModalAbonoGeneral=!0},calcularDistribucion(){this.$nextTick(()=>{})},async guardarAbonoGeneral(){if(!this.abonoGeneral.monto||this.abonoGeneral.monto<=0)alert("Por favor ingrese un monto v√°lido");else if(this.abonoGeneral.descripcion.trim())try{var a;this.abonoGeneral.proveedorId&&(null===(a=this.proveedoresUnicos.find(a=>a.id===this.abonoGeneral.proveedorId))||void 0===a||a.nombre);this.abonoGeneral.proveedorId?await this.distribuirAbonoEnDeudas():await this.distribuirAbonoGeneralCompleto(),this.showModalAbonoGeneral=!1,alert("Abono general aplicado exitosamente a las deudas"),await this.loadDeudas()}catch(t){console.error("Error al aplicar abono general:",t),alert("Error al aplicar el abono general: "+t.message)}else alert("Por favor ingrese una descripci√≥n")},async distribuirAbonoEnDeudas(){const a=this.deudas.filter(a=>a.proveedorId===this.abonoGeneral.proveedorId&&"pagado"!==a.estado&&a.saldoPendiente>0);0!==a.length?await this.aplicarDistribucionAbono(a):alert("No hay deudas pendientes para este proveedor")},async distribuirAbonoGeneralCompleto(){const a=this.deudas.filter(a=>"pagado"!==a.estado&&a.saldoPendiente>0);0!==a.length?await this.aplicarDistribucionAbono(a):alert("No hay deudas pendientes en este barco")},async aplicarDistribucionAbono(a){var t;const e=[...a].sort((a,t)=>new Date(a.fecha)-new Date(t.fecha));let o=this.abonoGeneral.monto;const s=[];for(const i of e){if(o<=0)break;const a=Math.min(o,i.saldoPendiente),t=i.saldoPendiente-a;s.push({deuda:i,montoAbono:a,saldoRestante:t}),o-=a}this.abonoGeneral.proveedorId&&(null===(t=this.proveedoresUnicos.find(a=>a.id===this.abonoGeneral.proveedorId))||void 0===t||t.nombre);for(const n of s)if(n.montoAbono>0){await Object(r["b"])(Object(r["c"])(i["a"],"abonosBarcos"),{deudaId:n.deuda.id,barco:this.barcoSeleccionado,nombreBarco:this.nombreBarco,proveedorId:n.deuda.proveedorId,nombreProveedor:n.deuda.nombreProveedor,monto:n.montoAbono,descripcion:this.abonoGeneral.descripcion+" (Abono General Distribuido)",fecha:this.abonoGeneral.fecha,tipo:"deuda",createdAt:new Date});const a=n.deuda.totalAbonado+n.montoAbono,t=n.saldoRestante,e=t<=0?"pagado":a>0?"parcial":"pendiente";await Object(r["s"])(Object(r["e"])(i["a"],"deudasBarcos",n.deuda.id),{totalAbonado:a,saldoPendiente:t,estado:e,updatedAt:new Date})}if(o>0&&s.length>0){const a=s[0].deuda;await Object(r["b"])(Object(r["c"])(i["a"],"abonosBarcos"),{deudaId:a.id,barco:this.barcoSeleccionado,nombreBarco:this.nombreBarco,proveedorId:a.proveedorId,nombreProveedor:a.nombreProveedor,monto:o,descripcion:this.abonoGeneral.descripcion+" (Sobrante del Abono General)",fecha:this.abonoGeneral.fecha,tipo:"deuda",createdAt:new Date});const t=Math.max(0,s[0].saldoRestante-o);await Object(r["s"])(Object(r["e"])(i["a"],"deudasBarcos",a.id),{totalAbonado:a.totalAbonado+s[0].montoAbono+o,saldoPendiente:t,estado:t<=0?"pagado":"parcial",updatedAt:new Date})}console.log(`üí∞ Abono general de $${this.formatNumber(this.abonoGeneral.monto)} distribuido entre ${s.length} deudas`)},async verHistorialCompleto(){try{await this.loadHistorialCompleto(),this.filtroHistorialTipo="",this.filtroHistorialProveedor="",this.showModalHistorialCompleto=!0}catch(a){console.error("Error al cargar historial completo:",a),alert("Error al cargar el historial completo")}},async loadHistorialCompleto(){try{const a=Object(r["o"])(Object(r["c"])(i["a"],"abonosBarcos"),Object(r["t"])("barco","==",this.barcoSeleccionado)),t=await Object(r["g"])(a);this.historialCompleto=t.docs.map(a=>({id:a.id,...a.data(),tipo:a.data().tipo||"deuda"})).sort((a,t)=>new Date(t.fecha)-new Date(a.fecha))}catch(a){console.error("Error al cargar historial completo:",a)}},async eliminarAbono(a,t){if(confirm("¬øEst√° seguro de eliminar este abono? Esta acci√≥n actualizar√° el saldo de la deuda."))try{await Object(r["d"])(Object(r["e"])(i["a"],"abonosBarcos",a.id)),this.historialAbonos.splice(t,1);const e=this.historialAbonos.reduce((a,t)=>a+t.monto,0),o=this.deudaSeleccionada.totalDeuda-e,s=o<=0?"pagado":e>0?"parcial":"pendiente";await Object(r["s"])(Object(r["e"])(i["a"],"deudasBarcos",this.deudaSeleccionada.id),{totalAbonado:e,saldoPendiente:o,estado:s,updatedAt:new Date}),this.deudaSeleccionada.totalAbonado=e,this.deudaSeleccionada.saldoPendiente=o,this.deudaSeleccionada.estado=s;const n=this.deudas.findIndex(a=>a.id===this.deudaSeleccionada.id);-1!==n&&(this.deudas[n]={...this.deudas[n],totalAbonado:e,saldoPendiente:o,estado:s}),console.log("‚úÖ Abono eliminado y deuda actualizada")}catch(e){console.error("Error al eliminar abono:",e),alert("Error al eliminar el abono: "+e.message)}finally{await this.loadDeudas()}},async eliminarAbonoCompleto(a,t){if(confirm("¬øEst√° seguro de eliminar este abono? Esta acci√≥n actualizar√° el saldo de la deuda correspondiente."))try{if(await Object(r["d"])(Object(r["e"])(i["a"],"abonosBarcos",a.id)),this.historialCompleto.splice(this.historialCompleto.findIndex(t=>t.id===a.id),1),a.deudaId){const t=Object(r["o"])(Object(r["c"])(i["a"],"abonosBarcos"),Object(r["t"])("deudaId","==",a.deudaId)),e=await Object(r["g"])(t),o=e.docs.map(a=>a.data()),s=o.reduce((a,t)=>a+t.monto,0),n=this.deudas.find(t=>t.id===a.deudaId);if(n){const t=n.totalDeuda-s,e=t<=0?"pagado":s>0?"parcial":"pendiente";await Object(r["s"])(Object(r["e"])(i["a"],"deudasBarcos",a.deudaId),{totalAbonado:s,saldoPendiente:t,estado:e,updatedAt:new Date});const o=this.deudas.findIndex(t=>t.id===a.deudaId);-1!==o&&(this.deudas[o]={...this.deudas[o],totalAbonado:s,saldoPendiente:t,estado:e})}}console.log("‚úÖ Abono eliminado del historial completo")}catch(e){console.error("Error al eliminar abono:",e),alert("Error al eliminar el abono: "+e.message)}finally{await this.loadDeudas()}},closeModalOnOverlay(a){a.target.classList.contains("modal-overlay")&&(this.showModalAbono=!1,this.showModalHistorial=!1,this.showModalAbonoGeneral=!1,this.showModalHistorialCompleto=!1)}}},d=l,u=(e("da50"),e("2877")),v=Object(u["a"])(d,o,s,!1,null,"6a587242",null);t["a"]=v.exports},7730:function(a,t,e){},"9c33":function(a,t,e){"use strict";var o=function(){var a=this,t=a._self._c;return t("div",{staticClass:"nueva-deuda-barco"},[t("div",{staticClass:"back-button-container"},[t("BackButton",{attrs:{to:"/barcos"}})],1),t("div",{staticClass:"header-section",style:{background:a.gradientePrimario}},[t("div",{staticClass:"header-content"},[t("h1",{staticClass:"main-title"},[t("i",{staticClass:"icon-new"},[a._v("‚ûï")]),a._v(" Nueva Deuda - "+a._s(a.nombreBarco)+" ")]),t("p",{staticClass:"subtitle"},[a._v("Registra una nueva deuda para el barco "+a._s(a.nombreBarco))])])]),t("div",{staticClass:"barco-info-card",style:{background:a.gradientePrimario}},[t("div",{staticClass:"barco-display"},[t("i",{staticClass:"barco-icon"},[a._v(a._s("galileo"===a.barcoSeleccionado?"üö¢":"üõ•Ô∏è"))]),t("div",{staticClass:"barco-details"},[t("h3",[a._v(a._s(a.nombreBarco))]),t("p",[a._v("Barco seleccionado")])])])]),t("div",{staticClass:"fecha-card"},[a._m(0),t("div",{staticClass:"fecha-container"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.fechaSeleccionada,expression:"fechaSeleccionada"}],staticClass:"modern-input",attrs:{type:"date"},domProps:{value:a.fechaSeleccionada},on:{input:function(t){t.target.composing||(a.fechaSeleccionada=t.target.value)}}}),t("span",{staticClass:"fecha-display"},[a._v(a._s(a.fechaFormateada))])])]),t("div",{staticClass:"proveedor-card"},[a._m(1),t("select",{directives:[{name:"model",rawName:"v-model",value:a.proveedorSeleccionado,expression:"proveedorSeleccionado"}],staticClass:"modern-select",attrs:{required:""},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.proveedorSeleccionado=t.target.multiple?e:e[0]}}},[t("option",{attrs:{value:"",disabled:""}},[a._v("Seleccione un proveedor")]),a._l(a.proveedores,(function(e){return t("option",{key:e.id,domProps:{value:e.id}},[a._v(" "+a._s(e.nombre)+" "+a._s(e.tipo?"- "+e.tipo:"")+" ")])}))],2),a.proveedorSeleccionado&&a.getNombreProveedor()?t("div",{staticClass:"proveedor-selected-info"},[t("div",{staticClass:"proveedor-color-display"},[t("div",{staticClass:"color-indicator-large",style:{backgroundColor:a.getProveedorColor(a.proveedorSeleccionado)}}),t("div",{staticClass:"proveedor-details"},[t("span",{staticClass:"proveedor-nombre"},[a._v(a._s(a.getNombreProveedor()))]),a.getProveedorTipo()?t("span",{staticClass:"proveedor-tipo"},[a._v(a._s(a.getProveedorTipo()))]):a._e(),t("span",{staticClass:"proveedor-label"},[a._v("Proveedor seleccionado")])])])]):a._e()]),a.proveedorSeleccionado?t("div",{staticClass:"productos-card"},[a._m(2),t("form",{staticClass:"add-item-form",on:{submit:function(t){return t.preventDefault(),a.addItem.apply(null,arguments)}}},[t("div",{staticClass:"form-grid"},[t("div",{staticClass:"form-group"},[a._m(3),t("input",{directives:[{name:"model",rawName:"v-model",value:a.nuevoItem.descripcion,expression:"nuevoItem.descripcion"}],staticClass:"modern-input",attrs:{type:"text",required:"",placeholder:"Ej: Combustible Diesel, Aceite de motor, etc."},domProps:{value:a.nuevoItem.descripcion},on:{input:function(t){t.target.composing||a.$set(a.nuevoItem,"descripcion",t.target.value)}}})]),t("div",{staticClass:"form-group"},[a._m(4),t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.nuevoItem.cantidad,expression:"nuevoItem.cantidad",modifiers:{number:!0}}],staticClass:"modern-input",attrs:{type:"number",step:"0.01",required:"",placeholder:"1"},domProps:{value:a.nuevoItem.cantidad},on:{input:[function(t){t.target.composing||a.$set(a.nuevoItem,"cantidad",a._n(t.target.value))},a.calcularTotal],blur:function(t){return a.$forceUpdate()}}})]),t("div",{staticClass:"form-group"},[a._m(5),t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.nuevoItem.precioUnitario,expression:"nuevoItem.precioUnitario",modifiers:{number:!0}}],staticClass:"modern-input",attrs:{type:"number",step:"0.01",required:"",placeholder:"0.00"},domProps:{value:a.nuevoItem.precioUnitario},on:{input:[function(t){t.target.composing||a.$set(a.nuevoItem,"precioUnitario",a._n(t.target.value))},a.calcularTotal],blur:function(t){return a.$forceUpdate()}}})]),t("div",{staticClass:"form-group"},[a._m(6),t("input",{staticClass:"modern-input readonly-input",attrs:{type:"text",readonly:""},domProps:{value:a.formatNumber(a.nuevoItem.total||0)}})])]),a._m(7)])]):a._e(),a.items.length>0?t("div",{staticClass:"tabla-container"},[a._m(8),t("div",{staticClass:"tabla-wrapper"},[t("table",{staticClass:"tabla-items"},[a._m(9),t("tbody",a._l(a.items,(function(e,o){return t("tr",{key:o},[t("td",{staticClass:"editable",on:{click:function(t){return a.editarItem(o,"descripcion")}}},[e.editando&&"descripcion"===e.campoEditando?t("input",{directives:[{name:"model",rawName:"v-model",value:e.descripcion,expression:"item.descripcion"}],staticClass:"table-input",attrs:{type:"text"},domProps:{value:e.descripcion},on:{blur:function(t){return a.finalizarEdicion(o)},keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.finalizarEdicion(o)},input:function(t){t.target.composing||a.$set(e,"descripcion",t.target.value)}}}):t("span",[a._v(a._s(e.descripcion))])]),t("td",{staticClass:"editable",on:{click:function(t){return a.editarItem(o,"cantidad")}}},[e.editando&&"cantidad"===e.campoEditando?t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.cantidad,expression:"item.cantidad",modifiers:{number:!0}}],staticClass:"table-input",attrs:{type:"number"},domProps:{value:e.cantidad},on:{blur:[function(t){return a.finalizarEdicion(o)},function(t){return a.$forceUpdate()}],keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.recalcularTotal(o)},input:function(t){t.target.composing||a.$set(e,"cantidad",a._n(t.target.value))}}}):t("span",[a._v(a._s(a.formatNumber(e.cantidad)))])]),t("td",{staticClass:"editable",on:{click:function(t){return a.editarItem(o,"precioUnitario")}}},[e.editando&&"precioUnitario"===e.campoEditando?t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.precioUnitario,expression:"item.precioUnitario",modifiers:{number:!0}}],staticClass:"table-input",attrs:{type:"number"},domProps:{value:e.precioUnitario},on:{blur:[function(t){return a.finalizarEdicion(o)},function(t){return a.$forceUpdate()}],keyup:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:a.recalcularTotal(o)},input:function(t){t.target.composing||a.$set(e,"precioUnitario",a._n(t.target.value))}}}):t("span",[a._v("$"+a._s(a.formatNumber(e.precioUnitario)))])]),t("td",{staticClass:"total-cell"},[a._v("$"+a._s(a.formatNumber(e.total)))]),t("td",{staticClass:"action-column"},[t("button",{staticClass:"btn-delete",on:{click:function(t){return a.removeItem(o)}}},[t("i",{staticClass:"icon-trash"},[a._v("üóëÔ∏è")])])])])})),0),t("tfoot",[t("tr",{staticClass:"total-row"},[t("td",{staticClass:"total-label",attrs:{colspan:"3"}},[a._v("Total General")]),t("td",{staticClass:"total-amount"},[a._v("$"+a._s(a.formatNumber(a.totalGeneral)))]),t("td")])])])])]):a._e(),a.items.length>0?t("div",{staticClass:"abonos-section"},[t("h2",[a._v("Abonos Iniciales (Opcional)")]),t("div",{staticClass:"abonos"},[a._l(a.abonos,(function(e,o){return t("div",{key:o,staticClass:"abono-row"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.descripcion,expression:"abono.descripcion"}],staticClass:"modern-input",attrs:{type:"text",placeholder:"Descripci√≥n del abono"},domProps:{value:e.descripcion},on:{input:function(t){t.target.composing||a.$set(e,"descripcion",t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model.number",value:e.monto,expression:"abono.monto",modifiers:{number:!0}}],staticClass:"modern-input",attrs:{type:"number",placeholder:"Monto"},domProps:{value:e.monto},on:{input:function(t){t.target.composing||a.$set(e,"monto",a._n(t.target.value))},blur:function(t){return a.$forceUpdate()}}}),t("button",{staticClass:"delete-btn",on:{click:function(t){return a.removeAbono(o)}}},[t("i",{staticClass:"icon-trash"},[a._v("üóëÔ∏è")])])])})),t("button",{staticClass:"add-abono-btn",on:{click:a.addAbono}},[t("i",{staticClass:"btn-icon"},[a._v("‚ûï")]),a._v(" Agregar Abono ")])],2),t("div",{staticClass:"resumen"},[t("h3",[a._v("Resumen")]),t("div",{staticClass:"resumen-item"},[t("span",[a._v("Total deuda:")]),t("span",[a._v("$"+a._s(a.formatNumber(a.totalGeneral)))])]),t("div",{staticClass:"resumen-item"},[t("span",[a._v("Total abonos:")]),t("span",[a._v("$"+a._s(a.formatNumber(a.totalAbonos)))])]),t("div",{staticClass:"resumen-item total"},[t("span",[a._v("Saldo pendiente:")]),t("span",[a._v("$"+a._s(a.formatNumber(a.saldoPendiente)))])])])]):a._e(),a.proveedorSeleccionado&&a.items.length>0?t("div",{staticClass:"button-container"},[t("button",{staticClass:"save-button",attrs:{disabled:a.guardando},on:{click:a.guardarDeuda}},[a._v(" "+a._s(a.guardando?"Guardando...":"Guardar Deuda")+" ")])]):a._e()])},s=[function(){var a=this,t=a._self._c;return t("h3",{staticClass:"section-title"},[t("i",{staticClass:"icon-calendar"},[a._v("üìÖ")]),a._v(" Fecha de la Deuda ")])},function(){var a=this,t=a._self._c;return t("h3",{staticClass:"section-title"},[t("i",{staticClass:"icon-supplier"},[a._v("üè≠")]),a._v(" Seleccionar Proveedor ")])},function(){var a=this,t=a._self._c;return t("h3",{staticClass:"section-title"},[t("i",{staticClass:"icon-products"},[a._v("üì¶")]),a._v(" Agregar Productos o Servicios ")])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"modern-label"},[t("i",{staticClass:"label-icon"},[a._v("üìù")]),a._v(" Descripci√≥n ")])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"modern-label"},[t("i",{staticClass:"label-icon"},[a._v("üî¢")]),a._v(" Cantidad ")])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"modern-label"},[t("i",{staticClass:"label-icon"},[a._v("üí∞")]),a._v(" Precio Unitario ")])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"modern-label"},[t("i",{staticClass:"label-icon"},[a._v("üßÆ")]),a._v(" Total Calculado ")])},function(){var a=this,t=a._self._c;return t("button",{staticClass:"add-item-button",attrs:{type:"submit"}},[t("i",{staticClass:"btn-icon"},[a._v("‚ûï")]),a._v(" Agregar ")])},function(){var a=this,t=a._self._c;return t("h3",{staticClass:"section-title"},[t("i",{staticClass:"icon-list"},[a._v("üìã")]),a._v(" Items Agregados ")])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Descripci√≥n")]),t("th",[a._v("Cantidad")]),t("th",[a._v("Precio Unit.")]),t("th",[a._v("Total")]),t("th",[a._v("Acciones")])])])}],i=(e("14d9"),e("13d5"),e("88a7"),e("271a"),e("5494"),e("dc59")),r=e("1494"),n=e("74c9"),c={name:"NuevaDeudaBarco",components:{BackButton:n["a"]},data(){return{barcoSeleccionado:"",fechaSeleccionada:(new Date).toISOString().split("T")[0],proveedorSeleccionado:"",proveedores:[],nuevoItem:{descripcion:"",cantidad:1,precioUnitario:null,total:0},items:[],abonos:[],guardando:!1}},computed:{colorPrimario(){return"maria-guadalupe"===this.barcoSeleccionado?"#27ae60":"#3498db"},colorSecundario(){return"maria-guadalupe"===this.barcoSeleccionado?"#2ecc71":"#2980b9"},gradientePrimario(){return"maria-guadalupe"===this.barcoSeleccionado?"linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)":"linear-gradient(135deg, #3498db 0%, #2980b9 100%)"},nombreBarco(){return"galileo"===this.barcoSeleccionado?"El Galileo":"Mar√≠a Guadalupe"},fechaFormateada(){if(!this.fechaSeleccionada)return"";const a=new Date(this.fechaSeleccionada+"T00:00:00"),t={year:"numeric",month:"long",day:"numeric"};return a.toLocaleDateString("es-ES",t)},totalGeneral(){return this.items.reduce((a,t)=>a+(parseFloat(t.total)||0),0)},totalAbonos(){return this.abonos.reduce((a,t)=>a+(parseFloat(t.monto)||0),0)},saldoPendiente(){return this.totalGeneral-this.totalAbonos}},mounted(){const a=new URLSearchParams(window.location.search);this.barcoSeleccionado=a.get("barco")||localStorage.getItem("barcoSeleccionado")||"galileo",this.loadProveedores()},methods:{async loadProveedores(){try{const a=Object(r["o"])(Object(r["c"])(i["a"],"proveedoresBarcos"),Object(r["l"])("nombre")),t=await Object(r["g"])(a);this.proveedores=t.docs.map(a=>({id:a.id,...a.data()}))}catch(a){console.error("Error al cargar proveedores:",a)}},getNombreProveedor(){const a=this.proveedores.find(a=>a.id===this.proveedorSeleccionado);return a?a.nombre:""},getProveedorColor(a){const t=this.proveedores.find(t=>t.id===a);return(null===t||void 0===t?void 0:t.color)||"#6c757d"},getProveedorTipo(){const a=this.proveedores.find(a=>a.id===this.proveedorSeleccionado);return(null===a||void 0===a?void 0:a.tipo)||""},calcularTotal(){const a=parseFloat(this.nuevoItem.cantidad)||0,t=parseFloat(this.nuevoItem.precioUnitario)||0;this.nuevoItem.total=a*t},addItem(){this.nuevoItem.descripcion&&this.nuevoItem.precioUnitario&&this.nuevoItem.cantidad?(this.calcularTotal(),this.items.push({descripcion:this.nuevoItem.descripcion,cantidad:parseFloat(this.nuevoItem.cantidad),precioUnitario:parseFloat(this.nuevoItem.precioUnitario),total:this.nuevoItem.total,editando:!1,campoEditando:null}),this.nuevoItem={descripcion:"",cantidad:1,precioUnitario:null,total:0}):alert("Por favor complete todos los campos obligatorios")},removeItem(a){this.items.splice(a,1)},editarItem(a,t){this.items[a].editando=!0,this.items[a].campoEditando=t},finalizarEdicion(a){const t=this.items[a];if("cantidad"===t.campoEditando||"precioUnitario"===t.campoEditando){const a=parseFloat(t.cantidad)||0,e=parseFloat(t.precioUnitario)||0;t.total=a*e}t.editando=!1,t.campoEditando=null},recalcularTotal(a){const t=this.items[a],e=parseFloat(t.cantidad)||0,o=parseFloat(t.precioUnitario)||0;t.total=e*o,t.editando=!1,t.campoEditando=null},addAbono(){this.abonos.push({descripcion:"",monto:0})},removeAbono(a){this.abonos.splice(a,1)},formatNumber(a){return new Intl.NumberFormat("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a||0)},async guardarDeuda(){if(!this.guardando)if(console.log("üíæ Guardando deuda para:",this.nombreBarco),this.proveedorSeleccionado&&0!==this.items.length){this.guardando=!0;try{const a={barco:this.barcoSeleccionado,nombreBarco:this.nombreBarco,proveedorId:this.proveedorSeleccionado,nombreProveedor:this.getNombreProveedor(),fecha:this.fechaSeleccionada,items:this.items.map(a=>({descripcion:a.descripcion,cantidad:a.cantidad,precioUnitario:a.precioUnitario,total:a.total})),totalDeuda:this.totalGeneral,totalAbonado:this.totalAbonos,saldoPendiente:this.saldoPendiente,estado:"pendiente",createdAt:new Date,updatedAt:new Date},t=await Object(r["b"])(Object(r["c"])(i["a"],"deudasBarcos"),a);if(this.abonos.length>0)for(const e of this.abonos)e.monto>0&&await Object(r["b"])(Object(r["c"])(i["a"],"abonosBarcos"),{deudaId:t.id,barco:this.barcoSeleccionado,nombreBarco:this.nombreBarco,proveedorId:this.proveedorSeleccionado,nombreProveedor:this.getNombreProveedor(),descripcion:e.descripcion||"Abono inicial",monto:e.monto,fecha:this.fechaSeleccionada,createdAt:new Date});console.log("‚úÖ Deuda guardada exitosamente para "+this.nombreBarco),alert("Deuda guardada exitosamente"),this.$router.push("/barcos/deudas/lista?barco="+this.barcoSeleccionado)}catch(a){console.error("Error al guardar deuda:",a),alert("Error al guardar la deuda")}finally{this.guardando=!1}}else alert("Por favor seleccione un proveedor y agregue al menos un item")}}},l=c,d=(e("a0f5"),e("2877")),u=Object(d["a"])(l,o,s,!1,null,"05c711ea",null);t["a"]=u.exports},a0f5:function(a,t,e){"use strict";e("db4a")},abba:function(a,t,e){},ae0d:function(a,t,e){"use strict";e("608e")},aee6:function(a,t,e){"use strict";e("7730")},da50:function(a,t,e){"use strict";e("abba")},db4a:function(a,t,e){},f40d:function(a,t,e){"use strict";var o=function(){var a=this,t=a._self._c;return t("div",{staticClass:"barcos-menu"},[t("div",{staticClass:"back-button-container"},[t("BackButton",{attrs:{to:"/procesos"}})],1),a._m(0),t("div",{staticClass:"menu-options",class:{disabled:!a.barcoSeleccionado}},[a.barcoSeleccionado?a._e():t("div",{staticClass:"selection-hint"},[t("i",{staticClass:"hint-icon"},[a._v("üëá")]),t("p",[a._v("Selecciona un barco para activar las opciones")])]),t("router-link",{class:["btn-action","btn-lista",a.barcoSeleccionado?"barco-theme-"+a.barcoSeleccionado:""],attrs:{to:a.barcoSeleccionado?"/barcos/deudas/lista?barco="+a.barcoSeleccionado:"#","aria-label":a.barcoSeleccionado?"Ver lista de deudas del barco":"Selecciona un barco primero"},on:{click:function(t){!a.barcoSeleccionado&&t.preventDefault()}}},[t("i",{staticClass:"icon"},[a._v("üìã")]),t("span",[a._v("Lista de Deudas")])]),t("router-link",{class:["btn-action","btn-nueva",a.barcoSeleccionado?"barco-theme-"+a.barcoSeleccionado:""],attrs:{to:a.barcoSeleccionado?"/barcos/deudas/nueva?barco="+a.barcoSeleccionado:"#","aria-label":a.barcoSeleccionado?"Crear nueva deuda para el barco":"Selecciona un barco primero"},on:{click:function(t){!a.barcoSeleccionado&&t.preventDefault()}}},[t("i",{staticClass:"icon"},[a._v("‚ûï")]),t("span",[a._v("Nueva Deuda")])]),t("router-link",{class:["btn-action","btn-reporte",a.barcoSeleccionado?"barco-theme-"+a.barcoSeleccionado:""],attrs:{to:"/barcos/resumen-mensual","aria-label":"Ver reporte mensual de barcos"}},[t("i",{staticClass:"icon"},[a._v("üìä")]),t("span",[a._v("Reporte Mensual")])]),t("router-link",{class:["btn-action","btn-tripulantes",a.barcoSeleccionado?"barco-theme-"+a.barcoSeleccionado:""],attrs:{to:a.barcoSeleccionado?"/barcos/tripulantes?barco="+a.barcoSeleccionado:"#","aria-label":a.barcoSeleccionado?"Gestionar tripulantes del barco":"Selecciona un barco primero"},on:{click:function(t){!a.barcoSeleccionado&&t.preventDefault()}}},[t("i",{staticClass:"icon"},[a._v("üë•")]),t("span",[a._v("Gesti√≥n de Tripulantes")])]),t("button",{class:["btn-action","btn-config",a.barcoSeleccionado?"barco-theme-"+a.barcoSeleccionado:""],attrs:{"aria-label":a.barcoSeleccionado?"Configurar proveedores de barcos":"Selecciona un barco primero"},on:{click:function(t){a.barcoSeleccionado&&a.openProveedoresModal()}}},[t("i",{staticClass:"icon"},[a._v("‚öôÔ∏è")]),t("span",[a._v("Configurar Proveedores")])])],1),t("div",{staticClass:"barco-selector-card"},[a._m(1),t("div",{staticClass:"barcos-buttons"},[t("button",{class:["barco-btn","barco-galileo",{active:"galileo"===a.barcoSeleccionado}],on:{click:function(t){return a.seleccionarBarco("galileo")}}},[t("i",{staticClass:"barco-icon"},[a._v("üö¢")]),t("span",[a._v("El Galileo")])]),t("button",{class:["barco-btn","barco-maria-guadalupe",{active:"maria-guadalupe"===a.barcoSeleccionado}],on:{click:function(t){return a.seleccionarBarco("maria-guadalupe")}}},[t("i",{staticClass:"barco-icon"},[a._v("üõ•Ô∏è")]),t("span",[a._v("Mar√≠a Guadalupe")])])])]),a.showModal?t("div",{staticClass:"modal-overlay",on:{click:a.closeModalOnOverlay}},[t("div",{staticClass:"modal-content modern-modal",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header modern-header"},[a._m(2),a._m(3),t("button",{staticClass:"close-button modern-close",on:{click:function(t){a.showModal=!1}}},[t("i",{staticClass:"fas fa-times"},[a._v("‚úï")])])]),t("div",{staticClass:"modal-body modern-body"},[t("div",{staticClass:"add-proveedor-section"},[a._m(4),t("form",{staticClass:"modern-form",on:{submit:function(t){return t.preventDefault(),a.addProveedor.apply(null,arguments)}}},[t("div",{staticClass:"form-grid"},[t("div",{staticClass:"form-group modern-group"},[a._m(5),t("input",{directives:[{name:"model",rawName:"v-model",value:a.newProveedor.nombre,expression:"newProveedor.nombre"}],staticClass:"modern-input",attrs:{id:"nombre",required:"",placeholder:"Ingrese el nombre del proveedor"},domProps:{value:a.newProveedor.nombre},on:{input:function(t){t.target.composing||a.$set(a.newProveedor,"nombre",t.target.value)}}})]),t("div",{staticClass:"form-group modern-group"},[a._m(6),t("input",{directives:[{name:"model",rawName:"v-model",value:a.newProveedor.telefono,expression:"newProveedor.telefono"}],staticClass:"modern-input",attrs:{id:"telefono",placeholder:"Ingrese el tel√©fono"},domProps:{value:a.newProveedor.telefono},on:{input:function(t){t.target.composing||a.$set(a.newProveedor,"telefono",t.target.value)}}})]),t("div",{staticClass:"form-group modern-group"},[a._m(7),t("input",{directives:[{name:"model",rawName:"v-model",value:a.newProveedor.tipo,expression:"newProveedor.tipo"}],staticClass:"modern-input",attrs:{id:"tipo",placeholder:"Ej: Combustible, Refacciones, etc."},domProps:{value:a.newProveedor.tipo},on:{input:function(t){t.target.composing||a.$set(a.newProveedor,"tipo",t.target.value)}}})])]),t("div",{staticClass:"color-selection"},[a._m(8),t("div",{staticClass:"color-options"},a._l(a.availableColors,(function(e){return t("button",{key:e,class:["color-option",{selected:a.newProveedor.color===e}],style:{backgroundColor:e},attrs:{type:"button"},on:{click:function(t){a.newProveedor.color=e}}},[a.newProveedor.color===e?t("span",{staticClass:"checkmark"},[a._v("‚úì")]):a._e()])})),0)]),a._m(9)])]),t("div",{staticClass:"proveedores-list"},[a._m(10),t("div",{staticClass:"proveedores-grid"},a._l(a.proveedores,(function(e){return t("div",{key:e.id,staticClass:"proveedor-card modern-card"},[t("div",{staticClass:"proveedor-header"},[t("div",{staticClass:"color-indicator",style:{backgroundColor:e.color||"#6c757d"}}),t("div",{staticClass:"proveedor-info"},[t("h4",[a._v(a._s(e.nombre))]),e.telefono?t("p",{staticClass:"telefono"},[t("i",{staticClass:"info-icon"},[a._v("üìû")]),a._v(" "+a._s(e.telefono)+" ")]):a._e(),e.tipo?t("p",{staticClass:"tipo"},[t("i",{staticClass:"info-icon"},[a._v("üè∑Ô∏è")]),a._v(" "+a._s(e.tipo)+" ")]):a._e()])]),t("button",{staticClass:"delete-button modern-delete",attrs:{title:"Eliminar "+e.nombre},on:{click:function(t){return a.deleteProveedor(e.id)}}},[t("i",{staticClass:"delete-icon"},[a._v("üóëÔ∏è")])])])})),0)])])])]):a._e(),t("BotonReporteMensual")],1)},s=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"header-section"},[t("div",{staticClass:"header-content"},[t("h1",{staticClass:"main-title"},[t("i",{staticClass:"icon-boat"},[a._v("‚õµ")]),a._v(" Gesti√≥n de Barcos ")]),t("p",{staticClass:"subtitle"},[a._v("Administra las deudas y gastos de El Galileo y Mar√≠a Guadalupe")])])])},function(){var a=this,t=a._self._c;return t("h3",{staticClass:"section-title"},[t("i",{staticClass:"icon-anchor"},[a._v("‚öì")]),a._v(" Seleccionar Barco ")])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"header-icon"},[t("i",{staticClass:"icon-config"},[a._v("‚öôÔ∏è")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"header-text"},[t("h2",[a._v("Gestionar Proveedores de Barcos")]),t("p",[a._v("Administra los proveedores para los barcos")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-header"},[t("i",{staticClass:"section-icon"},[a._v("‚ûï")]),t("h3",[a._v("Agregar Nuevo Proveedor")])])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"modern-label",attrs:{for:"nombre"}},[t("i",{staticClass:"label-icon"},[a._v("üë§")]),a._v(" Nombre del Proveedor ")])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"modern-label",attrs:{for:"telefono"}},[t("i",{staticClass:"label-icon"},[a._v("üìû")]),a._v(" Tel√©fono (opcional) ")])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"modern-label",attrs:{for:"tipo"}},[t("i",{staticClass:"label-icon"},[a._v("üè∑Ô∏è")]),a._v(" Tipo de Servicio ")])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"modern-label"},[t("i",{staticClass:"label-icon"},[a._v("üé®")]),a._v(" Color de Identificaci√≥n ")])},function(){var a=this,t=a._self._c;return t("button",{staticClass:"submit-button modern-submit",attrs:{type:"submit"}},[t("i",{staticClass:"btn-icon"},[a._v("‚ûï")]),a._v(" Agregar Proveedor ")])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-header"},[t("i",{staticClass:"section-icon"},[a._v("üìã")]),t("h3",[a._v("Proveedores Registrados")])])}],i=e("dc59"),r=e("1494"),n=e("74c9"),c=e("232e"),l={name:"BarcosMenu",components:{BackButton:n["a"],BotonReporteMensual:c["a"]},data(){return{barcoSeleccionado:localStorage.getItem("barcoSeleccionado")||"",showModal:!1,proveedores:[],newProveedor:{nombre:"",telefono:"",tipo:"",color:"#6c757d"},availableColors:["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FECA57","#FF9FF3","#54A0FF","#48DBFB","#F368E0","#FD79A8","#A29BFE","#6C5CE7","#00B894","#FDCB6E","#E17055","#FA8072","#DDA0DD","#98D8C8","#F7DC6F","#85C1E2"]}},computed:{colorPrimario(){return"maria-guadalupe"===this.barcoSeleccionado?"#27ae60":"#3498db"},colorSecundario(){return"maria-guadalupe"===this.barcoSeleccionado?"#2ecc71":"#2980b9"},colorHover(){return"maria-guadalupe"===this.barcoSeleccionado?"rgba(39, 174, 96, 0.2)":"rgba(52, 152, 219, 0.2)"},gradientePrimario(){return"maria-guadalupe"===this.barcoSeleccionado?"linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)":"linear-gradient(135deg, #3498db 0%, #2980b9 100%)"}},mounted(){this.loadProveedores()},methods:{seleccionarBarco(a){this.barcoSeleccionado=a,localStorage.setItem("barcoSeleccionado",a)},openProveedoresModal(){this.showModal=!0,this.loadProveedores()},closeModalOnOverlay(a){a.target.classList.contains("modal-overlay")&&(this.showModal=!1)},async loadProveedores(){try{const a=Object(r["o"])(Object(r["c"])(i["a"],"proveedoresBarcos"),Object(r["l"])("nombre")),t=await Object(r["g"])(a);this.proveedores=t.docs.map(a=>({id:a.id,...a.data()}))}catch(a){console.error("Error al cargar proveedores:",a),alert("Error al cargar proveedores")}},async addProveedor(){if(this.newProveedor.nombre.trim())try{await Object(r["b"])(Object(r["c"])(i["a"],"proveedoresBarcos"),{nombre:this.newProveedor.nombre.trim(),telefono:this.newProveedor.telefono.trim(),tipo:this.newProveedor.tipo.trim(),color:this.newProveedor.color,createdAt:new Date}),this.newProveedor={nombre:"",telefono:"",tipo:"",color:"#6c757d"},await this.loadProveedores(),alert("Proveedor agregado exitosamente")}catch(a){console.error("Error al agregar proveedor:",a),alert("Error al agregar proveedor")}else alert("Por favor ingrese el nombre del proveedor")},async deleteProveedor(a){if(confirm("¬øEst√° seguro de eliminar este proveedor?"))try{await Object(r["d"])(Object(r["e"])(i["a"],"proveedoresBarcos",a)),await this.loadProveedores(),alert("Proveedor eliminado exitosamente")}catch(t){console.error("Error al eliminar proveedor:",t),alert("Error al eliminar proveedor")}}}},d=l,u=(e("aee6"),e("2877")),v=Object(u["a"])(d,o,s,!1,null,"1635f580",null);t["a"]=v.exports},f957:function(a,t,e){"use strict";var o=function(){var a,t=this,e=t._self._c;return e("div",{staticClass:"gestion-tripulantes"},[e("div",{staticClass:"back-button-container"},[e("BackButton",{attrs:{to:"/barcos?barco="+t.barcoSeleccionado}})],1),e("div",{staticClass:"header-section",style:{background:t.gradientePrimario}},[e("div",{staticClass:"header-content"},[t._m(0),e("p",{staticClass:"subtitle"},[t._v(t._s(t.nombreBarco)+" - Administra la tripulaci√≥n y sus pr√©stamos")])])]),e("div",{staticClass:"barco-info-card"},[e("div",{staticClass:"barco-header"},[e("i",{staticClass:"barco-icon"},[t._v(t._s("galileo"===t.barcoSeleccionado?"üö¢":"üõ•Ô∏è"))]),e("div",{staticClass:"barco-details"},[e("h3",[t._v(t._s(t.nombreBarco))]),e("p",[t._v(t._s(t.tripulantes.length)+" tripulante(s) registrado(s)")])])])]),e("div",{staticClass:"acciones-principales"},[e("button",{class:["btn-accion","btn-nuevo","barco-theme-"+t.barcoSeleccionado],on:{click:t.openModalNuevoTripulante}},[e("i",{staticClass:"icon"},[t._v("üë§‚ûï")]),e("span",[t._v("Nuevo Tripulante")])]),e("button",{class:["btn-accion","btn-resumen","barco-theme-"+t.barcoSeleccionado],on:{click:function(a){t.mostrarResumenPrestamos=!t.mostrarResumenPrestamos}}},[e("i",{staticClass:"icon"},[t._v("üè¶")]),e("span",[t._v("Resumen de Pr√©stamos")])])]),t.mostrarResumenPrestamos?e("div",{staticClass:"resumen-prestamos-card"},[e("h3",[e("i",{staticClass:"icon-money"},[t._v("üè¶")]),t._v(" Resumen de Pr√©stamos - "+t._s(t.nombreBarco)+" ")]),e("div",{staticClass:"resumen-grid"},[e("div",{staticClass:"resumen-item"},[e("span",{staticClass:"label"},[t._v("Total Prestado:")]),e("span",{staticClass:"valor prestamo"},[t._v("$"+t._s(t.totalPrestado.toLocaleString()))])]),e("div",{staticClass:"resumen-item"},[e("span",{staticClass:"label"},[t._v("Total Abonado:")]),e("span",{staticClass:"valor abono"},[t._v("$"+t._s(t.totalPagado.toLocaleString()))])]),e("div",{staticClass:"resumen-item"},[e("span",{staticClass:"label"},[t._v("Saldo Pendiente:")]),e("span",{staticClass:"valor pendiente"},[t._v("$"+t._s((t.totalPrestado-t.totalPagado).toLocaleString()))])]),e("div",{staticClass:"resumen-item"},[e("span",{staticClass:"label"},[t._v("Tripulantes Activos:")]),e("span",{staticClass:"valor"},[t._v("$"+t._s(t.tripulantesActivos))])])])]):t._e(),e("div",{staticClass:"tripulantes-section"},[e("div",{staticClass:"section-header"},[t._m(1),e("div",{staticClass:"filtros"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.filtroEstado,expression:"filtroEstado"}],staticClass:"filtro-select",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));t.filtroEstado=a.target.multiple?e:e[0]}}},[e("option",{attrs:{value:""}},[t._v("Todos los estados")]),e("option",{attrs:{value:"activo"}},[t._v("Activos")]),e("option",{attrs:{value:"inactivo"}},[t._v("Inactivos")])])])]),0===t.tripulantesFiltrados.length?e("div",{staticClass:"no-tripulantes"},[e("i",{staticClass:"icon-empty"},[t._v("üë§")]),e("h4",[t._v("No hay tripulantes registrados")]),e("p",[t._v("Agrega el primer tripulante para comenzar a gestionar la tripulaci√≥n de "+t._s(t.nombreBarco))]),e("button",{staticClass:"btn-agregar-primero",on:{click:t.openModalNuevoTripulante}},[e("i",{staticClass:"icon"},[t._v("‚ûï")]),t._v(" Agregar Primer Tripulante ")])]):e("div",{staticClass:"tripulantes-grid"},t._l(t.tripulantesFiltrados,(function(a){return e("div",{key:a.id,staticClass:"tripulante-card",class:{inactivo:"inactivo"===a.estado}},[e("div",{staticClass:"tripulante-header"},[t._m(2,!0),e("div",{staticClass:"tripulante-info"},[e("h4",[t._v(t._s(a.nombre))]),e("p",{staticClass:"puesto"},[t._v(t._s(a.puesto||"Sin puesto asignado"))]),e("span",{class:["estado-badge",a.estado]},[t._v(" "+t._s("activo"===a.estado?"Activo":"Inactivo")+" ")])]),e("div",{staticClass:"tripulante-acciones"},[e("button",{staticClass:"btn-prestamo",attrs:{title:"Gestionar pr√©stamos de "+a.nombre},on:{click:function(e){return t.openModalPrestamos(a)}}},[e("i",{staticClass:"icon"},[t._v("üè¶")])]),e("button",{staticClass:"btn-editar",attrs:{title:"Editar "+a.nombre},on:{click:function(e){return t.editarTripulante(a)}}},[e("i",{staticClass:"icon"},[t._v("‚úèÔ∏è")])]),e("button",{class:["btn-toggle",a.estado],attrs:{title:"activo"===a.estado?"Desactivar":"Activar"},on:{click:function(e){return t.toggleEstadoTripulante(a)}}},[e("i",{staticClass:"icon"},[t._v(t._s("activo"===a.estado?"üî¥":"üü¢"))])])])]),e("div",{staticClass:"tripulante-stats"},[e("div",{staticClass:"stat-item"},[e("span",{staticClass:"stat-label"},[t._v("Total Prestado:")]),e("span",{staticClass:"stat-valor prestamo"},[t._v("$"+t._s((a.totalPrestado||0).toLocaleString()))])]),e("div",{staticClass:"stat-item"},[e("span",{staticClass:"stat-label"},[t._v("Total Abonado:")]),e("span",{staticClass:"stat-valor abono"},[t._v("$"+t._s((a.totalPagado||0).toLocaleString()))])]),e("div",{staticClass:"stat-item"},[e("span",{staticClass:"stat-label"},[t._v("Saldo Pendiente:")]),e("span",{staticClass:"stat-valor pendiente"},[t._v("$"+t._s(((a.totalPrestado||0)-(a.totalPagado||0)).toLocaleString()))])])]),e("div",{staticClass:"tripulante-actions-footer"},[e("button",{staticClass:"btn-historial",on:{click:function(e){return t.verHistorialPrestamos(a)}}},[e("i",{staticClass:"icon"},[t._v("üìÑ")]),t._v(" Ver Historial ")])])])})),0)]),t.showModalTripulante?e("div",{staticClass:"modal-overlay",on:{click:t.closeModalOnOverlay}},[e("div",{staticClass:"modal-content modern-modal",on:{click:function(a){a.stopPropagation()}}},[e("div",{staticClass:"modal-header modern-header",style:{background:t.gradientePrimario}},[t._m(3),e("div",{staticClass:"header-text"},[e("h2",[t._v(t._s(t.isEditMode?"Editar Tripulante":"Nuevo Tripulante"))]),e("p",[t._v(t._s(t.nombreBarco))])]),e("button",{staticClass:"close-button modern-close",on:{click:function(a){t.showModalTripulante=!1}}},[e("i",{staticClass:"fas fa-times"},[t._v("‚úï")])])]),e("div",{staticClass:"modal-body modern-body"},[e("form",{staticClass:"modern-form",on:{submit:function(a){return a.preventDefault(),t.guardarTripulante.apply(null,arguments)}}},[e("div",{staticClass:"form-grid"},[e("div",{staticClass:"form-group modern-group"},[t._m(4),e("input",{directives:[{name:"model",rawName:"v-model",value:t.formTripulante.nombre,expression:"formTripulante.nombre"}],staticClass:"modern-input",attrs:{id:"nombre",required:"",placeholder:"Ingrese el nombre completo"},domProps:{value:t.formTripulante.nombre},on:{input:function(a){a.target.composing||t.$set(t.formTripulante,"nombre",a.target.value)}}})]),e("div",{staticClass:"form-group modern-group"},[t._m(5),e("select",{directives:[{name:"model",rawName:"v-model",value:t.formTripulante.puesto,expression:"formTripulante.puesto"}],staticClass:"modern-input",attrs:{id:"puesto",required:""},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));t.$set(t.formTripulante,"puesto",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:""}},[t._v("Seleccionar puesto")]),e("option",{attrs:{value:"Capit√°n"}},[t._v("Capit√°n")]),e("option",{attrs:{value:"Motorista"}},[t._v("Motorista")]),e("option",{attrs:{value:"Winchero"}},[t._v("Winchero")]),e("option",{attrs:{value:"Cocinero"}},[t._v("Cocinero")]),e("option",{attrs:{value:"Pacotillero"}},[t._v("Pacotillero")])])])]),e("div",{staticClass:"modal-actions"},[e("button",{staticClass:"btn-cancelar",attrs:{type:"button"},on:{click:function(a){t.showModalTripulante=!1}}},[t._v(" Cancelar ")]),e("button",{staticClass:"btn-guardar",attrs:{type:"submit"}},[e("i",{staticClass:"btn-icon"},[t._v("üíæ")]),t._v(" "+t._s(t.isEditMode?"Actualizar":"Guardar")+" Tripulante ")])])])])])]):t._e(),t.showModalPrestamos?e("div",{staticClass:"modal-overlay",on:{click:t.closeModalOnOverlay}},[e("div",{staticClass:"modal-content modern-modal",on:{click:function(a){a.stopPropagation()}}},[e("div",{staticClass:"modal-header modern-header",style:{background:t.gradientePrimario}},[t._m(6),e("div",{staticClass:"header-text"},[e("h2",[t._v("Gestionar Pr√©stamos")]),e("p",[t._v(t._s(null===(a=t.tripulanteSeleccionado)||void 0===a?void 0:a.nombre)+" - "+t._s(t.nombreBarco))])]),e("button",{staticClass:"close-button modern-close",on:{click:function(a){t.showModalPrestamos=!1}}},[e("i",{staticClass:"fas fa-times"},[t._v("‚úï")])])]),e("div",{staticClass:"modal-body modern-body"},[t.tripulanteSeleccionado?e("PagosTripulante",{attrs:{tripulante:t.tripulanteSeleccionado,barco:t.barcoSeleccionado,"nombre-barco":t.nombreBarco},on:{"prestamo-registrado":t.onPrestamoRegistrado,close:function(a){t.showModalPrestamos=!1}}}):t._e()],1)])]):t._e()])},s=[function(){var a=this,t=a._self._c;return t("h1",{staticClass:"main-title"},[t("i",{staticClass:"icon-crew"},[a._v("üë•")]),a._v(" Gesti√≥n de Tripulantes ")])},function(){var a=this,t=a._self._c;return t("h3",[t("i",{staticClass:"icon-list"},[a._v("üìã")]),a._v(" Lista de Tripulantes ")])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"avatar"},[t("i",{staticClass:"avatar-icon"},[a._v("üë§")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"header-icon"},[t("i",{staticClass:"icon-user"},[a._v("üë§")])])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"modern-label",attrs:{for:"nombre"}},[t("i",{staticClass:"label-icon"},[a._v("üë§")]),a._v(" Nombre Completo ")])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"modern-label",attrs:{for:"puesto"}},[t("i",{staticClass:"label-icon"},[a._v("üõ†Ô∏è")]),a._v(" Puesto/Funci√≥n ")])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"header-icon"},[t("i",{staticClass:"icon-money"},[a._v("üè¶")])])}],i=(e("13d5"),e("dc59")),r=e("1494"),n=e("74c9"),c=function(){var a=this,t=a._self._c;return t("div",{staticClass:"pagos-tripulante"},[t("div",{staticClass:"tripulante-info-header"},[a._m(0),t("div",{staticClass:"tripulante-details"},[t("h3",[a._v(a._s(a.tripulante.nombre))]),t("p",{staticClass:"puesto"},[a._v(a._s(a.tripulante.puesto||"Sin puesto asignado"))]),t("span",{class:["estado-badge",a.tripulante.estado]},[a._v(" "+a._s("activo"===a.tripulante.estado?"Activo":"Inactivo")+" ")])]),t("div",{staticClass:"balance-info"},[t("div",{staticClass:"balance-item"},[t("span",{staticClass:"label"},[a._v("Saldo Pendiente:")]),t("span",{staticClass:"valor pendiente"},[a._v(" $"+a._s(a.saldoPendiente.toLocaleString())+" ")])])])]),t("div",{staticClass:"nuevo-prestamo-section"},[t("h4",[t("i",{staticClass:"icon-add"},[a._v("‚ûï")]),a._v(" Registrar Nuevo "+a._s("prestamo"===a.tipoTransaccion?"Pr√©stamo":"Abono")+" ")]),t("form",{staticClass:"prestamo-form",on:{submit:function(t){return t.preventDefault(),a.registrarTransaccion.apply(null,arguments)}}},[t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[a._m(1),t("div",{staticClass:"tipo-buttons"},[t("button",{class:["tipo-btn",{active:"prestamo"===a.tipoTransaccion}],attrs:{type:"button"},on:{click:function(t){a.tipoTransaccion="prestamo"}}},[t("i",{staticClass:"btn-icon"},[a._v("üè¶")]),a._v(" Pr√©stamo ")]),t("button",{class:["tipo-btn",{active:"pago"===a.tipoTransaccion}],attrs:{type:"button"},on:{click:function(t){a.tipoTransaccion="pago"}}},[t("i",{staticClass:"btn-icon"},[a._v("üí∞")]),a._v(" Abono ")])])])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[a._m(2),t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.formPago.monto,expression:"formPago.monto",modifiers:{number:!0}}],staticClass:"form-input",attrs:{id:"monto",type:"number",step:"0.01",min:"0.01",required:"",placeholder:"0.00"},domProps:{value:a.formPago.monto},on:{input:function(t){t.target.composing||a.$set(a.formPago,"monto",a._n(t.target.value))},blur:function(t){return a.$forceUpdate()}}})]),t("div",{staticClass:"form-group"},[a._m(3),t("input",{directives:[{name:"model",rawName:"v-model",value:a.formPago.fecha,expression:"formPago.fecha"}],staticClass:"form-input",attrs:{id:"fecha",type:"date",required:""},domProps:{value:a.formPago.fecha},on:{input:function(t){t.target.composing||a.$set(a.formPago,"fecha",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group full-width"},[a._m(4),t("input",{directives:[{name:"model",rawName:"v-model",value:a.formPago.concepto,expression:"formPago.concepto"}],staticClass:"form-input",attrs:{id:"concepto",type:"text",required:"",placeholder:"prestamo"===a.tipoTransaccion?"Ej: Anticipo de salario, emergencia m√©dica, combustible...":"Ej: Abono a pr√©stamo, descuento de salario..."},domProps:{value:a.formPago.concepto},on:{input:function(t){t.target.composing||a.$set(a.formPago,"concepto",t.target.value)}}})])]),t("div",{staticClass:"form-actions"},[t("button",{class:["btn-submit",a.tipoTransaccion],attrs:{type:"submit"}},[t("i",{staticClass:"btn-icon"},[a._v("üíæ")]),a._v(" Registrar "+a._s("prestamo"===a.tipoTransaccion?"Pr√©stamo":"Abono")+" ")])])])]),t("div",{staticClass:"historial-section"},[t("div",{staticClass:"historial-header"},[a._m(5),t("div",{staticClass:"filtros-historial"},[t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroTipo,expression:"filtroTipo"}],staticClass:"filtro-select",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.filtroTipo=t.target.multiple?e:e[0]}}},[t("option",{attrs:{value:""}},[a._v("Todos los tipos")]),t("option",{attrs:{value:"prestamo"}},[a._v("Solo Pr√©stamos")]),t("option",{attrs:{value:"pago"}},[a._v("Solo Abonos")])]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroMes,expression:"filtroMes"}],staticClass:"filtro-select",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.filtroMes=t.target.multiple?e:e[0]}}},[t("option",{attrs:{value:""}},[a._v("Todos los meses")]),t("option",{attrs:{value:"este-mes"}},[a._v("Este mes")]),t("option",{attrs:{value:"mes-pasado"}},[a._v("Mes pasado")]),t("option",{attrs:{value:"ultimos-3-meses"}},[a._v("√öltimos 3 meses")])])])]),0===a.transaccionesFiltradas.length?t("div",{staticClass:"no-transacciones"},[t("i",{staticClass:"icon-empty"},[a._v("üì≠")]),t("p",[a._v("No hay pr√©stamos registrados para este tripulante")])]):t("div",{staticClass:"transacciones-list"},a._l(a.transaccionesFiltradas,(function(e){return t("div",{key:e.id,class:["transaccion-item",e.tipo]},[t("div",{staticClass:"transaccion-header"},[t("div",{staticClass:"transaccion-info"},[t("div",{staticClass:"transaccion-tipo"},[t("i",{class:["tipo-icon",e.tipo]},[a._v(" "+a._s("pago"===e.tipo?"üí∞":"üè¶")+" ")]),t("div",{staticClass:"tipo-info"},[t("span",{staticClass:"tipo-label"},[a._v(a._s("prestamo"===e.tipo?"Pr√©stamo":"Abono"))]),t("span",{staticClass:"concepto"},[a._v(a._s(e.concepto))])])]),t("div",{staticClass:"transaccion-monto"},[t("span",{class:["monto",e.tipo]},[a._v(" "+a._s("prestamo"===e.tipo?"+":"-")+"$"+a._s(e.monto.toLocaleString())+" ")]),t("span",{staticClass:"fecha"},[a._v(a._s(a.formatearFecha(e.fecha)))])])]),t("div",{staticClass:"transaccion-actions"},[t("button",{staticClass:"btn-editar-trans",attrs:{title:"Editar transacci√≥n"},on:{click:function(t){return a.editarTransaccion(e)}}},[t("i",{staticClass:"icon"},[a._v("‚úèÔ∏è")])]),t("button",{staticClass:"btn-eliminar-trans",attrs:{title:"Eliminar transacci√≥n"},on:{click:function(t){return a.eliminarTransaccion(e)}}},[t("i",{staticClass:"icon"},[a._v("üóëÔ∏è")])])])])])})),0),a.transacciones.length>0?t("div",{staticClass:"resumen-historial"},[t("div",{staticClass:"resumen-item"},[t("span",{staticClass:"resumen-label"},[a._v("Total Prestado:")]),t("span",{staticClass:"resumen-valor prestamo"},[a._v("$"+a._s(a.totalPrestado.toLocaleString()))])]),t("div",{staticClass:"resumen-item"},[t("span",{staticClass:"resumen-label"},[a._v("Total Abonado:")]),t("span",{staticClass:"resumen-valor abono"},[a._v("$"+a._s(a.totalPagado.toLocaleString()))])]),t("div",{staticClass:"resumen-item"},[t("span",{staticClass:"resumen-label"},[a._v("Saldo Pendiente:")]),t("span",{staticClass:"resumen-valor pendiente"},[a._v(" $"+a._s(a.saldoPendiente.toLocaleString())+" ")])])]):a._e()]),a.showModalEditar?t("div",{staticClass:"modal-overlay",on:{click:a.closeModalOnOverlay}},[t("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("Editar Transacci√≥n")]),t("button",{staticClass:"close-btn",on:{click:function(t){a.showModalEditar=!1}}},[a._v("‚úï")])]),t("div",{staticClass:"modal-body"},[t("form",{staticClass:"edit-form",on:{submit:function(t){return t.preventDefault(),a.actualizarTransaccion.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",[a._v("Monto ($)")]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.transaccionEditando.monto,expression:"transaccionEditando.monto",modifiers:{number:!0}}],staticClass:"form-input",attrs:{type:"number",step:"0.01",required:""},domProps:{value:a.transaccionEditando.monto},on:{input:function(t){t.target.composing||a.$set(a.transaccionEditando,"monto",a._n(t.target.value))},blur:function(t){return a.$forceUpdate()}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Fecha")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.transaccionEditando.fecha,expression:"transaccionEditando.fecha"}],staticClass:"form-input",attrs:{type:"date",required:""},domProps:{value:a.transaccionEditando.fecha},on:{input:function(t){t.target.composing||a.$set(a.transaccionEditando,"fecha",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Concepto")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.transaccionEditando.concepto,expression:"transaccionEditando.concepto"}],staticClass:"form-input",attrs:{required:""},domProps:{value:a.transaccionEditando.concepto},on:{input:function(t){t.target.composing||a.$set(a.transaccionEditando,"concepto",t.target.value)}}})]),t("div",{staticClass:"modal-actions"},[t("button",{staticClass:"btn-cancelar",attrs:{type:"button"},on:{click:function(t){a.showModalEditar=!1}}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-actualizar",attrs:{type:"submit"}},[a._v(" Actualizar ")])])])])])]):a._e()])},l=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"tripulante-avatar"},[t("i",{staticClass:"avatar-icon"},[a._v("üë§")])])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"form-label"},[t("i",{staticClass:"label-icon"},[a._v("üîÑ")]),a._v(" Tipo de Transacci√≥n ")])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"form-label",attrs:{for:"monto"}},[t("i",{staticClass:"label-icon"},[a._v("üíµ")]),a._v(" Monto ($) ")])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"form-label",attrs:{for:"fecha"}},[t("i",{staticClass:"label-icon"},[a._v("üìÖ")]),a._v(" Fecha ")])},function(){var a=this,t=a._self._c;return t("label",{staticClass:"form-label",attrs:{for:"concepto"}},[t("i",{staticClass:"label-icon"},[a._v("üìù")]),a._v(" Concepto ")])},function(){var a=this,t=a._self._c;return t("h4",[t("i",{staticClass:"icon-history"},[a._v("üìÑ")]),a._v(" Historial de Pr√©stamos y Abonos ")])}],d={name:"PagosTripulante",props:{tripulante:{type:Object,required:!0},barco:{type:String,required:!0},nombreBarco:{type:String,required:!0}},data(){return{tipoTransaccion:"prestamo",formPago:{monto:null,fecha:(new Date).toISOString().split("T")[0],concepto:""},transacciones:[],filtroTipo:"",filtroMes:"",showModalEditar:!1,transaccionEditando:null}},computed:{totalPagado(){return this.transacciones.filter(a=>"pago"===a.tipo).reduce((a,t)=>a+t.monto,0)},totalPrestado(){return this.transacciones.filter(a=>"prestamo"===a.tipo).reduce((a,t)=>a+t.monto,0)},saldoPendiente(){return this.totalPrestado-this.totalPagado},transaccionesFiltradas(){let a=[...this.transacciones];if(this.filtroTipo&&(a=a.filter(a=>a.tipo===this.filtroTipo)),this.filtroMes){const t=new Date;a=a.filter(a=>{const e=new Date(a.fecha);switch(this.filtroMes){case"este-mes":return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear();case"mes-pasado":const a=new Date(t.getFullYear(),t.getMonth()-1);return e.getMonth()===a.getMonth()&&e.getFullYear()===a.getFullYear();case"ultimos-3-meses":const o=new Date(t.getFullYear(),t.getMonth()-3);return e>=o;default:return!0}})}return this.filtroTipo||this.filtroMes?a.sort((a,t)=>new Date(t.fecha)-new Date(a.fecha)):a}},mounted(){this.cargarTransacciones()},methods:{async cargarTransacciones(){try{const a=Object(r["o"])(Object(r["c"])(i["a"],"pagosTripulantes"),Object(r["t"])("tripulanteId","==",this.tripulante.id),Object(r["t"])("barco","==",this.barco)),t=await Object(r["g"])(a);this.transacciones=t.docs.map(a=>({id:a.id,...a.data()})),this.transacciones.sort((a,t)=>new Date(t.fecha)-new Date(a.fecha))}catch(a){console.error("Error al cargar transacciones:",a)}},async registrarTransaccion(){if(!this.formPago.monto||this.formPago.monto<=0)alert("Por favor ingrese un monto v√°lido");else if(this.formPago.concepto.trim())try{const a={tripulanteId:this.tripulante.id,tripulanteNombre:this.tripulante.nombre,barco:this.barco,nombreBarco:this.nombreBarco,tipo:this.tipoTransaccion,monto:this.formPago.monto,fecha:this.formPago.fecha,concepto:this.formPago.concepto.trim(),createdAt:new Date};await Object(r["b"])(Object(r["c"])(i["a"],"pagosTripulantes"),a),this.formPago={monto:null,fecha:(new Date).toISOString().split("T")[0],concepto:""},await this.cargarTransacciones(),this.$emit("prestamo-registrado"),alert(("prestamo"===this.tipoTransaccion?"Pr√©stamo":"Abono")+" registrado exitosamente")}catch(a){console.error("Error al registrar transacci√≥n:",a),alert("Error al registrar la transacci√≥n")}else alert("Por favor ingrese un concepto")},editarTransaccion(a){this.transaccionEditando={...a},this.showModalEditar=!0},async actualizarTransaccion(){try{await Object(r["s"])(Object(r["e"])(i["a"],"pagosTripulantes",this.transaccionEditando.id),{monto:this.transaccionEditando.monto,fecha:this.transaccionEditando.fecha,concepto:this.transaccionEditando.concepto,updatedAt:new Date}),this.showModalEditar=!1,await this.cargarTransacciones(),this.$emit("prestamo-registrado"),alert("Transacci√≥n actualizada exitosamente")}catch(a){console.error("Error al actualizar transacci√≥n:",a),alert("Error al actualizar la transacci√≥n")}},async eliminarTransaccion(a){const t="prestamo"===a.tipo?"pr√©stamo":"abono";if(confirm(`¬øEst√° seguro de eliminar este ${t} de $${a.monto.toLocaleString()}?`))try{await Object(r["d"])(Object(r["e"])(i["a"],"pagosTripulantes",a.id)),await this.cargarTransacciones(),this.$emit("prestamo-registrado"),alert("Transacci√≥n eliminada exitosamente")}catch(e){console.error("Error al eliminar transacci√≥n:",e),alert("Error al eliminar la transacci√≥n")}},formatearFecha(a){if(!a)return"";const[t,e,o]=a.split("-"),s=new Date(t,e-1,o);return s.toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})},closeModalOnOverlay(a){a.target.classList.contains("modal-overlay")&&(this.showModalEditar=!1)}}},u=d,v=(e("ae0d"),e("2877")),m=Object(v["a"])(u,c,l,!1,null,"0efe1d78",null),p=m.exports,b={name:"GestionTripulantes",components:{BackButton:n["a"],PagosTripulante:p},data(){return{barcoSeleccionado:"",tripulantes:[],mostrarResumenPrestamos:!1,filtroEstado:"",showModalTripulante:!1,showModalPrestamos:!1,isEditMode:!1,tripulanteSeleccionado:null,formTripulante:{nombre:"",puesto:""}}},computed:{nombreBarco(){return"galileo"===this.barcoSeleccionado?"El Galileo":"Mar√≠a Guadalupe"},gradientePrimario(){return"maria-guadalupe"===this.barcoSeleccionado?"linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)":"linear-gradient(135deg, #3498db 0%, #2980b9 100%)"},tripulantesFiltrados(){return this.tripulantes.filter(a=>!this.filtroEstado||a.estado===this.filtroEstado)},tripulantesActivos(){return this.tripulantes.filter(a=>"activo"===a.estado).length},totalPagado(){return this.tripulantes.reduce((a,t)=>a+(t.totalPagado||0),0)},totalPrestado(){return this.tripulantes.reduce((a,t)=>a+(t.totalPrestado||0),0)},saldoPendienteTotal(){return this.totalPrestado-this.totalPagado}},mounted(){this.barcoSeleccionado=this.$route.query.barco||localStorage.getItem("barcoSeleccionado")||"galileo",this.loadTripulantes()},methods:{async loadTripulantes(){try{const a=Object(r["o"])(Object(r["c"])(i["a"],"tripulantesBarcos"),Object(r["t"])("barco","==",this.barcoSeleccionado)),t=await Object(r["g"])(a);this.tripulantes=t.docs.map(a=>({id:a.id,...a.data()})),this.tripulantes.sort((a,t)=>a.nombre.localeCompare(t.nombre));for(let e of this.tripulantes)await this.calcularBalanceTripulante(e)}catch(a){console.error("Error al cargar tripulantes:",a),alert("Error al cargar tripulantes")}},async calcularBalanceTripulante(a){try{const t=Object(r["o"])(Object(r["c"])(i["a"],"pagosTripulantes"),Object(r["t"])("tripulanteId","==",a.id),Object(r["t"])("barco","==",this.barcoSeleccionado)),e=await Object(r["g"])(t);let o=0,s=0;e.docs.forEach(a=>{const t=a.data();"pago"===t.tipo?o+=t.monto:"prestamo"===t.tipo&&(s+=t.monto)}),a.totalPagado=o,a.totalPrestado=s,a.balance=o-s}catch(t){console.error("Error al calcular balance:",t)}},openModalNuevoTripulante(){this.isEditMode=!1,this.formTripulante={nombre:"",puesto:""},this.showModalTripulante=!0},editarTripulante(a){this.isEditMode=!0,this.tripulanteSeleccionado=a,this.formTripulante={nombre:a.nombre,puesto:a.puesto},this.showModalTripulante=!0},async guardarTripulante(){if(this.formTripulante.nombre.trim())if(this.formTripulante.puesto.trim())try{const a={nombre:this.formTripulante.nombre.trim(),puesto:this.formTripulante.puesto,barco:this.barcoSeleccionado,nombreBarco:this.nombreBarco,estado:"activo",totalPagado:0,totalPrestado:0,balance:0,updatedAt:new Date};this.isEditMode?(await Object(r["s"])(Object(r["e"])(i["a"],"tripulantesBarcos",this.tripulanteSeleccionado.id),{nombre:a.nombre,puesto:a.puesto,updatedAt:a.updatedAt}),alert("Tripulante actualizado exitosamente")):(a.createdAt=new Date,await Object(r["b"])(Object(r["c"])(i["a"],"tripulantesBarcos"),a),alert("Tripulante agregado exitosamente")),this.showModalTripulante=!1,await this.loadTripulantes()}catch(a){console.error("Error al guardar tripulante:",a),alert("Error al guardar tripulante")}else alert("Por favor seleccione el puesto del tripulante");else alert("Por favor ingrese el nombre del tripulante")},async toggleEstadoTripulante(a){const t="activo"===a.estado?"inactivo":"activo",e="activo"===t?"activar":"desactivar";if(confirm(`¬øEst√° seguro de ${e} a ${a.nombre}?`))try{await Object(r["s"])(Object(r["e"])(i["a"],"tripulantesBarcos",a.id),{estado:t,updatedAt:new Date}),await this.loadTripulantes(),alert(`Tripulante ${"activar"===e?"activado":"desactivado"} exitosamente`)}catch(o){console.error("Error al cambiar estado:",o),alert("Error al cambiar estado del tripulante")}},openModalPrestamos(a){this.tripulanteSeleccionado=a,this.showModalPrestamos=!0},verHistorialPrestamos(a){this.openModalPrestamos(a)},async onPrestamoRegistrado(){await this.loadTripulantes()},closeModalOnOverlay(a){a.target.classList.contains("modal-overlay")&&(this.showModalTripulante=!1,this.showModalPrestamos=!1)}}},h=b,f=(e("4cbd"),Object(v["a"])(h,o,s,!1,null,"de096c78",null));t["a"]=f.exports}}]);