(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app.51a12d86"],{"089a":function(a,t,e){},"0ae9":function(a,t,e){"use strict";var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"ventas-ganancias-catarro"},[t("div",{staticClass:"header"},[t("button",{staticClass:"back-button",on:{click:a.volverAlMenu}},[a._v("Volver")]),t("h2",[a._v("An√°lisis de Ventas y Ganancias - Catarro")])]),t("div",{staticClass:"filtros"},[t("label",{attrs:{for:"periodo-select"}},[a._v("Seleccionar per√≠odo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.periodoSeleccionado,expression:"periodoSeleccionado"}],attrs:{id:"periodo-select"},on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.periodoSeleccionado=t.target.multiple?e:e[0]},a.cargarDatos]}},[t("option",{attrs:{value:"semanal"}},[a._v("Semanal")]),t("option",{attrs:{value:"mensual"}},[a._v("Mensual")])])]),t("div",{staticClass:"graficas"},[t("div",{staticClass:"grafica"},[t("h3",[a._v("Ventas "+a._s("semanal"===a.periodoSeleccionado?"Semanales":"Mensuales"))]),t("canvas",{ref:"ventasChart"})]),t("div",{staticClass:"grafica"},[t("h3",[a._v("Ganancias "+a._s("semanal"===a.periodoSeleccionado?"Semanales":"Mensuales"))]),t("canvas",{ref:"gananciasChart"})])]),t("div",{staticClass:"resumen"},[t("h3",[a._v("Resumen")]),t("p",[a._v("Total de ventas: $"+a._s(a.formatNumber(a.totalVentas)))]),t("p",[a._v("Total de ganancias: $"+a._s(a.formatNumber(a.totalGanancias)))]),t("p",[a._v("Promedio de ventas por "+a._s("semanal"===a.periodoSeleccionado?"semana":"mes")+": $"+a._s(a.formatNumber(a.promedioVentas)))]),t("p",[a._v("Promedio de ganancias por "+a._s("semanal"===a.periodoSeleccionado?"semana":"mes")+": $"+a._s(a.formatNumber(a.promedioGanancias)))])])])},n=[],o=(e("14d9"),e("13d5"),e("dc59")),r=e("1494"),i=e("796e"),c={name:"VentasYGananciasCatarro",data(){return{periodoSeleccionado:"semanal",ventas:[],ganancias:[],totalVentas:0,totalGanancias:0,promedioVentas:0,promedioGanancias:0,ventasChart:null,gananciasChart:null,periodos:[]}},mounted(){this.cargarDatos()},methods:{async cargarDatos(){try{const a=Object(r["c"])(o["a"],"cuentasCatarro"),t=Object(r["o"])(a,Object(r["l"])("fecha","desc")),e=await Object(r["g"])(t),s=e.docs.map(a=>{const t=a.data();return{fecha:new Date(t.fecha),ventas:t.totalGeneralVenta||0,ganancias:this.calcularGanancias(t),estadoPagado:t.estadoPagado||!1}});this.procesarDatos(s),this.crearGraficas()}catch(a){console.error("Error al cargar datos:",a)}},procesarDatos(a){const t="semanal"===this.periodoSeleccionado?this.procesarDatosSemanal(a):this.procesarDatosMensual(a);this.periodos=t.map(a=>a.periodo),this.ventas=t.map(a=>a.ventas),this.ganancias=t.map(a=>a.ganancias),this.totalVentas=this.ventas.reduce((a,t)=>a+t,0),this.totalGanancias=this.ganancias.reduce((a,t)=>a+t,0),this.promedioVentas=this.totalVentas/this.ventas.length,this.promedioGanancias=this.totalGanancias/this.ganancias.length},procesarDatosSemanal(a){const t=a.reduce((a,t)=>{const e=this.obtenerNumeroSemana(t.fecha);return a[e]||(a[e]={ventas:0,ganancias:0}),a[e].ventas+=t.ventas,a[e].ganancias+=t.ganancias,a},{});return Object.entries(t).map(([a,t])=>({periodo:"Semana "+a,...t}))},procesarDatosMensual(a){const t=a.reduce((a,t)=>{const e=t.fecha.toLocaleString("default",{month:"long",year:"numeric"});return a[e]||(a[e]={ventas:0,ganancias:0}),a[e].ventas+=t.ventas,a[e].ganancias+=t.ganancias,a},{}),e=a.map(a=>a.fecha),s=new Date(Math.min.apply(null,e)),n=new Date(Math.max.apply(null,e)),o=this.obtenerMesesEntreFechas(s,n);return o.map(a=>({periodo:a,ventas:t[a]?t[a].ventas:0,ganancias:t[a]?t[a].ganancias:0})).sort((a,t)=>new Date(a.periodo)-new Date(t.periodo))},obtenerMesesEntreFechas(a,t){const e=[],s=new Date(a.getFullYear(),a.getMonth(),1);while(s<=t)e.push(s.toLocaleString("default",{month:"long",year:"numeric"})),s.setMonth(s.getMonth()+1);return e},obtenerNumeroSemana(a){const t=new Date(a.getFullYear(),0,1);return Math.ceil(((a-t)/864e5+t.getDay()+1)/7)},crearGraficas(){this.crearGrafica("ventasChart","Ventas",this.ventas,"#4CAF50"),this.crearGrafica("gananciasChart","Ganancias",this.ganancias,"#2196F3")},crearGrafica(a,t,e,s){const n=this.$refs[a].getContext("2d");this[a]&&this[a].destroy(),this[a]=new i["a"](n,{type:"bar",data:{labels:this.periodos,datasets:[{label:t,data:e,backgroundColor:s,borderColor:s,borderWidth:1}]},options:{responsive:!0,scales:{y:{beginAtZero:!0,ticks:{callback:function(a){return"$"+a.toLocaleString()}}}},plugins:{tooltip:{callbacks:{label:function(a){let t=a.dataset.label||"";return t&&(t+=": "),null!==a.parsed.y&&(t+="$"+a.parsed.y.toLocaleString()),t}}}}}})},formatNumber(a){return"number"!==typeof a?"0.00":a.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})},volverAlMenu(){this.$router.push("/cuentas-catarro")},calcularGanancias(a){return a.estadoPagado&&a.gananciaDelDia||0}}},l=c,d=(e("535b"),e("2877")),u=Object(d["a"])(l,s,n,!1,null,"cee72e80",null);t["a"]=u.exports},"236f":function(a,t,e){},4312:function(a,t,e){},"505e":function(a,t,e){"use strict";var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"page-container"},[t("div",{staticClass:"content-wrap"},[t("div",{staticClass:"cuentas-mexico-container"},[t("h1",[a._v("Cuentas M√©xico")]),t("div",{staticClass:"agenda-container"},[t("div",{staticClass:"card agenda",on:{click:function(t){return a.abrirAgenda()}}},[a._m(0)])]),t("div",{staticClass:"precios-container"},[t("PreciosHistorialModal")],1),t("div",{staticClass:"botones-container"},[t("router-link",{staticClass:"boton-cuenta",attrs:{to:"/cuentas-ozuna"}},[t("div",{staticClass:"card ozuna"},[t("h2",[a._v("Ozuna")])])]),t("router-link",{staticClass:"boton-cuenta",attrs:{to:"/cuentas-catarro"}},[t("div",{staticClass:"card catarro"},[t("h2",[a._v("Catarro")])])]),t("router-link",{staticClass:"boton-cuenta",attrs:{to:"/cuentas-joselito"}},[t("div",{staticClass:"card joselito"},[t("h2",[a._v("Joselito")])])]),t("router-link",{staticClass:"boton-cuenta",attrs:{to:"/cuentas-otilio"}},[t("div",{staticClass:"card otilio"},[t("h2",[a._v("Otilio")])])]),t("router-link",{staticClass:"boton-cuenta",attrs:{to:"/cuentas-veronica"}},[t("div",{staticClass:"card veronica"},[t("h2",[a._v("Veronica")])])])],1)])]),t("TransaccionesAgendaModal",{attrs:{mostrar:a.mostrarModalAgenda,cliente:a.clienteSeleccionado},on:{cerrar:a.cerrarModalAgenda}})],1)},n=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"card-content"},[t("i",{staticClass:"fas fa-calendar-alt"}),t("h2",[a._v("Agenda de Transacciones")])])}],o=e("fe3d"),r=e("666c"),i={name:"CuentasMexico",components:{TransaccionesAgendaModal:o["a"],PreciosHistorialModal:r["a"]},data(){return{mostrarModalAgenda:!1,clienteSeleccionado:"mexico"}},methods:{abrirAgenda(){this.mostrarModalAgenda=!0},cerrarModalAgenda(){this.mostrarModalAgenda=!1}}},c=i,l=(e("c883"),e("2877")),d=Object(l["a"])(c,s,n,!1,null,"473044b8",null);t["a"]=d.exports},5321:function(a,t,e){"use strict";var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"ventas-ganancias-veronica"},[t("div",{staticClass:"header"},[t("button",{staticClass:"back-button",on:{click:a.volverAlMenu}},[a._v("Volver")]),t("h2",[a._v("An√°lisis de Ventas y Ganancias - Veronica")])]),t("div",{staticClass:"filtros"},[t("label",{attrs:{for:"periodo-select"}},[a._v("Seleccionar per√≠odo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.periodoSeleccionado,expression:"periodoSeleccionado"}],attrs:{id:"periodo-select"},on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.periodoSeleccionado=t.target.multiple?e:e[0]},a.cargarDatos]}},[t("option",{attrs:{value:"semanal"}},[a._v("Semanal")]),t("option",{attrs:{value:"mensual"}},[a._v("Mensual")])])]),t("div",{staticClass:"graficas"},[t("div",{staticClass:"grafica"},[t("h3",[a._v("Ventas "+a._s("semanal"===a.periodoSeleccionado?"Semanales":"Mensuales"))]),t("canvas",{ref:"ventasChart"})]),t("div",{staticClass:"grafica"},[t("h3",[a._v("Ganancias "+a._s("semanal"===a.periodoSeleccionado?"Semanales":"Mensuales"))]),t("canvas",{ref:"gananciasChart"})])]),t("div",{staticClass:"resumen"},[t("h3",[a._v("Resumen")]),t("p",[a._v("Total de ventas: $"+a._s(a.formatNumber(a.totalVentas)))]),t("p",[a._v("Total de ganancias: $"+a._s(a.formatNumber(a.totalGanancias)))]),t("p",[a._v("Promedio de ventas por "+a._s("semanal"===a.periodoSeleccionado?"semana":"mes")+": $"+a._s(a.formatNumber(a.promedioVentas)))]),t("p",[a._v("Promedio de ganancias por "+a._s("semanal"===a.periodoSeleccionado?"semana":"mes")+": $"+a._s(a.formatNumber(a.promedioGanancias)))])])])},n=[],o=(e("14d9"),e("13d5"),e("dc59")),r=e("1494"),i=e("796e"),c={name:"VentasYGananciasVeronica",data(){return{periodoSeleccionado:"semanal",ventas:[],ganancias:[],totalVentas:0,totalGanancias:0,promedioVentas:0,promedioGanancias:0,ventasChart:null,gananciasChart:null,periodos:[]}},mounted(){this.cargarDatos()},methods:{async cargarDatos(){try{const a=Object(r["c"])(o["a"],"cuentasVeronica"),t=Object(r["o"])(a,Object(r["l"])("fecha","desc")),e=await Object(r["g"])(t),s=e.docs.map(a=>{const t=a.data();return{fecha:new Date(t.fecha),ventas:t.totalGeneralVenta||0,ganancias:this.calcularGanancias(t),estadoPagado:t.estadoPagado||!1}});this.procesarDatos(s),this.crearGraficas()}catch(a){console.error("Error al cargar datos:",a)}},procesarDatos(a){const t="semanal"===this.periodoSeleccionado?this.procesarDatosSemanal(a):this.procesarDatosMensual(a);this.periodos=t.map(a=>a.periodo),this.ventas=t.map(a=>a.ventas),this.ganancias=t.map(a=>a.ganancias),this.totalVentas=this.ventas.reduce((a,t)=>a+t,0),this.totalGanancias=this.ganancias.reduce((a,t)=>a+t,0),this.promedioVentas=this.totalVentas/this.ventas.length,this.promedioGanancias=this.totalGanancias/this.ganancias.length},procesarDatosSemanal(a){const t=a.reduce((a,t)=>{const e=this.obtenerNumeroSemana(t.fecha);return a[e]||(a[e]={ventas:0,ganancias:0}),a[e].ventas+=t.ventas,a[e].ganancias+=t.ganancias,a},{});return Object.entries(t).map(([a,t])=>({periodo:"Semana "+a,...t}))},procesarDatosMensual(a){const t=a.reduce((a,t)=>{const e=t.fecha.toLocaleString("default",{month:"long",year:"numeric"});return a[e]||(a[e]={ventas:0,ganancias:0}),a[e].ventas+=t.ventas,a[e].ganancias+=t.ganancias,a},{}),e=a.map(a=>a.fecha),s=new Date(Math.min.apply(null,e)),n=new Date(Math.max.apply(null,e)),o=this.obtenerMesesEntreFechas(s,n);return o.map(a=>({periodo:a,ventas:t[a]?t[a].ventas:0,ganancias:t[a]?t[a].ganancias:0})).sort((a,t)=>new Date(a.periodo)-new Date(t.periodo))},obtenerMesesEntreFechas(a,t){const e=[],s=new Date(a.getFullYear(),a.getMonth(),1);while(s<=t)e.push(s.toLocaleString("default",{month:"long",year:"numeric"})),s.setMonth(s.getMonth()+1);return e},obtenerNumeroSemana(a){const t=new Date(a.getFullYear(),0,1);return Math.ceil(((a-t)/864e5+t.getDay()+1)/7)},crearGraficas(){this.crearGrafica("ventasChart","Ventas",this.ventas,"#ff8c00"),this.crearGrafica("gananciasChart","Ganancias",this.ganancias,"#2196F3")},crearGrafica(a,t,e,s){const n=this.$refs[a].getContext("2d");this[a]&&this[a].destroy(),this[a]=new i["a"](n,{type:"bar",data:{labels:this.periodos,datasets:[{label:t,data:e,backgroundColor:s,borderColor:s,borderWidth:1}]},options:{responsive:!0,scales:{y:{beginAtZero:!0,ticks:{callback:function(a){return"$"+a.toLocaleString()}}}},plugins:{tooltip:{callbacks:{label:function(a){let t=a.dataset.label||"";return t&&(t+=": "),null!==a.parsed.y&&(t+="$"+a.parsed.y.toLocaleString()),t}}}}}})},formatNumber(a){return"number"!==typeof a?"0.00":a.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})},volverAlMenu(){this.$router.push("/cuentas-veronica")},calcularGanancias(a){return a.estadoPagado&&a.gananciaDelDia||0}}},l=c,d=(e("cd89"),e("2877")),u=Object(d["a"])(l,s,n,!1,null,"5fff4d17",null);t["a"]=u.exports},"535b":function(a,t,e){"use strict";e("089a")},"623b":function(a,t,e){},"65cd":function(a,t,e){"use strict";e("236f")},"8b75":function(a,t,e){},"95c6":function(a,t,e){"use strict";e("623b")},a918:function(a,t,e){},bee8:function(a,t,e){"use strict";e("a918")},c883:function(a,t,e){"use strict";e("8b75")},c8b7:function(a,t,e){"use strict";var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"ventas-ganancias-container"},[t("div",{staticClass:"back-button-container"},[t("BackButton",{attrs:{to:"/cuentas-joselito"}})],1),t("h1",[a._v("Ventas y Ganancias de Joselito")]),t("div",{staticClass:"date-range-selector"},[t("div",{staticClass:"date-input"},[t("label",[a._v("Fecha Inicial:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.fechaInicial,expression:"fechaInicial"}],attrs:{type:"date"},domProps:{value:a.fechaInicial},on:{input:function(t){t.target.composing||(a.fechaInicial=t.target.value)}}})]),t("div",{staticClass:"date-input"},[t("label",[a._v("Fecha Final:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.fechaFinal,expression:"fechaFinal"}],attrs:{type:"date"},domProps:{value:a.fechaFinal},on:{input:function(t){t.target.composing||(a.fechaFinal=t.target.value)}}})]),t("button",{staticClass:"search-btn",on:{click:a.buscarVentas}},[a._v("Buscar")])]),a.isLoading?t("div",{staticClass:"loading"},[a._v(" Cargando datos... ")]):t("div",[t("div",{staticClass:"summary-cards"},[t("div",{staticClass:"summary-card"},[t("h3",[a._v("Total Ventas")]),t("p",[a._v("$"+a._s(a.formatNumber(a.totalVentas)))])]),t("div",{staticClass:"summary-card"},[t("h3",[a._v("Total Costos")]),t("p",[a._v("$"+a._s(a.formatNumber(a.totalCostos)))])]),t("div",{staticClass:"summary-card"},[t("h3",[a._v("Ganancia Total")]),t("p",{class:{positive:a.gananciaTotal>0,negative:a.gananciaTotal<0}},[a._v(" $"+a._s(a.formatNumber(a.gananciaTotal))+" ")])])]),t("div",{staticClass:"ventas-table"},[t("h2",[a._v("Detalle de Ventas por Fecha")]),t("table",[a._m(0),t("tbody",a._l(a.ventasPorFecha,(function(e){return t("tr",{key:e.fecha},[t("td",[a._v(a._s(a.formatDate(e.fecha)))]),t("td",[a._v("$"+a._s(a.formatNumber(e.ventas)))]),t("td",[a._v("$"+a._s(a.formatNumber(e.costos)))]),t("td",{class:{positive:e.ganancia>0,negative:e.ganancia<0}},[a._v(" $"+a._s(a.formatNumber(e.ganancia))+" ")])])})),0)])]),t("div",{staticClass:"print-section"},[t("button",{staticClass:"print-btn",on:{click:a.imprimirReporte}},[a._v(" Imprimir Reporte ")])])])])},n=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Fecha")]),t("th",[a._v("Ventas")]),t("th",[a._v("Costos")]),t("th",[a._v("Ganancia")])])])}],o=(e("13d5"),e("dc59")),r=e("1494"),i=e("74c9"),c={name:"VentasYGananciasJoselito",components:{BackButton:i["a"]},data(){return{fechaInicial:"",fechaFinal:"",ventasPorFecha:[],isLoading:!1}},computed:{totalVentas(){return this.ventasPorFecha.reduce((a,t)=>a+t.ventas,0)},totalCostos(){return this.ventasPorFecha.reduce((a,t)=>a+t.costos,0)},gananciaTotal(){return this.totalVentas-this.totalCostos}},methods:{async buscarVentas(){if(this.fechaInicial&&this.fechaFinal){this.isLoading=!0;try{const a=Object(r["c"])(o["a"],"cuentasJoselito"),t=Object(r["o"])(a,Object(r["t"])("fecha",">=",this.fechaInicial),Object(r["t"])("fecha","<=",this.fechaFinal),Object(r["l"])("fecha","asc")),e=await Object(r["g"])(t);this.ventasPorFecha=e.docs.map(a=>{const t=a.data(),e=t.totalGeneralVenta||0,s=t.totalGeneral||0;return{fecha:t.fecha,ventas:e,costos:s,ganancia:e-s}})}catch(a){console.error("Error al buscar ventas:",a),alert("Error al cargar los datos")}finally{this.isLoading=!1}}else alert("Por favor seleccione ambas fechas")},formatNumber(a){return a.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})},formatDate(a){return new Date(a).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})},imprimirReporte(){const a=`\n        <html>\n          <head>\n            <title>Reporte de Ventas y Ganancias - Joselito</title>\n            <style>\n              body {\n                font-family: Arial, sans-serif;\n                padding: 20px;\n              }\n              h1 { color: #2196F3; }\n              table {\n                width: 100%;\n                border-collapse: collapse;\n                margin: 20px 0;\n              }\n              th, td {\n                border: 1px solid #ddd;\n                padding: 8px;\n                text-align: left;\n              }\n              th { background-color: #f5f5f5; }\n              .total { font-weight: bold; }\n              .positive { color: #4CAF50; }\n              .negative { color: #f44336; }\n            </style>\n          </head>\n          <body>\n            <h1>Reporte de Ventas y Ganancias - Joselito</h1>\n            <p>Per√≠odo: ${this.formatDate(this.fechaInicial)} - ${this.formatDate(this.fechaFinal)}</p>\n            \n            <h2>Resumen</h2>\n            <table>\n              <tr>\n                <th>Total Ventas</th>\n                <td>$${this.formatNumber(this.totalVentas)}</td>\n              </tr>\n              <tr>\n                <th>Total Costos</th>\n                <td>$${this.formatNumber(this.totalCostos)}</td>\n              </tr>\n              <tr class="total">\n                <th>Ganancia Total</th>\n                <td class="${this.gananciaTotal>0?"positive":"negative"}">\n                  $${this.formatNumber(this.gananciaTotal)}\n                </td>\n              </tr>\n            </table>\n\n            <h2>Detalle por Fecha</h2>\n            <table>\n              <thead>\n                <tr>\n                  <th>Fecha</th>\n                  <th>Ventas</th>\n                  <th>Costos</th>\n                  <th>Ganancia</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${this.ventasPorFecha.map(a=>`\n                  <tr>\n                    <td>${this.formatDate(a.fecha)}</td>\n                    <td>$${this.formatNumber(a.ventas)}</td>\n                    <td>$${this.formatNumber(a.costos)}</td>\n                    <td class="${a.ganancia>0?"positive":"negative"}">\n                      $${this.formatNumber(a.ganancia)}\n                    </td>\n                  </tr>\n                `).join("")}\n              </tbody>\n            </table>\n          </body>\n        </html>\n      `,t=window.open("","_blank");t.document.write(a),t.document.close(),t.print()}},mounted(){const a=new Date;this.fechaFinal=a.toISOString().split("T")[0],a.setMonth(a.getMonth()-1),this.fechaInicial=a.toISOString().split("T")[0],this.buscarVentas()}},l=c,d=(e("95c6"),e("2877")),u=Object(d["a"])(l,s,n,!1,null,"f6742926",null);t["a"]=u.exports},cd89:function(a,t,e){"use strict";e("4312")},d09c:function(a,t,e){"use strict";var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"veronica-cuentas-menu-container"},[t("h1",[a._v("Men√∫ de Cuentas Veronica")]),t("div",{staticClass:"actions-container actions-sticky"},[t("router-link",{staticClass:"action-button back-btn",attrs:{to:"/cuentas-mexico"}},[a._v(" Cuentas M√©xico ")]),t("router-link",{staticClass:"action-button new-cuenta-btn",attrs:{to:"/cuentas-veronica/nueva"}},[a._v(" Nueva Cuenta ")]),t("router-link",{staticClass:"action-button ventas-ganancias-btn",attrs:{to:"/ventas-ganancias-veronica"}},[a._v(" Ventas y Ganancias ")]),t("PreciosHistorialModal"),t("StashModalV2",{attrs:{cliente:"veronica"}})],1),t("div",{staticClass:"reporte-cuentas-card card"},[t("h2",[a._v("Generar reporte PDF")]),t("ReporteCuentasVeronicaButton"),t("button",{staticClass:"action-button reporte-semanal-btn",staticStyle:{"margin-top":"10px",width:"100%"},on:{click:a.generarReporteSemanal}},[a._v(" üìä Reporte Semanal ")])],1),t("div",{staticClass:"resumen-ventas-card card"},[t("h2",[a._v("Resumen de Ventas por Tipo de Producto")]),t("ResumenVentasVeronicaModal")],1),t("div",{staticClass:"filter-container"},[t("label",{attrs:{for:"filter-select"}},[a._v("Filtrar por estado:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroEstado,expression:"filtroEstado"}],attrs:{id:"filter-select"},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.filtroEstado=t.target.multiple?e:e[0]}}},[t("option",{attrs:{value:"todas"}},[a._v("Todas")]),t("option",{attrs:{value:"pagadas"}},[a._v("Pagadas")]),t("option",{attrs:{value:"no-pagadas"}},[a._v("No Pagadas")])])]),t("div",{staticClass:"cuentas-list card"},[t("h2",[a._v("Registros de Cuentas")]),a.isLoading?t("div",{staticClass:"loading"},[a._v("Cargando registros...")]):0===a.cuentasFiltradas.length?t("div",{staticClass:"no-records"},[a._v(" No hay registros de cuentas que coincidan con el filtro. ")]):t("ul",a._l(a.cuentasFiltradas,(function(e){return t("li",{key:e.id,staticClass:"cuenta-item",class:{"tiene-observacion":e.tieneObservacion||e.observacion&&e.observacion.trim().length}},[t("div",{staticClass:"cuenta-content"},[t("span",{staticClass:"cuenta-date"},[a._v(a._s(a.formatDate(e.fecha)))]),t("p",{staticClass:"cuenta-summary"},[t("span",[a._v("Saldo Hoy: $"+a._s(a.formatNumber(e.saldoHoy)))]),t("span",[a._v("Total Acumulado: $"+a._s(a.formatNumber(e.totalNota)))])]),e.tieneObservacion||e.observacion&&e.observacion.trim().length?t("div",{staticClass:"observacion-container"},[t("p",{staticClass:"observacion-texto"},[a._v(a._s(e.observacion))]),t("button",{staticClass:"delete-observacion-btn",attrs:{title:"Borrar observaci√≥n"},on:{click:function(t){return a.borrarObservacion(e.id)}}},[a._v("√ó")])]):a._e(),e.abonos&&e.abonos.length>0?t("div",{staticClass:"abonos-info"},a._l(e.abonos,(function(e,s){return t("p",{key:s,staticClass:"abono-detail"},[t("span",{staticClass:"abono-label"},[a._v("Abono:")]),t("span",{staticClass:"abono-monto"},[a._v("$"+a._s(a.formatNumber(e.monto)))]),t("span",{staticClass:"abono-descripcion"},[a._v(a._s(e.descripcion||"Sin descripci√≥n"))])])})),0):a._e(),t("span",{class:["estado-cuenta",e.estadoPagado?"pagado":"no-pagado"]},[a._v(" "+a._s(e.estadoPagado?"Pagado":"No Pagado")+" ")])]),t("div",{staticClass:"cuenta-actions"},[t("button",{staticClass:"edit-btn",on:{click:function(t){return a.editarCuenta(e.id)}}},[a._v("Editar")]),t("button",{staticClass:"delete-btn",on:{click:function(t){return a.borrarCuenta(e.id)}}},[a._v("Borrar")])])])})),0)]),a.showSaveMessage&&a.lastSaveMessage?[t("div",{staticClass:"save-message"},[a._v(" "+a._s(a.lastSaveMessage)+" ")])]:a._e(),a.showReporteSemanalModal?t("div",{staticClass:"modal-overlay",on:{click:function(t){if(t.target!==t.currentTarget)return null;a.showReporteSemanalModal=!1}}},[t("div",{staticClass:"modal-content"},[t("h2",[a._v("Reporte Semanal")]),t("div",{staticStyle:{"text-align":"center","margin-bottom":"15px"}},[t("label",{staticStyle:{display:"block","margin-bottom":"5px",color:"#666"}},[a._v("Seleccionar Semana (por fecha):")]),t("DatePicker",{attrs:{"value-type":"date",format:"DD/MM/YYYY",placeholder:"Selecciona una fecha",clearable:!1},on:{change:a.calcularReportePorFecha},model:{value:a.selectedReportDate,callback:function(t){a.selectedReportDate=t},expression:"selectedReportDate"}})],1),t("p",{staticStyle:{"text-align":"center",color:"#ff8c00","font-weight":"bold","margin-bottom":"20px"}},[a._v(" "+a._s(a.reporteSemanalData.startDate)+" - "+a._s(a.reporteSemanalData.endDate)+" ")]),t("div",{staticClass:"reporte-details",staticStyle:{margin:"20px 0"}},[t("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"10px","padding-bottom":"5px","border-bottom":"1px solid #eee"}},[t("span",{staticStyle:{"font-weight":"bold"}},[a._v("Enviado en Venta:")]),t("span",{staticStyle:{color:"#2c3e50"}},[a._v("$"+a._s(a.formatNumber(a.reporteSemanalData.totalVenta)))])]),t("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"10px","padding-bottom":"5px","border-bottom":"1px solid #eee"}},[t("span",{staticStyle:{"font-weight":"bold"}},[a._v("Total Abonado:")]),t("span",{staticStyle:{color:"#4CAF50"}},[a._v("$"+a._s(a.formatNumber(a.reporteSemanalData.totalAbonado)))])]),t("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-top":"15px","font-size":"1.1em"}},[t("span",{staticStyle:{"font-weight":"bold"}},[a._v("Faltante (Deuda):")]),t("span",{staticStyle:{color:"#f44336","font-weight":"bold"}},[a._v("$"+a._s(a.formatNumber(a.reporteSemanalData.faltante)))])])]),t("div",{staticClass:"modal-buttons",staticStyle:{"justify-content":"center","flex-direction":"column",gap:"10px"}},[t("ReporteSemanalPDFButton",{attrs:{"reporte-data":a.reporteSemanalData,"detalle-ventas":a.detalleVentasSemanal,"detalle-abonos":a.detalleAbonosSemanal}}),t("button",{staticClass:"btn-cerrar",on:{click:function(t){a.showReporteSemanalModal=!1}}},[a._v("Cerrar")])],1)])]):a._e()],2)},n=[],o=(e("14d9"),e("13d5"),e("dc59")),r=e("1494"),i=e("74c9"),c=e("666c"),l=e("3f5a"),d=e("10f2"),u=e("c8de"),h=e("2ee0"),m=e("c1df"),v=e.n(m),p=e("ec45"),b=(e("411c"),{name:"VeronicaCuentasMenu",components:{BackButton:i["a"],PreciosHistorialModal:c["a"],StashModalV2:l["a"],ReporteCuentasVeronicaButton:d["a"],ResumenVentasVeronicaModal:u["a"],DatePicker:p["a"],ReporteSemanalPDFButton:h["a"]},data(){return{cuentas:[],isLoading:!0,filtroEstado:"todas",unsubscribe:null,lastSaveMessage:"",showSaveMessage:!1,saveMessageTimer:null,showReporteSemanalModal:!1,selectedReportDate:null,reporteSemanalData:{totalVenta:0,totalAbonado:0,faltante:0,startDate:"",endDate:""},detalleVentasSemanal:[],detalleAbonosSemanal:[]}},computed:{cuentasFiltradas(){switch(this.filtroEstado){case"pagadas":return this.cuentas.filter(a=>a.estadoPagado);case"no-pagadas":return this.cuentas.filter(a=>!a.estadoPagado);default:return this.cuentas}}},methods:{async loadCuentas(){try{this.isLoading=!0;const a=Object(r["c"])(o["a"],"cuentasVeronica"),t=Object(r["o"])(a,Object(r["l"])("fecha","asc"));this.unsubscribe=Object(r["k"])(t,async a=>{const t=a.docs.map(a=>{const t=a.data(),e=(t.cobros||[]).reduce((a,t)=>a+(parseFloat(t.monto)||0),0),s=(t.abonos||[]).reduce((a,t)=>a+(parseFloat(t.monto)||0),0),n=(t.totalGeneralVenta||0)-e-s;return{id:a.id,fecha:t.fecha,saldoHoy:t.totalGeneralVenta||0,totalCobros:e,totalAbonos:s,totalNota:t.nuevoSaldoAcumulado||0,estadoPagado:0===n,nuevoSaldoAcumulado:t.nuevoSaldoAcumulado||0,saldoAcumuladoAnterior:t.saldoAcumuladoAnterior||0,abonos:t.abonos||[],tieneObservacion:t.tieneObservacion||!1,observacion:t.observacion||""}}),e=t.sort((a,t)=>new Date(a.fecha)-new Date(t.fecha));let s=0;const n=[];for(let o=0;o<e.length;o++){const a=e[o],t=a.saldoHoy-a.totalCobros-a.totalAbonos;s+=t;const r=0===o?0:e[o-1].nuevoSaldoAcumulado;a.saldoAcumuladoAnterior===r&&a.nuevoSaldoAcumulado===s||n.push({id:a.id,updates:{saldoAcumuladoAnterior:r,nuevoSaldoAcumulado:s,estadoPagado:0===t}}),a.totalNota=s,a.saldoAcumuladoAnterior=r,a.estadoPagado=0===t,s<=0&&(s=0)}n.length>0&&await Promise.all(n.map(({id:a,updates:t})=>Object(r["s"])(Object(r["e"])(o["a"],"cuentasVeronica",a),t))),this.cuentas=e.reverse(),this.isLoading=!1})}catch(a){console.error("Error al cargar cuentas: ",a),this.error=a.message,this.cuentas=[],this.isLoading=!1}},formatDate(a){const t=new Date(a);return t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),t.toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})},formatNumber(a){return a.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})},generarReporteSemanal(){this.selectedReportDate=new Date,this.calcularReportePorFecha(this.selectedReportDate),this.showReporteSemanalModal=!0},async calcularReportePorFecha(a){if(!a)return;const t=v()(a),e=t.clone().startOf("isoWeek"),s=t.clone().endOf("isoWeek"),n=this.cuentas.filter(a=>{const t=v()(a.fecha);return t.isBetween(e,s,"day","[]")}),i=n.reduce((a,t)=>a+(t.saldoHoy||0),0);this.detalleVentasSemanal=n.map(a=>({fecha:v()(a.fecha).format("DD/MM/YYYY"),monto:a.saldoHoy||0})).sort((a,t)=>v()(a.fecha,"DD/MM/YYYY").valueOf()-v()(t.fecha,"DD/MM/YYYY").valueOf());let c=0;const l=[];try{const a="cuentasVeronica",t=Object(r["o"])(Object(r["c"])(o["a"],a),Object(r["l"])("fecha","desc"),Object(r["j"])(50)),n=await Object(r["g"])(t);n.docs.forEach(a=>{const t=a.data();t.abonos&&t.abonos.length>0&&t.abonos.forEach(a=>{const t=a.fechaOriginalStash||a.fecha||a.fechaAplicacion;if(t){const n=v()(t);if(n.isValid()&&n.isBetween(e,s,"day","[]")){const t=parseFloat(a.monto)||0;c+=t,l.push({fecha:n.format("DD/MM/YYYY"),descripcion:a.descripcion||"Abono aplicado",monto:t})}}})});const i=Object(r["c"])(o["a"],"stash_veronica"),d=await Object(r["g"])(i);d.forEach(a=>{const t=a.data();if(t.fecha){const a=v()(t.fecha);if(a.isBetween(e,s,"day","[]")){const e=parseFloat(t.monto)||0;c+=e,l.push({fecha:a.format("DD/MM/YYYY"),descripcion:t.descripcion||"Abono en stash",monto:e})}}}),this.detalleAbonosSemanal=l.sort((a,t)=>v()(a.fecha,"DD/MM/YYYY").valueOf()-v()(t.fecha,"DD/MM/YYYY").valueOf())}catch(u){console.error("Error calculando abonos:",u)}const d=i-c;this.reporteSemanalData={totalVenta:i,totalAbonado:c,faltante:d,startDate:e.format("DD/MM/YYYY"),endDate:s.format("DD/MM/YYYY")}},editarCuenta(a){this.$router.push(`/cuentas-veronica/${a}?edit=true`)},async borrarCuenta(a){if(confirm("¬øEst√°s seguro de que quieres borrar este registro de cuenta?"))try{await Object(r["d"])(Object(r["e"])(o["a"],"cuentasVeronica",a)),"Registro de cuenta borrado con √©xito"===this.lastSaveMessage&&this.showSaveMessage||(this.lastSaveMessage="Registro de cuenta borrado con √©xito",this.showSaveMessage=!0,this.saveMessageTimer&&clearTimeout(this.saveMessageTimer),this.saveMessageTimer=setTimeout(()=>{this.showSaveMessage=!1},3e3))}catch(t){console.error("Error al borrar el registro de cuenta: ",t),"Error al borrar el registro de cuenta"===this.lastSaveMessage&&this.showSaveMessage||(this.lastSaveMessage="Error al borrar el registro de cuenta",this.showSaveMessage=!0,this.saveMessageTimer&&clearTimeout(this.saveMessageTimer),this.saveMessageTimer=setTimeout(()=>{this.showSaveMessage=!1},3e3))}},async borrarObservacion(a){if(confirm("¬øEst√°s seguro de que quieres borrar esta observaci√≥n?"))try{await Object(r["s"])(Object(r["e"])(o["a"],"cuentasVeronica",a),{tieneObservacion:!1,observacion:""}),"Observaci√≥n borrada con √©xito"===this.lastSaveMessage&&this.showSaveMessage||(this.lastSaveMessage="Observaci√≥n borrada con √©xito",this.showSaveMessage=!0,this.saveMessageTimer&&clearTimeout(this.saveMessageTimer),this.saveMessageTimer=setTimeout(()=>{this.showSaveMessage=!1},3e3))}catch(t){console.error("Error al borrar la observaci√≥n: ",t),"Error al borrar la observaci√≥n"===this.lastSaveMessage&&this.showSaveMessage||(this.lastSaveMessage="Error al borrar la observaci√≥n",this.showSaveMessage=!0,this.saveMessageTimer&&clearTimeout(this.saveMessageTimer),this.saveMessageTimer=setTimeout(()=>{this.showSaveMessage=!1},3e3))}}},mounted(){this.loadCuentas()},beforeUnmount(){this.unsubscribe&&this.unsubscribe()}}),g=b,f=(e("65cd"),e("2877")),_=Object(f["a"])(g,s,n,!1,null,"550bb236",null);t["a"]=_.exports},f515:function(a,t,e){"use strict";var s=function(){var a=this,t=a._self._c;return t("div",{staticClass:"ozuna-cuentas-menu-container"},[t("h1",[a._v("Men√∫ de Cuentas Ozuna")]),t("div",{staticClass:"actions-container"},[t("router-link",{staticClass:"action-button back-btn",attrs:{to:"/cuentas-mexico"}},[a._v(" Cuentas M√©xico ")]),t("router-link",{staticClass:"action-button new-cuenta-btn",attrs:{to:"/cuentas-ozuna/nueva"}},[a._v(" Nueva Cuenta ")])],1),t("div",{staticClass:"cuentas-list"},[t("h2",[a._v("Registros de Cuentas")]),a.isLoading?t("div",{staticClass:"loading"},[a._v("Cargando registros...")]):0===a.cuentas.length?t("div",{staticClass:"no-records"},[a._v(" No hay registros de cuentas. ")]):t("ul",a._l(a.cuentas,(function(e){return t("li",{key:e.id,staticClass:"cuenta-item"},[t("div",{staticClass:"cuenta-content"},[t("span",{staticClass:"cuenta-date"},[a._v(a._s(a.formatDate(e.fecha)))]),t("p",{staticClass:"cuenta-summary"},[t("span",[a._v("Saldo Hoy: $"+a._s(a.formatNumber(e.saldoHoy)))]),t("span",[a._v("Total Acumulado: $"+a._s(a.formatNumber(e.totalNota)))]),e.totalAbonos>0?t("span",{staticClass:"abono-indicator"},[a._v(" Abono: $"+a._s(a.formatNumber(e.totalAbonos))+" ")]):a._e(),e.totalCobros>0?t("span",{staticClass:"cobro-indicator"},[a._v(" Cobro: $"+a._s(a.formatNumber(e.totalCobros))+" ")]):a._e()])]),t("div",{staticClass:"cuenta-actions"},[t("button",{staticClass:"edit-btn",on:{click:function(t){return a.editarCuenta(e.id)}}},[a._v("Editar")]),t("button",{staticClass:"delete-btn",on:{click:function(t){return a.borrarCuenta(e.id)}}},[a._v("Borrar")])])])})),0)])])},n=[],o=(e("14d9"),e("13d5"),e("dc59")),r=e("1494"),i={name:"OzunaCuentasMenu",data(){return{cuentas:[],isLoading:!0}},methods:{async loadCuentas(){try{this.isLoading=!0;const a=Object(r["c"])(o["a"],"cuentasOzuna"),t=Object(r["o"])(a,Object(r["l"])("fecha","desc")),e=await Object(r["g"])(t);this.cuentas=e.docs.map(a=>{const t=a.data(),e=(t.abonos||[]).reduce((a,t)=>a+(t.monto||0),0),s=(t.cobros||[]).reduce((a,t)=>a+(t.monto||0),0);return{id:a.id,fecha:t.fecha,saldoHoy:t.totalGeneral||0,totalNota:t.totalSaldo||0,totalAbonos:e,totalCobros:s}}),console.log("Cuentas cargadas:",this.cuentas)}catch(a){console.error("Error al cargar cuentas: ",a),this.cuentas=[]}finally{this.isLoading=!1}},formatDate(a){const t=new Date(a);return t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),t.toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})},formatNumber(a){return a.toLocaleString("es-ES",{minimumFractionDigits:2,maximumFractionDigits:2})},editarCuenta(a){this.$router.push(`/cuentas-ozuna/${a}?edit=true`)},async borrarCuenta(a){if(confirm("¬øEst√°s seguro de que quieres borrar este registro de cuenta?"))try{await Object(r["d"])(Object(r["e"])(o["a"],"cuentasOzuna",a)),this.cuentas=this.cuentas.filter(t=>t.id!==a),alert("Registro de cuenta borrado con √©xito"),this.loadCuentas()}catch(t){console.error("Error al borrar el registro de cuenta: ",t),alert("Error al borrar el registro de cuenta")}}},mounted(){this.loadCuentas()}},c=i,l=(e("bee8"),e("2877")),d=Object(l["a"])(c,s,n,!1,null,"0777a32c",null);t["a"]=d.exports}}]);