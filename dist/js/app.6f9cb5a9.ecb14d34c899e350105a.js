(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app.6f9cb5a9"],{"2b17":function(e,t,o){"use strict";o("a8744")},3420:function(e,t,o){"use strict";o("14d9");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"impresion-container"},[t("h2",[e._v("Vista previa de impresiÃ³n - Pedido de CamarÃ³n Crudo")]),t("div",{staticClass:"buttons-container"},[t("button",{staticClass:"btn-generar",on:{click:e.generarPDF}},[t("span",{staticClass:"icon"},[e._v("ðŸ“„")]),e._v(" Generar PDF ")]),t("button",{staticClass:"btn-volver",on:{click:function(t){return e.$router.push("/procesos/pedidos")}}},[e._v(" Volver ")])]),t("div",{staticClass:"pdf-preview",attrs:{id:"pdfPreview"}},[t("h3",[e._v("Pedido de Crudos - "+e._s(e.fecha))]),t("table",{staticClass:"preview-table"},[t("thead",[t("tr",[t("th",[e._v("Cliente")]),e._l(e.obtenerColumnasConDatos(),(function(o){return t("th",{key:o},[e._v(" "+e._s(o)+" ")])}))],2)]),t("tbody",[e._l(e.obtenerClientesConDatos(),(function(o){return t("tr",{key:o},[t("td",{style:{backgroundColor:e.obtenerColorCliente(o),color:e.obtenerColorTextoCliente(o)}},[e._v(" "+e._s(o)+" ")]),e._l(e.obtenerColumnasConDatos(),(function(a){return t("td",{key:a},[e._v(" "+e._s(e.pedidos[o][a.toLowerCase()]||"")+" ")])}))],2)})),t("tr",{staticClass:"fila-totales"},[e._m(0),e._l(e.obtenerColumnasConDatos(),(function(o){return t("td",{key:o+"-total"},[e._v(" "+e._s(e.calcularTotalColumna(o))+" ")])}))],2)],2)])])])},i=[function(){var e=this,t=e._self._c;return t("td",[t("strong",[e._v("Total")])])}],s=(o("13d5"),o("e499")),r=o.n(s);const d={Roboto:{normal:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Regular.ttf",bold:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Medium.ttf",italics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Italic.ttf",bolditalics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-MediumItalic.ttf"}};r.a.fonts=d;var l={name:"PedidoCrudosImpresion",props:{fecha:{type:String,required:!0},pedidos:{type:Object,required:!0},columnas:{type:Array,required:!0}},methods:{obtenerClientesConDatos(){return Object.keys(this.pedidos).filter(e=>Object.values(this.pedidos[e]).some(e=>{const t=parseFloat(e);return null!==e&&""!==e&&!isNaN(t)&&t>0}))},obtenerColumnasConDatos(){return this.columnas.filter(e=>{const t=e.toLowerCase();return this.obtenerClientesConDatos().some(e=>{const o=this.pedidos[e][t],a=parseFloat(o);return null!==o&&""!==o&&!isNaN(a)&&a>0})})},obtenerColorCliente(e){const t={"8a":"#3498db",catarro:"#e74c3c",otilio:"#f1c40f",ozuna:"#2ecc71",veronica:"#ff8c00"};return t[e.toLowerCase()]||"#000000"},obtenerColorTextoCliente(e){const t=["otilio","veronica"];return t.includes(e.toLowerCase())?"#000000":"#FFFFFF"},obtenerDiaSemana(e){const t=["Domingo","Lunes","Martes","MiÃ©rcoles","Jueves","Viernes","SÃ¡bado"],[o,a,i]=e.split("-").map(Number),s=new Date(o,a-1,i);return t[s.getDay()]},calcularTotalColumna(e){const t=e.toLowerCase();return Object.keys(this.pedidos).reduce((e,o)=>{const a=parseFloat(this.pedidos[o][t])||0;return e+a},0)},generarPDF(){const e=this.obtenerClientesConDatos(),t=this.obtenerColumnasConDatos(),o=this.obtenerDiaSemana(this.fecha),a=e.map(e=>{const o=[e];return t.forEach(t=>{const a=this.pedidos[e][t.toLowerCase()]||"";o.push({text:a.toString(),alignment:"center"})}),o}),i=["Cliente",...t].map(e=>({text:e,alignment:"center"})),s=i.length>5?"100%":"auto",d=i.length>5?28:34,l={};e.forEach((e,t)=>{l[t]={fillColor:this.obtenerColorCliente(e),color:this.obtenerColorTextoCliente(e),bold:!0}});const n=t.map(e=>{const t=this.calcularTotalColumna(e);return{text:t.toString(),alignment:"center",bold:!0,italics:!0,fillColor:"#f8f9fa"}});a.push([{text:"Total",bold:!0,fillColor:"#f8f9fa"},...n]);const c={pageOrientation:"landscape",pageMargins:[40,40,40,40],content:[{text:`Pedido de Crudos - ${o} ${this.fecha}`,style:"header"},{table:{headerRows:1,widths:Array(i.length).fill("*"),body:[i,...a]},layout:{fillColor:function(e,t,o){var a;return 0===e?"#f2f2f2":0===o?null===(a=l[e-1])||void 0===a?void 0:a.fillColor:null},defaultBorder:!0,hLineWidth:function(e,t){return e===t.table.body.length-1||e===t.table.body.length?2:1},vLineWidth:function(e,t){return t.table.body.length-1===t.row?2:1},hLineColor:function(e){return"#000000"},vLineColor:function(e){return"#000000"},paddingLeft:function(e){return 10},paddingRight:function(e){return 10},paddingTop:function(e){return 10},paddingBottom:function(e){return 10}},width:s}],styles:{header:{fontSize:34,bold:!0,margin:[0,0,0,20],alignment:"center"}},defaultStyle:{fontSize:d,bold:!0,font:"Roboto"}};r.a.createPdf(c).download("Ped-crudos-"+this.fecha+".pdf")}}},n=l,c=(o("f1ca"),o("2877")),p=Object(c["a"])(n,a,i,!1,null,"5a006379",null);t["a"]=p.exports},"92c9":function(e,t,o){"use strict";o("14d9");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"impresion-container"},[t("h2",[e._v("Vista previa de impresiÃ³n - Pedido de CamarÃ³n Limpio")]),t("div",{staticClass:"scale-control"},[t("label",[e._v("Escala del contenido:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.contentScale,expression:"contentScale"}],staticClass:"scale-slider",attrs:{type:"range",min:"0.5",max:"2",step:"0.1"},domProps:{value:e.contentScale},on:{__r:function(t){e.contentScale=t.target.value}}}),t("span",{staticClass:"scale-value"},[e._v(e._s((100*e.contentScale).toFixed(0))+"%")])]),t("div",{staticClass:"buttons-container"},[t("button",{staticClass:"btn-generar",on:{click:e.generarPDF}},[t("span",{staticClass:"icon"},[e._v("ðŸ“„")]),e._v(" Generar PDF ")]),t("button",{staticClass:"btn-menu",on:{click:function(t){return e.$router.push("/procesos/pedidos")}}},[e._v(" MenÃº ")]),t("button",{staticClass:"btn-volver",on:{click:e.volverAEditar}},[e._v(" Editar Pedido ")]),t("button",{staticClass:"btn-sacada",on:{click:e.irASacadaDelDia}},[e._v(" Ir a Sacada del dÃ­a ")])]),t("div",{staticClass:"pdf-preview",attrs:{id:"pdfPreview"}},[t("div",{staticClass:"preview-page"},[t("h3",{staticClass:"cliente-header otilio-header"},[e._v("Otilio")]),t("table",{staticClass:"preview-table"},[e._m(0),t("tbody",e._l(e.pedidoOtilio||[],(function(o,a){return t("tr",{key:"otilio-"+a},[t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:o.completado,expression:"item.completado"}],staticClass:"pedido-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(o.completado)?e._i(o.completado,null)>-1:o.completado},on:{change:[function(t){var a=o.completado,i=t.target,s=!!i.checked;if(Array.isArray(a)){var r=null,d=e._i(a,r);i.checked?d<0&&e.$set(o,"completado",a.concat([r])):d>-1&&e.$set(o,"completado",a.slice(0,d).concat(a.slice(d+1)))}else e.$set(o,"completado",s)},function(t){return e.actualizarCompletado("otilio",a,o.completado)}]}})]),t("td",[e._v(e._s(o.kilos)),o.esTara?t("i",[e._v("T")]):e._e()]),t("td",[e._v(" "+e._s(o.medida)+" "),o.proveedor?t("span",{staticClass:"proveedor-tag"},[e._v(e._s(o.proveedor))]):e._e()]),t("td",{class:{"text-blue":"C/H20"===o.tipo,"text-blue compact":"1.35 y .15"===o.tipo||"1.5 y .3"===o.tipo}},[e._v(" "+e._s(o.tipo)+" "),o.nota?t("span",{staticClass:"nota-tag"},[e._v(e._s(o.nota))]):e._e()])])})),0)])]),t("div",{staticClass:"preview-page"},[t("div",{staticClass:"cliente-seccion",class:{compacto:e.pedidoJoselito&&e.pedidoJoselito.length>=5}},[t("h4",{staticClass:"cliente-header joselito-header",class:{compacto:e.pedidoJoselito&&e.pedidoJoselito.length>=5}},[e._v("Joselito")]),t("table",{staticClass:"preview-table",class:{compacto:e.pedidoJoselito&&e.pedidoJoselito.length>=5}},[e._m(1),t("tbody",e._l(e.pedidoJoselito||[],(function(o,a){return t("tr",{key:"joselito-"+a},[t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:o.completado,expression:"item.completado"}],staticClass:"pedido-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(o.completado)?e._i(o.completado,null)>-1:o.completado},on:{change:[function(t){var a=o.completado,i=t.target,s=!!i.checked;if(Array.isArray(a)){var r=null,d=e._i(a,r);i.checked?d<0&&e.$set(o,"completado",a.concat([r])):d>-1&&e.$set(o,"completado",a.slice(0,d).concat(a.slice(d+1)))}else e.$set(o,"completado",s)},function(t){return e.actualizarCompletado("joselito",a,o.completado)}]}})]),t("td",[e._v(e._s(o.kilos)),o.esTara?t("i",[e._v("T")]):e._e()]),t("td",[e._v(" "+e._s(o.medida)+" "),o.proveedor?t("span",{staticClass:"proveedor-tag"},[e._v(e._s(o.proveedor))]):e._e()]),t("td",{class:{"text-blue":"C/H20"===o.tipo,"text-blue compact":"1.35 y .15"===o.tipo||"1.5 y .3"===o.tipo}},[e._v(" "+e._s(o.tipo)+" "),o.nota?t("span",{staticClass:"nota-tag"},[e._v(e._s(o.nota))]):e._e()])])})),0)])]),t("div",{staticClass:"cliente-seccion",class:{compacto:e.pedidoLorena&&e.pedidoLorena.length>=5}},[t("h4",{staticClass:"cliente-header lorena-header",class:{compacto:e.pedidoLorena&&e.pedidoLorena.length>=5}},[e._v("Lorena")]),t("table",{staticClass:"preview-table",class:{compacto:e.pedidoLorena&&e.pedidoLorena.length>=5}},[e._m(2),t("tbody",e._l(e.pedidoLorena||[],(function(o,a){return t("tr",{key:"lorena-"+a},[t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:o.completado,expression:"item.completado"}],staticClass:"pedido-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(o.completado)?e._i(o.completado,null)>-1:o.completado},on:{change:[function(t){var a=o.completado,i=t.target,s=!!i.checked;if(Array.isArray(a)){var r=null,d=e._i(a,r);i.checked?d<0&&e.$set(o,"completado",a.concat([r])):d>-1&&e.$set(o,"completado",a.slice(0,d).concat(a.slice(d+1)))}else e.$set(o,"completado",s)},function(t){return e.actualizarCompletado("lorena",a,o.completado)}]}})]),t("td",[e._v(e._s(o.kilos)),o.esTara?t("i",[e._v("T")]):e._e()]),t("td",[e._v(" "+e._s(o.medida)+" "),o.proveedor?t("span",{staticClass:"proveedor-tag"},[e._v(e._s(o.proveedor))]):e._e()]),t("td",{class:{"text-blue":"C/H20"===o.tipo,"text-blue compact":"1.35 y .15"===o.tipo||"1.5 y .3"===o.tipo}},[e._v(" "+e._s(o.tipo)+" "),o.nota?t("span",{staticClass:"nota-tag"},[e._v(e._s(o.nota))]):e._e()])])})),0)])]),t("div",{staticClass:"bottom-section"},[t("div",{staticClass:"bottom-cliente"},[t("h4",{staticClass:"cliente-header catarro-header"},[e._v("Catarro")]),t("table",{staticClass:"preview-table"},[e._m(3),t("tbody",e._l(e.pedidoCatarro||[],(function(o,a){return t("tr",{key:"catarro-"+a},[t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:o.completado,expression:"item.completado"}],staticClass:"pedido-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(o.completado)?e._i(o.completado,null)>-1:o.completado},on:{change:[function(t){var a=o.completado,i=t.target,s=!!i.checked;if(Array.isArray(a)){var r=null,d=e._i(a,r);i.checked?d<0&&e.$set(o,"completado",a.concat([r])):d>-1&&e.$set(o,"completado",a.slice(0,d).concat(a.slice(d+1)))}else e.$set(o,"completado",s)},function(t){return e.actualizarCompletado("catarro",a,o.completado)}]}})]),t("td",[e._v(e._s(o.kilos)),o.esTara?t("i",[e._v("T")]):e._e()]),t("td",[e._v(" "+e._s(o.medida)+" "),o.proveedor?t("span",{staticClass:"proveedor-tag"},[e._v(e._s(o.proveedor))]):e._e()])])})),0)])]),t("div",{staticClass:"bottom-cliente"},[t("h4",{staticClass:"cliente-header ozuna-header"},[e._v("Ozuna")]),t("table",{staticClass:"preview-table"},[e._m(4),t("tbody",e._l(e.pedidoOzuna||[],(function(o,a){return t("tr",{key:"ozuna-"+a},[t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:o.completado,expression:"item.completado"}],staticClass:"pedido-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(o.completado)?e._i(o.completado,null)>-1:o.completado},on:{change:[function(t){var a=o.completado,i=t.target,s=!!i.checked;if(Array.isArray(a)){var r=null,d=e._i(a,r);i.checked?d<0&&e.$set(o,"completado",a.concat([r])):d>-1&&e.$set(o,"completado",a.slice(0,d).concat(a.slice(d+1)))}else e.$set(o,"completado",s)},function(t){return e.actualizarCompletado("ozuna",a,o.completado)}]}})]),t("td",[e._v(e._s(o.kilos)),o.esTara?t("i",[e._v("T")]):e._e()]),t("td",[e._v(" "+e._s(o.medida)+" "),o.proveedor?t("span",{staticClass:"proveedor-tag"},[e._v(e._s(o.proveedor))]):e._e()])])})),0)])])])]),e.clientesTemporales&&Object.keys(e.clientesTemporales).length>0?t("div",{staticClass:"preview-page"},e._l(e.clientesTemporales,(function(o,a){return t("div",{key:a,staticClass:"cliente-seccion temporal"},[t("h3",{staticClass:"cliente-header temporal-header"},[e._v(e._s(o.nombre))]),t("table",{staticClass:"preview-table"},[e._m(5,!0),t("tbody",e._l(o.pedidos||[],(function(o,i){return t("tr",{key:"temp-"+a+"-"+i},[t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:o.completado,expression:"item.completado"}],staticClass:"pedido-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(o.completado)?e._i(o.completado,null)>-1:o.completado},on:{change:function(t){var a=o.completado,i=t.target,s=!!i.checked;if(Array.isArray(a)){var r=null,d=e._i(a,r);i.checked?d<0&&e.$set(o,"completado",a.concat([r])):d>-1&&e.$set(o,"completado",a.slice(0,d).concat(a.slice(d+1)))}else e.$set(o,"completado",s)}}})]),t("td",[e._v(e._s(o.kilos)),o.esTara?t("i",[e._v("T")]):e._e()]),t("td",[e._v(" "+e._s(o.medida)+" "),o.proveedor?t("span",{staticClass:"proveedor-tag"},[e._v(e._s(o.proveedor))]):e._e()]),t("td",{class:{"text-blue":"C/H20"===o.tipo,"text-blue compact":"1.35 y .15"===o.tipo||"1.5 y .3"===o.tipo}},[e._v(" "+e._s(o.tipo)+" "),o.nota?t("span",{staticClass:"nota-tag"},[e._v(e._s(o.nota))]):e._e()])])})),0)])])})),0):e._e(),t("div",{staticClass:"resumen-medidas"},[t("h3",{staticClass:"resumen-header"},[e._v("Resumen por Medida")]),t("table",{staticClass:"resumen-table"},[e._m(6),t("tbody",[e._l(e.calcularTotalesPorMedida(),(function(o,a){return t("tr",{key:a},[t("td",{attrs:{"data-label":"Medida"}},[e._v(e._s(o.medida))]),t("td",{staticClass:"total-kilos-cell",attrs:{"data-label":"Total Kilos"}},[t("div",{staticClass:"kilos-container"},[t("span",{staticClass:"total-kilos-clickeable",attrs:{title:"Click para agregar kilos refrigerados"},on:{click:function(t){return e.abrirModalKilosRefrigerados(o)}}},[e._v(" "+e._s(o.total)+" kg ")]),e.kilosRefrigerados[o.medida]?t("div",{staticClass:"kilos-info"},[t("span",{staticClass:"kilos-refrigerados"},[e._v(" ðŸ§Š "+e._s(e.kilosRefrigerados[o.medida])+" kg ")]),t("span",{staticClass:"kilos-faltantes",class:{suficientes:e.obtenerKilosFaltantes(o)<=0,sobra:e.obtenerKilosFaltantes(o)<0}},[e.obtenerKilosFaltantes(o)>0?[e._v(" Faltan: "+e._s(e.obtenerKilosFaltantes(o))+" kg ")]:e.obtenerKilosFaltantes(o)<0?[e._v(" Sobra: "+e._s(Math.abs(e.obtenerKilosFaltantes(o)))+" kg ")]:[e._v(" Exactos: 0 kg ")]],2)]):e._e()])]),t("td",{attrs:{"data-label":"Rendimientos"}},[t("div",{staticClass:"rendimientos-column"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.rendimientos[o.medida],expression:"rendimientos[medida.medida]"}],staticClass:"rendimiento-box",attrs:{type:"number",step:"0.01",placeholder:"1.00"},domProps:{value:e.rendimientos[o.medida]},on:{input:[function(t){t.target.composing||e.$set(e.rendimientos,o.medida,t.target.value)},function(t){return e.calcularRendimiento(o)}]}}),e.rendimientos[o.medida]?t("div",{staticClass:"rendimiento-total"},[e._v(" "+e._s(Math.round(o.total*e.rendimientos[o.medida]))+" ")]):e._e()])]),t("td",{attrs:{"data-label":"Masters"}},[e.esMedidaGranja(o.medida)?t("div",{staticClass:"checkbox-group"},[t("label",[t("input",{attrs:{type:"radio",name:"master-"+o.medida},domProps:{checked:20===e.divisores[o.medida]},on:{click:function(t){return e.toggleDivisor(o,20)}}}),e._v(" 20 ")]),t("label",[t("input",{attrs:{type:"radio",name:"master-"+o.medida},domProps:{checked:22===e.divisores[o.medida]},on:{click:function(t){return e.toggleDivisor(o,22)}}}),e._v(" 22 ")])]):e._e()]),t("td",{attrs:{"data-label":"Cajas"}},[e.rendimientos[o.medida]?[e.esMedidaGranja(o.medida)&&e.divisores[o.medida]?t("span",{staticClass:"cajas-result",class:{"cajas-faltantes":e.kilosRefrigerados[o.medida]>0}},[e._v(" "+e._s(Math.round(Math.max(0,e.obtenerKilosFaltantes(o))*e.rendimientos[o.medida]/e.divisores[o.medida]))+" ")]):t("span",{staticClass:"cajas-result",class:{"cajas-faltantes":e.kilosRefrigerados[o.medida]>0}},[e._v(" "+e._s(Math.round(Math.max(0,e.obtenerKilosFaltantes(o))*e.rendimientos[o.medida]))+" kg ")])]:e._e()],2)])})),t("tr",{staticClass:"total-row"},[t("td",[e._v("Total:")]),t("td",[e._v(e._s(e.calcularTotalKilos())+" kg")]),t("td"),t("td"),t("td")])],2)])])]),t("KilosRefrigeradosModal",{attrs:{mostrar:e.modalKilosVisible,medida:e.medidaSeleccionada,"total-kilos":e.totalKilosSeleccionados,"kilos-refrigerados-iniciales":e.kilosRefrigerados[e.medidaSeleccionada]||0},on:{cerrar:e.cerrarModalKilosRefrigerados,guardar:e.guardarKilosRefrigerados}})],1)},i=[function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("âœ“")]),t("th",[e._v("Kilos/Taras")]),t("th",[e._v("Medida")]),t("th",[e._v("Tipo")])])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("âœ“")]),t("th",[e._v("Kilos/Taras")]),t("th",[e._v("Medida")]),t("th",[e._v("Tipo")])])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("âœ“")]),t("th",[e._v("Kilos/Taras")]),t("th",[e._v("Medida")]),t("th",[e._v("Tipo")])])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("âœ“")]),t("th",[e._v("Kilos/Taras")]),t("th",[e._v("Medida")])])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("âœ“")]),t("th",[e._v("Kilos/Taras")]),t("th",[e._v("Medida")])])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("âœ“")]),t("th",[e._v("Kilos/Taras")]),t("th",[e._v("Medida")]),t("th",[e._v("Tipo")])])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("Medida")]),t("th",[e._v("Total Kilos")]),t("th",[e._v("Rendimientos")]),t("th",[e._v("Masters")]),t("th",[e._v("Cajas")])])])}],s=(o("13d5"),o("e499")),r=o.n(s),d=o("6e02"),l=o("dc59"),n=o("1494");const c={Roboto:{normal:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Regular.ttf",bold:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Medium.ttf",italics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Italic.ttf",bolditalics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-MediumItalic.ttf"}};r.a.fonts=c;var p={name:"PedidoLimpioImpresion",components:{KilosRefrigeradosModal:d["a"]},props:{fecha:{type:String,required:!0},id:{type:String,default:""},pedidoOtilio:{type:Array,required:!0},pedidoCatarro:{type:Array,required:!0},pedidoJoselito:{type:Array,required:!0},pedidoLorena:{type:Array,required:!0},pedidoOzuna:{type:Array,required:!0},clientesTemporales:{type:Object,default:()=>({})},rendimientosGuardados:{type:Object,default:()=>({})},divisoresGuardados:{type:Object,default:()=>({})},completadosGuardados:{type:Object,default:()=>({})},kilosRefrigeradosGuardados:{type:Object,default:()=>({})}},data(){return{rendimientos:this.rendimientosGuardados||{},divisores:this.divisoresGuardados||{},contentScale:1,completados:this.completadosGuardados||{},kilosRefrigerados:this.kilosRefrigeradosGuardados||{},modalKilosVisible:!1,medidaSeleccionada:"",totalKilosSeleccionados:0,editando:!1,pedidoId:null}},created(){this.completados.otilio||(this.completados.otilio={}),this.completados.catarro||(this.completados.catarro={}),this.completados.joselito||(this.completados.joselito={}),this.completados.lorena||(this.completados.lorena={}),this.completados.ozuna||(this.completados.ozuna={}),this.rendimientos={...this.rendimientosGuardados},this.divisores={...this.divisoresGuardados},this.completados={...this.completadosGuardados},this.kilosRefrigerados={...this.kilosRefrigeradosGuardados},this.completados.otilio||this.$set(this.completados,"otilio",{}),this.completados.catarro||this.$set(this.completados,"catarro",{}),this.completados.joselito||this.$set(this.completados,"joselito",{}),this.completados.lorena||this.$set(this.completados,"lorena",{}),this.completados.ozuna||this.$set(this.completados,"ozuna",{}),this.id&&(this.editando=!0,this.pedidoId=this.id),this.aplicarEstadosCompletado()},methods:{itemTieneDatos(e){if(!e)return!1;const t=Number(e.kilos),o=null!==e.kilos&&""!==e.kilos&&!Number.isNaN(t)&&0!==t;return o},obtenerItemsConDatos(e){return Array.isArray(e)?e.filter(e=>this.itemTieneDatos(e)):[]},clienteTieneDatos(e){return this.obtenerItemsConDatos(e).length>0},obtenerClientesTemporalesConDatos(){return this.clientesTemporales&&"object"===typeof this.clientesTemporales?Object.entries(this.clientesTemporales).filter(([e,t])=>this.clienteTieneDatos(null===t||void 0===t?void 0:t.pedidos)).map(([e,t])=>({id:e,...t})):[]},async irASacadaDelDia(){try{const e=new Date(this.fecha+"T00:00:00"),t=new Date(this.fecha+"T23:59:59.999"),o=Object(n["o"])(Object(n["c"])(l["a"],"sacadas"),Object(n["t"])("fecha",">=",e),Object(n["t"])("fecha","<=",t)),a=await Object(n["g"])(o),i={pedidoFecha:this.fecha};if(this.id&&(i.pedidoId=this.id),i.pedidoTipo="limpio",a.empty)this.$router.push({name:"NuevaSacada",query:{...i,fecha:this.fecha}});else{const e=a.docs[0].id;this.$router.push({name:"DetalleSacada",params:{id:e},query:i})}}catch(e){console.error("Error al navegar a la sacada del dÃ­a:",e),this.$router.push("/sacadas")}},volverAEditar(){if(this.id){const e={path:"/procesos/pedidos/limpio",query:{edit:"true",id:this.id,fecha:this.fecha}},t=this.$route.path===e.path&&this.$route.query.edit===e.query.edit&&this.$route.query.id===e.query.id&&this.$route.query.fecha===e.query.fecha;if(t||"PedidosLimpio"===this.$route.name)return void this.$emit("volver");this.$router.push(e).catch(e=>{e&&"NavigationDuplicated"===e.name&&this.$emit("volver")})}else this.$router.push("/procesos/pedidos")},aplicarEstadosCompletado(){this.pedidoOtilio&&Array.isArray(this.pedidoOtilio)&&this.pedidoOtilio.forEach((e,t)=>{this.completados.otilio&&void 0!==this.completados.otilio[t]&&this.$set(e,"completado",this.completados.otilio[t])}),this.pedidoCatarro&&Array.isArray(this.pedidoCatarro)&&this.pedidoCatarro.forEach((e,t)=>{this.completados.catarro&&void 0!==this.completados.catarro[t]&&this.$set(e,"completado",this.completados.catarro[t])}),this.pedidoJoselito&&Array.isArray(this.pedidoJoselito)&&this.pedidoJoselito.forEach((e,t)=>{this.completados.joselito&&void 0!==this.completados.joselito[t]&&this.$set(e,"completado",this.completados.joselito[t])}),this.pedidoLorena&&Array.isArray(this.pedidoLorena)&&this.pedidoLorena.forEach((e,t)=>{this.completados.lorena&&void 0!==this.completados.lorena[t]&&this.$set(e,"completado",this.completados.lorena[t])}),this.pedidoOzuna&&Array.isArray(this.pedidoOzuna)&&this.pedidoOzuna.forEach((e,t)=>{this.completados.ozuna&&void 0!==this.completados.ozuna[t]&&this.$set(e,"completado",this.completados.ozuna[t])})},actualizarCompletado(e,t,o){this.completados[e]||this.$set(this.completados,e,{}),this.$set(this.completados[e],t,o),this.editando&&this.pedidoId&&Object(n["s"])(Object(n["e"])(l["a"],"pedidos",this.pedidoId),{completados:this.completados}).catch(e=>{console.error("Error al actualizar estados completados:",e)}),this.$emit("actualizar-completados",this.completados)},obtenerDiaSemana(e){const t=["Domingo","Lunes","Martes","MiÃ©rcoles","Jueves","Viernes","SÃ¡bado"],o=new Date(e);return t[o.getDay()]},generarTablaCliente(e,t=16){const o=this.obtenerItemsConDatos(e);if(0===o.length)return null;const a=o.length>7,i=a?2:16,s=o.map(e=>[{text:e.kilos?e.esTara?[{text:e.kilos.toString(),fontSize:2*t},{text:"T",fontSize:1.2*t,italics:!0,alignment:"right",margin:[0,-8,0,0]}]:{text:e.kilos.toString(),fontSize:2*t}:"",alignment:"center",margin:[0,-2,0,-2]},{stack:[{text:e.medida||"",fontSize:2*t},e.proveedor?{text:e.proveedor,fontSize:1.1*t,color:"#FFFFFF",background:"#FF0000",margin:[0,2,0,0],padding:[2,1],alignment:"center"}:""],margin:[0,2,0,2]},{stack:[{text:[{text:e.tipo||"",fontSize:2*t,color:"C/H20"===e.tipo||"1.35 y .15"===e.tipo||"1.5 y .3"===e.tipo?"#0000FF":void 0,margin:"1.35 y .15"===e.tipo||"1.5 y .3"===e.tipo?[0,0,0,0]:[0,2,0,2]}]},e.nota?{text:e.nota,fontSize:1.1*t,margin:[0,1,0,0],padding:[1,1],bold:!0,background:"#FF0000",color:"#FFFFFF"}:""],margin:[0,2,0,2]}]);return{table:{widths:["30%","35%","35%"],body:s},layout:{hLineWidth:()=>0,vLineWidth:()=>0,paddingLeft:()=>8,paddingRight:()=>8,paddingTop:()=>i,paddingBottom:()=>i}}},generarPDF(){const e=this.clienteTieneDatos(this.pedidoOtilio),t=this.clienteTieneDatos(this.pedidoJoselito),o=this.clienteTieneDatos(this.pedidoLorena),a=this.clienteTieneDatos(this.pedidoCatarro),i=this.clienteTieneDatos(this.pedidoOzuna),s=this.obtenerClientesTemporalesConDatos(),d=t&&this.obtenerItemsConDatos(this.pedidoJoselito).length>=5||o&&this.obtenerItemsConDatos(this.pedidoLorena).length>=5,l=d?.5:30,n=d?22:26,c=d?24:36,p=this.contentScale,m={otilio:48*p,joselito:(d?24:48)*p,inferior:c*p,tabla:26*p,tablaJoselito:n*p},h=[];if(e){const e=[{columns:[{text:"OTILIO",style:"clienteHeader",fontSize:m.otilio,width:"*",alignment:"left",background:"#FFEB3B"},{text:this.fecha,fontSize:.75*m.otilio,italics:!0,width:"auto",alignment:"right"}],margin:[0,0,0,10*p]},this.generarTablaCliente(this.pedidoOtilio,m.tabla)];h.push(...e);const r=t||o||a||i||s.length>0;r&&h.push({text:"",pageBreak:"after"})}const u=[];t&&u.push({text:"JOSELITO",style:"clienteHeader",fontSize:m.joselito,margin:[0,0,0,d?.5:0],background:"#2196F3"},this.generarTablaCliente(this.pedidoJoselito,m.tablaJoselito),{text:"",margin:[0,l,0,0]}),o&&u.push({text:"LORENA",style:"clienteHeader",fontSize:m.inferior,margin:[0,0,0,d?1:0],background:"#e67e22"},this.generarTablaCliente(this.pedidoLorena,m.tablaJoselito),{text:"",margin:[0,l,0,0]});const v=[];a&&v.push({stack:[{text:"CATARRO",style:"clienteHeader",fontSize:m.inferior,margin:[0,0,0,d?1:0],background:"#FF5252"},this.generarTablaClienteReducido(this.pedidoCatarro,m.tablaJoselito)],width:a&&i?"47%":"*"}),a&&i&&v.push({stack:[{canvas:[{type:"line",x1:10,y1:0,x2:10,y2:d?30:150,lineWidth:d?.3:1.5}]}],width:"6%",margin:[0,d?2:20,0,0]}),i&&v.push({stack:[{text:"OZUNA",style:"clienteHeader",fontSize:m.inferior,margin:[0,0,0,d?1:0],background:"#4CAF50"},this.generarTablaClienteReducido(this.pedidoOzuna,m.tablaJoselito)],width:a&&i?"47%":"*"}),v.length>0&&u.push({columns:v}),u.length>0&&(h.push(...u),s.length>0&&h.push({text:"",pageBreak:"after"})),s.length>0&&s.forEach(e=>{const t=this.generarTablaCliente(e.pedidos,22);t&&h.push({text:e.nombre.toUpperCase(),style:"clienteHeader",fontSize:36,margin:[0,0,0,10],background:"#95a5a6"},t,{text:"",margin:[0,20,0,20]})}),0===h.length&&h.push({text:"No hay productos para generar el PDF.",alignment:"center",margin:[0,40,0,0],fontSize:18});const f={pageSize:"letter",pageOrientation:"portrait",pageMargins:[10,10,10,10],content:h,styles:{header:{alignment:"center",margin:[0,0,0,20],bold:!0},clienteHeader:{bold:!0,alignment:"center"},tableHeader:{bold:!0,fontSize:14,color:"black",alignment:"center"}},defaultStyle:{font:"Roboto"}};r.a.createPdf(f).download("Ped-limpio-"+this.fecha+".pdf")},generarTablaClienteReducido(e,t=16){const o=this.obtenerItemsConDatos(e);if(0===o.length)return null;const a=o.map(e=>[{text:e.kilos?e.esTara?[{text:e.kilos.toString(),fontSize:2*t},{text:"T",fontSize:1.2*t,italics:!0,alignment:"right",margin:[0,-8,0,0]}]:{text:e.kilos.toString(),fontSize:2*t}:"",alignment:"center",margin:[0,-2,0,-2]},{stack:[{text:e.medida||"",fontSize:2*t},e.proveedor?{text:e.proveedor,fontSize:1.1*t,color:"#FFFFFF",background:"#FF0000",padding:[2,1],alignment:"center"}:"",e.nota?{text:e.nota,fontSize:.9*t,padding:[1,0],bold:!0,background:"#FF0000",color:"#FFFFFF"}:""],margin:[0,1,0,1]}]);return{table:{widths:["45%","55%"],body:a},layout:{hLineWidth:()=>0,vLineWidth:()=>0,paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}}},obtenerNombreCliente(e){return e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")},calcularTotalesTemporales(e){if(!this.clientesTemporales[e])return{tarasTotal:"0",kilosTotal:"0"};let t=0,o=0,a=0,i=0,s=0,r=0,d=0,l=0,n=0;this.clientesTemporales[e].forEach(e=>{e.kilos&&(e.esTara?(t+=Number(e.kilos),"C/H20"===e.tipo?a+=30*Number(e.kilos)*.65:"1.35 y .15"===e.tipo?r+=30*Number(e.kilos):"1.5 y .3"===e.tipo?l+=30*Number(e.kilos):i+=30*Number(e.kilos)):"S/H20"===e.tipo?o+=Number(e.kilos):"C/H20"===e.tipo?a+=Number(e.kilos):"1.35 y .15"===e.tipo?s+=1.35*Number(e.kilos):"1.5 y .3"===e.tipo?d+=1.5*Number(e.kilos):".7 y .3"===e.tipo&&(n+=.7*Number(e.kilos)))});const c=o/27,p=s/33.75,m=d/37.5,h=Math.round(t+c+p+m),u=o+i+r+l,v=Math.round(u+a+s+d+n);return{tarasTotal:h.toString(),kilosTotal:v.toString()}},calcularTotalesPorMedida(){const e=new Map,t=(t,o=!1)=>{t&&Array.isArray(t)&&t.forEach(t=>{if(!t.medida)return;const a=t.medida,i=o&&t.esMaquila?a.toLowerCase().trim()+"-maq":a.toLowerCase().trim();e.has(i)||e.set(i,{medida:o&&t.esMaquila?a+" Maq":a,total:0});const s=e.get(i),r=Number(t.kilos)||0;t.esTara?"C/H20"===t.tipo?s.total+=30*r*.65:("1.35 y .15"===t.tipo||t.tipo,s.total+=30*r):"C/H20"===t.tipo?s.total+=.65*r:"1.35 y .15"===t.tipo?s.total+=1.35*r:"1.5 y .3"===t.tipo?s.total+=1.5*r:o&&".7 y .3"===t.tipo?s.total+=.7*r:s.total+=r})};return t(this.pedidoOtilio),t(this.pedidoCatarro),t(this.pedidoJoselito),t(this.pedidoLorena),t(this.pedidoOzuna,!0),this.clientesTemporales&&"object"===typeof this.clientesTemporales&&Object.values(this.clientesTemporales).forEach(e=>{e&&e.pedidos&&Array.isArray(e.pedidos)&&t(e.pedidos)}),Array.from(e.values()).map(e=>({medida:e.medida,total:Math.round(e.total)})).sort((e,t)=>{const o=e.medida.replace(" Maq",""),a=t.medida.replace(" Maq","");return o===a?e.medida.includes("Maq")?1:-1:o.localeCompare(a)})},calcularRendimiento(e){const t=parseFloat(this.rendimientos[e.medida]);isNaN(t)&&(this.rendimientos[e.medida]=""),this.editando&&this.pedidoId&&Object(n["s"])(Object(n["e"])(l["a"],"pedidos",this.pedidoId),{rendimientos:this.rendimientos}).catch(e=>{console.error("Error al actualizar rendimientos:",e)}),this.$emit("actualizar-rendimientos",this.rendimientos)},toggleDivisor(e,t){this.divisores[e.medida]===t?this.$set(this.divisores,e.medida,null):this.$set(this.divisores,e.medida,t),this.editando&&this.pedidoId&&Object(n["s"])(Object(n["e"])(l["a"],"pedidos",this.pedidoId),{divisores:this.divisores}).catch(e=>{console.error("Error al actualizar divisores:",e)}),this.$emit("actualizar-divisores",this.divisores)},esMedidaGranja(e){return/^\d/.test(e)},calcularTotalKilos(){const e=this.calcularTotalesPorMedida(),t=e.reduce((e,t)=>e+t.total,0);return t.toLocaleString()},abrirModalKilosRefrigerados(e){this.medidaSeleccionada=e.medida,this.totalKilosSeleccionados=e.total,this.modalKilosVisible=!0},cerrarModalKilosRefrigerados(){this.modalKilosVisible=!1,this.medidaSeleccionada="",this.totalKilosSeleccionados=0},guardarKilosRefrigerados(e){this.$set(this.kilosRefrigerados,e.medida,e.kilosRefrigerados),this.editando&&this.pedidoId&&Object(n["s"])(Object(n["e"])(l["a"],"pedidos",this.pedidoId),{kilosRefrigerados:this.kilosRefrigerados}).catch(e=>{console.error("Error al actualizar kilos refrigerados:",e)}),this.$emit("actualizar-kilos-refrigerados",this.kilosRefrigerados)},obtenerKilosFaltantes(e){const t=this.kilosRefrigerados[e.medida]||0;return e.total-t}},watch:{rendimientosGuardados:{handler(e){this.rendimientos={...e}},deep:!0,immediate:!0},divisoresGuardados:{handler(e){this.divisores={...e}},deep:!0,immediate:!0},completadosGuardados:{handler(e){this.completados={...e},this.aplicarEstadosCompletado()},deep:!0,immediate:!0},kilosRefrigeradosGuardados:{handler(e){this.kilosRefrigerados={...e}},deep:!0,immediate:!0},pedidoOtilio:{deep:!0,handler(e){e&&Array.isArray(e)&&e.forEach((e,t)=>{e&&void 0!==e.completado&&this.actualizarCompletado("otilio",t,e.completado)})}},pedidoJoselito:{deep:!0,handler(e){e&&Array.isArray(e)&&e.forEach((e,t)=>{e&&void 0!==e.completado&&this.actualizarCompletado("joselito",t,e.completado)})}},pedidoCatarro:{deep:!0,handler(e){e&&Array.isArray(e)&&e.forEach((e,t)=>{e&&void 0!==e.completado&&this.actualizarCompletado("catarro",t,e.completado)})}},pedidoOzuna:{deep:!0,handler(e){e&&Array.isArray(e)&&e.forEach((e,t)=>{e&&void 0!==e.completado&&this.actualizarCompletado("ozuna",t,e.completado)})}}}},m=p,h=(o("2b17"),o("2877")),u=Object(h["a"])(m,a,i,!1,null,"6c888258",null);t["a"]=u.exports},a8744:function(e,t,o){},e54c:function(e,t,o){},f1ca:function(e,t,o){"use strict";o("e54c")}}]);