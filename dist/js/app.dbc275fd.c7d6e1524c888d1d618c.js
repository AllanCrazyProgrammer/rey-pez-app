(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app.dbc275fd"],{"0005":function(e,t,a){"use strict";a("526c")},2910:function(e,t,a){},"526c":function(e,t,a){},"7c84":function(e,t,a){},"91f0":function(e,t,a){"use strict";a("f198")},"928c":function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("button",{staticClass:"btn btn-outline-primary btn-esqueleto",attrs:{disabled:e.isDisabled||e.loading,title:"Generar el esqueleto del embarque desde los pedidos limpios y crudos"},on:{click:e.handleClick}},[e.loading?t("span",{staticClass:"loader-inline"}):[t("i",{staticClass:"fas fa-layer-group"}),e._v(" Esqueleto Embarque ")]],2)},i=[],o=(a("14d9"),a("1494"));const n={joselito:"1",catarro:"2",otilio:"3",ozuna:"4",lorena:"5"},c={"8a":"1",catarro:"2",otilio:"3",ozuna:"4",veronica:"5"},s={chico:"Chico c/c",med:"Med c/c","med-esp":"Med-Esp c/c","med-gde":"Med-Gde c/c",gde:"Gde c/c","gde c/ extra":"Gde c/ Extra c/c",extra:"Extra c/c",jumbo:"Jumbo c/c",linea:"Linea","lag gde":"Lag gde c/c",acamaya:"Acamaya",rechazo:"Rechazo"};var l={name:"GenerarEsqueletoEmbarqueButton",props:{fechaEmbarque:{type:String,default:""},embarqueBloqueado:{type:Boolean,default:!1}},emits:["esqueleto-generado","error"],data(){return{loading:!1}},computed:{isDisabled(){return this.embarqueBloqueado||!this.fechaEmbarque}},methods:{async handleClick(){if(!this.loading&&!this.isDisabled){this.loading=!0;try{const[e,t]=await Promise.all([this.obtenerPedidosLimpios(),this.obtenerPedidosCrudos()]);if(0===e.length&&0===t.length)return void this.emitirError("No se encontraron pedidos (limpios o crudos) para la fecha seleccionada.");const a=this.construirEsqueletoPorCliente(e);this.agregarCrudosAlEsqueleto(a,t);const r=Object.values(a).some(e=>e.length>0);if(!r)return void this.emitirError("Los pedidos no contienen medidas para los clientes predeterminados.");this.$emit("esqueleto-generado",a)}catch(e){console.error("[GenerarEsqueletoEmbarqueButton] Error al generar esqueleto:",e),this.emitirError("Ocurrió un error al generar el esqueleto del embarque. Intente nuevamente.")}finally{this.loading=!1}}},async obtenerPedidosLimpios(){const e=Object(o["h"])(),t=Object(o["c"])(e,"pedidos"),a=Object(o["o"])(t,Object(o["t"])("fecha","==",this.fechaEmbarque)),r=await Object(o["g"])(a);return r.docs.map(e=>e.data()).filter(e=>"limpio"===(e.tipo||"").toLowerCase())},async obtenerPedidosCrudos(){const e=Object(o["h"])(),t=Object(o["c"])(e,"pedidos"),a=Object(o["o"])(t,Object(o["t"])("fecha","==",this.fechaEmbarque)),r=await Object(o["g"])(a);return r.docs.map(e=>e.data()).filter(e=>"crudo"===(e.tipo||"").toLowerCase())},construirEsqueletoPorCliente(e){const t={};e.forEach(e=>{Object.entries(n).forEach(([a,r])=>{const i=Array.isArray(e[a])?e[a]:[];0!==i.length&&(t[r]||(t[r]=new Map),i.forEach(e=>{if(!e)return;const a=(e.medida||"").toString().trim();if(!a)return;const i=this.normalizarTipo(e.tipo),o=`${a}__${i.tipo||""}__${i.tipoPersonalizado||""}`;t[r].has(o)||t[r].set(o,{medida:a,tipo:i.tipo,tipoPersonalizado:i.tipoPersonalizado||""})}))})});const a={};return Object.entries(t).forEach(([e,t])=>{a[e]=Array.from(t.values())}),a},agregarCrudosAlEsqueleto(e,t){t.forEach(t=>{t.pedidos&&Object.entries(t.pedidos).forEach(([t,a])=>{const r=t.toLowerCase(),i=c[r];i&&(e[i]||(e[i]=[]),Object.entries(a).forEach(([t,a])=>{if(!a||0===parseFloat(a))return;const r=t.toLowerCase().trim(),o=s[r]||t,n=o+"__crudo__",c=e[i].some(e=>{const t=`${e.medida}__${e.tipo||""}__${e.tipoPersonalizado||""}`;return t===n});c||e[i].push({medida:o,tipo:"crudo",tipoPersonalizado:""})}))})})},normalizarTipo(e){const t=(e||"").toString().trim(),a=t.toLowerCase();return"s/h20"===a||"s/h2o"===a?{tipo:"s/h20"}:"c/h20"===a||"c/h2o"===a?{tipo:"c/h20"}:"crudo"===a?{tipo:"crudo"}:a?{tipo:"otro",tipoPersonalizado:t}:{tipo:""}},emitirError(e){this.$emit("error",e),this.$toast?this.$toast.error(e,{duration:4e3}):console.warn("[GenerarEsqueletoEmbarqueButton] "+e)}}},u=l,d=(a("91f0"),a("2877")),m=Object(d["a"])(u,r,i,!1,null,"72085d4e",null);t["a"]=m.exports},b9b6:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.clienteActivo===e.clienteId||null===e.clienteActivo,expression:"clienteActivo === clienteId || clienteActivo === null"}],staticClass:"cliente-grupo"},[t("div",{staticClass:"cliente-header sticky-header",attrs:{"data-cliente":e.nombreCliente}},[t("div",{staticClass:"cliente-info"},[t("h3",[e._v(" "+e._s(e.nombreCliente||"Cliente Desconocido")+" "),t("button",{staticClass:"btn-pedido-mini",attrs:{title:"Ver pedidos del cliente"},on:{click:function(t){return t.stopPropagation(),e.$emit("ver-pedido-cliente")}}},[t("i",{staticClass:"fas fa-clipboard-list"})])]),t("div",{staticClass:"cliente-totales"},[t("span",[e._v("Limpio: "+e._s(e.calcularTotalLimpioCliente)+"T / "+e._s(e.formatearKilos(e.calcularKilosLimpioCliente))+"Kg")]),t("span",[e._v("Crudo: "+e._s(e.calcularTotalCrudoCliente)+"T / "+e._s(e.formatearKilos(e.calcularKilosCrudoCliente))+"Kg")])])]),t("div",{staticClass:"cliente-header-controls"},[t("div",{staticClass:"juntar-medidas-checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.clientesJuntarMedidas[e.clienteId],expression:"clientesJuntarMedidas[clienteId]"}],attrs:{type:"checkbox",id:"juntar-medidas-"+e.clienteId,disabled:e.embarqueBloqueado},domProps:{checked:Array.isArray(e.clientesJuntarMedidas[e.clienteId])?e._i(e.clientesJuntarMedidas[e.clienteId],null)>-1:e.clientesJuntarMedidas[e.clienteId]},on:{change:[function(t){var a=e.clientesJuntarMedidas[e.clienteId],r=t.target,i=!!r.checked;if(Array.isArray(a)){var o=null,n=e._i(a,o);r.checked?n<0&&e.$set(e.clientesJuntarMedidas,e.clienteId,a.concat([o])):n>-1&&e.$set(e.clientesJuntarMedidas,e.clienteId,a.slice(0,n).concat(a.slice(n+1)))}else e.$set(e.clientesJuntarMedidas,e.clienteId,i)},e.handleJuntarMedidasChange],click:function(e){e.stopPropagation()}}}),t("label",{attrs:{for:"juntar-medidas-"+e.clienteId},on:{click:function(e){e.stopPropagation()}}},[e._v("Juntar medidas")])]),e.esClienteOtilio?t("div",{staticClass:"regla-otilio-checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.clientesReglaOtilio[e.clienteId],expression:"clientesReglaOtilio[clienteId]"}],attrs:{type:"checkbox",id:"regla-otilio-"+e.clienteId,disabled:e.embarqueBloqueado},domProps:{checked:Array.isArray(e.clientesReglaOtilio[e.clienteId])?e._i(e.clientesReglaOtilio[e.clienteId],null)>-1:e.clientesReglaOtilio[e.clienteId]},on:{change:[function(t){var a=e.clientesReglaOtilio[e.clienteId],r=t.target,i=!!r.checked;if(Array.isArray(a)){var o=null,n=e._i(a,o);r.checked?n<0&&e.$set(e.clientesReglaOtilio,e.clienteId,a.concat([o])):n>-1&&e.$set(e.clientesReglaOtilio,e.clienteId,a.slice(0,n).concat(a.slice(n+1)))}else e.$set(e.clientesReglaOtilio,e.clienteId,i)},e.handleReglaOtilioChange],click:function(e){e.stopPropagation()}}}),t("label",{attrs:{for:"regla-otilio-"+e.clienteId},on:{click:function(e){e.stopPropagation()}}},[e._v("Sumar 0.5 kg por cada 100 kg")])]):e._e(),t("div",{staticClass:"incluir-precios-checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.clientesIncluirPrecios[e.clienteId],expression:"clientesIncluirPrecios[clienteId]"}],attrs:{type:"checkbox",id:"incluir-precios-"+e.clienteId,disabled:e.embarqueBloqueado},domProps:{checked:Array.isArray(e.clientesIncluirPrecios[e.clienteId])?e._i(e.clientesIncluirPrecios[e.clienteId],null)>-1:e.clientesIncluirPrecios[e.clienteId]},on:{change:[function(t){var a=e.clientesIncluirPrecios[e.clienteId],r=t.target,i=!!r.checked;if(Array.isArray(a)){var o=null,n=e._i(a,o);r.checked?n<0&&e.$set(e.clientesIncluirPrecios,e.clienteId,a.concat([o])):n>-1&&e.$set(e.clientesIncluirPrecios,e.clienteId,a.slice(0,n).concat(a.slice(n+1)))}else e.$set(e.clientesIncluirPrecios,e.clienteId,i)},e.handleIncluirPreciosChange],click:function(e){e.stopPropagation()}}}),t("label",{attrs:{for:"incluir-precios-"+e.clienteId},on:{click:function(e){e.stopPropagation()}}},[e._v("Incluir precios en PDF")])]),e.clientesIncluirPrecios[e.clienteId]?t("div",{staticClass:"cuenta-en-pdf-checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.clientesCuentaEnPdf[e.clienteId],expression:"clientesCuentaEnPdf[clienteId]"}],attrs:{type:"checkbox",id:"cuenta-en-pdf-"+e.clienteId,disabled:e.embarqueBloqueado},domProps:{checked:Array.isArray(e.clientesCuentaEnPdf[e.clienteId])?e._i(e.clientesCuentaEnPdf[e.clienteId],null)>-1:e.clientesCuentaEnPdf[e.clienteId]},on:{change:[function(t){var a=e.clientesCuentaEnPdf[e.clienteId],r=t.target,i=!!r.checked;if(Array.isArray(a)){var o=null,n=e._i(a,o);r.checked?n<0&&e.$set(e.clientesCuentaEnPdf,e.clienteId,a.concat([o])):n>-1&&e.$set(e.clientesCuentaEnPdf,e.clienteId,a.slice(0,n).concat(a.slice(n+1)))}else e.$set(e.clientesCuentaEnPdf,e.clienteId,i)},e.handleCuentaEnPdfChange],click:function(e){e.stopPropagation()}}}),t("label",{attrs:{for:"cuenta-en-pdf-"+e.clienteId},on:{click:function(e){e.stopPropagation()}}},[e._v("Cuenta en PDF")])]):e._e(),e.esClienteCatarro?t("div",{staticClass:"sumar-kg-catarro-checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.clientesSumarKgCatarro[e.clienteId],expression:"clientesSumarKgCatarro[clienteId]"}],attrs:{type:"checkbox",id:"sumar-kg-catarro-"+e.clienteId,disabled:e.embarqueBloqueado},domProps:{checked:Array.isArray(e.clientesSumarKgCatarro[e.clienteId])?e._i(e.clientesSumarKgCatarro[e.clienteId],null)>-1:e.clientesSumarKgCatarro[e.clienteId]},on:{change:[function(t){var a=e.clientesSumarKgCatarro[e.clienteId],r=t.target,i=!!r.checked;if(Array.isArray(a)){var o=null,n=e._i(a,o);r.checked?n<0&&e.$set(e.clientesSumarKgCatarro,e.clienteId,a.concat([o])):n>-1&&e.$set(e.clientesSumarKgCatarro,e.clienteId,a.slice(0,n).concat(a.slice(n+1)))}else e.$set(e.clientesSumarKgCatarro,e.clienteId,i)},e.handleSumarKgCatarroChange],click:function(e){e.stopPropagation()}}}),e._v('">Sumar 1 kg')]):e._e(),t("button",{staticClass:"btn btn-primary btn-sm generar-pdf-cliente",attrs:{type:"button",title:"Generar Nota de Venta PDF (incluye página sin precios)",disabled:e.isGeneratingPdf},on:{click:function(t){return t.stopPropagation(),e.$emit("generar-pdf","cliente",e.clienteId)}}},[e.isGeneratingPdf&&e.pdfType==="cliente-"+e.clienteId?t("span",{staticClass:"loader-inline"}):t("i",{staticClass:"fas fa-file-pdf"}),e._v(" Generar Nota PDF ")]),e.esClienteJoselito?t("button",{staticClass:"btn btn-success btn-sm crear-cuenta-joselito",attrs:{type:"button",title:"Crear Cuenta para Joselito",disabled:e.isCreatingAccount},on:{click:function(t){return t.stopPropagation(),e.crearCuentaJoselito.apply(null,arguments)}}},[e.isCreatingAccount?t("span",{staticClass:"loader-inline"}):t("i",{staticClass:"fas fa-plus-circle"}),e._v(" Crear Cuenta ")]):e._e(),e.esClienteCatarro?t("button",{staticClass:"btn btn-success btn-sm crear-cuenta-catarro",attrs:{type:"button",title:"Crear Cuenta para Catarro",disabled:e.isCreatingAccount},on:{click:function(t){return t.stopPropagation(),e.crearCuentaCatarro.apply(null,arguments)}}},[e.isCreatingAccount?t("span",{staticClass:"loader-inline"}):t("i",{staticClass:"fas fa-plus-circle"}),e._v(" Crear Cuenta ")]):e._e(),e.esClienteOzuna?t("button",{staticClass:"btn btn-success btn-sm crear-cuenta-ozuna",attrs:{type:"button",title:"Crear Cuenta para Ozuna",disabled:e.isCreatingAccount},on:{click:function(t){return t.stopPropagation(),e.crearCuentaOzuna.apply(null,arguments)}}},[e.isCreatingAccount?t("span",{staticClass:"loader-inline"}):t("i",{staticClass:"fas fa-plus-circle"}),e._v(" Crear Cuenta ")]):e._e(),e.esClienteOtilio?t("button",{staticClass:"btn btn-success btn-sm crear-cuenta-otilio",attrs:{type:"button",title:"Crear Cuenta para Otilio",disabled:e.isCreatingAccount},on:{click:function(t){return t.stopPropagation(),e.crearCuentaOtilio.apply(null,arguments)}}},[e.isCreatingAccount?t("span",{staticClass:"loader-inline"}):t("i",{staticClass:"fas fa-plus-circle"}),e._v(" Crear Cuenta ")]):e._e(),e.esClienteVeronica?t("button",{staticClass:"btn btn-success btn-sm crear-cuenta-veronica",attrs:{type:"button",title:"Crear Cuenta para Veronica",disabled:e.isCreatingAccount},on:{click:function(t){return t.stopPropagation(),e.crearCuentaVeronica.apply(null,arguments)}}},[e.isCreatingAccount?t("span",{staticClass:"loader-inline"}):t("i",{staticClass:"fas fa-plus-circle"}),e._v(" Crear Cuenta ")]):e._e(),t("button",{staticClass:"btn btn-danger btn-sm eliminar-cliente",attrs:{type:"button",disabled:e.embarqueBloqueado},on:{click:function(t){return t.stopPropagation(),e.$emit("eliminar-cliente",e.clienteId)}}},[e._v("Eliminar Cliente")])])]),t("div",{staticClass:"productos-container"},[e._l(e.productos,(function(a,r){return t("ProductoItem",{key:r,attrs:{producto:a,"embarque-bloqueado":e.embarqueBloqueado,"medidas-usadas":e.medidasUsadas,"medidas-configuracion":e.medidasConfiguracion,"nombre-cliente":e.nombreCliente,"precios-actuales":e.preciosActuales,"fecha-embarque":e.fechaEmbarque},on:{"update:producto":e.actualizarProducto,"eliminar-producto":function(t){return e.$emit("eliminar-producto",a)},"mostrar-modal-precio":function(t){return e.$emit("mostrar-modal-precio",t)},"mostrar-modal-hilos":function(t){return e.$emit("mostrar-modal-hilos",t)},"mostrar-modal-nota":function(t){return e.$emit("mostrar-modal-nota",t)},"mostrar-modal-nombre-alternativo":function(t){return e.$emit("mostrar-modal-nombre-alternativo",t)},"mostrar-modal-alt":function(t){return e.$emit("mostrar-modal-alt",t)},"seleccionar-medida":e.seleccionarMedida,"activar-incluir-precios-catarro":e.activarIncluirPreciosCatarro,"marcar-campo-edicion":function(t){return e.$emit("marcar-campo-edicion",t.productoId,t.campo)},"desmarcar-campo-edicion":function(t){return e.$emit("desmarcar-campo-edicion",t.productoId,t.campo)}}})})),e._l(e.crudos,(function(a,r){return t("CrudoItem",{key:"crudo-"+r,attrs:{crudo:a,"embarque-bloqueado":e.embarqueBloqueado,"cliente-id":e.clienteId,"crudo-index":r,"precios-actuales":e.preciosActuales,"fecha-embarque":e.fechaEmbarque,"nombre-cliente":e.nombreCliente},on:{"update:crudo":function(t){return e.actualizarCrudo(r,t)},"eliminar-crudo":function(t){return e.$emit("eliminar-crudo",t,e.clienteId)},"eliminar-crudo-item":function(t){return e.$emit("eliminar-crudo-item",e.clienteId,...t)},"agregar-crudo-item":function(t){return e.$emit("agregar-crudo-item",e.clienteId,t)},"toggle-sobrante":function(t){return e.$emit("toggle-sobrante",e.clienteId,...t)},"mostrar-modal-precio":function(t){return e.$emit("mostrar-modal-precio",t)}}})}))],2),t("div",{staticClass:"botones-agregar"},[t("button",{staticClass:"btn btn-primary btn-sm agregar-producto",attrs:{type:"button",disabled:e.embarqueBloqueado},on:{click:function(t){return e.$emit("agregar-producto",e.clienteId)}}},[e._v("Agregar Producto")]),t("button",{staticClass:"btn btn-info btn-sm agregar-crudo",attrs:{type:"button",s:"",disabled:e.embarqueBloqueado},on:{click:function(t){return e.$emit("agregar-crudo",e.clienteId)}}},[e._v("Agregar Crudos")])])])},i=[],o=(a("13d5"),a("2c04")),n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"producto crudo",class:{"crudo-ozuna":e.isClienteOzuna}},[t("h2",{staticClass:"crudo-header"},[e._v("Crudos")]),t("div",{staticClass:"crudo-items"},e._l(e.crudoData.items||[],(function(a,r){return t("div",{key:"item-"+r,staticClass:"crudo-item",attrs:{"data-es-venta":a.esVenta}},[t("div",{staticClass:"crudo-talla-container"},[t("button",{staticClass:"btn-precio",class:{"tiene-precio":a.precio},attrs:{disabled:e.embarqueBloqueado},on:{click:function(t){return e.abrirModalPrecio(a)}}},[e._v(" $ ")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.talla,expression:"item.talla"}],staticClass:"form-control talla-select",attrs:{disabled:e.embarqueBloqueado},on:{change:[function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"talla",t.target.multiple?r:r[0])},function(t){return e.onTallaCrudoChange(a)}]}},[t("option",{attrs:{value:""}},[e._v("Elige talla")]),t("option",{attrs:{value:"Chico c/c"}},[e._v("Chico c/c")]),t("option",{attrs:{value:"Med c/c"}},[e._v("Med c/c")]),t("option",{attrs:{value:"Med-Esp c/c"}},[e._v("Med-Esp c/c")]),t("option",{attrs:{value:"Med-Gde c/c"}},[e._v("Med-Gde c/c")]),t("option",{attrs:{value:"Gde c/c"}},[e._v("Gde c/c")]),t("option",{attrs:{value:"Gde c/ Extra"}},[e._v("Gde c/ Extra c/c")]),t("option",{attrs:{value:"Extra c/c"}},[e._v("Extra c/c")]),t("option",{attrs:{value:"Jumbo c/c"}},[e._v("Jumbo c/c")]),t("option",{attrs:{value:"Linea"}},[e._v("Linea")]),t("option",{attrs:{value:"Lag gde c/c"}},[e._v("Lag gde c/c")]),t("option",{attrs:{value:"Acamaya"}},[e._v("Acamaya")]),t("option",{attrs:{value:"Cam s/c"}},[e._v("Cam s/c")]),t("option",{attrs:{value:"Rechazo"}},[e._v("Rechazo")])]),a.precio?t("span",{staticClass:"precio-tag"},[e._v("$"+e._s(a.precio))]):e._e(),e.isClienteOzuna?t("div",{staticClass:"venta-checkbox-container",staticStyle:{display:"none"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.esVenta,expression:"item.esVenta"}],staticClass:"form-check-input venta-checkbox",attrs:{type:"checkbox",id:"ventaCrudo-"+e.crudoIndex+"-"+r,disabled:e.embarqueBloqueado},domProps:{checked:Array.isArray(a.esVenta)?e._i(a.esVenta,null)>-1:a.esVenta},on:{change:[function(t){var r=a.esVenta,i=t.target,o=!!i.checked;if(Array.isArray(r)){var n=null,c=e._i(r,n);i.checked?c<0&&e.$set(a,"esVenta",r.concat([n])):c>-1&&e.$set(a,"esVenta",r.slice(0,c).concat(r.slice(c+1)))}else e.$set(a,"esVenta",o)},e.actualizarCrudo]}}),t("label",{attrs:{for:"ventaCrudo-"+e.crudoIndex+"-"+r}},[e._v("Venta")])]):e._e(),t("input",{directives:[{name:"model",rawName:"v-model",value:a.barco,expression:"item.barco"}],staticClass:"form-control barco-input",attrs:{type:"text",placeholder:"Barco",disabled:e.embarqueBloqueado},domProps:{value:a.barco},on:{input:[function(t){t.target.composing||e.$set(a,"barco",t.target.value)},e.actualizarCrudo]}})]),t("div",{staticClass:"crudo-taras-container"},[t("div",{staticClass:"taras-wrapper"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.taras,expression:"item.taras"}],staticClass:"form-control taras-input",attrs:{type:"text",placeholder:"Taras",disabled:e.embarqueBloqueado},domProps:{value:a.taras},on:{input:[function(t){t.target.composing||e.$set(a,"taras",t.target.value)},e.actualizarCrudo]}}),a.mostrarSobrante?t("input",{directives:[{name:"model",rawName:"v-model",value:a.sobrante,expression:"item.sobrante"}],staticClass:"form-control taras-input",attrs:{type:"text",placeholder:"Sbrte",disabled:e.embarqueBloqueado},domProps:{value:a.sobrante},on:{input:[function(t){t.target.composing||e.$set(a,"sobrante",t.target.value)},e.actualizarCrudo]}}):e._e()]),t("div",{staticClass:"buttons-wrapper"},[t("button",{staticClass:"btn btn-danger btn-sm eliminar-crudo-item",attrs:{type:"button",disabled:e.embarqueBloqueado},on:{click:function(t){return e.eliminarCrudoItem(r)}}},[e._v("-")]),t("button",{staticClass:"btn btn-success btn-sm agregar-sobrante",attrs:{type:"button",disabled:e.embarqueBloqueado},on:{click:function(t){return e.toggleSobrante(r)}}},[e._v("+")])])])])})),0),t("div",{staticClass:"crudo-footer"},[t("button",{staticClass:"btn btn-primary btn-sm agregar-crudo-item",attrs:{type:"button",disabled:e.embarqueBloqueado},on:{click:e.agregarCrudoItem}},[e._v("+ Agregar Talla/Taras")]),t("button",{staticClass:"btn btn-danger btn-sm eliminar-crudo",attrs:{type:"button",disabled:e.embarqueBloqueado},on:{click:e.eliminarCrudo}},[e._v("Eliminar Crudo")]),t("div",{staticClass:"total-crudos"},[e._v("Total de taras: "+e._s(e.calcularTotalCrudos))])])])},c=[],s=(a("14d9"),a("1cf6")),l=a("fa1c"),u={name:"CrudoItem",props:{crudo:{type:Object,default:()=>({items:[]})},embarqueBloqueado:{type:Boolean,default:!1},clienteId:{type:[String,Number],required:!0},crudoIndex:{type:Number,required:!0},preciosActuales:{type:Array,default:()=>[]},fechaEmbarque:{type:String,default:""},nombreCliente:{type:String,default:""}},emits:["update:crudo","eliminar-crudo","eliminar-crudo-item","agregar-crudo-item","toggle-sobrante","mostrar-modal-precio"],data(){return{crudoData:this.crudo||{items:[]}}},watch:{crudo:{handler(e){this.crudoData=e||{items:[]},this.isClienteOzuna&&this.crudoData.items&&this.crudoData.items.forEach(e=>{e&&this.$set(e,"esVenta",!0)}),this.asignarPrecioAutomaticoCrudo()},immediate:!0},preciosActuales:{handler(){this.asignarPrecioAutomaticoCrudo()},deep:!0},fechaEmbarque(e){e&&this.asignarPrecioAutomaticoCrudo()}},computed:{calcularTotalCrudos(){return this.crudoData&&this.crudoData.items&&Array.isArray(this.crudoData.items)?this.crudoData.items.reduce((e,t)=>{let a=this.extraerNumero(t.taras),r=this.extraerNumero(t.sobrante);return e+a+r},0):0},isClienteOzuna(){return"4"===this.clienteId||4===this.clienteId||this.$parent&&this.$parent.nombreCliente&&this.$parent.nombreCliente.toLowerCase().includes("ozuna")}},methods:{extraerNumero(e){if(!e)return 0;const t=e.toString().match(/^(\d+)/);return t?parseInt(t[1]):0},actualizarCrudo(){this.$emit("update:crudo",this.crudoData)},abrirModalPrecio(e){this.$emit("mostrar-modal-precio",e)},onTallaCrudoChange(e){e.medida=e.talla,e.precioBorradoManualmente&&this.$set(e,"precioBorradoManualmente",!1),this.asignarPrecioAutomaticoCrudo(e),this.actualizarCrudo()},agregarCrudoItem(){this.crudoData.items||(this.crudoData.items=[]);const e={talla:"",barco:"",taras:"",sobrante:"",precio:null,mostrarSobrante:!1,esVenta:this.isClienteOzuna};this.crudoData.items.push(e),this.actualizarCrudo()},eliminarCrudoItem(e){this.crudoData.items&&this.crudoData.items.length>e&&(this.crudoData.items.splice(e,1),this.actualizarCrudo())},eliminarCrudo(){this.$emit("eliminar-crudo",this.crudoIndex,this.clienteId)},toggleSobrante(e){this.crudoData.items&&this.crudoData.items.length>e&&(this.crudoData.items[e].mostrarSobrante=!this.crudoData.items[e].mostrarSobrante,this.crudoData.items[e].mostrarSobrante||(this.crudoData.items[e].sobrante=""),this.actualizarCrudo())},asignarPrecioAutomaticoCrudo(e=null){const t=(this.nombreCliente||"").trim().toLowerCase(),a={catarro:"catarro",joselito:"joselito",otilio:"otilio",ozuna:"ozuna",veronica:"veronica",lorena:"veronica"},r=a[t]||null,i=this.fechaEmbarque?Object(l["c"])(this.fechaEmbarque):Object(l["d"])(),o=e=>{if(!e)return;const t=e.medida||e.talla||"";if(!t)return;if(e.precioBorradoManualmente)return;const a=Object(s["a"])(this.preciosActuales,t,i,r);null!==a&&void 0!==a?this.$set(e,"precio",a):null!==e.precio&&void 0!==e.precio&&this.$set(e,"precio",null)};e?o(e):this.crudoData&&Array.isArray(this.crudoData.items)&&this.crudoData.items.forEach(o)}}},d=u,m=(a("bed9"),a("2877")),p=Object(m["a"])(d,n,c,!1,null,"12fe61f2",null),h=p.exports,b={name:"ClienteProductos",components:{ProductoItem:o["a"],CrudoItem:h},props:{clienteId:{type:[String,Number],required:!0},productos:{type:Array,default:()=>[]},crudos:{type:Array,default:()=>[]},clientesJuntarMedidas:{type:Object,default:()=>({})},clientesReglaOtilio:{type:Object,default:()=>({})},clientesIncluirPrecios:{type:Object,default:()=>({})},clientesCuentaEnPdf:{type:Object,default:()=>({})},clientesSumarKgCatarro:{type:Object,default:()=>({})},nombreCliente:{type:String,required:!0,default:"Cliente Desconocido"},clienteActivo:{type:[String,Number,null],default:null},embarqueBloqueado:{type:Boolean,default:!1},medidasUsadas:{type:Array,default:()=>[]},medidasConfiguracion:{type:Array,default:()=>[]},isGeneratingPdf:{type:Boolean,default:!1},pdfType:{type:String,default:""},isCreatingAccount:{type:Boolean,default:!1},preciosActuales:{type:Array,default:()=>[]},fechaEmbarque:{type:String,default:""}},emits:["update:productos","update:crudos","juntarMedidas-change","reglaOtilio-change","incluirPrecios-change","sumarKgCatarro-change","eliminar-cliente","eliminar-producto","eliminar-crudo","eliminar-crudo-item","agregar-producto","agregar-crudo","agregar-crudo-item","toggle-sobrante","mostrar-modal-precio","mostrar-modal-hilos","mostrar-modal-nota","mostrar-modal-nombre-alternativo","mostrar-modal-alt","seleccionar-medida","generar-pdf","crear-cuenta-joselito","crear-cuenta-catarro","crear-cuenta-ozuna","crear-cuenta-otilio","ver-pedido-cliente"],computed:{esClienteJoselito(){return this.nombreCliente&&this.nombreCliente.toLowerCase().includes("joselito")},esClienteCatarro(){return this.nombreCliente&&this.nombreCliente.toLowerCase().includes("catarro")},esClienteOzuna(){return this.nombreCliente&&this.nombreCliente.toLowerCase().includes("ozuna")},esClienteOtilio(){return this.nombreCliente&&this.nombreCliente.toLowerCase().includes("otilio")},esClienteVeronica(){return this.nombreCliente&&(this.nombreCliente.toLowerCase().includes("veronica")||this.nombreCliente.toLowerCase().includes("lorena"))},calcularTotalLimpioCliente(){return this.productos.reduce((e,t)=>{const a=(t.taras||[]).reduce((e,t)=>e+(t||0),0),r=(t.tarasExtra||[]).reduce((e,t)=>e+(t||0),0);return e+a+r},0)},calcularKilosLimpioCliente(){return this.productos.reduce((e,t)=>{if("c/h20"===t.tipo){const a=t.reporteTaras||[],r=t.reporteBolsas||[];let i=0;for(let e=0;e<a.length;e++){const t=parseInt(a[e])||0,o=parseInt(r[e])||0;i+=t*o}const o=i*(t.camaronNeto||.65);return e+o}{const a=(t.kilos||[]).reduce((e,t)=>e+(t||0),0),r=(t.taras||[]).reduce((e,t)=>e+(t||0),0),i=t.restarTaras?3*r:0,o=Number((a-i).toFixed(1));return e+o}},0)},calcularTotalCrudoCliente(){return this.crudos.reduce((e,t)=>t&&t.items&&Array.isArray(t.items)?e+t.items.reduce((e,t)=>{let a=this.extraerNumero(t.taras),r=this.extraerNumero(t.sobrante);return e+a+r},0):e,0)},calcularKilosCrudoCliente(){return this.crudos.reduce((e,t)=>t&&t.items&&Array.isArray(t.items)?e+t.items.reduce((e,t)=>e+this.calcularKilosCrudos(t),0):e,0)}},methods:{extraerNumero(e){if(!e)return 0;const t=e.toString().match(/^(\d+)/);return t?parseInt(t[1]):0},actualizarProducto(e){this.$emit("update:productos",this.productos.map(t=>t.id===e.id?e:t))},actualizarCrudo(e,t){const a=[...this.crudos];a[e]=t,this.$emit("update:crudos",a)},seleccionarMedida(e,t){e.medida=t,this.actualizarProducto(e),this.$emit("seleccionar-medida",e,t)},calcularKilosCrudos(e){let t=0;if(e.taras){const a=/^(\d+)-(\d+)$/.exec(e.taras);if(a){const e=parseInt(a[1])||0;let r=parseInt(a[2])||0;19===r&&(r=20),t+=e*r}else{const[a,r]=e.taras.split("-").map(Number);t+=a*r}}if(e.sobrante){const a=/^(\d+)-(\d+)$/.exec(e.sobrante);if(a){const e=parseInt(a[1])||0;let r=parseInt(a[2])||0;19===r&&(r=20),t+=e*r}else{const[a,r]=e.sobrante.split("-").map(Number);t+=a*r}}return t},formatearKilos(e){return e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:1})},handleJuntarMedidasChange(e){this.$emit("juntarMedidas-change",this.clienteId,e.target.checked)},handleReglaOtilioChange(e){this.$emit("reglaOtilio-change",this.clienteId,e.target.checked)},handleIncluirPreciosChange(e){this.$emit("incluirPrecios-change",this.clienteId,e.target.checked)},handleCuentaEnPdfChange(e){this.$emit("cuentaEnPdf-change",this.clienteId,e.target.checked)},handleSumarKgCatarroChange(e){console.log("[DEBUG] Checkbox Sumar Kg Catarro cambiado:",{clienteId:this.clienteId,checked:e.target.checked,nombreCliente:this.nombreCliente}),this.$emit("sumarKgCatarro-change",this.clienteId,e.target.checked)},crearCuentaJoselito(){this.$emit("crear-cuenta-joselito",this.clienteId,this.productos,this.crudos)},crearCuentaCatarro(){this.$emit("crear-cuenta-catarro",this.clienteId,this.productos,this.crudos)},crearCuentaOzuna(){this.$emit("crear-cuenta-ozuna",this.clienteId,this.productos,this.crudos)},crearCuentaOtilio(){this.$emit("crear-cuenta-otilio",this.clienteId,this.productos,this.crudos)},crearCuentaVeronica(){this.$emit("crear-cuenta-veronica",this.clienteId,this.productos,this.crudos)},activarIncluirPreciosCatarro(){this.esClienteCatarro&&!this.clientesIncluirPrecios[this.clienteId]&&this.$set(this.clientesIncluirPrecios,this.clienteId,!0)}}},C=b,g=(a("0005"),Object(m["a"])(C,r,i,!1,null,"233ef821",null));t["a"]=g.exports},bed9:function(e,t,a){"use strict";a("2910")},bf5e:function(e,t,a){"use strict";a("7c84")},f198:function(e,t,a){},ff7a:function(e,t,a){"use strict";var r=function(){var e=this,t=e._self._c;return e.mostrar?t("div",{staticClass:"modal-overlay",on:{click:function(t){return t.target!==t.currentTarget?null:e.cerrar.apply(null,arguments)}}},[t("div",{staticClass:"modal-contenido",on:{click:function(e){e.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[e._v(e._s(e.titulo))]),t("button",{staticClass:"btn-cerrar-modal",on:{click:function(t){return t.stopPropagation(),e.cerrar.apply(null,arguments)}}},[t("i",{staticClass:"fas fa-times"})])]),t("div",{staticClass:"modal-body"},[e._t("default")],2),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btn-secondary",on:{click:function(t){return t.stopPropagation(),e.cerrar.apply(null,arguments)}}},[e._v("Cancelar")]),t("button",{staticClass:"btn btn-primary",on:{click:function(t){return t.stopPropagation(),e.confirmar.apply(null,arguments)}}},[e._v(e._s(e.textoBotonConfirmar))])])])]):e._e()},i=[],o={name:"BaseModal",props:{mostrar:{type:Boolean,required:!0},titulo:{type:String,default:"Modal"},textoBotonConfirmar:{type:String,default:"Guardar"}},methods:{cerrar(){this.$emit("cerrar")},confirmar(){this.$emit("confirmar")}}},n=o,c=(a("bf5e"),a("2877")),s=Object(c["a"])(n,r,i,!1,null,"145be654",null);t["a"]=s.exports}}]);