(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app.13c3a502"],{"053c":function(t,e,o){"use strict";o("b2f8")},1245:function(t,e,o){"use strict";o("a874")},2531:function(t,e,o){},"27a1":function(t,e,o){},"2b5e":function(t,e,o){},"2c04":function(t,e,o){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"producto",class:{"reporte-completo":t.coincideTarasYBolsas,"reporte-incompleto":!t.coincideTarasYBolsas&&t.tieneAlgunReporte,"taras-reportadas":t.coincideTaras,"taras-no-reportadas":t.totalTaras>0&&!t.coincideTaras,"producto-en-cero":0===t.totalTaras&&0===t.totalTarasReportadas,"medida-vacia":!t.producto.medida},attrs:{"data-es-venta":t.producto.esVenta}},[t.isClienteOzuna?e("div",{staticClass:"venta-checkbox-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.esVenta,expression:"producto.esVenta"}],staticClass:"form-check-input venta-checkbox",attrs:{type:"checkbox",id:"ventaCheck-"+t.producto.id,disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.producto.esVenta)?t._i(t.producto.esVenta,null)>-1:t.producto.esVenta},on:{change:[function(e){var o=t.producto.esVenta,a=e.target,i=!!a.checked;if(Array.isArray(o)){var r=null,s=t._i(o,r);a.checked?s<0&&t.$set(t.producto,"esVenta",o.concat([r])):s>-1&&t.$set(t.producto,"esVenta",o.slice(0,s).concat(o.slice(s+1)))}else t.$set(t.producto,"esVenta",i)},t.actualizarProducto]}}),e("label",{attrs:{for:"ventaCheck-"+t.producto.id}},[t._v("Venta")])]):t._e(),e("h2",{staticClass:"encabezado-medida"},[e("div",{staticClass:"botones-encabezado"},[e("div",{staticClass:"botones-fila-superior"},[e("button",{staticClass:"btn-precio",class:{"tiene-precio":t.producto.precio},on:{click:t.abrirModalPrecio}},[t._v(" $ ")]),e("button",{staticClass:"btn-hilos",class:{"tiene-hilos":t.producto.hilos},on:{click:t.abrirModalHilos}},[t._v(" H ")])]),e("div",{staticClass:"botones-fila-inferior"},[e("button",{staticClass:"btn-nota",class:{"tiene-nota":t.producto.nota},on:{click:t.abrirModalNota}},[t._v(" N ")]),e("div",{staticClass:"kg-radio"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.noSumarKilos,expression:"producto.noSumarKilos"}],staticClass:"kg-checkbox",attrs:{type:"checkbox",id:"kg-"+t.producto.id,disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.producto.noSumarKilos)?t._i(t.producto.noSumarKilos,null)>-1:t.producto.noSumarKilos},on:{change:function(e){var o=t.producto.noSumarKilos,a=e.target,i=!!a.checked;if(Array.isArray(o)){var r=null,s=t._i(o,r);a.checked?s<0&&t.$set(t.producto,"noSumarKilos",o.concat([r])):s>-1&&t.$set(t.producto,"noSumarKilos",o.slice(0,s).concat(o.slice(s+1)))}else t.$set(t.producto,"noSumarKilos",i)}}}),e("label",{attrs:{for:"kg-"+t.producto.id}},[t._v("kg")])])])]),e("span",{staticClass:"medida-texto",class:{disabled:t.embarqueBloqueado,"tiene-nombre-alternativo":t.producto.nombreAlternativoPDF},on:{click:t.handleNombreAlternativoClick}},["c/h20"===t.producto.tipo?[t._v(" "+t._s(t.producto.nombreAlternativoPDF||t.producto.medida||"Sin Medida")+" "),e("span",{staticClass:"ch20-text"},[t._v("c/h20")]),t.producto.nombreAlternativoPDF?e("span",{staticClass:"pdf-badge",attrs:{title:"Nombre personalizado para PDF"}},[t._v("PDF")]):t._e()]:[t._v(" "+t._s(t.producto.nombreAlternativoPDF||t.producto.medida||"Sin Medida")+" - "+t._s(t.obtenerTipoProducto)+" "),t.producto.nombreAlternativoPDF?e("span",{staticClass:"pdf-badge",attrs:{title:"Nombre personalizado para PDF"}},[t._v("PDF")]):t._e()]],2),t.producto.precio?e("span",{staticClass:"precio-tag"},[t._v("$"+t._s(t.producto.precio))]):t._e()]),e("div",{staticClass:"producto-header"},[e("div",{staticClass:"medida-input-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.medida,expression:"producto.medida"}],staticClass:"medida-input",attrs:{type:"text",placeholder:"Medida",disabled:t.embarqueBloqueado,autocomplete:"off"},domProps:{value:t.producto.medida},on:{input:[function(e){e.target.composing||t.$set(t.producto,"medida",e.target.value)},t.onMedidaInput],blur:t.onMedidaBlur,focus:t.onMedidaFocus}}),e("button",{staticClass:"btn-alt",class:{"tiene-alt":t.producto.textoAlternativo},attrs:{disabled:t.embarqueBloqueado},on:{click:t.abrirModalAlt}},[t._v(" Alt ")]),t.mostrarSugerencias&&(t.sugerenciasMedidas.length>0||t.medidasConfiguracion.length>0)?e("div",{staticClass:"sugerencias-container"},[t.medidasConfiguradas.length>0?e("div",{staticClass:"sugerencias-seccion"},[e("div",{staticClass:"sugerencias-titulo"},[t._v("Medidas configuradas:")]),t._l(t.medidasConfiguradas,(function(o){return e("div",{key:"config-"+o,staticClass:"sugerencia-item config-medida",on:{mousedown:function(e){return t.seleccionarMedida(o)}}},[e("i",{staticClass:"fas fa-star"}),t._v(" "+t._s(o)+" ")])}))],2):t._e(),t.sugerenciasMedidas.length>0?e("div",{staticClass:"sugerencias-seccion"},[e("div",{staticClass:"sugerencias-titulo"},[t._v("Medidas usadas anteriormente:")]),t._l(t.sugerenciasMedidas,(function(o){return e("div",{key:"hist-"+o,staticClass:"sugerencia-item hist-medida",on:{mousedown:function(e){return t.seleccionarMedida(o)}}},[e("i",{staticClass:"fas fa-history"}),t._v(" "+t._s(o)+" ")])}))],2):t._e(),!t.producto.medida&&t.medidasConfiguracion.length>0?e("div",{staticClass:"sugerencias-seccion"},[e("div",{staticClass:"sugerencias-titulo"},[t._v("Todas las medidas disponibles:")]),t._l(t.medidasConfiguracion,(function(o){return e("div",{key:"all-"+o,staticClass:"sugerencia-item all-medida",on:{mousedown:function(e){return t.seleccionarMedida(o)}}},[t._v(" "+t._s(o)+" ")])}))],2):t._e()]):t._e()]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.producto.tipo,expression:"producto.tipo"}],staticClass:"form-control tipo-select",class:{"tipo-azul":"c/h20"===t.producto.tipo,"tipo-verde":"s/h20"===t.producto.tipo},attrs:{disabled:t.embarqueBloqueado},on:{change:[function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.producto,"tipo",e.target.multiple?o:o[0])},t.onTipoChange]}},[e("option",{attrs:{value:""}},[t._v("Seleccionar")]),e("option",{attrs:{value:"s/h20"}},[t._v("S/H20")]),e("option",{attrs:{value:"c/h20"}},[t._v("C/H20")]),e("option",{attrs:{value:"otro"}},[t._v("Otro")])]),"otro"===t.producto.tipo?e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.tipoPersonalizado,expression:"producto.tipoPersonalizado"}],staticClass:"form-control tipo-input",attrs:{type:"text",placeholder:"Especificar",disabled:t.embarqueBloqueado},domProps:{value:t.producto.tipoPersonalizado},on:{input:function(e){e.target.composing||t.$set(t.producto,"tipoPersonalizado",e.target.value)}}}):t._e(),e("button",{staticClass:"btn btn-danger btn-sm eliminar-producto",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.eliminarProducto}},[t._v("X")])]),t.esClienteAgregado?e("div",{staticClass:"refrigeracion-checkbox-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.refrigerar,expression:"producto.refrigerar"}],staticClass:"form-check-input refrigeracion-checkbox",attrs:{type:"checkbox",id:"refrigerarCheck-"+t.producto.id,disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.producto.refrigerar)?t._i(t.producto.refrigerar,null)>-1:t.producto.refrigerar},on:{change:[function(e){var o=t.producto.refrigerar,a=e.target,i=!!a.checked;if(Array.isArray(o)){var r=null,s=t._i(o,r);a.checked?s<0&&t.$set(t.producto,"refrigerar",o.concat([r])):s>-1&&t.$set(t.producto,"refrigerar",o.slice(0,s).concat(o.slice(s+1)))}else t.$set(t.producto,"refrigerar",i)},t.actualizarProducto]}}),e("label",{staticClass:"refrigeracion-label",attrs:{for:"refrigerarCheck-"+t.producto.id}},[t._v(" ðŸ§Š Refrigerar ")])]):t._e(),"c/h20"===t.producto.tipo?e("div",{staticClass:"valores-container-debajo"},[e("div",{staticClass:"valor-neto-container"},[e("label",[t._v("Valor neto:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.camaronNeto,expression:"producto.camaronNeto"}],staticClass:"camaron-neto-input ios-numeric",attrs:{type:"number",step:"0.01",min:"0",max:"1",inputmode:"numeric",pattern:"[0-9]*",disabled:t.embarqueBloqueado},domProps:{value:t.producto.camaronNeto},on:{input:function(e){e.target.composing||t.$set(t.producto,"camaronNeto",e.target.value)}}})])]):t._e(),e("div",{staticClass:"sumas-verticales"},[e("div",{staticClass:"columna"},[e("div",{staticClass:"taras-header"},[e("h5",[t._v("Taras")]),e("div",{staticClass:"checkbox-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.restarTaras,expression:"producto.restarTaras"}],attrs:{type:"checkbox",disabled:t.embarqueBloqueado},domProps:{checked:Array.isArray(t.producto.restarTaras)?t._i(t.producto.restarTaras,null)>-1:t.producto.restarTaras},on:{change:function(e){var o=t.producto.restarTaras,a=e.target,i=!!a.checked;if(Array.isArray(o)){var r=null,s=t._i(o,r);a.checked?s<0&&t.$set(t.producto,"restarTaras",o.concat([r])):s>-1&&t.$set(t.producto,"restarTaras",o.slice(0,s).concat(o.slice(s+1)))}else t.$set(t.producto,"restarTaras",i)}}}),e("label",[t._v("-3")])])]),t._l(t.producto.taras,(function(o,a){return e("div",{key:a,staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.producto.taras[a],expression:"producto.taras[taraIndex]",modifiers:{number:!0}}],staticClass:"form-control tara-input",attrs:{type:"tel",placeholder:"Tara",size:String(t.producto.taras[a]||"").length||1,disabled:t.embarqueBloqueado},domProps:{value:t.producto.taras[a]},on:{focus:function(e){return t.onTaraFocus(a,e)},blur:[function(e){return t.onTaraBlur(a)},function(e){return t.$forceUpdate()}],input:[function(e){e.target.composing||t.$set(t.producto.taras,a,t._n(e.target.value))},function(e){return t.onTaraInput(a)}]}}),e("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.eliminarTara(a)}}},[t._v("-")])])})),t._l(t.producto.tarasExtra,(function(o,a){return e("div",{key:"extra-"+a,staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.producto.tarasExtra[a],expression:"producto.tarasExtra[taraExtraIndex]",modifiers:{number:!0}}],staticClass:"form-control tara-input",attrs:{type:"tel",placeholder:"Tara Extra",size:String(t.producto.tarasExtra[a]||"").length||1,disabled:t.embarqueBloqueado},domProps:{value:t.producto.tarasExtra[a]},on:{focus:function(t){return t.target.select()},input:function(e){e.target.composing||t.$set(t.producto.tarasExtra,a,t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),e("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.eliminarTaraExtra(a)}}},[t._v("-")])])})),e("div",{staticClass:"botones-tara"},[e("button",{staticClass:"btn btn-success btn-sm agregar-tara",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.agregarTara}},[t._v("+")]),e("button",{staticClass:"btn btn-warning btn-sm agregar-tara-extra",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.agregarTaraExtra}},[t._v("+ Extra")])]),e("div",{staticClass:"total"},[t._v("Total: "+t._s(t.totalTaras))])],2),e("div",{staticClass:"columna"},[e("h5",[t._v("Kilos")]),t._l(t.producto.kilos,(function(o,a){return e("div",{key:a,staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.producto.kilos[a],expression:"producto.kilos[kiloIndex]",modifiers:{number:!0}}],staticClass:"form-control kilo-input",attrs:{type:"tel",placeholder:"Kilos",size:String(t.producto.kilos[a]||"").length||1,disabled:t.embarqueBloqueado},domProps:{value:t.producto.kilos[a]},on:{focus:function(e){return t.onKiloFocus(a,e)},blur:[function(e){return t.onKiloBlur(a)},function(e){return t.$forceUpdate()}],input:[function(e){e.target.composing||t.$set(t.producto.kilos,a,t._n(e.target.value))},function(e){return t.onKiloInput(a)}]}})])})),e("div",{staticStyle:{height:"38px"}}),e("div",{staticClass:"total"},[t._v("Total: "+t._s(t.totalKilos))])],2)]),e("div",{staticClass:"reporte-taras-bolsas"},[e("div",{staticClass:"reporte-item"},[e("h5",[t._v("Taras")]),t._l(t.producto.reporteTaras,(function(o,a){return e("div",{key:a,staticClass:"input-group mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.reporteTaras[a],expression:"producto.reporteTaras[index]"}],staticClass:"form-control reporte-input",attrs:{type:"tel",disabled:t.embarqueBloqueado},domProps:{value:t.producto.reporteTaras[a]},on:{focus:function(t){return t.target.select()},input:[function(e){e.target.composing||t.$set(t.producto.reporteTaras,a,e.target.value)},t.actualizarProducto]}}),e("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:function(e){return t.eliminarReporteTara(a)}}},[t._v("-")])])})),e("button",{staticClass:"btn btn-success btn-sm",attrs:{type:"button",disabled:t.embarqueBloqueado},on:{click:t.agregarReporteTara}},[t._v("+")]),e("div",{staticClass:"total-taras-reporte",class:{coincide:t.coincideTaras,"no-coincide":!t.coincideTaras}},[t._v(" Reportadas: "+t._s(t.totalTarasReportadas)+" ")])],2),e("div",{staticClass:"reporte-item"},[e("h5",[t._v("Bolsas")]),t._l(t.producto.reporteBolsas,(function(o,a){return e("div",{key:a,staticClass:"input-group mb-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.producto.reporteBolsas[a],expression:"producto.reporteBolsas[index]"}],staticClass:"form-control reporte-input",attrs:{type:"tel",disabled:t.embarqueBloqueado},domProps:{value:t.producto.reporteBolsas[a]},on:{focus:function(t){return t.target.select()},input:[function(e){e.target.composing||t.$set(t.producto.reporteBolsas,a,e.target.value)},t.actualizarProducto]}})])})),e("div",{staticStyle:{height:"31px"}}),e("div",{staticClass:"total-bolsas-reporte"},[t._v(" Bolsas: "+t._s(t.totalBolsasReportadas)+" ")])],2)]),t.reporteExcedeTresParentesis?e("div",{staticClass:"reporte-extenso"},[t._v(" "+t._s(t.generarReporteExtenso)+" ")]):t._e()])},i=[],r=(o("14d9"),o("13d5"),o("1cf6")),s=o("fa1c"),n={name:"ProductoItem",props:{producto:{type:Object,required:!0},embarqueBloqueado:{type:Boolean,default:!1},medidasUsadas:{type:Array,default:()=>[]},medidasConfiguracion:{type:Array,default:()=>[]},nombreCliente:{type:String,default:""},preciosActuales:{type:Array,default:()=>[]},fechaEmbarque:{type:String,default:""}},data(){return{mostrarSugerencias:!1,sugerenciasMedidas:[]}},emits:["update:producto","eliminar-producto","mostrar-modal-precio","mostrar-modal-hilos","mostrar-modal-nota","mostrar-modal-nombre-alternativo","mostrar-modal-alt","actualizar-medidas-usadas","seleccionar-medida","activar-incluir-precios-catarro","precio-asignado-automaticamente"],computed:{isClienteOzuna(){return"ozuna"===this.nombreCliente.toLowerCase()},medidasConfiguradas(){if(!this.producto.medida)return[];const t=this.producto.medida.toLowerCase();return this.medidasConfiguracion.filter(e=>e.toLowerCase().includes(t)&&e.toLowerCase()!==t)},esClienteAgregado(){const t=["joselito","catarro","ozuna","otilio","elizabeth","veronica","lorena"];return!t.includes(this.nombreCliente.toLowerCase())},totalTaras(){const t=(this.producto.taras||[]).reduce((t,e)=>t+(e||0),0),e=(this.producto.tarasExtra||[]).reduce((t,e)=>t+(e||0),0);return t+e},totalKilos(){const t=(this.producto.kilos||[]).reduce((t,e)=>t+(e||0),0),e=(this.producto.taras||[]).reduce((t,e)=>t+(e||0),0),o=this.producto.restarTaras?3*e:0,a=Number((t-o).toFixed(1));return a},obtenerTipoProducto(){return"otro"===this.producto.tipo?this.producto.tipoPersonalizado||"Otro":this.producto.tipo||"Sin Tipo"},totalTarasReportadas(){return(this.producto.reporteTaras||[]).reduce((t,e)=>t+(parseInt(e)||0),0)},totalBolsasReportadas(){const t=Array.isArray(this.producto.reporteBolsas)?this.producto.reporteBolsas:[];return(this.producto.reporteTaras||[]).reduce((e,o,a)=>{const i=parseInt(o,10)||0,r=parseInt(t[a],10)||0;return e+i*r},0)},coincideTaras(){return this.totalTarasReportadas===this.totalTaras},coincideTarasYBolsas(){const t=this.totalTaras,e=this.totalTarasReportadas;return(0!==t||0!==e)&&t===e},tieneAlgunReporte(){return(this.producto.reporteTaras||[]).some(t=>t)||(this.producto.reporteBolsas||[]).some(t=>t)},reporteExcedeTresParentesis(){const t=this.combinarTarasBolsas();return(t.match(/\(/g)||[]).length>3},generarReporteExtenso(){const t=this.combinarTarasBolsas();return t.replace(/\) /g,")\n")}},mounted(){this.asignarPrecioAutomatico(),this.nombreCliente.trim().toLowerCase().includes("catarro")&&this.$emit("activar-incluir-precios-catarro")},watch:{"producto.medida":function(){this.asignarPrecioAutomatico()},nombreCliente:function(){this.asignarPrecioAutomatico(),this.nombreCliente.trim().toLowerCase().includes("catarro")&&this.$emit("activar-incluir-precios-catarro")},preciosActuales:{handler(){this.asignarPrecioAutomatico()},deep:!0},fechaEmbarque:{handler(t){t&&this.asignarPrecioAutomatico()}},"producto.esVenta":{handler(){this.isClienteOzuna&&(this.producto.precioBorradoManualmente&&(this.producto.precioBorradoManualmente=!1),this.asignarPrecioAutomatico())}}},methods:{actualizarProducto(){this.$emit("update:producto",this.producto)},onKiloFocus(t,e){e.target.select(),this.$emit("marcar-campo-edicion",{productoId:this.producto.id,campo:"kilos-"+t})},onKiloBlur(t){this.$emit("desmarcar-campo-edicion",{productoId:this.producto.id,campo:"kilos-"+t}),this.actualizarProducto()},onKiloInput(t){},onTaraFocus(t,e){e.target.select(),this.$emit("marcar-campo-edicion",{productoId:this.producto.id,campo:"taras-"+t})},onTaraBlur(t){this.$emit("desmarcar-campo-edicion",{productoId:this.producto.id,campo:"taras-"+t}),this.actualizarProducto()},onTaraInput(t){},handleNombreAlternativoClick(){this.embarqueBloqueado||this.abrirModalNombreAlternativo()},agregarTara(){this.producto.taras.push(null),this.producto.kilos.push(null),this.actualizarProducto()},eliminarTara(t){this.producto.taras.splice(t,1),this.producto.kilos.splice(t,1),this.actualizarProducto()},agregarTaraExtra(){Array.isArray(this.producto.tarasExtra)||this.$set(this.producto,"tarasExtra",[]),this.producto.tarasExtra.push(null),this.actualizarProducto()},eliminarTaraExtra(t){this.producto.tarasExtra.splice(t,1),this.actualizarProducto()},agregarReporteTara(){Array.isArray(this.producto.reporteTaras)||this.$set(this.producto,"reporteTaras",[]),Array.isArray(this.producto.reporteBolsas)||this.$set(this.producto,"reporteBolsas",[]),this.producto.reporteTaras.push(null),this.producto.reporteBolsas.push(null),this.actualizarProducto()},eliminarReporteTara(t){this.producto.reporteTaras.splice(t,1),this.producto.reporteBolsas.splice(t,1),this.actualizarProducto()},combinarTarasBolsas(){const t={},e=this.producto.reporteTaras||[],o=this.producto.reporteBolsas||[];return e.forEach((e,a)=>{const i=o[a]||"",r=i;t[r]=(t[r]||0)+parseInt(e||1)}),Object.entries(t).map(([t,e])=>`(${e}-${t})`).join(" ")},asignarPrecioAutomatico(){if(!this.producto.medida)return;if(this.producto.precioBorradoManualmente)return;const t=this.nombreCliente.trim().toLowerCase();if("ozuna"===t&&!this.producto.esVenta)return this.producto.precio=20,void this.$emit("precio-asignado-automaticamente",{medida:this.producto.medida,cliente:t,precio:20,fecha:this.fechaEmbarque||Object(s["d"])(),esMaquila:!0,clienteId:"ozuna"});const e={catarro:"catarro",joselito:"joselito",otilio:"otilio",ozuna:"ozuna",veronica:"veronica",lorena:"veronica"},o=e[t]||null,a=this.fechaEmbarque?Object(s["c"])(this.fechaEmbarque):Object(s["d"])(),i=Object(r["a"])(this.preciosActuales,this.producto.medida,a,o);i&&(this.producto.precio=i,this.$emit("precio-asignado-automaticamente",{medida:this.producto.medida,cliente:t,precio:i,fecha:a,esMismoDiaActual:a===Object(s["d"])(),clienteId:o}))},onMedidaInput(t){const e=t.target.value.toLowerCase();this.mostrarSugerencias=!0,this.sugerenciasMedidas=e?this.medidasUsadas.filter(t=>t.toLowerCase().includes(e)&&t.toLowerCase()!==e&&!this.medidasConfiguracion.some(e=>e.toLowerCase()===t.toLowerCase())):[],this.producto.isEditing=!0,this.producto.precioBorradoManualmente&&(this.producto.precioBorradoManualmente=!1),this.asignarPrecioAutomatico(),this.actualizarProducto()},onMedidaBlur(){setTimeout(()=>{this.mostrarSugerencias=!1},200),this.actualizarProducto()},onMedidaFocus(){this.mostrarSugerencias=!0,this.producto.medida||(this.sugerenciasMedidas=[])},seleccionarMedida(t){this.producto.medida=t,this.mostrarSugerencias=!1,this.producto.precioBorradoManualmente&&(this.producto.precioBorradoManualmente=!1),this.asignarPrecioAutomatico(),this.actualizarProducto(),this.$emit("seleccionar-medida",this.producto,t)},onTipoChange(){"otro"!==this.producto.tipo&&(this.producto.tipoPersonalizado=""),"c/h20"!==this.producto.tipo||this.producto.camaronNeto||(this.producto.camaronNeto=.65),this.producto.precioBorradoManualmente&&(this.producto.precioBorradoManualmente=!1),this.asignarPrecioAutomatico(),this.actualizarProducto()},abrirModalPrecio(){this.$emit("mostrar-modal-precio",this.producto)},abrirModalHilos(){this.$emit("mostrar-modal-hilos",this.producto)},abrirModalNota(){this.$emit("mostrar-modal-nota",this.producto)},abrirModalNombreAlternativo(){this.$emit("mostrar-modal-nombre-alternativo",this.producto)},abrirModalAlt(){this.$emit("mostrar-modal-alt",this.producto)},eliminarProducto(){this.$emit("eliminar-producto",this.producto)}}},c=n,d=(o("1245"),o("2877")),l=Object(d["a"])(c,a,i,!1,null,"2f052604",null);e["a"]=l.exports},"2e3c":function(t,e,o){"use strict";o("2b5e")},"2eb9":function(t,e,o){},"3e74":function(t,e,o){"use strict";o("d70b")},4166:function(t,e,o){"use strict";o("4c89")},"4c89":function(t,e,o){},"57d4":function(t,e,o){"use strict";var a=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Nombre para PDF"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarNombre}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"nombreAlternativoPDF"}},[t._v("Nombre que aparecerÃ¡ en el PDF:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nombreLocal,expression:"nombreLocal"}],ref:"nombreInput",staticClass:"form-control",attrs:{type:"text",id:"nombreAlternativoPDF",placeholder:"Ingrese el nombre para el PDF"},domProps:{value:t.nombreLocal},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardarNombre.apply(null,arguments)},input:[function(e){e.target.composing||(t.nombreLocal=e.target.value)},t.onInputUsuario],keydown:t.onInputUsuario,focus:t.onInputUsuario}}),e("small",{staticClass:"form-text text-muted"},[t._v(" Este nombre solo se mostrarÃ¡ en el PDF generado. El nombre original se mantendrÃ¡ en la aplicaciÃ³n. ")])])])},i=[],r=o("ff7a"),s={name:"NombreAlternativoModal",components:{BaseModal:r["a"]},props:{mostrar:{type:Boolean,required:!0},nombreOriginal:{type:String,default:""},nombreAlternativo:{type:String,default:""}},data(){return{nombreLocal:"",usuarioEditando:!1,timeoutEdicion:null}},watch:{mostrar(t){t?(this.usuarioEditando=!1,this.timeoutEdicion&&(clearTimeout(this.timeoutEdicion),this.timeoutEdicion=null),this.nombreLocal=this.nombreAlternativo||this.nombreOriginal,this.$nextTick(()=>{this.$refs.nombreInput&&(this.$refs.nombreInput.focus(),this.$refs.nombreInput.select())})):(this.usuarioEditando=!1,this.timeoutEdicion&&(clearTimeout(this.timeoutEdicion),this.timeoutEdicion=null))},nombreAlternativo(t){this.mostrar&&!this.usuarioEditando&&(this.nombreLocal=t||this.nombreOriginal)}},methods:{guardarNombre(){this.timeoutEdicion&&(clearTimeout(this.timeoutEdicion),this.timeoutEdicion=null),this.usuarioEditando=!1,this.$emit("guardar",this.nombreLocal.trim())},onInputUsuario(){this.usuarioEditando=!0,this.timeoutEdicion&&clearTimeout(this.timeoutEdicion),this.timeoutEdicion=setTimeout(()=>{this.usuarioEditando=!1,this.timeoutEdicion=null},2e3)}},beforeDestroy(){this.timeoutEdicion&&clearTimeout(this.timeoutEdicion)}},n=s,c=(o("7043"),o("2877")),d=Object(c["a"])(n,a,i,!1,null,"df87262a",null);e["a"]=d.exports},6123:function(t,e,o){"use strict";var a=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Establecer Precio"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarPrecio}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"precioInput"}},[t._v("Precio:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.precioLocal,expression:"precioLocal"}],ref:"precioInput",staticClass:"form-control",attrs:{type:"number",id:"precioInput",placeholder:"Ingrese el precio",disabled:t.guardando},domProps:{value:t.precioLocal},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardarPrecio.apply(null,arguments)},input:function(e){e.target.composing||(t.precioLocal=e.target.value)}}}),t.guardando?e("div",{staticClass:"guardando-indicador"},[e("div",{staticClass:"spinner"}),e("span",[t._v("Guardando...")])]):t._e()])])},i=[],r=o("ff7a"),s={name:"PrecioModal",components:{BaseModal:r["a"]},props:{mostrar:{type:Boolean,required:!0},precio:{type:[Number,String],default:""},guardando:{type:Boolean,default:!1}},data(){return{precioLocal:""}},watch:{mostrar(t){t&&(this.precioLocal=this.precio,this.$nextTick(()=>{var t;null===(t=this.$refs.precioInput)||void 0===t||t.focus()}))},precio(t){this.precioLocal=t}},methods:{guardarPrecio(){const t=parseFloat(this.precioLocal);isNaN(t)?""===this.precioLocal&&this.$emit("guardar",null):this.$emit("guardar",t)}}},n=s,c=(o("bf23"),o("2877")),d=Object(c["a"])(n,a,i,!1,null,"f3dd5b80",null);e["a"]=d.exports},"6d00":function(t,e,o){"use strict";var a=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Establecer Nota"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarNota}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"notaInput"}},[t._v("Nota:")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.notaLocal,expression:"notaLocal"}],ref:"notaInput",staticClass:"form-control",attrs:{id:"notaInput",placeholder:"Ingrese la nota",rows:"4",disabled:t.guardando},domProps:{value:t.notaLocal},on:{input:function(e){e.target.composing||(t.notaLocal=e.target.value)}}}),t.guardando?e("div",{staticClass:"guardando-indicador"},[e("div",{staticClass:"spinner"}),e("span",[t._v("Guardando...")])]):t._e()])])},i=[],r=o("ff7a"),s={name:"NotaModal",components:{BaseModal:r["a"]},props:{mostrar:{type:Boolean,required:!0},nota:{type:String,default:""},guardando:{type:Boolean,default:!1}},data(){return{notaLocal:""}},watch:{mostrar(t){t&&(this.notaLocal=this.nota,this.$nextTick(()=>{var t;null===(t=this.$refs.notaInput)||void 0===t||t.focus()}))},nota(t){this.notaLocal=t}},methods:{guardarNota(){this.$emit("guardar",this.notaLocal.trim())}}},n=s,c=(o("4166"),o("2877")),d=Object(c["a"])(n,a,i,!1,null,"107ff0c0",null);e["a"]=d.exports},7043:function(t,e,o){"use strict";o("991e")},"7edf":function(t,e,o){},"7fed":function(t,e,o){"use strict";o("27a1")},9131:function(t,e,o){"use strict";o("d129")},"991e":function(t,e,o){},a874:function(t,e,o){},ad72:function(t,e,o){"use strict";o("13d5");e["a"]={methods:{totalTaras(t){const e=(t.taras||[]).reduce((t,e)=>t+(e||0),0),o=(t.tarasExtra||[]).reduce((t,e)=>t+(e||0),0);return e+o},totalKilos(t){const e=(t.kilos||[]).reduce((t,e)=>t+(e||0),0),o=(t.taras||[]).reduce((t,e)=>t+(e||0),0),a=t.restarTaras?3*o:0,i=Number((e-a).toFixed(1));return i},calcularKilosProductoCH20(t){const e=t.reporteTaras||[],o=t.reporteBolsas||[];let a=0;if(e.length>0&&o.length>0){for(let t=0;t<e.length;t++){const i=parseInt(e[t])||0,r=parseInt(o[t])||0;a+=i*r}const i=t.camaronNeto&&t.camaronNeto>0?t.camaronNeto:.65;return a*i}{const e=(t.kilos||[]).reduce((t,e)=>t+(Number(e)||0),0),o=t.camaronNeto&&t.camaronNeto>0?t.camaronNeto:.65;return e*o}},calcularKilosCrudos(t){let e=0;if(t.taras){const o=/^(\d+)-(\d+)$/.exec(t.taras);if(o){const t=parseInt(o[1])||0;let a=parseInt(o[2])||0;19===a&&(a=20),e+=t*a}else{const[o,a]=t.taras.split("-").map(Number);e+=o*a}}if(t.sobrante){const o=/^(\d+)-(\d+)$/.exec(t.sobrante);if(o){const t=parseInt(o[1])||0;let a=parseInt(o[2])||0;19===a&&(a=20),e+=t*a}else{const[o,a]=t.sobrante.split("-").map(Number);e+=o*a}}return e},calcularTarasCrudos(t){let e=0;if(t.taras){const[o]=t.taras.split("-").map(Number);e+=o}if(t.sobrante){const[o]=t.sobrante.split("-").map(Number);e+=o}return e},combinarTarasBolsas(t,e){const o={};return t.forEach((t,a)=>{const i=e[a]||"",r=i;o[r]=(o[r]||0)+parseInt(t||1)}),Object.entries(o).map(([t,e])=>`(${e}-${t})`).join(" ")},totalTarasReportadas(t){return(t.reporteTaras||[]).reduce((t,e)=>t+(parseInt(e)||0),0)},totalBolsasReportadas(t){return(t.reporteTaras||[]).reduce((e,o,a)=>{const i=parseInt(o)||0,r=parseInt(t.reporteBolsas[a])||0;return e+i*r},0)},coincideTaras(t){const e=this.totalTarasReportadas(t),o=this.totalTaras(t);return e===o},coincideTarasYBolsas(t){const e=this.totalTaras(t),o=this.totalTarasReportadas(t);return(0!==e||0!==o)&&e===o},tieneAlgunReporte(t){return(t.reporteTaras||[]).some(t=>t)||(t.reporteBolsas||[]).some(t=>t)},formatearKilos(t){return t.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:1})},compararMedidas(t,e){if(!t)return 1;if(!e)return-1;const o=t=>{const e=t.match(/\d+/g);return e?1===e.length?[parseInt(e[0]),parseInt(e[0])]:[parseInt(e[0]),parseInt(e[1])]:[0,0]},[a,i]=o(t),[r,s]=o(e);return a&&r?a-r:t.localeCompare(e)},formatearTallaCrudo(t){const e={"Med c/c":"Med","Med-Esp c/c":"Esp","Med-gde c/c":"M-G","Gde c/c":"Gde","Extra c/c":"Ext","Jumbo c/c":"Jbo",Linea:"Lin",Rechazo:"Rch"};return e[t]||t}}}},ad92:function(t,e,o){"use strict";o("2eb9")},b2f8:function(t,e,o){},bf23:function(t,e,o){"use strict";o("7edf")},c005:function(t,e,o){"use strict";var a=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Establecer Hilos"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarHilos}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"hilosInput"}},[t._v("Hilos:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.hilosLocal,expression:"hilosLocal"}],ref:"hilosInput",staticClass:"form-control",attrs:{type:"text",id:"hilosInput",placeholder:"Ingrese los hilos",disabled:t.guardando},domProps:{value:t.hilosLocal},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardarHilos.apply(null,arguments)},input:function(e){e.target.composing||(t.hilosLocal=e.target.value)}}}),t.guardando?e("div",{staticClass:"guardando-indicador"},[e("div",{staticClass:"spinner"}),e("span",[t._v("Guardando...")])]):t._e()])])},i=[],r=o("ff7a"),s={name:"HilosModal",components:{BaseModal:r["a"]},props:{mostrar:{type:Boolean,required:!0},hilos:{type:String,default:""},guardando:{type:Boolean,default:!1}},data(){return{hilosLocal:""}},watch:{mostrar(t){t&&(this.hilosLocal=this.hilos,this.$nextTick(()=>{var t;null===(t=this.$refs.hilosInput)||void 0===t||t.focus()}))},hilos(t){this.hilosLocal=t}},methods:{guardarHilos(){this.$emit("guardar",this.hilosLocal.trim())}}},n=s,c=(o("9131"),o("2877")),d=Object(c["a"])(n,a,i,!1,null,"e9c2fe66",null);e["a"]=d.exports},c0b0:function(t,e,o){"use strict";var a=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Nombre Alternativo para PDF"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.guardarAlt}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"altInput"}},[t._v("Nombre alternativo:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.altLocal,expression:"altLocal"}],ref:"altInput",staticClass:"form-control",attrs:{type:"text",id:"altInput",placeholder:"Ingrese el nombre alternativo para PDF",disabled:t.guardando},domProps:{value:t.altLocal},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.guardarAlt.apply(null,arguments)},input:[function(e){e.target.composing||(t.altLocal=e.target.value)},t.onInputUsuario],keydown:t.onInputUsuario,focus:t.onInputUsuario}}),e("small",{staticClass:"form-text text-muted"},[t._v(" Este nombre solo se mostrarÃ¡ en el PDF de resumen de embarque. ")]),t.guardando?e("div",{staticClass:"guardando-indicador"},[e("div",{staticClass:"spinner"}),e("span",[t._v("Guardando...")])]):t._e()])])},i=[],r=o("ff7a"),s={name:"AltModal",components:{BaseModal:r["a"]},props:{mostrar:{type:Boolean,required:!0},alt:{type:String,default:""},guardando:{type:Boolean,default:!1}},data(){return{altLocal:"",usuarioEditando:!1,timeoutEdicion:null}},watch:{mostrar(t){t?(this.usuarioEditando=!1,this.timeoutEdicion&&(clearTimeout(this.timeoutEdicion),this.timeoutEdicion=null),this.altLocal=this.alt,this.$nextTick(()=>{var t;null===(t=this.$refs.altInput)||void 0===t||t.focus()})):(this.usuarioEditando=!1,this.timeoutEdicion&&(clearTimeout(this.timeoutEdicion),this.timeoutEdicion=null))},alt(t){this.mostrar&&!this.usuarioEditando&&(this.altLocal=t)}},methods:{guardarAlt(){this.timeoutEdicion&&(clearTimeout(this.timeoutEdicion),this.timeoutEdicion=null),this.usuarioEditando=!1,this.$emit("guardar",this.altLocal.trim())},onInputUsuario(){this.usuarioEditando=!0,this.timeoutEdicion&&clearTimeout(this.timeoutEdicion),this.timeoutEdicion=setTimeout(()=>{this.usuarioEditando=!1,this.timeoutEdicion=null},2e3)}},beforeDestroy(){this.timeoutEdicion&&clearTimeout(this.timeoutEdicion)}},n=s,c=(o("ad92"),o("2877")),d=Object(c["a"])(n,a,i,!1,null,"23a92a9e",null);e["a"]=d.exports},c62d:function(t,e,o){"use strict";o("2531")},d10f:function(t,e,o){"use strict";var a=function(){var t=this,e=t._self._c;return t.mostrar?e("div",{staticClass:"modal-pedido-overlay",on:{click:t.cerrarModal}},[e("div",{staticClass:"modal-pedido-content",on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"modal-pedido-header"},[e("h2",[t._v("ðŸ“‹ Pedidos de "+t._s(t.nombreCliente)+" - "+t._s(t.fechaEmbarque))]),e("button",{staticClass:"btn-cerrar-modal",on:{click:t.cerrarModal}},[t._v("Ã—")])]),e("div",{staticClass:"modal-pedido-body"},[t.cargandoPedidos?e("div",{staticClass:"cargando-pedidos"},[e("div",{staticClass:"spinner"}),e("p",[t._v("Cargando pedidos del cliente...")])]):t.pedidoLimpio||t.pedidoCrudo?e("div",{staticClass:"pedidos-cliente-contenedor"},[t.pedidoLimpio?e("div",{staticClass:"pedido-seccion limpio"},[e("div",{staticClass:"pedido-seccion-header"},[e("div",{staticClass:"pedido-tipo-info"},[e("span",{staticClass:"tipo-badge limpio"},[t._v("Limpio")]),e("div",{staticClass:"pedido-totales"},[e("span",[t._v(t._s(t.calcularKilosPedidoLimpio)+" kg")]),e("span",[t._v(t._s(t.calcularTarasPedidoLimpio)+" T")])])]),e("div",{staticClass:"pedido-acciones"},[e("button",{staticClass:"btn-editar-pedido",on:{click:function(e){return t.editarPedido(t.pedidoLimpio)}}},[t._v(" âœï¸ Editar ")])])]),e("div",{staticClass:"pedido-detalles"},[e("div",{staticClass:"items-lista"},t._l(t.itemsPedidoLimpio,(function(o,a){return e("div",{key:a,staticClass:"item-pedido"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(t.pedidoLimpio.id,"limpio",t.nombreClienteEncontradoLimpio,a)},on:{change:function(e){return t.toggleItemCompletado(t.pedidoLimpio.id,"limpio",t.nombreClienteEncontradoLimpio,a,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"item-texto",class:{completado:t.getItemCompletadoState(t.pedidoLimpio.id,"limpio",t.nombreClienteEncontradoLimpio,a)}},[t._v(" "+t._s(o.kilos)+t._s(o.esTara?" T":" kg")+" - "+t._s(o.medida||"Sin medida")+" - "),e("span",{staticClass:"tipo-producto",class:{"no-sh20":o.tipo&&"S/H20"!==o.tipo}},[t._v(" "+t._s(o.tipo||"Sin tipo")+" ")])])])})),0)])]):t._e(),t.pedidoCrudo?e("div",{staticClass:"pedido-seccion crudo"},[e("div",{staticClass:"pedido-seccion-header"},[e("div",{staticClass:"pedido-tipo-info"},[e("span",{staticClass:"tipo-badge crudo"},[t._v("Crudo")]),e("div",{staticClass:"pedido-totales"},[e("span",[t._v(t._s(t.calcularKilosPedidoCrudo)+" kg")]),e("span",[t._v(t._s(t.calcularTarasPedidoCrudo)+" T")])])]),e("div",{staticClass:"pedido-acciones"},[e("button",{staticClass:"btn-editar-pedido",on:{click:function(e){return t.editarPedido(t.pedidoCrudo)}}},[t._v(" âœï¸ Editar ")])])]),e("div",{staticClass:"pedido-detalles"},[e("div",{staticClass:"columnas-crudo"},t._l(t.itemsPedidoCrudo,(function(o,a){return o?e("div",{key:a,staticClass:"columna-item"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(t.pedidoCrudo.id,"crudo",t.nombreClienteEncontradoCrudo,a)},on:{change:function(e){return t.toggleItemCompletado(t.pedidoCrudo.id,"crudo",t.nombreClienteEncontradoCrudo,a,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"columna-texto",class:{completado:t.getItemCompletadoState(t.pedidoCrudo.id,"crudo",t.nombreClienteEncontradoCrudo,a)}},[t._v(" "+t._s(a)+": "+t._s(o)+" ")])]):t._e()})),0)])]):t._e()]):e("div",{staticClass:"sin-pedidos-cliente"},[e("div",{staticClass:"icono-sin-pedidos"},[t._v("ðŸ“„")]),e("p",[t._v("No hay pedidos registrados para "+t._s(t.nombreCliente)+" el dÃ­a "+t._s(t.fechaEmbarque))]),e("div",{staticClass:"acciones-sin-pedidos"},[e("button",{staticClass:"btn-crear-pedido crudo",on:{click:t.crearPedidoCrudo}},[t._v(" + Crear Pedido Crudo ")]),e("button",{staticClass:"btn-crear-pedido limpio",on:{click:t.crearPedidoLimpio}},[t._v(" + Crear Pedido Limpio ")])])])]),e("div",{staticClass:"modal-pedido-footer"},[e("button",{staticClass:"btn-cerrar-footer",on:{click:t.cerrarModal}},[t._v("Cerrar")])])])]):t._e()},i=[],r=(o("14d9"),o("88e6"),o("70cc"),o("eb03"),o("22e5c"),o("c01e"),o("fa76"),o("8306"),o("1494")),s={name:"PedidoClienteModal",props:{mostrar:{type:Boolean,default:!1},fechaEmbarque:{type:String,default:""},nombreCliente:{type:String,default:""}},data(){return{pedidoLimpio:null,pedidoCrudo:null,cargandoPedidos:!1,itemsCompletados:{},nombreClienteEncontradoLimpio:null,nombreClienteEncontradoCrudo:null}},computed:{clienteKey(){return this.nombreCliente?this.nombreCliente.toLowerCase():""},posiblesNombresCliente(){if(!this.nombreCliente||""===this.nombreCliente.trim())return[];const t=[],e=this.nombreCliente;return t.push(e),t.push(e.toLowerCase()),t.push(e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),(e.toLowerCase().includes("veronica")||e.toLowerCase().includes("lorena"))&&t.push("Veronica","veronica","Lorena","lorena"),(e.toLowerCase().includes("joselito")||"8a"===e.toLowerCase())&&t.push("Joselito","joselito","8a","8A"),[...new Set(t)]},itemsPedidoLimpio(){if(!this.pedidoLimpio)return[];for(const t of this.posiblesNombresCliente)if(this.pedidoLimpio[t]&&this.pedidoLimpio[t].length>0)return this.pedidoLimpio[t];if(this.pedidoLimpio.clientesTemporales)for(const t in this.pedidoLimpio.clientesTemporales){const e=this.pedidoLimpio.clientesTemporales[t];if(e.nombre){const t=e.nombre.toLowerCase();for(const o of this.posiblesNombresCliente)if(t===o.toLowerCase())return e.pedidos||[]}}return[]},itemsPedidoCrudo(){if(!this.pedidoCrudo||!this.pedidoCrudo.pedidos)return{};for(const t of this.posiblesNombresCliente)if(this.pedidoCrudo.pedidos[t])return this.pedidoCrudo.pedidos[t];return{}},calcularKilosPedidoLimpio(){let t=0;return this.itemsPedidoLimpio.forEach(e=>{e.kilos&&(e.esTara?"C/H20"===e.tipo?t+=30*Number(e.kilos)*.65:(e.tipo,t+=30*Number(e.kilos)):"S/H20"===e.tipo||"C/H20"===e.tipo?t+=Number(e.kilos):"1.35 y .15"===e.tipo?t+=1.35*Number(e.kilos):".7 y .3"===e.tipo&&(t+=.7*Number(e.kilos)))}),Math.round(t).toString()},calcularTarasPedidoLimpio(){let t=0,e=0,o=0;this.itemsPedidoLimpio.forEach(a=>{a.kilos&&(a.esTara?t+=Number(a.kilos):"S/H20"===a.tipo?e+=Number(a.kilos):"1.35 y .15"===a.tipo&&(o+=Number(a.kilos)))});const a=e/25,i=o/33.75;return Math.round(t+a+i).toString()},calcularKilosPedidoCrudo(){let t=0;for(const e in this.itemsPedidoCrudo){const o=this.itemsPedidoCrudo[e];o&&!isNaN(o)&&(t+=parseFloat(o))}return(19*t).toFixed(0)},calcularTarasPedidoCrudo(){const t=parseFloat(this.calcularKilosPedidoCrudo);return Math.round(t/19).toString()}},watch:{mostrar(t){t&&this.cargarPedidosCliente()}},methods:{async cargarPedidosCliente(){if(this.nombreCliente&&""!==this.nombreCliente.trim()){this.cargandoPedidos=!0;try{const t=Object(r["h"])(),e=Object(r["c"])(t,"pedidos"),o=Object(r["o"])(e,Object(r["t"])("fecha","==",this.fechaEmbarque)),a=await Object(r["g"])(o);this.pedidoLimpio=null,this.pedidoCrudo=null,this.itemsCompletados={},this.nombreClienteEncontradoLimpio=null,this.nombreClienteEncontradoCrudo=null,a.docs.forEach(t=>{const e=t.data();if("limpio"===e.tipo){let o=null;for(const t of this.posiblesNombresCliente)if(e[t]&&e[t].length>0){o=t;break}if(!o&&e.clientesTemporales)for(const t in e.clientesTemporales){const a=e.clientesTemporales[t];if(a.nombre){const t=a.nombre.toLowerCase();for(const e of this.posiblesNombresCliente)if(t===e.toLowerCase()){o=a.nombre;break}if(o)break}}o&&(this.pedidoLimpio={id:t.id,...e},this.nombreClienteEncontradoLimpio=o,this.cargarEstadosCompletados(t.id,e,"limpio"))}else if("crudo"===e.tipo){let o=null;if(e.pedidos)for(const t of this.posiblesNombresCliente)if(e.pedidos[t]){o=t;break}o&&(this.pedidoCrudo={id:t.id,...e},this.nombreClienteEncontradoCrudo=o,this.cargarEstadosCompletados(t.id,e,"crudo"))}})}catch(t){console.error("Error al cargar los pedidos del cliente:",t),alert("Hubo un error al cargar los pedidos del cliente. Por favor, intente de nuevo.")}finally{this.cargandoPedidos=!1}}},cargarEstadosCompletados(t,e,o){if(this.$set(this.itemsCompletados,t,{}),e.itemsCompletados)if("limpio"===o){const o=this.nombreClienteEncontradoLimpio;if(o&&e[o]&&e[o].forEach((a,i)=>{const r=`limpio-${o}-${i}`;e.itemsCompletados[r]&&this.$set(this.itemsCompletados[t],r,e.itemsCompletados[r])}),e.clientesTemporales)for(const a in e.clientesTemporales){const i=e.clientesTemporales[a];i.nombre===o&&i.pedidos&&i.pedidos.forEach((o,i)=>{const r=`limpio-${a}-${i}`;e.itemsCompletados[r]&&this.$set(this.itemsCompletados[t],r,e.itemsCompletados[r])})}}else if("crudo"===o){const o=this.nombreClienteEncontradoCrudo;if(o&&e.pedidos&&e.pedidos[o])for(const a in e.pedidos[o]){const i=`crudo-${o}-${a}`;e.itemsCompletados[i]&&this.$set(this.itemsCompletados[t],i,e.itemsCompletados[i])}}},async toggleItemCompletado(t,e,o,a,i){try{const s=`${e}-${o}-${a}`;this.itemsCompletados[t]||this.$set(this.itemsCompletados,t,{}),this.$set(this.itemsCompletados[t],s,i);const n=Object(r["h"])(),c=Object(r["e"])(n,"pedidos",t);await Object(r["s"])(c,{["itemsCompletados."+s]:i,[`itemsCompletados.${s}_fecha`]:i?(new Date).toISOString():null}),console.log(`Item ${s} marcado como ${i?"completado":"pendiente"}`)}catch(s){console.error("Error al actualizar estado del item:",s);const r=`${e}-${o}-${a}`;this.$set(this.itemsCompletados[t],r,!i),alert("Error al actualizar el estado del item. Por favor, intente de nuevo.")}},getItemCompletadoState(t,e,o,a){const i=`${e}-${o}-${a}`;return this.itemsCompletados[t]&&this.itemsCompletados[t][i]||!1},editarPedido(t){const e="crudo"===t.tipo?"/procesos/pedidos/crudo":"/procesos/pedidos/limpio";this.$router.push({path:e,query:{edit:"true",id:t.id,fecha:t.fecha}}),this.cerrarModal()},crearPedidoCrudo(){this.$router.push({path:"/procesos/pedidos/crudo",query:{fecha:this.fechaEmbarque}}),this.cerrarModal()},crearPedidoLimpio(){this.$router.push({path:"/procesos/pedidos/limpio",query:{fecha:this.fechaEmbarque}}),this.cerrarModal()},cerrarModal(){this.$emit("cerrar"),this.pedidoLimpio=null,this.pedidoCrudo=null,this.itemsCompletados={},this.nombreClienteEncontradoLimpio=null,this.nombreClienteEncontradoCrudo=null}}},n=s,c=(o("3e74"),o("2877")),d=Object(c["a"])(n,a,i,!1,null,"690aec02",null);e["a"]=d.exports},d129:function(t,e,o){},d70b:function(t,e,o){},d830:function(t,e,o){"use strict";var a=function(){var t=this,e=t._self._c;return t.mostrar?e("div",{staticClass:"modal-overlay"},[e("div",{staticClass:"modal-configuracion-medidas"},[e("div",{staticClass:"modal-header"},[e("h3",[t._v("ConfiguraciÃ³n de Medidas")]),e("button",{staticClass:"btn-cerrar",on:{click:t.cerrar}},[t._v("Ã—")])]),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"agregar-medida-section"},[e("h4",[t._v("Agregar Nueva Medida")]),e("div",{staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.nuevaMedida,expression:"nuevaMedida"}],staticClass:"input-nueva-medida",attrs:{type:"text",placeholder:"Ingresa una nueva medida (ej: 16/20, 21/25, etc.)"},domProps:{value:t.nuevaMedida},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.agregarMedida.apply(null,arguments)},input:function(e){e.target.composing||(t.nuevaMedida=e.target.value)}}}),e("button",{staticClass:"btn btn-success",attrs:{disabled:!t.nuevaMedida.trim()},on:{click:t.agregarMedida}},[t._v(" Agregar ")])])]),e("div",{staticClass:"medidas-configuradas-section"},[e("h4",[t._v("Medidas Disponibles en el Selector")]),e("p",{staticClass:"descripcion"},[t._v(" Selecciona las medidas que aparecerÃ¡n como opciones en el campo de medida. Los usuarios tambiÃ©n podrÃ¡n escribir manualmente medidas que no estÃ©n en esta lista. ")]),e("div",{staticClass:"medidas-grid"},t._l(t.todasLasMedidas,(function(o){return e("div",{key:o,staticClass:"medida-item",class:{seleccionada:t.medidasSeleccionadas.includes(o)},on:{click:function(e){return t.toggleMedida(o)}}},[e("span",{staticClass:"medida-texto"},[t._v(t._s(o))]),t.medidasSeleccionadas.includes(o)?e("span",{staticClass:"checkmark"},[t._v("âœ“")]):t._e()])})),0)])]),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",on:{click:t.cerrar}},[t._v("Cancelar")]),e("button",{staticClass:"btn btn-primary",on:{click:t.guardar}},[t._v("Guardar ConfiguraciÃ³n")])])])]):t._e()},i=[],r=(o("14d9"),o("88e6"),o("70cc"),o("eb03"),o("22e5c"),o("c01e"),o("fa76"),o("8306"),{name:"ConfiguracionMedidasModal",props:{mostrar:{type:Boolean,default:!1},medidasConfiguracion:{type:Array,default:()=>[]},medidasUsadas:{type:Array,default:()=>[]}},emits:["cerrar","guardar"],data(){return{nuevaMedida:"",medidasSeleccionadas:[...this.medidasConfiguracion]}},computed:{todasLasMedidas(){const t=new Set([...this.medidasUsadas,...this.medidasSeleccionadas]);return Array.from(t).sort()}},watch:{medidasConfiguracion:{handler(t){this.medidasSeleccionadas=[...t]},immediate:!0}},methods:{agregarMedida(){const t=this.nuevaMedida.trim();t&&!this.todasLasMedidas.includes(t)&&(this.medidasSeleccionadas.push(t),this.nuevaMedida="")},toggleMedida(t){const e=this.medidasSeleccionadas.indexOf(t);-1===e?this.medidasSeleccionadas.push(t):this.medidasSeleccionadas.splice(e,1)},cerrar(){this.$emit("cerrar")},guardar(){this.$emit("guardar",this.medidasSeleccionadas),this.cerrar()}}}),s=r,n=(o("2e3c"),o("2877")),c=Object(n["a"])(s,a,i,!1,null,"3a901204",null);e["a"]=c.exports},e7ae:function(t,e,o){"use strict";o("d9e2"),o("14d9"),o("88e6"),o("70cc"),o("eb03"),o("22e5c"),o("c01e"),o("fa76"),o("8306");var a=o("2fe3"),i=o("80ac"),r=o("692f");e["a"]={methods:{async generarPDF(t,e=null){this.$set(this,"isGeneratingPdf",!0),this.$set(this,"pdfType",e?`${t}-${e}`:t);try{switch(t){case"cliente":await this.generarPDFCliente(e);break;case"all":await this.generarPDFTodosClientes();break;case"taras":await this.generarPDFTaras();break;case"resumen":await this.generarPDFResumen();break;default:throw new Error("Tipo de PDF no soportado: "+t)}console.log(`PDF ${t} generado con Ã©xito`)}catch(o){console.error(`Error al generar PDF ${t}:`,o),alert("Hubo un error al generar el PDF: "+o.message)}finally{this.$set(this,"isGeneratingPdf",!1),this.$set(this,"pdfType",null)}},async generarPDFCliente(t){const e=this.productosPorCliente[t],o=this.clienteCrudos[t];e&&e.forEach(t=>{t.medida&&t.tipo&&(t.isEditing=!1,t.isNew=!1)});const i={fecha:this.embarque.fecha,cargaCon:this.embarque.cargaCon,productos:e,clienteCrudos:{[t]:o},kilosCrudos:this.embarque.kilosCrudos||{}};Object(a["a"])(i,this.clientesDisponibles,this.clientesJuntarMedidas,this.clientesReglaOtilio,this.clientesIncluirPrecios,this.clientesSumarKgCatarro,this.clientesCuentaEnPdf)},async generarPDFTodosClientes(){this.embarque.productos&&this.embarque.productos.forEach(t=>{t.medida&&t.tipo&&(t.isEditing=!1,t.isNew=!1)});const t={fecha:this.embarque.fecha,cargaCon:this.embarque.cargaCon,productos:this.embarque.productos,clienteCrudos:this.clienteCrudos,kilosCrudos:this.embarque.kilosCrudos||{}};Object(a["a"])(t,this.clientesDisponibles,this.clientesJuntarMedidas,this.clientesReglaOtilio,this.clientesIncluirPrecios,this.clientesSumarKgCatarro,this.clientesCuentaEnPdf)},async generarPDFTaras(){const t={fecha:this.embarque.fecha,cargaCon:this.embarque.cargaCon,productos:this.embarque.productos,clienteCrudos:this.clienteCrudos};Object(i["a"])(t,this.clientesDisponibles)},async generarPDFResumen(t=100){const e=new Set;Object.values(this.clienteCrudos).forEach(t=>{t.forEach(t=>{t&&t.items&&Array.isArray(t.items)&&t.items.forEach(t=>{t.talla&&e.add(t.talla)})})});const o=this.prepararDatosResumenEmbarque(e);Object(r["a"])(o,this.productosPorCliente,this.obtenerNombreCliente,this.clientesDisponibles,t)},prepararDatosResumenEmbarque(t){return{...this.embarque,crudos:Object.entries(this.clienteCrudos).flatMap(([t,e])=>e.flatMap(e=>e&&e.items&&Array.isArray(e.items)?e.items.map(e=>{const o=[];return e.taras&&o.push(e.taras),e.sobrante&&o.push(e.sobrante),{clienteId:t,medida:e.talla,taras:o,barco:e.barco,textoAlternativo:e.textoAlternativo,precio:e.precio}}):[])),medidasCrudos:Array.from(t)}}}}},eb99:function(t,e,o){"use strict";var a=function(){var t=this,e=t._self._c;return e("BaseModal",{attrs:{mostrar:t.mostrar,titulo:"Agregar Nuevo Cliente","texto-boton-confirmar":"Agregar"},on:{cerrar:function(e){return t.$emit("cerrar")},confirmar:t.agregarCliente}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"nombreCliente"}},[t._v("Nombre del Cliente:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.nombreCliente,expression:"nombreCliente"}],ref:"nombreInput",staticClass:"form-control",attrs:{type:"text",id:"nombreCliente",placeholder:"Ingrese el nombre del cliente"},domProps:{value:t.nombreCliente},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.agregarCliente.apply(null,arguments)},input:function(e){e.target.composing||(t.nombreCliente=e.target.value)}}})])])},i=[],r=o("ff7a"),s={name:"NuevoClienteModal",components:{BaseModal:r["a"]},props:{mostrar:{type:Boolean,required:!0}},data(){return{nombreCliente:"",colorCliente:"#007bff"}},watch:{mostrar(t){t&&(this.nombreCliente="",this.$nextTick(()=>{var t;null===(t=this.$refs.nombreInput)||void 0===t||t.focus()}))}},methods:{agregarCliente(){""!==this.nombreCliente.trim()?(this.$emit("agregar",{nombre:this.nombreCliente,color:this.colorCliente}),this.nombreCliente=""):alert("Por favor, ingrese un nombre para el nuevo cliente.")}}},n=s,c=(o("053c"),o("2877")),d=Object(c["a"])(n,a,i,!1,null,"091821fc",null);e["a"]=d.exports},fdb2:function(t,e,o){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"header-embarque"},[e("h1",[t._v(t._s(t.modoEdicion?"Embarque":"Nuevo Embarque"))]),e("div",{staticClass:"botones"},[e("button",{staticClass:"btn-volver",on:{click:t.volverAEmbarquesMenu}},[e("i",{staticClass:"fas fa-arrow-left"}),t._v(" Volver a Menu ")]),e("button",{class:["btn-bloqueo",{bloqueado:t.embarqueBloqueado}],on:{click:t.toggleBloqueo}},[e("i",{class:["fas",t.embarqueBloqueado?"fa-lock":"fa-lock-open"]}),t._v(" "+t._s(t.embarqueBloqueado?"Desbloquear":"Bloquear")+" Embarque ")]),e("button",{staticClass:"btn-configuracion-medidas",on:{click:t.abrirConfiguracionMedidas}},[e("i",{staticClass:"fas fa-cog"}),t._v(" Configurar Medidas ")])]),e("div",{staticClass:"botones-accion"},[e("button",{staticClass:"btn btn-success",attrs:{title:"Ver pedido del dÃ­a de hoy"},on:{click:t.verPedidoDelDia}},[e("i",{staticClass:"fas fa-clipboard-list"}),t._v(" Pedido del DÃ­a ")]),e("GenerarEsqueletoEmbarqueButton",{attrs:{"fecha-embarque":t.fechaLocal,"embarque-bloqueado":t.embarqueBloqueado},on:{"esqueleto-generado":t.onEsqueletoGenerado,error:t.onEsqueletoError}}),e("button",{staticClass:"btn btn-info",attrs:{disabled:t.isGeneratingPdf},on:{click:function(e){return t.$emit("generar-taras")}}},[t.isGeneratingPdf&&"taras"===t.pdfType?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-file-pdf"}),t._v(" PDF Taras ")]),e("button",{staticClass:"btn btn-info",attrs:{disabled:t.isGeneratingPdf},on:{click:function(e){return t.$emit("generar-resumen")}}},[t.isGeneratingPdf&&"resumen"===t.pdfType?e("span",{staticClass:"loader-inline"}):e("i",{staticClass:"fas fa-file-pdf"}),t._v(" Resumen Embarque ")]),t.embarqueId&&""!==t.embarqueId?e("router-link",{staticClass:"btn btn-warning",class:{disabled:t.isGeneratingPdf},attrs:{to:{name:"Rendimientos",params:{id:t.embarqueId}}}},[e("i",{staticClass:"fas fa-chart-line"}),t._v(" Rendimientos ")]):t._e(),e("precios-historial-modal",{attrs:{clienteActual:t.clienteEmbarque},on:{"precio-agregado":t.onPrecioAgregado}})],1),e("div",{staticClass:"header"},[e("div",{staticClass:"header-row"},[e("div",{staticClass:"fecha-selector"},[e("label",{attrs:{for:"fecha"}},[t._v("Fecha de Embarque:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.fechaLocal,expression:"fechaLocal"}],staticClass:"form-control",attrs:{type:"date",id:"fecha",required:"",disabled:t.embarqueBloqueado},domProps:{value:t.fechaLocal},on:{change:t.actualizarFecha,input:function(e){e.target.composing||(t.fechaLocal=e.target.value)}}})]),e("div",{staticClass:"carga-selector"},[e("label",{attrs:{for:"cargaCon"}},[t._v("Carga con:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.cargaConLocal,expression:"cargaConLocal"}],staticClass:"form-control",attrs:{id:"cargaCon",required:"",disabled:t.embarqueBloqueado},on:{change:[function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.cargaConLocal=e.target.multiple?o:o[0]},t.actualizarCargaCon]}},[e("option",{attrs:{value:""}},[t._v("Seleccionar")]),e("option",{attrs:{value:"Porro"}},[t._v("Porro")]),e("option",{attrs:{value:"Caminante"}},[t._v("Caminante")])])])])]),e("PedidoDelDiaModal",{attrs:{mostrar:t.mostrarModalPedido,fechaEmbarque:t.fechaLocal},on:{cerrar:t.cerrarModalPedido}})],1)},i=[],r=o("666c"),s=function(){var t=this,e=t._self._c;return t.mostrar?e("div",{staticClass:"modal-pedido-overlay",on:{click:t.cerrarModal}},[e("div",{staticClass:"modal-pedido-content",on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"modal-pedido-header"},[e("h2",[t._v("ðŸ“‹ Pedido del DÃ­a - "+t._s(t.fechaEmbarque))]),e("button",{staticClass:"btn-cerrar-modal",on:{click:t.cerrarModal}},[t._v("Ã—")])]),e("div",{staticClass:"modal-pedido-body"},[t.cargandoPedidos?e("div",{staticClass:"cargando-pedidos"},[e("div",{staticClass:"spinner"}),e("p",[t._v("Cargando pedidos del dÃ­a...")])]):0===t.pedidosDelDia.length?e("div",{staticClass:"sin-pedidos-dia"},[e("div",{staticClass:"icono-sin-pedidos"},[t._v("ðŸ“„")]),e("p",[t._v("No hay pedidos registrados para el dÃ­a "+t._s(t.fechaEmbarque))]),e("div",{staticClass:"acciones-sin-pedidos"},[e("button",{staticClass:"btn-crear-pedido crudo",on:{click:t.crearPedidoCrudo}},[t._v(" + Crear Pedido Crudo ")]),e("button",{staticClass:"btn-crear-pedido limpio",on:{click:t.crearPedidoLimpio}},[t._v(" + Crear Pedido Limpio ")])])]):e("div",{staticClass:"pedidos-dia-lista"},t._l(t.pedidosDelDia,(function(o){return e("div",{key:o.id,staticClass:"pedido-item"},[e("div",{staticClass:"pedido-header"},[e("div",{staticClass:"pedido-tipo"},[e("span",{staticClass:"tipo-badge"},[t._v(t._s(t.capitalizarPrimeraLetra(o.tipo)))]),e("div",{staticClass:"pedido-totales"},[e("span",[t._v(t._s(t.calcularKilosPedido(o))+" kg")]),e("span",[t._v(t._s(t.calcularTarasPedido(o))+" T")])])]),e("div",{staticClass:"pedido-acciones"},[e("button",{staticClass:"btn-ver-pedido",on:{click:function(e){return t.verDetallesPedido(o)}}},[t._v(" ðŸ‘ï¸ Ver ")]),e("button",{staticClass:"btn-editar-pedido",on:{click:function(e){return t.editarPedido(o)}}},[t._v(" âœï¸ Editar ")])])]),o.mostrarDetalles?e("div",{staticClass:"pedido-detalles"},["crudo"===o.tipo?e("div",{staticClass:"detalles-crudo"},[e("h4",[t._v("Detalle por Cliente:")]),e("div",{staticClass:"clientes-grid"},t._l(o.pedidos,(function(a,i){return e("div",{key:i,staticClass:"cliente-crudo"},[e("strong",[t._v(t._s(i)+":")]),e("div",{staticClass:"columnas-crudo"},t._l(a,(function(a,r){return a?e("div",{key:r,staticClass:"columna-item"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(o.id,"crudo",i,r)},on:{change:function(e){return t.toggleItemCompletado(o.id,"crudo",i,r,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"columna-texto",class:{completado:t.getItemCompletadoState(o.id,"crudo",i,r)}},[t._v(" "+t._s(r)+": "+t._s(a)+" ")])]):t._e()})),0)])})),0)]):e("div",{staticClass:"detalles-limpio"},[e("h4",[t._v("Detalle por Cliente:")]),e("div",{staticClass:"clientes-grid"},[o.otilio&&o.otilio.length>0?e("div",{staticClass:"cliente-limpio otilio"},[e("strong",[t._v("Otilio:")]),t._l(o.otilio,(function(a,i){return a.kilos?e("div",{key:i,staticClass:"item-limpio-container"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(o.id,"limpio","otilio",i)},on:{change:function(e){return t.toggleItemCompletado(o.id,"limpio","otilio",i,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"item-limpio",class:{completado:t.getItemCompletadoState(o.id,"limpio","otilio",i)}},[t._v(" "+t._s(a.kilos)+t._s(a.esTara?" T":" kg")+" - "+t._s(a.medida||"Sin medida")+" - "),e("span",{staticClass:"tipo-producto",class:{"no-sh20":a.tipo&&"S/H20"!==a.tipo}},[t._v(" "+t._s(a.tipo||"Sin tipo")+" ")])])]):t._e()}))],2):t._e(),o.catarro&&o.catarro.length>0?e("div",{staticClass:"cliente-limpio catarro"},[e("strong",[t._v("Catarro:")]),t._l(o.catarro,(function(a,i){return a.kilos?e("div",{key:i,staticClass:"item-limpio-container"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(o.id,"limpio","catarro",i)},on:{change:function(e){return t.toggleItemCompletado(o.id,"limpio","catarro",i,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"item-limpio",class:{completado:t.getItemCompletadoState(o.id,"limpio","catarro",i)}},[t._v(" "+t._s(a.kilos)+t._s(a.esTara?" T":" kg")+" - "+t._s(a.medida||"Sin medida")+" - "),e("span",{staticClass:"tipo-producto",class:{"no-sh20":a.tipo&&"S/H20"!==a.tipo}},[t._v(" "+t._s(a.tipo||"Sin tipo")+" ")])])]):t._e()}))],2):t._e(),o.joselito&&o.joselito.length>0?e("div",{staticClass:"cliente-limpio joselito"},[e("strong",[t._v("Joselito:")]),t._l(o.joselito,(function(a,i){return a.kilos?e("div",{key:i,staticClass:"item-limpio-container"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(o.id,"limpio","joselito",i)},on:{change:function(e){return t.toggleItemCompletado(o.id,"limpio","joselito",i,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"item-limpio",class:{completado:t.getItemCompletadoState(o.id,"limpio","joselito",i)}},[t._v(" "+t._s(a.kilos)+t._s(a.esTara?" T":" kg")+" - "+t._s(a.medida||"Sin medida")+" - "),e("span",{staticClass:"tipo-producto",class:{"no-sh20":a.tipo&&"S/H20"!==a.tipo}},[t._v(" "+t._s(a.tipo||"Sin tipo")+" ")])])]):t._e()}))],2):t._e(),o.ozuna&&o.ozuna.length>0?e("div",{staticClass:"cliente-limpio ozuna"},[e("strong",[t._v("Ozuna:")]),t._l(o.ozuna,(function(a,i){return a.kilos?e("div",{key:i,staticClass:"item-limpio-container"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(o.id,"limpio","ozuna",i)},on:{change:function(e){return t.toggleItemCompletado(o.id,"limpio","ozuna",i,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"item-limpio",class:{completado:t.getItemCompletadoState(o.id,"limpio","ozuna",i)}},[t._v(" "+t._s(a.kilos)+t._s(a.esTara?" T":" kg")+" - "+t._s(a.medida||"Sin medida")+" - "),e("span",{staticClass:"tipo-producto",class:{"no-sh20":a.tipo&&"S/H20"!==a.tipo}},[t._v(" "+t._s(a.tipo||"Sin tipo")+" ")])])]):t._e()}))],2):t._e(),o.lorena&&o.lorena.length>0?e("div",{staticClass:"cliente-limpio lorena"},[e("strong",[t._v("Lorena:")]),t._l(o.lorena,(function(a,i){return a.kilos?e("div",{key:i,staticClass:"item-limpio-container"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(o.id,"limpio","lorena",i)},on:{change:function(e){return t.toggleItemCompletado(o.id,"limpio","lorena",i,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"item-limpio",class:{completado:t.getItemCompletadoState(o.id,"limpio","lorena",i)}},[t._v(" "+t._s(a.kilos)+t._s(a.esTara?" T":" kg")+" - "+t._s(a.medida||"Sin medida")+" - "),e("span",{staticClass:"tipo-producto",class:{"no-sh20":a.tipo&&"S/H20"!==a.tipo}},[t._v(" "+t._s(a.tipo||"Sin tipo")+" ")])])]):t._e()}))],2):t._e(),t._l(o.clientesTemporales,(function(a,i){return a.pedidos&&a.pedidos.length>0?e("div",{key:i,staticClass:"cliente-limpio temporal"},[e("strong",[t._v(t._s(a.nombre)+":")]),t._l(a.pedidos,(function(a,r){return a.kilos?e("div",{key:r,staticClass:"item-limpio-container"},[e("label",{staticClass:"item-checkbox-container"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:t.getItemCompletadoState(o.id,"limpio",i,r)},on:{change:function(e){return t.toggleItemCompletado(o.id,"limpio",i,r,e.target.checked)}}}),e("span",{staticClass:"item-checkmark"})]),e("span",{staticClass:"item-limpio",class:{completado:t.getItemCompletadoState(o.id,"limpio",i,r)}},[t._v(" "+t._s(a.kilos)+t._s(a.esTara?" T":" kg")+" - "+t._s(a.medida||"Sin medida")+" - "),e("span",{staticClass:"tipo-producto",class:{"no-sh20":a.tipo&&"S/H20"!==a.tipo}},[t._v(" "+t._s(a.tipo||"Sin tipo")+" ")])])]):t._e()}))],2):t._e()}))],2)])]):t._e()])})),0)]),e("div",{staticClass:"modal-pedido-footer"},[e("button",{staticClass:"btn-cerrar-footer",on:{click:t.cerrarModal}},[t._v("Cerrar")])])])]):t._e()},n=[],c=(o("14d9"),o("1494")),d={name:"PedidoDelDiaModal",props:{mostrar:{type:Boolean,default:!1},fechaEmbarque:{type:String,default:""}},data(){return{pedidosDelDia:[],cargandoPedidos:!1,itemsCompletados:{}}},watch:{mostrar(t){t&&this.cargarPedidosDelDia()}},methods:{async cargarPedidosDelDia(){if(this.fechaEmbarque&&""!==this.fechaEmbarque.trim()){this.cargandoPedidos=!0;try{const t=Object(c["h"])(),e=Object(c["c"])(t,"pedidos"),o=Object(c["o"])(e,Object(c["t"])("fecha","==",this.fechaEmbarque)),a=await Object(c["g"])(o);this.pedidosDelDia=[],this.itemsCompletados={},a.docs.forEach(t=>{const e=t.data();this.pedidosDelDia.push({id:t.id,...e,mostrarDetalles:!1}),this.cargarEstadosCompletados(t.id,e)})}catch(t){console.error("Error al cargar los pedidos del dÃ­a:",t),alert("Hubo un error al cargar los pedidos del dÃ­a. Por favor, intente de nuevo.")}finally{this.cargandoPedidos=!1}}},cargarEstadosCompletados(t,e){if(this.$set(this.itemsCompletados,t,{}),"crudo"===e.tipo&&e.pedidos)for(const o in e.pedidos)for(const a in e.pedidos[o]){const i=`crudo-${o}-${a}`;e.itemsCompletados&&e.itemsCompletados[i]&&this.$set(this.itemsCompletados[t],i,e.itemsCompletados[i])}else if("limpio"===e.tipo&&(e.otilio&&e.otilio.forEach((o,a)=>{const i="limpio-otilio-"+a;e.itemsCompletados&&e.itemsCompletados[i]&&this.$set(this.itemsCompletados[t],i,e.itemsCompletados[i])}),e.catarro&&e.catarro.forEach((o,a)=>{const i="limpio-catarro-"+a;e.itemsCompletados&&e.itemsCompletados[i]&&this.$set(this.itemsCompletados[t],i,e.itemsCompletados[i])}),e.joselito&&e.joselito.forEach((o,a)=>{const i="limpio-joselito-"+a;e.itemsCompletados&&e.itemsCompletados[i]&&this.$set(this.itemsCompletados[t],i,e.itemsCompletados[i])}),e.ozuna&&e.ozuna.forEach((o,a)=>{const i="limpio-ozuna-"+a;e.itemsCompletados&&e.itemsCompletados[i]&&this.$set(this.itemsCompletados[t],i,e.itemsCompletados[i])}),e.lorena&&e.lorena.forEach((o,a)=>{const i="limpio-lorena-"+a;e.itemsCompletados&&e.itemsCompletados[i]&&this.$set(this.itemsCompletados[t],i,e.itemsCompletados[i])}),e.clientesTemporales))for(const o in e.clientesTemporales){const a=e.clientesTemporales[o];a.pedidos&&a.pedidos.forEach((a,i)=>{const r=`limpio-${o}-${i}`;e.itemsCompletados&&e.itemsCompletados[r]&&this.$set(this.itemsCompletados[t],r,e.itemsCompletados[r])})}},async toggleItemCompletado(t,e,o,a,i){try{const r=`${e}-${o}-${a}`;this.itemsCompletados[t]||this.$set(this.itemsCompletados,t,{}),this.$set(this.itemsCompletados[t],r,i);const s=Object(c["h"])(),n=Object(c["e"])(s,"pedidos",t);await Object(c["s"])(n,{["itemsCompletados."+r]:i,[`itemsCompletados.${r}_fecha`]:i?(new Date).toISOString():null}),console.log(`Item ${r} en pedido ${t} marcado como ${i?"completado":"pendiente"}`)}catch(r){console.error("Error al actualizar estado del item:",r);const s=`${e}-${o}-${a}`;this.$set(this.itemsCompletados[t],s,!i),alert("Error al actualizar el estado del item. Por favor, intente de nuevo.")}},getItemCompletadoState(t,e,o,a){const i=`${e}-${o}-${a}`;return this.itemsCompletados[t]&&this.itemsCompletados[t][i]||!1},capitalizarPrimeraLetra(t){return t.charAt(0).toUpperCase()+t.slice(1)},calcularKilosPedido(t){if("crudo"===t.tipo){let e=0;if(t.pedidos)for(const o in t.pedidos)for(const a in t.pedidos[o]){const i=t.pedidos[o][a];i&&!isNaN(i)&&(e+=parseFloat(i))}return(19*e).toFixed(0)}{let e=0;if(t.otilio&&(e+=this.calcularKilosCliente(t.otilio)),t.catarro&&(e+=this.calcularKilosCliente(t.catarro)),t.joselito&&(e+=this.calcularKilosCliente(t.joselito)),t.ozuna&&(e+=this.calcularKilosCliente(t.ozuna)),t.lorena&&(e+=this.calcularKilosCliente(t.lorena)),t.clientesTemporales)for(const o in t.clientesTemporales){const a=t.clientesTemporales[o];a.pedidos&&(e+=this.calcularKilosCliente(a.pedidos))}return Math.round(e).toString()}},calcularTarasPedido(t){if("crudo"===t.tipo){const e=parseFloat(this.calcularKilosPedido(t));return Math.round(e/19).toString()}{let e=0;if(t.otilio&&(e+=this.calcularTarasCliente(t.otilio)),t.catarro&&(e+=this.calcularTarasCliente(t.catarro)),t.joselito&&(e+=this.calcularTarasCliente(t.joselito)),t.ozuna&&(e+=this.calcularTarasCliente(t.ozuna)),t.lorena&&(e+=this.calcularTarasCliente(t.lorena)),t.clientesTemporales)for(const o in t.clientesTemporales){const a=t.clientesTemporales[o];a.pedidos&&(e+=this.calcularTarasCliente(a.pedidos))}return Math.round(e).toString()}},calcularKilosCliente(t){let e=0,o=0,a=0,i=0,r=0,s=0;return t.forEach(t=>{t.kilos&&(t.esTara?"C/H20"===t.tipo?o+=30*Number(t.kilos)*.65:"1.35 y .15"===t.tipo?r+=30*Number(t.kilos):a+=30*Number(t.kilos):"S/H20"===t.tipo?e+=Number(t.kilos):"C/H20"===t.tipo?o+=Number(t.kilos):"1.35 y .15"===t.tipo?i+=1.35*Number(t.kilos):".7 y .3"===t.tipo&&(s+=.7*Number(t.kilos)))}),e+a+r+o+i+s},calcularTarasCliente(t){let e=0,o=0,a=0;t.forEach(t=>{t.kilos&&(t.esTara?e+=Number(t.kilos):"S/H20"===t.tipo?o+=Number(t.kilos):"1.35 y .15"===t.tipo&&(a+=Number(t.kilos)))});const i=o/25,r=a/33.75;return e+i+r},verDetallesPedido(t){this.$set(t,"mostrarDetalles",!t.mostrarDetalles)},editarPedido(t){const e="crudo"===t.tipo?"/procesos/pedidos/crudo":"/procesos/pedidos/limpio";this.$router.push({path:e,query:{edit:"true",id:t.id,fecha:t.fecha}}),this.cerrarModal()},crearPedidoCrudo(){this.$router.push({path:"/procesos/pedidos/crudo",query:{fecha:this.fechaEmbarque}}),this.cerrarModal()},crearPedidoLimpio(){this.$router.push({path:"/procesos/pedidos/limpio",query:{fecha:this.fechaEmbarque}}),this.cerrarModal()},cerrarModal(){this.$emit("cerrar"),this.pedidosDelDia=[],this.itemsCompletados={}}}},l=d,u=(o("7fed"),o("2877")),p=Object(u["a"])(l,s,n,!1,null,"0dbbac5e",null),m=p.exports,h=o("928c"),C={name:"HeaderEmbarque",components:{PreciosHistorialModal:r["a"],PedidoDelDiaModal:m,GenerarEsqueletoEmbarqueButton:h["a"]},props:{modoEdicion:{type:Boolean,default:!1},embarqueBloqueado:{type:Boolean,default:!1},embarque:{type:Object,required:!0,validator:t=>"fecha"in t&&"cargaCon"in t},isGeneratingPdf:{type:Boolean,default:!1},pdfType:{type:String,default:""},embarqueId:{type:String,default:""},clienteEmbarque:{type:String,default:""}},data(){return{fechaLocal:this.embarque.fecha,cargaConLocal:this.embarque.cargaCon,mostrarModalPedido:!1}},watch:{"embarque.fecha"(t){this.fechaLocal=t},"embarque.cargaCon"(t){this.cargaConLocal=t}},methods:{volverAEmbarquesMenu(){this.$emit("volver")},toggleBloqueo(){this.$emit("toggle-bloqueo")},actualizarFecha(){this.embarqueId&&localStorage.setItem("ultimoEmbarqueId",this.embarqueId),this.$emit("verificar-fecha",this.fechaLocal)},actualizarCargaCon(){this.$emit("update:cargaCon",this.cargaConLocal)},verPedidoDelDia(){this.mostrarModalPedido=!0},cerrarModalPedido(){this.mostrarModalPedido=!1},abrirConfiguracionMedidas(){this.$emit("abrir-configuracion-medidas")},onPrecioAgregado(t){console.log("[HEADER-EMBARQUE] Precio agregado:",t),this.$emit("precio-agregado",t)},onEsqueletoGenerado(t){this.$emit("generar-esqueleto",t)},onEsqueletoError(t){this.$emit("esqueleto-error",t)}}},b=C,f=(o("c62d"),Object(u["a"])(b,a,i,!1,null,"aa31f502",null));e["a"]=f.exports}}]);