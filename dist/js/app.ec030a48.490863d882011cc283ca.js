(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app.ec030a48"],{"0951":function(a,e,t){"use strict";t("5d46")},"5d46":function(a,e,t){},"9c26":function(a,e,t){},b34e:function(a,e,t){"use strict";t("14d9");var i=function(){var a=this,e=a._self._c;return e("div",{staticClass:"lista-embarques"},[e("div",{staticClass:"header-section"},[a._m(0),e("div",{staticClass:"header-actions"},[e("button",{staticClass:"btn-refresh",attrs:{title:"Actualizar lista"},on:{click:a.cargarEmbarques}},[e("i",{staticClass:"icon"},[a._v("ðŸ”„")]),a._v(" Actualizar ")])])]),a.cargando?e("div",{staticClass:"loading-state"},[e("div",{staticClass:"loading-spinner"}),e("p",[a._v("Cargando embarques...")])]):a.error?e("div",{staticClass:"error-state"},[e("i",{staticClass:"icon-error"},[a._v("âš ï¸")]),e("h3",[a._v("Error al cargar")]),e("p",[a._v(a._s(a.error))]),e("button",{staticClass:"btn-retry",on:{click:a.cargarEmbarques}},[a._v("Reintentar")])]):e("div",{staticClass:"embarques-container"},[a.embarques.length>0?e("div",{staticClass:"embarques-grid"},a._l(a.embarques,(function(t){return e("div",{key:t.id,staticClass:"embarque-card",class:{"card-blocked":t.embarqueBloqueado}},[e("div",{staticClass:"card-header"},[e("div",{staticClass:"fecha-section"},[e("i",{staticClass:"icon-calendar"},[a._v("ðŸ“…")]),e("div",{staticClass:"fecha-info"},[e("span",{staticClass:"fecha-label"},[a._v("Fecha")]),e("span",{staticClass:"fecha-value"},[a._v(a._s(a.formatearFecha(t.fecha)))])])]),e("div",{staticClass:"status-section"},[t.noEnviadoMexico?e("span",{staticClass:"status-badge no-mexico"},[e("i",{staticClass:"icon-mexico"},[a._v("ðŸš«")]),a._v(" No enviado ")]):t.embarqueBloqueado?e("span",{staticClass:"status-badge blocked"},[e("i",{staticClass:"icon-lock"},[a._v("ðŸ”’")]),a._v(" Bloqueado ")]):e("span",{staticClass:"status-badge active"},[e("i",{staticClass:"icon-check"},[a._v("âœ…")]),a._v(" Activo ")])])]),e("div",{staticClass:"card-content"},[e("div",{staticClass:"stats-grid"},[e("div",{staticClass:"stat-item"},[e("i",{staticClass:"icon-clean"},[a._v("ðŸ¥¤")]),e("div",{staticClass:"stat-info"},[e("span",{staticClass:"stat-label"},[a._v("Kilos Limpios")]),e("span",{staticClass:"stat-value"},[a._v(a._s(a.calcularKilosLimpios(t))+" kg")])])]),e("div",{staticClass:"stat-item"},[e("i",{staticClass:"icon-raw"},[a._v("ðŸ¦")]),e("div",{staticClass:"stat-info"},[e("span",{staticClass:"stat-label"},[a._v("Kilos Crudos")]),e("span",{staticClass:"stat-value"},[a._v(a._s(a.calcularKilosCrudos(t))+" kg")])])]),e("div",{staticClass:"stat-item"},[e("i",{staticClass:"icon-total"},[a._v("âš–ï¸")]),e("div",{staticClass:"stat-info"},[e("span",{staticClass:"stat-label"},[a._v("Total Kilos")]),e("span",{staticClass:"stat-value total"},[a._v(a._s((Number(a.calcularKilosLimpios(t))+Number(a.calcularKilosCrudos(t))).toFixed(1))+" kg")])])]),e("div",{staticClass:"stat-item"},[e("i",{staticClass:"icon-taras"},[a._v("ðŸ“¦")]),e("div",{staticClass:"stat-info"},[e("span",{staticClass:"stat-label"},[a._v("Total Taras")]),e("span",{staticClass:"stat-value"},[a._v(a._s(a.calcularTotalTaras(t)))])])])]),e("div",{staticClass:"additional-info"},[e("div",{staticClass:"info-item"},[e("i",{staticClass:"icon-truck"},[a._v("ðŸšš")]),e("span",{staticClass:"info-label"},[a._v("Carga con:")]),e("span",{staticClass:"info-value"},[a._v(a._s(t.cargaCon||"No especificado"))])])])]),e("div",{staticClass:"card-actions"},[e("button",{staticClass:"btn-action btn-mexico",class:{"btn-mexico-active":t.noEnviadoMexico},attrs:{title:t.noEnviadoMexico?"Marcar como enviado a MÃ©xico":"Marcar como NO enviado a MÃ©xico"},on:{click:function(e){return a.toggleNoEnviadoMexico(t.id,t.noEnviadoMexico)}}},[e("i",{staticClass:"icon"},[a._v(a._s(t.noEnviadoMexico?"ðŸš«":"âœ…"))]),a._v(" "+a._s(t.noEnviadoMexico?"No enviado":"Enviado")+" ")]),e("button",{staticClass:"btn-action btn-edit",attrs:{title:"Editar embarque"},on:{click:function(e){return a.editarEmbarque(t.id)}}},[e("i",{staticClass:"icon"},[a._v("âœï¸")]),a._v(" Editar ")]),e("button",{staticClass:"btn-action btn-delete",class:{"btn-disabled":t.embarqueBloqueado},attrs:{disabled:t.embarqueBloqueado,title:t.embarqueBloqueado?"Este embarque estÃ¡ bloqueado":"Eliminar embarque"},on:{click:function(e){return a.eliminarEmbarque(t.id)}}},[e("i",{staticClass:"icon"},[a._v("ðŸ—‘ï¸")]),a._v(" Eliminar ")])])])})),0):e("div",{staticClass:"empty-state"},[e("div",{staticClass:"empty-icon"},[a._v("ðŸ“‹")]),e("h3",[a._v("No hay embarques registrados")]),e("p",[a._v("Comienza creando tu primer embarque")]),e("button",{staticClass:"btn-create",on:{click:function(e){return a.$router.push({name:"NuevoEmbarque",params:{id:"nuevo"}})}}},[e("i",{staticClass:"icon"},[a._v("âž•")]),a._v(" Crear Embarque ")])])]),e("NotificacionRespaldo",{attrs:{visible:a.mostrarNotificacion,tipo:a.tipoNotificacion,titulo:a.tituloNotificacion,mensaje:a.mensajeNotificacion},on:{close:a.cerrarNotificacion}})],1)},s=[function(){var a=this,e=a._self._c;return e("div",{staticClass:"header-content"},[e("h1",{staticClass:"main-title"},[e("i",{staticClass:"icon-ship"},[a._v("ðŸš¢")]),a._v(" Lista de Embarques ")]),e("p",{staticClass:"subtitle"},[a._v("Gestiona todos tus embarques de manera eficiente")])])}],o=(t("13d5"),t("1494")),r=t("ebad"),n=function(){var a=this,e=a._self._c;return a.visible?e("div",{staticClass:"notificacion-respaldo",class:a.tipo},[e("div",{staticClass:"notificacion-content"},[e("div",{staticClass:"notificacion-icon"},["success"===a.tipo?e("span",[a._v("âœ…")]):"error"===a.tipo?e("span",[a._v("âŒ")]):"warning"===a.tipo?e("span",[a._v("âš ï¸")]):e("span",[a._v("ðŸ’¾")])]),e("div",{staticClass:"notificacion-text"},[e("h4",[a._v(a._s(a.titulo))]),e("p",[a._v(a._s(a.mensaje))])]),e("button",{staticClass:"notificacion-close",on:{click:a.cerrar}},[e("span",[a._v("âœ•")])])])]):a._e()},c=[],l={name:"NotificacionRespaldo",props:{visible:{type:Boolean,default:!1},tipo:{type:String,default:"info",validator:a=>["success","error","warning","info"].includes(a)},titulo:{type:String,default:"Respaldo automÃ¡tico"},mensaje:{type:String,default:"Se ha creado un respaldo de seguridad"},autoClose:{type:Number,default:5e3}},data(){return{timeout:null}},watch:{visible(a){a&&this.autoClose>0&&(this.timeout=setTimeout(()=>{this.cerrar()},this.autoClose))}},methods:{cerrar(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.$emit("close")}},beforeDestroy(){this.timeout&&clearTimeout(this.timeout)}},d=l,u=(t("0951"),t("2877")),m=Object(u["a"])(d,n,c,!1,null,"023e4c32",null),f=m.exports,p=t("b1ba"),b=t("f549"),h={name:"ListaEmbarques",components:{NotificacionRespaldo:f},data(){return{embarques:[],cargando:!0,error:null,mostrarNotificacion:!1,tipoNotificacion:"success",tituloNotificacion:"",mensajeNotificacion:""}},methods:{safeClone(a,e=null){if(void 0===a||null===a)return e;try{return JSON.parse(JSON.stringify(a))}catch(t){return console.warn("[ListaEmbarques] Error al clonar valor, usando fallback:",t),e}},mapOfflineRecordToLista(a){if(!a)return null;let e;try{e=a.fecha?new Date(a.fecha):null}catch(t){e=null}return{id:a.id,fecha:e||new Date,embarqueBloqueado:Boolean(a.embarqueBloqueado),noEnviadoMexico:Boolean(a.noEnviadoMexico),clientes:a.clientes||[],cargaCon:a.cargaCon||"No especificado",pendingSync:Boolean(a.pendingSync)}},construirSnapshotOfflineDesdeRemoto(a,e,t){const i=Array.isArray(e.clientes)?e.clientes:[],s=i.flatMap(a=>{const e=Array.isArray(a.productos)?a.productos:[];return e.map(e=>({...e,clienteId:a.id,nombreCliente:a.nombre}))}),o={};i.forEach(a=>{o[a.id]=Array.isArray(a.crudos)?a.crudos:[]});const r={...this.safeClone(e,{}),fecha:t?t.toISOString():null};return{id:a,fecha:t?t.toISOString():null,cargaCon:e.cargaCon||"",embarqueBloqueado:e.embarqueBloqueado||!1,noEnviadoMexico:e.noEnviadoMexico||!1,clientesPersonalizados:e.clientesPersonalizados||[],clientesJuntarMedidas:e.clientesJuntarMedidas||{},clientesReglaOtilio:e.clientesReglaOtilio||{},clientesIncluirPrecios:e.clientesIncluirPrecios||{},clientesCuentaEnPdf:e.clientesCuentaEnPdf||{},clientesSumarKgCatarro:e.clientesSumarKgCatarro||{},clientes:i,productos:s,clienteCrudos:o,costosPorMedida:e.costosPorMedida||{},aplicarCostoExtra:e.aplicarCostoExtra||{},costoExtra:void 0!==e.costoExtra?e.costoExtra:18,medidasConfiguracion:e.medidasConfiguracion||[],preciosActuales:[],docData:r}},normalizarDocDataParaFirestore(a){const e=a&&a.docData?JSON.parse(JSON.stringify(a.docData)):{},t=a=>{if(!a)return new Date;if(a instanceof Date)return a;if("string"===typeof a){const e=new Date(a);if(!Number.isNaN(e.getTime()))return e}if("object"===typeof a){var e;const t=null!==(e=null===a||void 0===a?void 0:a.seconds)&&void 0!==e?e:null===a||void 0===a?void 0:a._seconds;if("number"===typeof t)return new Date(1e3*t)}try{return new Date(a)}catch(t){return console.warn("[ListaEmbarques] No se pudo parsear la fecha, usando fecha actual.",t),new Date}},i=(t,i)=>void 0!==e[t]?e[t]:a&&void 0!==a[t]?a[t]:i,s={fecha:t(i("fecha",null)),cargaCon:i("cargaCon",""),clientes:Array.isArray(i("clientes",[]))?i("clientes",[]).map(a=>({...a,productos:Array.isArray(a.productos)?a.productos.map(a=>({...a,restarTaras:a.restarTaras||!1,noSumarKilos:a.noSumarKilos||!1})):[],crudos:Array.isArray(a.crudos)?a.crudos:[]})):[],clientesJuntarMedidas:i("clientesJuntarMedidas",{}),clientesReglaOtilio:i("clientesReglaOtilio",{}),clientesIncluirPrecios:i("clientesIncluirPrecios",{}),clientesCuentaEnPdf:i("clientesCuentaEnPdf",{}),clientesSumarKgCatarro:i("clientesSumarKgCatarro",{}),clientesPersonalizados:Array.isArray(i("clientesPersonalizados",[]))?i("clientesPersonalizados",[]):[],costosPorMedida:i("costosPorMedida",{}),aplicarCostoExtra:i("aplicarCostoExtra",{}),costoExtra:"number"===typeof i("costoExtra",void 0)?i("costoExtra",void 0):18,medidasConfiguracion:Array.isArray(i("medidasConfiguracion",[]))?i("medidasConfiguracion",[]):[],preciosActuales:Array.isArray(i("preciosActuales",[]))?i("preciosActuales",[]):[],embarqueBloqueado:Boolean(i("embarqueBloqueado",!1)),noEnviadoMexico:Boolean(i("noEnviadoMexico",!1))};return s},async sincronizarPendientesOffline(){try{const i=await p["a"].getPendingSync();if(!Array.isArray(i)||0===i.length)return;const s=Object(b["useAuthStore"])(),r=Object(o["h"])();for(const n of i)try{var a;const e=Object(o["e"])(r,"embarques",n.id),t=await Object(o["f"])(e);if(n.deleted){t.exists()&&await Object(o["d"])(e),await p["a"].hardDelete(n.id);continue}const i=this.normalizarDocDataParaFirestore(n),c={...i,ultimaEdicion:{userId:(null===s||void 0===s?void 0:s.userId)||"offline-user",username:(null===s||void 0===s||null===(a=s.user)||void 0===a?void 0:a.username)||"Modo offline",timestamp:Object(o["q"])()}};t.exists()?await Object(o["r"])(e,c,{merge:!1}):await Object(o["r"])(e,c),await p["a"].markSynced(n.id)}catch(e){console.error("[ListaEmbarques] Error al sincronizar registro offline:",e);try{await p["a"].markSyncError(n.id,e.message||e)}catch(t){console.warn("[ListaEmbarques] No se pudo marcar el error de sincronizaciÃ³n:",t)}}}catch(e){console.error("[ListaEmbarques] Error general al sincronizar registros offline:",e)}},async cargarEmbarques(){try{this.cargando=!0,this.error=null,await p["a"].init();try{const a=await p["a"].getAll();Array.isArray(a)&&a.length>0?this.embarques=a.map(this.mapOfflineRecordToLista).filter(Boolean).sort((a,e)=>new Date(e.fecha)-new Date(a.fecha)):this.embarques=[]}catch(a){console.warn("[ListaEmbarques] No se pudieron leer datos offline:",a)}if(!navigator.onLine)return void(0===this.embarques.length&&(this.error="Sin conexiÃ³n y sin datos locales de embarques."));await this.sincronizarPendientesOffline();const t=Object(o["h"])(),i=Object(o["c"])(t,"embarques"),s=await Object(o["g"])(i),n={};s.docs.forEach(a=>{const e=a.data();let t;if(e.fecha&&"function"===typeof e.fecha.toDate)t=e.fecha.toDate();else if(e.fecha instanceof Date)t=e.fecha;else{if("string"!==typeof e.fecha)return void(n[a.id]=[{id:a.id,data:e,fecha:null}]);t=new Date(e.fecha)}const i=t.toISOString().split("T")[0];n[i]||(n[i]=[]),n[i].push({id:a.id,data:e,fecha:t})});const c=[];for(const a in n)if(n[a].length>1){console.log(`[DUPLICADOS] Encontrados ${n[a].length} embarques para ${a}`),n[a].sort((a,e)=>{const t=a.data.clientes?a.data.clientes.reduce((a,e)=>a+(e.productos?e.productos.length:0),0):0,i=e.data.clientes?e.data.clientes.reduce((a,e)=>a+(e.productos?e.productos.length:0),0):0,s=a.data.clientes?a.data.clientes.reduce((a,e)=>a+(e.crudos?e.crudos.length:0),0):0,o=e.data.clientes?e.data.clientes.reduce((a,e)=>a+(e.crudos?e.crudos.length:0),0):0,r=t+2*s,n=i+2*o;return n-r});const e=n[a][0],t=this.calcularPuntajeCompletitud(e.data);for(let i=1;i<n[a].length;i++){const e=n[a][i],s=this.calcularPuntajeCompletitud(e.data);(t>s||0===s)&&c.push({id:e.id,data:e.data,razon:"duplicado_inferior_"+a,puntajePrincipal:t,puntajeCandidato:s})}}if(c.length>0){console.log(`[RESPALDOS] Creando respaldos para ${c.length} embarques antes de eliminar`);for(const a of c)try{await r["a"].crearRespaldoEmergencia(a.id,a.razon),console.log("[RESPALDO] Respaldo creado para embarque "+a.id)}catch(e){console.error(`[RESPALDO] Error al crear respaldo para ${a.id}:`,e);continue}for(const a of c)try{await Object(o["d"])(Object(o["e"])(t,"embarques",a.id)),console.log(`[ELIMINACIÃ“N] Embarque ${a.id} eliminado (respaldado)`)}catch(e){console.error(`[ELIMINACIÃ“N] Error al eliminar embarque ${a.id}:`,e)}if(c.length>0)return console.log(`[LIMPIEZA] Recargando lista despuÃ©s de eliminar ${c.length} duplicados`),this.cargarEmbarques()}const l=[];for(const a in n){const e=n[a][0],t=e.fecha instanceof Date?e.fecha:e.fecha?new Date(e.fecha):new Date;l.push({id:e.id,fecha:t,embarqueBloqueado:e.data.embarqueBloqueado||!1,noEnviadoMexico:e.data.noEnviadoMexico||!1,clientes:e.data.clientes||[],cargaCon:e.data.cargaCon||"No especificado"});const i=this.construirSnapshotOfflineDesdeRemoto(e.id,e.data,t);await p["a"].save(i,{pendingSync:!1,syncState:"synced"})}this.embarques=l.sort((a,e)=>new Date(e.fecha)-new Date(a.fecha))}catch(e){console.error("Error al cargar embarques:",e),0===this.embarques.length?this.error="Error al cargar los embarques. Por favor, intenta nuevamente.":(this.mostrarNotificacion=!0,this.tipoNotificacion="warning",this.tituloNotificacion="Modo offline",this.mensajeNotificacion="Mostrando embarques guardados localmente.")}finally{this.cargando=!1}},calcularKilosLimpios(a){if(!a.clientes)return"0.0";let e=0;return a.clientes.forEach(a=>{a.productos&&a.productos.forEach(a=>{if("c/h20"===a.tipo){const t=a.reporteTaras||[],i=a.reporteBolsas||[];let s=0;for(let a=0;a<t.length;a++){const e=parseInt(t[a])||0,o=parseInt(i[a])||0;s+=e*o}const o=s*(a.camaronNeto||.65);e+=o}else{const t=(a.kilos||[]).reduce((a,e)=>a+(Number(e)||0),0),i=(a.taras||[]).reduce((a,e)=>a+(Number(e)||0),0),s=a.restarTaras?3*i:0;e+=t-s}})}),e.toFixed(1)},calcularKilosCrudos(a){if(!a.clientes)return"0.0";let e=0;return a.clientes.forEach(a=>{a.crudos&&Array.isArray(a.crudos)&&a.crudos.forEach(a=>{a&&a.items&&Array.isArray(a.items)&&a.items.forEach(a=>{let t=0;if(a.taras){const e=/^(\d+)-(\d+)$/.exec(a.taras);if(e){const a=parseInt(e[1])||0;let i=parseInt(e[2])||0;19===i&&(i=20),t+=a*i}else{const[e,i]=a.taras.split("-").map(Number);t+=(e||0)*(i||0)}}if(a.sobrante){const e=/^(\d+)-(\d+)$/.exec(a.sobrante);if(e){const a=parseInt(e[1])||0;let i=parseInt(e[2])||0;19===i&&(i=20),t+=a*i}else{const[e,i]=a.sobrante.split("-").map(Number);t+=(e||0)*(i||0)}}e+=t})})}),e.toFixed(1)},calcularTotalTaras(a){if(!a.clientes)return 0;let e=0;return a.clientes.forEach(a=>{a.productos&&a.productos.forEach(a=>{const t=Array.isArray(a.taras)?a.taras:[],i=Array.isArray(a.tarasExtra)?a.tarasExtra:[],s=[...t,...i];e+=s.reduce((a,e)=>a+(parseInt(e)||0),0)}),a.crudos&&a.crudos.forEach(a=>{a.items&&Array.isArray(a.items)&&a.items.forEach(a=>{if(a.taras){const[t]=a.taras.split("-");e+=parseInt(t)||0}if(a.sobrante){const[t]=a.sobrante.split("-");e+=parseInt(t)||0}})})}),e},formatearFecha(a){if(!a)return"Fecha no disponible";let e;if(a.toDate&&"function"===typeof a.toDate)e=a.toDate();else if(a instanceof Date)e=a;else{if("string"!==typeof a)return"Fecha invÃ¡lida";e=new Date(a)}const t=new Date(e.getTime()+6e4*e.getTimezoneOffset());return t.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})},editarEmbarque(a){this.$router.push({name:"NuevoEmbarque",params:{id:a}})},regresarAMenu(){this.$router.push({name:"EmbarquesMenu"})},async toggleNoEnviadoMexico(a,e){try{const s=!e,r=s?"Â¿Marcar este embarque como NO enviado a MÃ©xico?\n\nEsto significa que NO se contarÃ¡ en la suma de fletes.":"Â¿Marcar este embarque como enviado a MÃ©xico?\n\nEsto significa que SÃ se contarÃ¡ en la suma de fletes.";if(confirm(r)){await p["a"].init();const e=this.embarques.find(e=>e.id===a);if(e&&(e.noEnviadoMexico=s),navigator.onLine){const e=Object(o["h"])(),r=Object(b["useAuthStore"])(),n=Object(o["e"])(e,"embarques",a),c=await Object(o["f"])(n);if(c.exists()){var t,i;const e=c.data(),l={...e,noEnviadoMexico:s,ultimaEdicion:{userId:(null===r||void 0===r?void 0:r.userId)||"unknown",username:(null===r||void 0===r||null===(t=r.user)||void 0===t?void 0:t.username)||"Usuario",timestamp:Object(o["q"])()}};await Object(o["r"])(n,l,{merge:!1});const d=this.construirSnapshotOfflineDesdeRemoto(a,l,null!==(i=c.data().fecha)&&void 0!==i&&i.toDate?c.data().fecha.toDate():new Date(c.data().fecha));await p["a"].save(d,{pendingSync:!1,syncState:"synced"}),this.mostrarNotificacionRespaldo("success","âœ… Estado actualizado",s?"El embarque NO se contarÃ¡ para los fletes de MÃ©xico.":"El embarque SÃ se contarÃ¡ para los fletes de MÃ©xico.")}}else{const e=await p["a"].get(a);e&&(e.noEnviadoMexico=s,e.docData&&(e.docData.noEnviadoMexico=s),await p["a"].save(e,{pendingSync:!0,syncState:"pending"})),this.mostrarNotificacionRespaldo("warning","ðŸ“¡ Cambio guardado offline","El cambio se sincronizarÃ¡ automÃ¡ticamente cuando recuperes la conexiÃ³n.")}}}catch(s){console.error("[toggleNoEnviadoMexico] Error:",s),this.mostrarNotificacionRespaldo("error","âŒ Error","No se pudo actualizar el estado del embarque.");const t=this.embarques.find(e=>e.id===a);t&&(t.noEnviadoMexico=e)}},async eliminarEmbarque(a){const e=this.embarques.find(e=>e.id===a);if(e&&e.embarqueBloqueado)alert("Este embarque estÃ¡ bloqueado y no puede ser eliminado.");else if(confirm("Â¿EstÃ¡s seguro de que quieres eliminar este embarque?\n\nSe crearÃ¡ un respaldo automÃ¡tico antes de eliminarlo."))try{if(console.log("[ELIMINACIÃ“N MANUAL] Iniciando eliminaciÃ³n con respaldo para embarque "+a),await p["a"].init(),!navigator.onLine)return await p["a"].markDeleted(a,{pendingSync:!0,syncState:"pending-delete"}),this.embarques=this.embarques.filter(e=>e.id!==a),void this.mostrarNotificacionRespaldo("warning","ðŸ—‘ï¸ EliminaciÃ³n en modo offline","El embarque se marcarÃ¡ para eliminarse definitivamente cuando recuperes la conexiÃ³n.");try{await r["a"].crearRespaldoEmergencia(a,"eliminacion_manual_usuario"),console.log("[RESPALDO MANUAL] Respaldo creado exitosamente para embarque "+a),this.mostrarNotificacionRespaldo("success","ðŸ’¾ Respaldo creado","Se ha creado un respaldo de seguridad antes de eliminar el embarque")}catch(t){return console.error("[RESPALDO MANUAL] Error al crear respaldo:",t),void this.mostrarNotificacionRespaldo("error","âŒ Error en respaldo","No se pudo crear el respaldo de seguridad. El embarque NO serÃ¡ eliminado por seguridad.")}const e=Object(o["h"])();await Object(o["d"])(Object(o["e"])(e,"embarques",a)),await p["a"].hardDelete(a),console.log(`[ELIMINACIÃ“N MANUAL] Embarque ${a} eliminado exitosamente`),this.mostrarNotificacionRespaldo("success","âœ… Embarque eliminado","El embarque fue eliminado exitosamente. Puedes recuperarlo desde la herramienta de emergencia si es necesario."),await this.cargarEmbarques()}catch(i){console.error("[ELIMINACIÃ“N MANUAL] Error al eliminar el embarque:",i),this.mostrarNotificacionRespaldo("error","âŒ Error al eliminar","Hubo un error al eliminar el embarque. El respaldo fue creado exitosamente.")}},calcularPuntajeCompletitud(a){if(!a.clientes)return 0;let e=0;return a.clientes.forEach(a=>{a.productos&&Array.isArray(a.productos)&&a.productos.forEach(a=>{e+=1,a.reporteTaras&&a.reporteTaras.length>0&&(e+=2),a.reporteBolsas&&a.reporteBolsas.length>0&&(e+=2),a.medida&&""!==a.medida.trim()&&(e+=1)}),a.crudos&&Array.isArray(a.crudos)&&a.crudos.forEach(a=>{e+=3,a.kilos&&parseFloat(a.kilos)>0&&(e+=2)})}),a.cargaCon&&""!==a.cargaCon.trim()&&(e+=1),console.log("[PUNTAJE] Embarque calculado con puntaje: "+e),e},mostrarNotificacionRespaldo(a,e,t){this.tipoNotificacion=a,this.tituloNotificacion=e,this.mensajeNotificacion=t,this.mostrarNotificacion=!0},cerrarNotificacion(){this.mostrarNotificacion=!1}},async mounted(){await this.cargarEmbarques()}},v=h,g=(t("cf6a"),Object(u["a"])(v,i,s,!1,null,"1edb38c3",null));e["a"]=g.exports},cf6a:function(a,e,t){"use strict";t("9c26")}}]);