(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app.ce05ead1"],{"052b":function(e,o,a){"use strict";a("e28d")},"258d":function(e,o,a){},6319:function(e,o,a){"use strict";a("258d")},"6e99":function(e,o,a){"use strict";var t=function(){var e=this,o=e._self._c;return o("div",{staticClass:"lista-deudas-barcos"},[o("div",{staticClass:"back-button-container"},[o("BackButton",{attrs:{to:"/barcos"}})],1),o("div",{staticClass:"header-section"},[o("div",{staticClass:"header-content"},[o("h1",{staticClass:"main-title"},[o("i",{staticClass:"icon-list"},[e._v("üìã")]),e._v(" Lista de Deudas - "+e._s(e.nombreBarco)+" ")]),o("p",{staticClass:"subtitle"},[e._v("Gestiona las deudas pendientes del barco "+e._s(e.nombreBarco))])])]),o("div",{staticClass:"resumen-cards"},[o("div",{staticClass:"resumen-card barco-card"},[o("i",{staticClass:"card-icon"},[e._v(e._s("galileo"===e.barcoSeleccionado?"üö¢":"üõ•Ô∏è"))]),o("div",{staticClass:"card-content"},[o("h3",[e._v(e._s(e.nombreBarco))]),o("p",[e._v("Barco seleccionado")])])]),o("div",{staticClass:"resumen-card"},[o("i",{staticClass:"card-icon"},[e._v("üí∞")]),o("div",{staticClass:"card-content"},[o("h3",[e._v("$"+e._s(e.formatNumber(e.totalDeudas)))]),o("p",[e._v("Total Deudas")])])]),o("div",{staticClass:"resumen-card"},[o("i",{staticClass:"card-icon"},[e._v("‚úÖ")]),o("div",{staticClass:"card-content"},[o("h3",[e._v("$"+e._s(e.formatNumber(e.totalAbonado)))]),o("p",[e._v("Total Abonado")])])]),o("div",{staticClass:"resumen-card"},[o("i",{staticClass:"card-icon"},[e._v("‚è≥")]),o("div",{staticClass:"card-content"},[o("h3",[e._v("$"+e._s(e.formatNumber(e.totalPendiente)))]),o("p",[e._v("Total Pendiente")])])])]),o("div",{staticClass:"filtros-card"},[e._m(0),o("div",{staticClass:"filtros-container"},[o("select",{directives:[{name:"model",rawName:"v-model",value:e.filtroEstado,expression:"filtroEstado"}],staticClass:"filtro-select",on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,(function(e){return e.selected})).map((function(e){var o="_value"in e?e._value:e.value;return o}));e.filtroEstado=o.target.multiple?a:a[0]}}},[o("option",{attrs:{value:""}},[e._v("Todos los estados")]),o("option",{attrs:{value:"pendiente"}},[e._v("Pendiente")]),o("option",{attrs:{value:"pagado"}},[e._v("Pagado")]),o("option",{attrs:{value:"parcial"}},[e._v("Pago Parcial")])]),o("select",{directives:[{name:"model",rawName:"v-model",value:e.filtroProveedor,expression:"filtroProveedor"}],staticClass:"filtro-select",on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,(function(e){return e.selected})).map((function(e){var o="_value"in e?e._value:e.value;return o}));e.filtroProveedor=o.target.multiple?a:a[0]}}},[o("option",{attrs:{value:""}},[e._v("Todos los proveedores")]),e._l(e.proveedoresUnicos,(function(a){return o("option",{key:a.id,domProps:{value:a.id}},[e._v(" "+e._s(a.nombre)+" ")])}))],2),o("input",{directives:[{name:"model",rawName:"v-model",value:e.filtroFechaInicio,expression:"filtroFechaInicio"}],staticClass:"filtro-input",attrs:{type:"date",placeholder:"Fecha inicio"},domProps:{value:e.filtroFechaInicio},on:{input:function(o){o.target.composing||(e.filtroFechaInicio=o.target.value)}}}),o("input",{directives:[{name:"model",rawName:"v-model",value:e.filtroFechaFin,expression:"filtroFechaFin"}],staticClass:"filtro-input",attrs:{type:"date",placeholder:"Fecha fin"},domProps:{value:e.filtroFechaFin},on:{input:function(o){o.target.composing||(e.filtroFechaFin=o.target.value)}}}),o("button",{staticClass:"btn-limpiar",on:{click:e.limpiarFiltros}},[o("i",{staticClass:"icon"},[e._v("üóëÔ∏è")]),e._v(" Limpiar ")]),o("button",{staticClass:"btn-historial-general",on:{click:e.verHistorialGeneral}},[o("i",{staticClass:"icon"},[e._v("üìä")]),e._v(" Historial General ")])])]),e.deudasFiltradas.length>0?o("div",{staticClass:"deudas-container"},e._l(e.deudasFiltradas,(function(a){return o("div",{key:a.id,staticClass:"deuda-card",class:{pagado:"pagado"===a.estado}},[o("div",{staticClass:"deuda-header"},[o("div",{staticClass:"proveedor-info"},[o("div",{staticClass:"color-indicator",style:{backgroundColor:e.getProveedorColor(a.proveedorId)}}),o("div",[o("h3",[e._v(e._s(a.nombreProveedor))]),o("p",{staticClass:"fecha"},[e._v(e._s(e.formatDate(a.fecha)))])])]),o("div",{staticClass:"estado-badge",class:"estado-"+a.estado},[e._v(" "+e._s(e.getEstadoLabel(a.estado))+" ")])]),o("div",{staticClass:"deuda-items"},[o("h4",[e._v("Items:")]),o("ul",e._l(a.items,(function(a,t){return o("li",{key:t},[e._v(" "+e._s(a.descripcion)+" "),a.cantidad?o("span",[e._v("("+e._s(a.cantidad)+")")]):e._e(),e._v(" - $"+e._s(e.formatNumber(a.costo))+" ")])})),0)]),o("div",{staticClass:"deuda-totales"},[o("div",{staticClass:"total-item"},[o("span",[e._v("Total Deuda:")]),o("span",{staticClass:"amount"},[e._v("$"+e._s(e.formatNumber(a.totalDeuda)))])]),o("div",{staticClass:"total-item"},[o("span",[e._v("Total Abonado:")]),o("span",{staticClass:"amount abonado"},[e._v("$"+e._s(e.formatNumber(a.totalAbonado)))])]),o("div",{staticClass:"total-item saldo"},[o("span",[e._v("Saldo Pendiente:")]),o("span",{staticClass:"amount"},[e._v("$"+e._s(e.formatNumber(a.saldoPendiente)))])])]),o("div",{staticClass:"deuda-actions"},[o("button",{staticClass:"btn-abono",attrs:{disabled:"pagado"===a.estado},on:{click:function(o){return e.abrirModalAbono(a)}}},[o("i",{staticClass:"icon"},[e._v("üíµ")]),e._v(" Realizar Abono ")]),o("button",{staticClass:"btn-historial",on:{click:function(o){return e.verHistorialAbonos(a)}}},[o("i",{staticClass:"icon"},[e._v("üìú")]),e._v(" Ver Abonos ")]),"pagado"!==a.estado?o("button",{staticClass:"btn-estado",on:{click:function(o){return e.cambiarEstado(a)}}},[o("i",{staticClass:"icon"},[e._v("‚úÖ")]),e._v(" Marcar Pagado ")]):e._e(),o("button",{staticClass:"btn-eliminar",on:{click:function(o){return e.eliminarDeuda(a)}}},[o("i",{staticClass:"icon"},[e._v("üóëÔ∏è")])])])])})),0):o("div",{staticClass:"no-deudas"},[o("i",{staticClass:"empty-icon"},[e._v("üì≠")]),o("h3",[e._v("No hay deudas registradas")]),o("p",[e._v("No se encontraron deudas para los filtros seleccionados")])]),e.showModalAbono?o("div",{staticClass:"modal-overlay",on:{click:e.closeModalOnOverlay}},[o("div",{staticClass:"modal-content",on:{click:function(e){e.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h2",[e._v("Realizar Abono")]),o("button",{staticClass:"close-button",on:{click:function(o){e.showModalAbono=!1}}},[e._v("‚úï")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"deuda-info"},[o("h4",[e._v(e._s(e.deudaSeleccionada.nombreProveedor))]),o("p",[e._v("Saldo pendiente: $"+e._s(e.formatNumber(e.deudaSeleccionada.saldoPendiente)))])]),o("form",{on:{submit:function(o){return o.preventDefault(),e.guardarAbono.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",[e._v("Monto del abono")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:e.nuevoAbono.monto,expression:"nuevoAbono.monto",modifiers:{number:!0}}],staticClass:"form-input",attrs:{type:"number",step:"0.01",required:"",max:e.deudaSeleccionada.saldoPendiente},domProps:{value:e.nuevoAbono.monto},on:{input:function(o){o.target.composing||e.$set(e.nuevoAbono,"monto",e._n(o.target.value))},blur:function(o){return e.$forceUpdate()}}})]),o("div",{staticClass:"form-group"},[o("label",[e._v("Descripci√≥n (opcional)")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevoAbono.descripcion,expression:"nuevoAbono.descripcion"}],staticClass:"form-input",attrs:{type:"text",placeholder:"Descripci√≥n del abono"},domProps:{value:e.nuevoAbono.descripcion},on:{input:function(o){o.target.composing||e.$set(e.nuevoAbono,"descripcion",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[e._v("Fecha del abono")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevoAbono.fecha,expression:"nuevoAbono.fecha"}],staticClass:"form-input",attrs:{type:"date",required:""},domProps:{value:e.nuevoAbono.fecha},on:{input:function(o){o.target.composing||e.$set(e.nuevoAbono,"fecha",o.target.value)}}})]),o("div",{staticClass:"modal-actions"},[o("button",{staticClass:"btn-cancelar",attrs:{type:"button"},on:{click:function(o){e.showModalAbono=!1}}},[e._v(" Cancelar ")]),o("button",{staticClass:"btn-guardar",attrs:{type:"submit"}},[e._v(" Guardar Abono ")])])])])])]):e._e(),e.showModalHistorial?o("div",{staticClass:"modal-overlay",on:{click:e.closeModalOnOverlay}},[o("div",{staticClass:"modal-content modal-historial",on:{click:function(e){e.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h2",[e._v("Historial de Abonos")]),o("button",{staticClass:"close-button",on:{click:function(o){e.showModalHistorial=!1}}},[e._v("‚úï")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"deuda-info"},[o("h4",[e._v(e._s(e.deudaSeleccionada.nombreProveedor))]),o("p",[e._v("Total deuda: $"+e._s(e.formatNumber(e.deudaSeleccionada.totalDeuda)))])]),e.historialAbonos.length>0?o("div",{staticClass:"abonos-list"},[e._l(e.historialAbonos,(function(a){return o("div",{key:a.id,staticClass:"abono-item",class:{"abono-general":a.esGeneral}},[o("div",{staticClass:"abono-fecha"},[e._v(e._s(e.formatDate(a.fecha)))]),o("div",{staticClass:"abono-info"},[o("div",{staticClass:"abono-descripcion"},[e._v(e._s(a.descripcion||"Abono"))]),o("div",{staticClass:"abono-proveedor"},[e._v(e._s(a.nombreProveedor))]),a.tipoAbono?o("div",{staticClass:"abono-tipo"},[e._v(e._s(a.tipoAbono))]):e._e()]),o("div",{staticClass:"abono-monto"},[e._v("$"+e._s(e.formatNumber(a.monto)))])])})),o("div",{staticClass:"abonos-total"},[o("span",[e._v("Total abonado:")]),o("span",[e._v("$"+e._s(e.formatNumber(e.totalAbonosHistorial)))])])],2):o("div",{staticClass:"no-abonos"},[o("p",[e._v("No hay abonos registrados para esta deuda")])])])])]):e._e()])},s=[function(){var e=this,o=e._self._c;return o("h3",{staticClass:"section-title"},[o("i",{staticClass:"icon-filter"},[e._v("üîç")]),e._v(" Filtros ")])}],r=(a("13d5"),a("88a7"),a("271a"),a("5494"),a("dc59")),i=a("1494"),n=a("74c9"),c={name:"ListaDeudasBarcos",components:{BackButton:n["a"]},data(){return{barcoSeleccionado:"",deudas:[],proveedores:[],filtroEstado:"",filtroProveedor:"",filtroFechaInicio:"",filtroFechaFin:"",showModalAbono:!1,showModalHistorial:!1,deudaSeleccionada:null,nuevoAbono:{monto:null,descripcion:"",fecha:(new Date).toISOString().split("T")[0]},historialAbonos:[]}},computed:{nombreBarco(){return"galileo"===this.barcoSeleccionado?"El Galileo":"Mar√≠a Guadalupe"},deudasFiltradas(){return this.deudas.filter(e=>{if(this.filtroEstado&&e.estado!==this.filtroEstado)return!1;if(this.filtroProveedor&&e.proveedorId!==this.filtroProveedor)return!1;if(this.filtroFechaInicio||this.filtroFechaFin){const o=new Date(e.fecha);if(this.filtroFechaInicio&&o<new Date(this.filtroFechaInicio))return!1;if(this.filtroFechaFin&&o>new Date(this.filtroFechaFin))return!1}return!0})},proveedoresUnicos(){const e=new Map;return this.deudas.forEach(o=>{e.has(o.proveedorId)||e.set(o.proveedorId,{id:o.proveedorId,nombre:o.nombreProveedor})}),Array.from(e.values())},totalDeudas(){return this.deudasFiltradas.reduce((e,o)=>e+o.totalDeuda,0)},totalAbonado(){return this.deudasFiltradas.reduce((e,o)=>e+o.totalAbonado,0)},totalPendiente(){return this.deudasFiltradas.reduce((e,o)=>e+o.saldoPendiente,0)},totalAbonosHistorial(){return this.historialAbonos.reduce((e,o)=>e+o.monto,0)}},mounted(){const e=new URLSearchParams(window.location.search);this.barcoSeleccionado=e.get("barco")||localStorage.getItem("barcoSeleccionado")||"galileo",this.loadDeudas(),this.loadProveedores()},methods:{async loadDeudas(){try{const e=Object(i["o"])(Object(i["c"])(r["a"],"deudasBarcos"),Object(i["s"])("barco","==",this.barcoSeleccionado),Object(i["l"])("fecha","desc")),o=await Object(i["g"])(e);this.deudas=o.docs.map(e=>({id:e.id,...e.data()}))}catch(e){console.error("Error al cargar deudas:",e)}},async loadProveedores(){try{const e=await Object(i["g"])(Object(i["c"])(r["a"],"proveedoresBarcos"));this.proveedores=e.docs.map(e=>({id:e.id,...e.data()}))}catch(e){console.error("Error al cargar proveedores:",e)}},getProveedorColor(e){const o=this.proveedores.find(o=>o.id===e);return(null===o||void 0===o?void 0:o.color)||"#6c757d"},formatNumber(e){return new Intl.NumberFormat("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e||0)},formatDate(e){if(!e)return"";const o=new Date(e+"T00:00:00"),a={year:"numeric",month:"long",day:"numeric"};return o.toLocaleDateString("es-ES",a)},getEstadoLabel(e){const o={pendiente:"Pendiente",pagado:"Pagado",parcial:"Pago Parcial"};return o[e]||e},limpiarFiltros(){this.filtroEstado="",this.filtroProveedor="",this.filtroFechaInicio="",this.filtroFechaFin=""},abrirModalAbono(e){this.deudaSeleccionada=e,this.nuevoAbono={monto:null,descripcion:"",fecha:(new Date).toISOString().split("T")[0]},this.showModalAbono=!0},async guardarAbono(){const e=parseFloat(this.nuevoAbono.monto)||0;if(!e||e<=0)return void alert("Por favor ingrese un monto v√°lido mayor a 0");const o=parseFloat(this.deudaSeleccionada.saldoPendiente)||0;if(e>o)alert(`El monto del abono ($${e.toFixed(2)}) no puede ser mayor al saldo pendiente ($${o.toFixed(2)})`);else if(this.nuevoAbono.fecha)try{await Object(i["b"])(Object(i["c"])(r["a"],"abonosBarcos"),{deudaId:this.deudaSeleccionada.id,barco:this.barcoSeleccionado,nombreBarco:this.nombreBarco,proveedorId:this.deudaSeleccionada.proveedorId,nombreProveedor:this.deudaSeleccionada.nombreProveedor,monto:parseFloat(e.toFixed(2)),descripcion:(this.nuevoAbono.descripcion||"Abono").trim(),fecha:this.nuevoAbono.fecha,createdAt:new Date});const o=parseFloat(this.deudaSeleccionada.totalAbonado)||0,a=parseFloat((o+e).toFixed(2)),t=parseFloat((this.deudaSeleccionada.totalDeuda-a).toFixed(2));let s="pendiente";t<=0?s="pagado":a>0&&(s="parcial"),await Object(i["r"])(Object(i["e"])(r["a"],"deudasBarcos",this.deudaSeleccionada.id),{totalAbonado:a,saldoPendiente:Math.max(0,t),estado:s,updatedAt:new Date}),this.showModalAbono=!1,await this.loadDeudas(),alert("Abono registrado exitosamente")}catch(a){console.error("Error al guardar abono:",a),alert("Error al guardar el abono: "+a.message)}else alert("Por favor seleccione una fecha para el abono")},async verHistorialAbonos(e){this.deudaSeleccionada=e;try{const o=Object(i["o"])(Object(i["c"])(r["a"],"abonosBarcos"),Object(i["s"])("deudaId","==",e.id),Object(i["l"])("fecha","desc")),a=await Object(i["g"])(o);this.historialAbonos=a.docs.map(e=>({id:e.id,...e.data()})),this.showModalHistorial=!0}catch(o){console.error("Error al cargar historial:",o),alert("Error al cargar el historial de abonos")}},async verHistorialGeneral(){this.deudaSeleccionada={nombreProveedor:"Historial General - "+this.nombreBarco,totalDeuda:0};try{const e=Object(i["o"])(Object(i["c"])(r["a"],"abonosBarcos"),Object(i["s"])("barco","==",this.barcoSeleccionado),Object(i["l"])("fecha","desc")),o=await Object(i["g"])(e);this.historialAbonos=o.docs.map(e=>{const o=e.data();return{id:e.id,...o,esGeneral:!o.deudaId,tipoAbono:o.deudaId?"Deuda espec√≠fica":"Abono general"}}),this.showModalHistorial=!0}catch(e){console.error("Error al cargar historial general:",e),alert("Error al cargar el historial general de abonos")}},async cambiarEstado(e){if(confirm("¬øEst√° seguro de marcar esta deuda como pagada?"))try{await Object(i["r"])(Object(i["e"])(r["a"],"deudasBarcos",e.id),{totalAbonado:e.totalDeuda,saldoPendiente:0,estado:"pagado",updatedAt:new Date}),await this.loadDeudas(),alert("Deuda marcada como pagada")}catch(o){console.error("Error al cambiar estado:",o),alert("Error al cambiar el estado de la deuda")}},async eliminarDeuda(e){if(confirm("¬øEst√° seguro de eliminar esta deuda? Esta acci√≥n no se puede deshacer."))try{const o=Object(i["o"])(Object(i["c"])(r["a"],"abonosBarcos"),Object(i["s"])("deudaId","==",e.id)),a=await Object(i["g"])(o),t=a.docs.map(e=>Object(i["d"])(e.ref));await Promise.all(t),await Object(i["d"])(Object(i["e"])(r["a"],"deudasBarcos",e.id)),await this.loadDeudas(),alert("Deuda eliminada exitosamente")}catch(o){console.error("Error al eliminar deuda:",o),alert("Error al eliminar la deuda")}},closeModalOnOverlay(e){e.target.classList.contains("modal-overlay")&&(this.showModalAbono=!1,this.showModalHistorial=!1)}}},l=c,d=(a("052b"),a("2877")),u=Object(d["a"])(l,t,s,!1,null,"6e75242c",null);o["a"]=u.exports},"9c33":function(e,o,a){"use strict";var t=function(){var e=this,o=e._self._c;return o("div",{staticClass:"nueva-deuda-barco"},[o("div",{staticClass:"back-button-container"},[o("BackButton",{attrs:{to:"/barcos"}})],1),o("div",{staticClass:"header-section"},[o("div",{staticClass:"header-content"},[o("h1",{staticClass:"main-title"},[o("i",{staticClass:"icon-new"},[e._v("‚ûï")]),e._v(" Nueva Deuda - "+e._s(e.nombreBarco)+" ")]),o("p",{staticClass:"subtitle"},[e._v("Registra una nueva deuda para el barco "+e._s(e.nombreBarco))])])]),o("div",{staticClass:"barco-info-card"},[o("div",{staticClass:"barco-display"},[o("i",{staticClass:"barco-icon"},[e._v(e._s("galileo"===e.barcoSeleccionado?"üö¢":"üõ•Ô∏è"))]),o("div",{staticClass:"barco-details"},[o("h3",[e._v(e._s(e.nombreBarco))]),o("p",[e._v("Barco seleccionado")])])])]),o("div",{staticClass:"fecha-card"},[e._m(0),o("div",{staticClass:"fecha-container"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.fechaSeleccionada,expression:"fechaSeleccionada"}],staticClass:"modern-input",attrs:{type:"date"},domProps:{value:e.fechaSeleccionada},on:{input:function(o){o.target.composing||(e.fechaSeleccionada=o.target.value)}}}),o("span",{staticClass:"fecha-display"},[e._v(e._s(e.fechaFormateada))])])]),o("div",{staticClass:"proveedor-card"},[e._m(1),o("select",{directives:[{name:"model",rawName:"v-model",value:e.proveedorSeleccionado,expression:"proveedorSeleccionado"}],staticClass:"modern-select",attrs:{required:""},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,(function(e){return e.selected})).map((function(e){var o="_value"in e?e._value:e.value;return o}));e.proveedorSeleccionado=o.target.multiple?a:a[0]}}},[o("option",{attrs:{value:"",disabled:""}},[e._v("Seleccione un proveedor")]),e._l(e.proveedores,(function(a){return o("option",{key:a.id,domProps:{value:a.id}},[e._v(" "+e._s(a.nombre)+" "+e._s(a.tipo?"- "+a.tipo:"")+" ")])}))],2),e.proveedorSeleccionado&&e.getNombreProveedor()?o("div",{staticClass:"proveedor-selected-info"},[o("div",{staticClass:"proveedor-color-display"},[o("div",{staticClass:"color-indicator-large",style:{backgroundColor:e.getProveedorColor(e.proveedorSeleccionado)}}),o("div",{staticClass:"proveedor-details"},[o("span",{staticClass:"proveedor-nombre"},[e._v(e._s(e.getNombreProveedor()))]),e.getProveedorTipo()?o("span",{staticClass:"proveedor-tipo"},[e._v(e._s(e.getProveedorTipo()))]):e._e(),o("span",{staticClass:"proveedor-label"},[e._v("Proveedor seleccionado")])])])]):e._e()]),e.proveedorSeleccionado?o("div",{staticClass:"productos-card"},[e._m(2),o("form",{staticClass:"add-item-form",on:{submit:function(o){return o.preventDefault(),e.addItem.apply(null,arguments)}}},[o("div",{staticClass:"form-grid"},[o("div",{staticClass:"form-group"},[e._m(3),o("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevoItem.descripcion,expression:"nuevoItem.descripcion"}],staticClass:"modern-input",attrs:{type:"text",required:"",placeholder:"Ej: Combustible Diesel, Aceite de motor, etc."},domProps:{value:e.nuevoItem.descripcion},on:{input:function(o){o.target.composing||e.$set(e.nuevoItem,"descripcion",o.target.value)}}})]),o("div",{staticClass:"form-group"},[e._m(4),o("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevoItem.cantidad,expression:"nuevoItem.cantidad"}],staticClass:"modern-input",attrs:{type:"text",placeholder:"Ej: 100 litros, 5 galones"},domProps:{value:e.nuevoItem.cantidad},on:{input:function(o){o.target.composing||e.$set(e.nuevoItem,"cantidad",o.target.value)}}})]),o("div",{staticClass:"form-group"},[e._m(5),o("input",{directives:[{name:"model",rawName:"v-model.number",value:e.nuevoItem.costo,expression:"nuevoItem.costo",modifiers:{number:!0}}],staticClass:"modern-input",attrs:{type:"number",step:"0.01",required:"",placeholder:"0.00"},domProps:{value:e.nuevoItem.costo},on:{input:function(o){o.target.composing||e.$set(e.nuevoItem,"costo",e._n(o.target.value))},blur:function(o){return e.$forceUpdate()}}})])]),e._m(6)])]):e._e(),e.items.length>0?o("div",{staticClass:"tabla-container"},[e._m(7),o("div",{staticClass:"tabla-wrapper"},[o("table",{staticClass:"tabla-items"},[e._m(8),o("tbody",e._l(e.items,(function(a,t){return o("tr",{key:t},[o("td",{staticClass:"editable",on:{click:function(o){return e.editarItem(t,"descripcion")}}},[a.editando&&"descripcion"===a.campoEditando?o("input",{directives:[{name:"model",rawName:"v-model",value:a.descripcion,expression:"item.descripcion"}],staticClass:"table-input",attrs:{type:"text"},domProps:{value:a.descripcion},on:{blur:function(o){return e.finalizarEdicion(t)},keyup:function(o){return!o.type.indexOf("key")&&e._k(o.keyCode,"enter",13,o.key,"Enter")?null:e.finalizarEdicion(t)},input:function(o){o.target.composing||e.$set(a,"descripcion",o.target.value)}}}):o("span",[e._v(e._s(a.descripcion))])]),o("td",{staticClass:"editable",on:{click:function(o){return e.editarItem(t,"cantidad")}}},[a.editando&&"cantidad"===a.campoEditando?o("input",{directives:[{name:"model",rawName:"v-model",value:a.cantidad,expression:"item.cantidad"}],staticClass:"table-input",attrs:{type:"text"},domProps:{value:a.cantidad},on:{blur:function(o){return e.finalizarEdicion(t)},keyup:function(o){return!o.type.indexOf("key")&&e._k(o.keyCode,"enter",13,o.key,"Enter")?null:e.finalizarEdicion(t)},input:function(o){o.target.composing||e.$set(a,"cantidad",o.target.value)}}}):o("span",[e._v(e._s(a.cantidad||"-"))])]),o("td",{staticClass:"editable",on:{click:function(o){return e.editarItem(t,"costo")}}},[a.editando&&"costo"===a.campoEditando?o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.costo,expression:"item.costo",modifiers:{number:!0}}],staticClass:"table-input",attrs:{type:"number"},domProps:{value:a.costo},on:{blur:[function(o){return e.finalizarEdicion(t)},function(o){return e.$forceUpdate()}],keyup:function(o){return!o.type.indexOf("key")&&e._k(o.keyCode,"enter",13,o.key,"Enter")?null:e.finalizarEdicion(t)},input:function(o){o.target.composing||e.$set(a,"costo",e._n(o.target.value))}}}):o("span",[e._v("$"+e._s(e.formatNumber(a.costo)))])]),o("td",{staticClass:"action-column"},[o("button",{staticClass:"btn-delete",on:{click:function(o){return e.removeItem(t)}}},[o("i",{staticClass:"icon-trash"},[e._v("üóëÔ∏è")])])])])})),0),o("tfoot",[o("tr",{staticClass:"total-row"},[o("td",{staticClass:"total-label",attrs:{colspan:"2"}},[e._v("Total General")]),o("td",{staticClass:"total-amount"},[e._v("$"+e._s(e.formatNumber(e.totalGeneral)))]),o("td")])])])])]):e._e(),e.items.length>0?o("div",{staticClass:"abonos-section"},[o("h2",[e._v("Abonos Iniciales (Opcional)")]),o("div",{staticClass:"abonos"},[e._l(e.abonos,(function(a,t){return o("div",{key:t,staticClass:"abono-row"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.descripcion,expression:"abono.descripcion"}],staticClass:"modern-input",attrs:{type:"text",placeholder:"Descripci√≥n del abono"},domProps:{value:a.descripcion},on:{input:function(o){o.target.composing||e.$set(a,"descripcion",o.target.value)}}}),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.monto,expression:"abono.monto",modifiers:{number:!0}}],staticClass:"modern-input",attrs:{type:"number",placeholder:"Monto"},domProps:{value:a.monto},on:{input:function(o){o.target.composing||e.$set(a,"monto",e._n(o.target.value))},blur:function(o){return e.$forceUpdate()}}}),o("button",{staticClass:"delete-btn",on:{click:function(o){return e.removeAbono(t)}}},[o("i",{staticClass:"icon-trash"},[e._v("üóëÔ∏è")])])])})),o("button",{staticClass:"add-abono-btn",on:{click:e.addAbono}},[o("i",{staticClass:"btn-icon"},[e._v("‚ûï")]),e._v(" Agregar Abono ")])],2),o("div",{staticClass:"resumen"},[o("h3",[e._v("Resumen")]),o("div",{staticClass:"resumen-item"},[o("span",[e._v("Total deuda:")]),o("span",[e._v("$"+e._s(e.formatNumber(e.totalGeneral)))])]),o("div",{staticClass:"resumen-item"},[o("span",[e._v("Total abonos:")]),o("span",[e._v("$"+e._s(e.formatNumber(e.totalAbonos)))])]),o("div",{staticClass:"resumen-item total"},[o("span",[e._v("Saldo pendiente:")]),o("span",[e._v("$"+e._s(e.formatNumber(e.saldoPendiente)))])])])]):e._e(),e.proveedorSeleccionado&&e.items.length>0?o("div",{staticClass:"button-container"},[o("button",{staticClass:"save-button",attrs:{disabled:e.guardando},on:{click:e.guardarDeuda}},[e._v(" "+e._s(e.guardando?"Guardando...":"Guardar Deuda")+" ")])]):e._e()])},s=[function(){var e=this,o=e._self._c;return o("h3",{staticClass:"section-title"},[o("i",{staticClass:"icon-calendar"},[e._v("üìÖ")]),e._v(" Fecha de la Deuda ")])},function(){var e=this,o=e._self._c;return o("h3",{staticClass:"section-title"},[o("i",{staticClass:"icon-supplier"},[e._v("üè≠")]),e._v(" Seleccionar Proveedor ")])},function(){var e=this,o=e._self._c;return o("h3",{staticClass:"section-title"},[o("i",{staticClass:"icon-products"},[e._v("üì¶")]),e._v(" Agregar Productos o Servicios ")])},function(){var e=this,o=e._self._c;return o("label",{staticClass:"modern-label"},[o("i",{staticClass:"label-icon"},[e._v("üìù")]),e._v(" Descripci√≥n ")])},function(){var e=this,o=e._self._c;return o("label",{staticClass:"modern-label"},[o("i",{staticClass:"label-icon"},[e._v("üî¢")]),e._v(" Cantidad (opcional) ")])},function(){var e=this,o=e._self._c;return o("label",{staticClass:"modern-label"},[o("i",{staticClass:"label-icon"},[e._v("üí∞")]),e._v(" Costo Total ")])},function(){var e=this,o=e._self._c;return o("button",{staticClass:"add-item-button",attrs:{type:"submit"}},[o("i",{staticClass:"btn-icon"},[e._v("‚ûï")]),e._v(" Agregar ")])},function(){var e=this,o=e._self._c;return o("h3",{staticClass:"section-title"},[o("i",{staticClass:"icon-list"},[e._v("üìã")]),e._v(" Items Agregados ")])},function(){var e=this,o=e._self._c;return o("thead",[o("tr",[o("th",[e._v("Descripci√≥n")]),o("th",[e._v("Cantidad")]),o("th",[e._v("Costo")]),o("th",[e._v("Acciones")])])])}],r=(a("14d9"),a("13d5"),a("88a7"),a("271a"),a("5494"),a("dc59")),i=a("1494"),n=a("74c9"),c={name:"NuevaDeudaBarco",components:{BackButton:n["a"]},data(){return{barcoSeleccionado:"",fechaSeleccionada:(new Date).toISOString().split("T")[0],proveedorSeleccionado:"",proveedores:[],nuevoItem:{descripcion:"",cantidad:"",costo:null},items:[],abonos:[],guardando:!1}},computed:{nombreBarco(){return"galileo"===this.barcoSeleccionado?"El Galileo":"Mar√≠a Guadalupe"},fechaFormateada(){if(!this.fechaSeleccionada)return"";const e=new Date(this.fechaSeleccionada+"T00:00:00"),o={year:"numeric",month:"long",day:"numeric"};return e.toLocaleDateString("es-ES",o)},totalGeneral(){return this.items.reduce((e,o)=>e+(parseFloat(o.costo)||0),0)},totalAbonos(){return this.abonos.reduce((e,o)=>e+(parseFloat(o.monto)||0),0)},saldoPendiente(){return this.totalGeneral-this.totalAbonos}},mounted(){const e=new URLSearchParams(window.location.search);this.barcoSeleccionado=e.get("barco")||localStorage.getItem("barcoSeleccionado")||"galileo",this.loadProveedores()},methods:{async loadProveedores(){try{const e=Object(i["o"])(Object(i["c"])(r["a"],"proveedoresBarcos"),Object(i["l"])("nombre")),o=await Object(i["g"])(e);this.proveedores=o.docs.map(e=>({id:e.id,...e.data()}))}catch(e){console.error("Error al cargar proveedores:",e)}},getNombreProveedor(){const e=this.proveedores.find(e=>e.id===this.proveedorSeleccionado);return e?e.nombre:""},getProveedorColor(e){const o=this.proveedores.find(o=>o.id===e);return(null===o||void 0===o?void 0:o.color)||"#6c757d"},getProveedorTipo(){const e=this.proveedores.find(e=>e.id===this.proveedorSeleccionado);return(null===e||void 0===e?void 0:e.tipo)||""},addItem(){this.nuevoItem.descripcion&&this.nuevoItem.costo?(this.items.push({descripcion:this.nuevoItem.descripcion,cantidad:this.nuevoItem.cantidad,costo:parseFloat(this.nuevoItem.costo),editando:!1,campoEditando:null}),this.nuevoItem={descripcion:"",cantidad:"",costo:null}):alert("Por favor complete la descripci√≥n y el costo")},removeItem(e){this.items.splice(e,1)},editarItem(e,o){this.items[e].editando=!0,this.items[e].campoEditando=o},finalizarEdicion(e){this.items[e].editando=!1,this.items[e].campoEditando=null},addAbono(){this.abonos.push({descripcion:"",monto:0})},removeAbono(e){this.abonos.splice(e,1)},formatNumber(e){return new Intl.NumberFormat("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e||0)},async guardarDeuda(){if(!this.guardando)if(this.proveedorSeleccionado&&0!==this.items.length){this.guardando=!0;try{const e=this.totalAbonos,o=this.totalGeneral-e;let a="pendiente";0===o?a="pagado":e>0&&(a="parcial");const t={barco:this.barcoSeleccionado,nombreBarco:this.nombreBarco,proveedorId:this.proveedorSeleccionado,nombreProveedor:this.getNombreProveedor(),fecha:this.fechaSeleccionada,items:this.items.map(e=>({descripcion:e.descripcion.trim(),cantidad:e.cantidad?e.cantidad.trim():"",costo:parseFloat(e.costo)||0})),totalDeuda:parseFloat(this.totalGeneral.toFixed(2)),totalAbonado:parseFloat(e.toFixed(2)),saldoPendiente:parseFloat(o.toFixed(2)),estado:a,createdAt:new Date,updatedAt:new Date},s=await Object(i["b"])(Object(i["c"])(r["a"],"deudasBarcos"),t);if(this.abonos.length>0){const e=[];for(const o of this.abonos){const a=parseFloat(o.monto)||0;a>0&&e.push(Object(i["b"])(Object(i["c"])(r["a"],"abonosBarcos"),{deudaId:s.id,barco:this.barcoSeleccionado,nombreBarco:this.nombreBarco,proveedorId:this.proveedorSeleccionado,nombreProveedor:this.getNombreProveedor(),descripcion:(o.descripcion||"Abono inicial").trim(),monto:parseFloat(a.toFixed(2)),fecha:this.fechaSeleccionada,createdAt:new Date}))}e.length>0&&await Promise.all(e)}alert("Deuda guardada exitosamente"),this.$router.push("/barcos/deudas/lista?barco="+this.barcoSeleccionado)}catch(e){console.error("Error al guardar deuda:",e),alert("Error al guardar la deuda")}finally{this.guardando=!1}}else alert("Por favor seleccione un proveedor y agregue al menos un item")}}},l=c,d=(a("6319"),a("2877")),u=Object(d["a"])(l,t,s,!1,null,"14104177",null);o["a"]=u.exports},db97:function(e,o,a){"use strict";a("facf")},e28d:function(e,o,a){},f40d:function(e,o,a){"use strict";var t=function(){var e=this,o=e._self._c;return o("div",{staticClass:"barcos-menu"},[o("div",{staticClass:"back-button-container"},[o("BackButton",{attrs:{to:"/"}})],1),e._m(0),o("div",{staticClass:"barco-selector-card"},[e._m(1),o("div",{staticClass:"barcos-buttons"},[o("button",{class:["barco-btn",{active:"galileo"===e.barcoSeleccionado}],on:{click:function(o){return e.seleccionarBarco("galileo")}}},[o("i",{staticClass:"barco-icon"},[e._v("üö¢")]),o("span",[e._v("El Galileo")])]),o("button",{class:["barco-btn",{active:"maria-guadalupe"===e.barcoSeleccionado}],on:{click:function(o){return e.seleccionarBarco("maria-guadalupe")}}},[o("i",{staticClass:"barco-icon"},[e._v("üõ•Ô∏è")]),o("span",[e._v("Mar√≠a Guadalupe")])])])]),e.barcoSeleccionado?o("div",{staticClass:"menu-options"},[o("router-link",{staticClass:"btn-action btn-lista",attrs:{to:"/barcos/deudas/lista?barco="+e.barcoSeleccionado,"aria-label":"Ver lista de deudas del barco"}},[o("i",{staticClass:"icon"},[e._v("üìã")]),o("span",[e._v("Lista de Deudas")])]),o("router-link",{staticClass:"btn-action btn-nueva",attrs:{to:"/barcos/deudas/nueva?barco="+e.barcoSeleccionado,"aria-label":"Crear nueva deuda para el barco"}},[o("i",{staticClass:"icon"},[e._v("‚ûï")]),o("span",[e._v("Nueva Deuda")])]),o("button",{staticClass:"btn-action btn-abono-general",attrs:{"aria-label":"Crear abono general para el barco"},on:{click:e.openAbonoGeneralModal}},[o("i",{staticClass:"icon"},[e._v("üíµ")]),o("span",[e._v("Abono General")])]),o("button",{staticClass:"btn-action btn-config",attrs:{"aria-label":"Configurar proveedores de barcos"},on:{click:e.openProveedoresModal}},[o("i",{staticClass:"icon"},[e._v("‚öôÔ∏è")]),o("span",[e._v("Configurar Proveedores")])])],1):e._e(),e.showModal?o("div",{staticClass:"modal-overlay",on:{click:e.closeModalOnOverlay}},[o("div",{staticClass:"modal-content modern-modal",on:{click:function(e){e.stopPropagation()}}},[o("div",{staticClass:"modal-header modern-header"},[e._m(2),e._m(3),o("button",{staticClass:"close-button modern-close",on:{click:function(o){e.showModal=!1}}},[o("i",{staticClass:"fas fa-times"},[e._v("‚úï")])])]),o("div",{staticClass:"modal-body modern-body"},[o("div",{staticClass:"add-proveedor-section"},[e._m(4),o("form",{staticClass:"modern-form",on:{submit:function(o){return o.preventDefault(),e.addProveedor.apply(null,arguments)}}},[o("div",{staticClass:"form-grid"},[o("div",{staticClass:"form-group modern-group"},[e._m(5),o("input",{directives:[{name:"model",rawName:"v-model",value:e.newProveedor.nombre,expression:"newProveedor.nombre"}],staticClass:"modern-input",attrs:{id:"nombre",required:"",placeholder:"Ingrese el nombre del proveedor"},domProps:{value:e.newProveedor.nombre},on:{input:function(o){o.target.composing||e.$set(e.newProveedor,"nombre",o.target.value)}}})]),o("div",{staticClass:"form-group modern-group"},[e._m(6),o("input",{directives:[{name:"model",rawName:"v-model",value:e.newProveedor.telefono,expression:"newProveedor.telefono"}],staticClass:"modern-input",attrs:{id:"telefono",placeholder:"Ingrese el tel√©fono"},domProps:{value:e.newProveedor.telefono},on:{input:function(o){o.target.composing||e.$set(e.newProveedor,"telefono",o.target.value)}}})]),o("div",{staticClass:"form-group modern-group"},[e._m(7),o("input",{directives:[{name:"model",rawName:"v-model",value:e.newProveedor.tipo,expression:"newProveedor.tipo"}],staticClass:"modern-input",attrs:{id:"tipo",placeholder:"Ej: Combustible, Refacciones, etc."},domProps:{value:e.newProveedor.tipo},on:{input:function(o){o.target.composing||e.$set(e.newProveedor,"tipo",o.target.value)}}})])]),o("div",{staticClass:"color-selection"},[e._m(8),o("div",{staticClass:"color-options"},e._l(e.availableColors,(function(a){return o("button",{key:a,class:["color-option",{selected:e.newProveedor.color===a}],style:{backgroundColor:a},attrs:{type:"button"},on:{click:function(o){e.newProveedor.color=a}}},[e.newProveedor.color===a?o("span",{staticClass:"checkmark"},[e._v("‚úì")]):e._e()])})),0)]),e._m(9)])]),o("div",{staticClass:"proveedores-list"},[e._m(10),o("div",{staticClass:"proveedores-grid"},e._l(e.proveedores,(function(a){return o("div",{key:a.id,staticClass:"proveedor-card modern-card"},[o("div",{staticClass:"proveedor-header"},[o("div",{staticClass:"color-indicator",style:{backgroundColor:a.color||"#6c757d"}}),o("div",{staticClass:"proveedor-info"},[o("h4",[e._v(e._s(a.nombre))]),a.telefono?o("p",{staticClass:"telefono"},[o("i",{staticClass:"info-icon"},[e._v("üìû")]),e._v(" "+e._s(a.telefono)+" ")]):e._e(),a.tipo?o("p",{staticClass:"tipo"},[o("i",{staticClass:"info-icon"},[e._v("üè∑Ô∏è")]),e._v(" "+e._s(a.tipo)+" ")]):e._e()])]),o("button",{staticClass:"delete-button modern-delete",attrs:{title:"Eliminar "+a.nombre},on:{click:function(o){return e.deleteProveedor(a.id)}}},[o("i",{staticClass:"delete-icon"},[e._v("üóëÔ∏è")])])])})),0)])])])]):e._e(),e.showModalAbonoGeneral?o("div",{staticClass:"modal-overlay",on:{click:e.closeModalOnOverlay}},[o("div",{staticClass:"modal-content modern-modal",on:{click:function(e){e.stopPropagation()}}},[o("div",{staticClass:"modal-header modern-header"},[e._m(11),o("div",{staticClass:"header-text"},[o("h2",[e._v("Abono General - "+e._s(e.nombreBarco))]),o("p",[e._v("Registra un abono general para el barco")])]),o("button",{staticClass:"close-button modern-close",on:{click:function(o){e.showModalAbonoGeneral=!1}}},[o("i",{staticClass:"fas fa-times"},[e._v("‚úï")])])]),o("div",{staticClass:"modal-body modern-body"},[o("form",{staticClass:"modern-form",on:{submit:function(o){return o.preventDefault(),e.guardarAbonoGeneral.apply(null,arguments)}}},[o("div",{staticClass:"form-group modern-group"},[e._m(12),o("select",{directives:[{name:"model",rawName:"v-model",value:e.abonoGeneral.proveedorId,expression:"abonoGeneral.proveedorId"}],staticClass:"modern-input",attrs:{id:"proveedor-abono",required:""},on:{change:function(o){var a=Array.prototype.filter.call(o.target.options,(function(e){return e.selected})).map((function(e){var o="_value"in e?e._value:e.value;return o}));e.$set(e.abonoGeneral,"proveedorId",o.target.multiple?a:a[0])}}},[o("option",{attrs:{value:"",disabled:""}},[e._v("Seleccione un proveedor")]),e._l(e.proveedores,(function(a){return o("option",{key:a.id,domProps:{value:a.id}},[e._v(" "+e._s(a.nombre)+" "+e._s(a.tipo?"- "+a.tipo:"")+" ")])}))],2)]),o("div",{staticClass:"form-group modern-group"},[e._m(13),o("input",{directives:[{name:"model",rawName:"v-model",value:e.abonoGeneral.descripcion,expression:"abonoGeneral.descripcion"}],staticClass:"modern-input",attrs:{id:"descripcion-abono",required:"",placeholder:"Descripci√≥n del abono"},domProps:{value:e.abonoGeneral.descripcion},on:{input:function(o){o.target.composing||e.$set(e.abonoGeneral,"descripcion",o.target.value)}}})]),o("div",{staticClass:"form-group modern-group"},[e._m(14),o("input",{directives:[{name:"model",rawName:"v-model.number",value:e.abonoGeneral.monto,expression:"abonoGeneral.monto",modifiers:{number:!0}}],staticClass:"modern-input",attrs:{id:"monto-abono",type:"number",step:"0.01",required:"",placeholder:"0.00"},domProps:{value:e.abonoGeneral.monto},on:{input:function(o){o.target.composing||e.$set(e.abonoGeneral,"monto",e._n(o.target.value))},blur:function(o){return e.$forceUpdate()}}})]),o("div",{staticClass:"form-group modern-group"},[e._m(15),o("input",{directives:[{name:"model",rawName:"v-model",value:e.abonoGeneral.fecha,expression:"abonoGeneral.fecha"}],staticClass:"modern-input",attrs:{id:"fecha-abono",type:"date",required:""},domProps:{value:e.abonoGeneral.fecha},on:{input:function(o){o.target.composing||e.$set(e.abonoGeneral,"fecha",o.target.value)}}})]),o("button",{staticClass:"submit-button modern-submit",attrs:{type:"submit",disabled:e.guardandoAbono}},[o("i",{staticClass:"btn-icon"},[e._v("üíæ")]),e._v(" "+e._s(e.guardandoAbono?"Guardando...":"Guardar Abono")+" ")])])])])]):e._e()])},s=[function(){var e=this,o=e._self._c;return o("div",{staticClass:"header-section"},[o("div",{staticClass:"header-content"},[o("h1",{staticClass:"main-title"},[o("i",{staticClass:"icon-boat"},[e._v("‚õµ")]),e._v(" Gesti√≥n de Barcos ")]),o("p",{staticClass:"subtitle"},[e._v("Administra las deudas y gastos de El Galileo y Mar√≠a Guadalupe")])])])},function(){var e=this,o=e._self._c;return o("h3",{staticClass:"section-title"},[o("i",{staticClass:"icon-anchor"},[e._v("‚öì")]),e._v(" Seleccionar Barco ")])},function(){var e=this,o=e._self._c;return o("div",{staticClass:"header-icon"},[o("i",{staticClass:"icon-config"},[e._v("‚öôÔ∏è")])])},function(){var e=this,o=e._self._c;return o("div",{staticClass:"header-text"},[o("h2",[e._v("Gestionar Proveedores de Barcos")]),o("p",[e._v("Administra los proveedores para los barcos")])])},function(){var e=this,o=e._self._c;return o("div",{staticClass:"section-header"},[o("i",{staticClass:"section-icon"},[e._v("‚ûï")]),o("h3",[e._v("Agregar Nuevo Proveedor")])])},function(){var e=this,o=e._self._c;return o("label",{staticClass:"modern-label",attrs:{for:"nombre"}},[o("i",{staticClass:"label-icon"},[e._v("üë§")]),e._v(" Nombre del Proveedor ")])},function(){var e=this,o=e._self._c;return o("label",{staticClass:"modern-label",attrs:{for:"telefono"}},[o("i",{staticClass:"label-icon"},[e._v("üìû")]),e._v(" Tel√©fono (opcional) ")])},function(){var e=this,o=e._self._c;return o("label",{staticClass:"modern-label",attrs:{for:"tipo"}},[o("i",{staticClass:"label-icon"},[e._v("üè∑Ô∏è")]),e._v(" Tipo de Servicio ")])},function(){var e=this,o=e._self._c;return o("label",{staticClass:"modern-label"},[o("i",{staticClass:"label-icon"},[e._v("üé®")]),e._v(" Color de Identificaci√≥n ")])},function(){var e=this,o=e._self._c;return o("button",{staticClass:"submit-button modern-submit",attrs:{type:"submit"}},[o("i",{staticClass:"btn-icon"},[e._v("‚ûï")]),e._v(" Agregar Proveedor ")])},function(){var e=this,o=e._self._c;return o("div",{staticClass:"section-header"},[o("i",{staticClass:"section-icon"},[e._v("üìã")]),o("h3",[e._v("Proveedores Registrados")])])},function(){var e=this,o=e._self._c;return o("div",{staticClass:"header-icon"},[o("i",{staticClass:"icon-money"},[e._v("üíµ")])])},function(){var e=this,o=e._self._c;return o("label",{staticClass:"modern-label",attrs:{for:"proveedor-abono"}},[o("i",{staticClass:"label-icon"},[e._v("üè≠")]),e._v(" Proveedor ")])},function(){var e=this,o=e._self._c;return o("label",{staticClass:"modern-label",attrs:{for:"descripcion-abono"}},[o("i",{staticClass:"label-icon"},[e._v("üìù")]),e._v(" Descripci√≥n ")])},function(){var e=this,o=e._self._c;return o("label",{staticClass:"modern-label",attrs:{for:"monto-abono"}},[o("i",{staticClass:"label-icon"},[e._v("üí∞")]),e._v(" Monto ")])},function(){var e=this,o=e._self._c;return o("label",{staticClass:"modern-label",attrs:{for:"fecha-abono"}},[o("i",{staticClass:"label-icon"},[e._v("üìÖ")]),e._v(" Fecha ")])}],r=a("dc59"),i=a("1494"),n=a("74c9"),c={name:"BarcosMenu",components:{BackButton:n["a"]},data(){return{barcoSeleccionado:localStorage.getItem("barcoSeleccionado")||"",showModal:!1,showModalAbonoGeneral:!1,proveedores:[],newProveedor:{nombre:"",telefono:"",tipo:"",color:"#6c757d"},abonoGeneral:{proveedorId:"",descripcion:"",monto:null,fecha:(new Date).toISOString().split("T")[0]},guardandoAbono:!1,availableColors:["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FECA57","#FF9FF3","#54A0FF","#48DBFB","#F368E0","#FD79A8","#A29BFE","#6C5CE7","#00B894","#FDCB6E","#E17055","#FA8072","#DDA0DD","#98D8C8","#F7DC6F","#85C1E2"]}},computed:{nombreBarco(){return"galileo"===this.barcoSeleccionado?"El Galileo":"Mar√≠a Guadalupe"}},mounted(){this.loadProveedores()},methods:{seleccionarBarco(e){this.barcoSeleccionado=e,localStorage.setItem("barcoSeleccionado",e)},openProveedoresModal(){this.showModal=!0,this.loadProveedores()},closeModalOnOverlay(e){e.target.classList.contains("modal-overlay")&&(this.showModal=!1,this.showModalAbonoGeneral=!1)},openAbonoGeneralModal(){this.abonoGeneral={proveedorId:"",descripcion:"",monto:null,fecha:(new Date).toISOString().split("T")[0]},this.showModalAbonoGeneral=!0,this.loadProveedores()},async guardarAbonoGeneral(){if(this.guardandoAbono)return;if(!this.abonoGeneral.proveedorId)return void alert("Por favor seleccione un proveedor");if(!this.abonoGeneral.descripcion.trim())return void alert("Por favor ingrese una descripci√≥n");const e=parseFloat(this.abonoGeneral.monto)||0;if(e<=0)alert("Por favor ingrese un monto v√°lido mayor a 0");else if(this.abonoGeneral.fecha){this.guardandoAbono=!0;try{const o=this.proveedores.find(e=>e.id===this.abonoGeneral.proveedorId);await Object(i["b"])(Object(i["c"])(r["a"],"abonosBarcos"),{deudaId:null,barco:this.barcoSeleccionado,nombreBarco:this.nombreBarco,proveedorId:this.abonoGeneral.proveedorId,nombreProveedor:(null===o||void 0===o?void 0:o.nombre)||"Proveedor desconocido",monto:parseFloat(e.toFixed(2)),descripcion:this.abonoGeneral.descripcion.trim(),fecha:this.abonoGeneral.fecha,tipo:"general",createdAt:new Date}),this.showModalAbonoGeneral=!1,alert("Abono general registrado exitosamente"),this.abonoGeneral={proveedorId:"",descripcion:"",monto:null,fecha:(new Date).toISOString().split("T")[0]}}catch(o){console.error("Error al guardar abono general:",o),alert("Error al guardar el abono general: "+o.message)}finally{this.guardandoAbono=!1}}else alert("Por favor seleccione una fecha")},async loadProveedores(){try{const e=Object(i["o"])(Object(i["c"])(r["a"],"proveedoresBarcos"),Object(i["l"])("nombre")),o=await Object(i["g"])(e);this.proveedores=o.docs.map(e=>({id:e.id,...e.data()}))}catch(e){console.error("Error al cargar proveedores:",e),alert("Error al cargar proveedores")}},async addProveedor(){if(this.newProveedor.nombre.trim())try{await Object(i["b"])(Object(i["c"])(r["a"],"proveedoresBarcos"),{nombre:this.newProveedor.nombre.trim(),telefono:this.newProveedor.telefono.trim(),tipo:this.newProveedor.tipo.trim(),color:this.newProveedor.color,createdAt:new Date}),this.newProveedor={nombre:"",telefono:"",tipo:"",color:"#6c757d"},await this.loadProveedores(),alert("Proveedor agregado exitosamente")}catch(e){console.error("Error al agregar proveedor:",e),alert("Error al agregar proveedor")}else alert("Por favor ingrese el nombre del proveedor")},async deleteProveedor(e){if(confirm("¬øEst√° seguro de eliminar este proveedor?"))try{await Object(i["d"])(Object(i["e"])(r["a"],"proveedoresBarcos",e)),await this.loadProveedores(),alert("Proveedor eliminado exitosamente")}catch(o){console.error("Error al eliminar proveedor:",o),alert("Error al eliminar proveedor")}}}},l=c,d=(a("db97"),a("2877")),u=Object(d["a"])(l,t,s,!1,null,"3c200800",null);o["a"]=u.exports},facf:function(e,o,a){}}]);