(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app.3a037446"],{"0042":function(e,t,a){"use strict";var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pedidos-container"},[t("h2",[e._v("Pedidos de Camarón")]),t("div",{staticClass:"tipo-pedido-selector"},[t("button",{class:["btn-tipo",{active:"crudo"===e.tipoPedido}],on:{click:function(t){e.tipoPedido="crudo"}}},[e._v(" Camarón Crudo ")]),t("button",{class:["btn-tipo",{active:"limpio"===e.tipoPedido}],on:{click:function(t){e.tipoPedido="limpio"}}},[e._v(" Camarón Limpio ")])]),"crudo"===e.tipoPedido?t("PedidosCrudo"):t("PedidosLimpio")],1)},i=[],s=a("cc985"),r=a("d918"),l={name:"Pedidos",components:{PedidosCrudo:s["a"],PedidosLimpio:r["a"]},data(){return{tipoPedido:"crudo"}}},n=l,d=(a("d248"),a("2877")),c=Object(d["a"])(n,o,i,!1,null,"6395483f",null);c.exports},"1e3c":function(e,t,a){"use strict";a("3502")},"2f5c":function(e,t,a){"use strict";a("b1dc")},3420:function(e,t,a){"use strict";a("14d9");var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"impresion-container"},[t("h2",[e._v("Vista previa de impresión - Pedido de Camarón Crudo")]),t("div",{staticClass:"buttons-container"},[t("button",{staticClass:"btn-generar",on:{click:e.generarPDF}},[t("span",{staticClass:"icon"},[e._v("📄")]),e._v(" Generar PDF ")]),t("button",{staticClass:"btn-volver",on:{click:function(t){return e.$router.push("/procesos/pedidos")}}},[e._v(" Volver ")])]),t("div",{staticClass:"pdf-preview",attrs:{id:"pdfPreview"}},[t("h3",[e._v("Pedido de Crudos - "+e._s(e.fecha))]),t("table",{staticClass:"preview-table"},[t("thead",[t("tr",[t("th",[e._v("Cliente")]),e._l(e.obtenerColumnasConDatos(),(function(a){return t("th",{key:a},[e._v(" "+e._s(a)+" ")])}))],2)]),t("tbody",[e._l(e.obtenerClientesConDatos(),(function(a){return t("tr",{key:a},[t("td",{style:{backgroundColor:e.obtenerColorCliente(a),color:e.obtenerColorTextoCliente(a)}},[e._v(" "+e._s(a)+" ")]),e._l(e.obtenerColumnasConDatos(),(function(o){return t("td",{key:o},[e._v(" "+e._s(e.pedidos[a][o.toLowerCase()]||"")+" ")])}))],2)})),t("tr",{staticClass:"fila-totales"},[e._m(0),e._l(e.obtenerColumnasConDatos(),(function(a){return t("td",{key:a+"-total"},[e._v(" "+e._s(e.calcularTotalColumna(a))+" ")])}))],2)],2)])])])},i=[function(){var e=this,t=e._self._c;return t("td",[t("strong",[e._v("Total")])])}],s=(a("13d5"),a("e499")),r=a.n(s);const l={Roboto:{normal:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Regular.ttf",bold:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Medium.ttf",italics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Italic.ttf",bolditalics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-MediumItalic.ttf"}};r.a.fonts=l;var n={name:"PedidoCrudosImpresion",props:{fecha:{type:String,required:!0},pedidos:{type:Object,required:!0},columnas:{type:Array,required:!0}},methods:{obtenerClientesConDatos(){return Object.keys(this.pedidos).filter(e=>Object.values(this.pedidos[e]).some(e=>null!==e&&""!==e))},obtenerColumnasConDatos(){return this.columnas.filter(e=>{const t=e.toLowerCase();return this.obtenerClientesConDatos().some(e=>null!==this.pedidos[e][t]&&""!==this.pedidos[e][t])})},obtenerColorCliente(e){const t={"8a":"#3498db",catarro:"#e74c3c",otilio:"#f1c40f",ozuna:"#2ecc71",elizabeth:"#9b59b6"};return t[e.toLowerCase()]||"#000000"},obtenerColorTextoCliente(e){return"otilio"===e.toLowerCase()?"#000000":"#FFFFFF"},obtenerDiaSemana(e){const t=["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],[a,o,i]=e.split("-").map(Number),s=new Date(a,o-1,i);return t[s.getDay()]},calcularTotalColumna(e){const t=e.toLowerCase();return Object.keys(this.pedidos).reduce((e,a)=>{const o=parseFloat(this.pedidos[a][t])||0;return e+o},0)},generarPDF(){const e=this.obtenerClientesConDatos(),t=this.obtenerColumnasConDatos(),a=this.obtenerDiaSemana(this.fecha),o=e.map(e=>{const a=[e];return t.forEach(t=>{const o=this.pedidos[e][t.toLowerCase()]||"";a.push({text:o.toString(),alignment:"center"})}),a}),i=["Cliente",...t].map(e=>({text:e,alignment:"center"})),s=i.length>5?"100%":"auto",l=i.length>5?28:34,n={};e.forEach((e,t)=>{n[t]={fillColor:this.obtenerColorCliente(e),color:this.obtenerColorTextoCliente(e),bold:!0}});const d=t.map(e=>{const t=this.calcularTotalColumna(e);return{text:t.toString(),alignment:"center",bold:!0,italics:!0,fillColor:"#f8f9fa"}});o.push([{text:"Total",bold:!0,fillColor:"#f8f9fa"},...d]);const c={pageOrientation:"landscape",pageMargins:[40,40,40,40],content:[{text:`Pedido de Crudos - ${a} ${this.fecha}`,style:"header"},{table:{headerRows:1,widths:Array(i.length).fill("*"),body:[i,...o]},layout:{fillColor:function(e,t,a){var o;return 0===e?"#f2f2f2":0===a?null===(o=n[e-1])||void 0===o?void 0:o.fillColor:null},defaultBorder:!0,hLineWidth:function(e,t){return e===t.table.body.length-1||e===t.table.body.length?2:1},vLineWidth:function(e,t){return t.table.body.length-1===t.row?2:1},hLineColor:function(e){return"#000000"},vLineColor:function(e){return"#000000"},paddingLeft:function(e){return 10},paddingRight:function(e){return 10},paddingTop:function(e){return 10},paddingBottom:function(e){return 10}},width:s}],styles:{header:{fontSize:34,bold:!0,margin:[0,0,0,20],alignment:"center"}},defaultStyle:{fontSize:l,bold:!0,font:"Roboto"}};r.a.createPdf(c).download("Ped-crudos-"+this.fecha+".pdf")}}},d=n,c=(a("1e3c"),a("2877")),u=Object(c["a"])(d,o,i,!1,null,"51c4c999",null);t["a"]=u.exports},3502:function(e,t,a){},4437:function(e,t,a){},"680c":function(e,t,a){"use strict";a("4437")},7292:function(e,t,a){"use strict";a("a94c")},"91a4":function(e,t,a){},"92c9":function(e,t,a){"use strict";a("14d9");var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"impresion-container"},[t("h2",[e._v("Vista previa de impresión - Pedido de Camarón Limpio")]),t("div",{staticClass:"scale-control"},[t("label",[e._v("Escala del contenido:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.contentScale,expression:"contentScale"}],staticClass:"scale-slider",attrs:{type:"range",min:"0.5",max:"2",step:"0.1"},domProps:{value:e.contentScale},on:{__r:function(t){e.contentScale=t.target.value}}}),t("span",{staticClass:"scale-value"},[e._v(e._s((100*e.contentScale).toFixed(0))+"%")])]),t("div",{staticClass:"buttons-container"},[t("button",{staticClass:"btn-generar",on:{click:e.generarPDF}},[t("span",{staticClass:"icon"},[e._v("📄")]),e._v(" Generar PDF ")]),t("button",{staticClass:"btn-menu",on:{click:function(t){return e.$router.push("/procesos/pedidos")}}},[e._v(" Menú ")]),t("button",{staticClass:"btn-volver",on:{click:e.volverAEditar}},[e._v(" Editar Pedido ")])]),t("div",{staticClass:"pdf-preview",attrs:{id:"pdfPreview"}},[t("div",{staticClass:"preview-page"},[t("h3",{staticClass:"cliente-header otilio-header"},[e._v("Otilio")]),t("table",{staticClass:"preview-table"},[e._m(0),t("tbody",e._l(e.pedidoOtilio,(function(a,o){return t("tr",{key:"otilio-"+o},[t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:a.completado,expression:"item.completado"}],staticClass:"pedido-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.completado)?e._i(a.completado,null)>-1:a.completado},on:{change:[function(t){var o=a.completado,i=t.target,s=!!i.checked;if(Array.isArray(o)){var r=null,l=e._i(o,r);i.checked?l<0&&e.$set(a,"completado",o.concat([r])):l>-1&&e.$set(a,"completado",o.slice(0,l).concat(o.slice(l+1)))}else e.$set(a,"completado",s)},function(t){return e.actualizarCompletado("otilio",o,a.completado)}]}})]),t("td",[e._v(e._s(a.kilos)),a.esTara?t("i",[e._v("T")]):e._e()]),t("td",[e._v(" "+e._s(a.medida)+" "),a.proveedor?t("span",{staticClass:"proveedor-tag"},[e._v(e._s(a.proveedor))]):e._e()]),t("td",{class:{"text-blue":"C/H20"===a.tipo,"text-blue compact":"1.35 y .15"===a.tipo}},[e._v(" "+e._s(a.tipo)+" "),a.nota?t("span",{staticClass:"nota-tag"},[e._v(e._s(a.nota))]):e._e()])])})),0)])]),t("div",{staticClass:"preview-page"},[t("div",{staticClass:"cliente-seccion",class:{compacto:e.pedidoJoselito.length>=5}},[t("h4",{staticClass:"cliente-header joselito-header",class:{compacto:e.pedidoJoselito.length>=5}},[e._v("Joselito")]),t("table",{staticClass:"preview-table",class:{compacto:e.pedidoJoselito.length>=5}},[e._m(1),t("tbody",e._l(e.pedidoJoselito,(function(a,o){return t("tr",{key:"joselito-"+o},[t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:a.completado,expression:"item.completado"}],staticClass:"pedido-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.completado)?e._i(a.completado,null)>-1:a.completado},on:{change:[function(t){var o=a.completado,i=t.target,s=!!i.checked;if(Array.isArray(o)){var r=null,l=e._i(o,r);i.checked?l<0&&e.$set(a,"completado",o.concat([r])):l>-1&&e.$set(a,"completado",o.slice(0,l).concat(o.slice(l+1)))}else e.$set(a,"completado",s)},function(t){return e.actualizarCompletado("joselito",o,a.completado)}]}})]),t("td",[e._v(e._s(a.kilos)),a.esTara?t("i",[e._v("T")]):e._e()]),t("td",[e._v(" "+e._s(a.medida)+" "),a.proveedor?t("span",{staticClass:"proveedor-tag"},[e._v(e._s(a.proveedor))]):e._e()]),t("td",{class:{"text-blue":"C/H20"===a.tipo,"text-blue compact":"1.35 y .15"===a.tipo}},[e._v(" "+e._s(a.tipo)+" "),a.nota?t("span",{staticClass:"nota-tag"},[e._v(e._s(a.nota))]):e._e()])])})),0)])]),t("div",{staticClass:"bottom-section"},[t("div",{staticClass:"bottom-cliente"},[t("h4",{staticClass:"cliente-header catarro-header"},[e._v("Catarro")]),t("table",{staticClass:"preview-table"},[e._m(2),t("tbody",e._l(e.pedidoCatarro,(function(a,o){return t("tr",{key:"catarro-"+o},[t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:a.completado,expression:"item.completado"}],staticClass:"pedido-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.completado)?e._i(a.completado,null)>-1:a.completado},on:{change:[function(t){var o=a.completado,i=t.target,s=!!i.checked;if(Array.isArray(o)){var r=null,l=e._i(o,r);i.checked?l<0&&e.$set(a,"completado",o.concat([r])):l>-1&&e.$set(a,"completado",o.slice(0,l).concat(o.slice(l+1)))}else e.$set(a,"completado",s)},function(t){return e.actualizarCompletado("catarro",o,a.completado)}]}})]),t("td",[e._v(e._s(a.kilos)),a.esTara?t("i",[e._v("T")]):e._e()]),t("td",[e._v(" "+e._s(a.medida)+" "),a.proveedor?t("span",{staticClass:"proveedor-tag"},[e._v(e._s(a.proveedor))]):e._e()])])})),0)])]),t("div",{staticClass:"bottom-cliente"},[t("h4",{staticClass:"cliente-header ozuna-header"},[e._v("Ozuna")]),t("table",{staticClass:"preview-table"},[e._m(3),t("tbody",e._l(e.pedidoOzuna,(function(a,o){return t("tr",{key:"ozuna-"+o},[t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:a.completado,expression:"item.completado"}],staticClass:"pedido-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.completado)?e._i(a.completado,null)>-1:a.completado},on:{change:[function(t){var o=a.completado,i=t.target,s=!!i.checked;if(Array.isArray(o)){var r=null,l=e._i(o,r);i.checked?l<0&&e.$set(a,"completado",o.concat([r])):l>-1&&e.$set(a,"completado",o.slice(0,l).concat(o.slice(l+1)))}else e.$set(a,"completado",s)},function(t){return e.actualizarCompletado("ozuna",o,a.completado)}]}})]),t("td",[e._v(e._s(a.kilos)),a.esTara?t("i",[e._v("T")]):e._e()]),t("td",[e._v(" "+e._s(a.medida)+" "),a.proveedor?t("span",{staticClass:"proveedor-tag"},[e._v(e._s(a.proveedor))]):e._e()])])})),0)])])])]),Object.keys(e.clientesTemporales).length>0?t("div",{staticClass:"preview-page"},e._l(e.clientesTemporales,(function(a,o){return t("div",{key:o,staticClass:"cliente-seccion temporal"},[t("h3",{staticClass:"cliente-header temporal-header"},[e._v(e._s(a.nombre))]),t("table",{staticClass:"preview-table"},[e._m(4,!0),t("tbody",e._l(a.pedidos,(function(a,i){return t("tr",{key:"temp-"+o+"-"+i},[t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:a.completado,expression:"item.completado"}],staticClass:"pedido-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.completado)?e._i(a.completado,null)>-1:a.completado},on:{change:function(t){var o=a.completado,i=t.target,s=!!i.checked;if(Array.isArray(o)){var r=null,l=e._i(o,r);i.checked?l<0&&e.$set(a,"completado",o.concat([r])):l>-1&&e.$set(a,"completado",o.slice(0,l).concat(o.slice(l+1)))}else e.$set(a,"completado",s)}}})]),t("td",[e._v(e._s(a.kilos)),a.esTara?t("i",[e._v("T")]):e._e()]),t("td",[e._v(" "+e._s(a.medida)+" "),a.proveedor?t("span",{staticClass:"proveedor-tag"},[e._v(e._s(a.proveedor))]):e._e()]),t("td",{class:{"text-blue":"C/H20"===a.tipo,"text-blue compact":"1.35 y .15"===a.tipo}},[e._v(" "+e._s(a.tipo)+" "),a.nota?t("span",{staticClass:"nota-tag"},[e._v(e._s(a.nota))]):e._e()])])})),0)])])})),0):e._e(),t("div",{staticClass:"resumen-medidas"},[t("h3",{staticClass:"resumen-header"},[e._v("Resumen por Medida")]),t("table",{staticClass:"resumen-table"},[e._m(5),t("tbody",[e._l(e.calcularTotalesPorMedida(),(function(a,o){return t("tr",{key:o},[t("td",{attrs:{"data-label":"Medida"}},[e._v(e._s(a.medida))]),t("td",{attrs:{"data-label":"Total Kilos"}},[e._v(e._s(a.total)+" kg")]),t("td",{attrs:{"data-label":"Rendimientos"}},[t("div",{staticClass:"rendimientos-column"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.rendimientos[a.medida],expression:"rendimientos[medida.medida]"}],staticClass:"rendimiento-box",attrs:{type:"number",step:"0.01",placeholder:"1.00"},domProps:{value:e.rendimientos[a.medida]},on:{input:[function(t){t.target.composing||e.$set(e.rendimientos,a.medida,t.target.value)},function(t){return e.calcularRendimiento(a)}]}}),e.rendimientos[a.medida]?t("div",{staticClass:"rendimiento-total"},[e._v(" "+e._s(Math.round(a.total*e.rendimientos[a.medida]))+" ")]):e._e()])]),t("td",{attrs:{"data-label":"Masters"}},[e.esMedidaGranja(a.medida)?t("div",{staticClass:"checkbox-group"},[t("label",[t("input",{attrs:{type:"radio",name:"master-"+a.medida},domProps:{checked:20===e.divisores[a.medida]},on:{click:function(t){return e.toggleDivisor(a,20)}}}),e._v(" 20 ")]),t("label",[t("input",{attrs:{type:"radio",name:"master-"+a.medida},domProps:{checked:22===e.divisores[a.medida]},on:{click:function(t){return e.toggleDivisor(a,22)}}}),e._v(" 22 ")])]):e._e()]),t("td",{attrs:{"data-label":"Cajas"}},[e.rendimientos[a.medida]?[e.esMedidaGranja(a.medida)&&e.divisores[a.medida]?t("span",{staticClass:"cajas-result"},[e._v(" "+e._s(Math.round(a.total*e.rendimientos[a.medida]/e.divisores[a.medida]))+" ")]):t("span",{staticClass:"cajas-result"},[e._v(" "+e._s(Math.round(a.total*e.rendimientos[a.medida]))+" kg ")])]:e._e()],2)])})),t("tr",{staticClass:"total-row"},[t("td",[e._v("Total:")]),t("td",[e._v(e._s(e.calcularTotalKilos())+" kg")]),t("td"),t("td"),t("td")])],2)])])])])},i=[function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("✓")]),t("th",[e._v("Kilos/Taras")]),t("th",[e._v("Medida")]),t("th",[e._v("Tipo")])])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("✓")]),t("th",[e._v("Kilos/Taras")]),t("th",[e._v("Medida")]),t("th",[e._v("Tipo")])])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("✓")]),t("th",[e._v("Kilos/Taras")]),t("th",[e._v("Medida")])])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("✓")]),t("th",[e._v("Kilos/Taras")]),t("th",[e._v("Medida")])])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("✓")]),t("th",[e._v("Kilos/Taras")]),t("th",[e._v("Medida")]),t("th",[e._v("Tipo")])])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("Medida")]),t("th",[e._v("Total Kilos")]),t("th",[e._v("Rendimientos")]),t("th",[e._v("Masters")]),t("th",[e._v("Cajas")])])])}],s=(a("13d5"),a("e499")),r=a.n(s);const l={Roboto:{normal:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Regular.ttf",bold:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Medium.ttf",italics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Italic.ttf",bolditalics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-MediumItalic.ttf"}};r.a.fonts=l;var n={name:"PedidoLimpioImpresion",props:{fecha:{type:String,required:!0},id:{type:String,default:""},pedidoOtilio:{type:Array,required:!0},pedidoCatarro:{type:Array,required:!0},pedidoJoselito:{type:Array,required:!0},pedidoOzuna:{type:Array,required:!0},clientesTemporales:{type:Object,default:()=>({})},rendimientosGuardados:{type:Object,default:()=>({})},divisoresGuardados:{type:Object,default:()=>({})},completadosGuardados:{type:Object,default:()=>({})}},data(){return{rendimientos:this.rendimientosGuardados||{},divisores:this.divisoresGuardados||{},contentScale:1,completados:this.completadosGuardados||{}}},created(){this.completados.otilio||(this.completados.otilio={}),this.completados.catarro||(this.completados.catarro={}),this.completados.joselito||(this.completados.joselito={}),this.completados.ozuna||(this.completados.ozuna={}),this.rendimientos={...this.rendimientosGuardados},this.divisores={...this.divisoresGuardados},this.completados={...this.completadosGuardados},this.aplicarEstadosCompletado()},methods:{volverAEditar(){this.id?this.$router.push({path:"/procesos/pedidos/limpio",query:{edit:"true",id:this.id,fecha:this.fecha}}):this.$router.push("/procesos/pedidos")},aplicarEstadosCompletado(){this.pedidoOtilio.forEach((e,t)=>{void 0!==this.completados.otilio[t]&&this.$set(e,"completado",this.completados.otilio[t])}),this.pedidoCatarro.forEach((e,t)=>{void 0!==this.completados.catarro[t]&&this.$set(e,"completado",this.completados.catarro[t])}),this.pedidoJoselito.forEach((e,t)=>{void 0!==this.completados.joselito[t]&&this.$set(e,"completado",this.completados.joselito[t])}),this.pedidoOzuna.forEach((e,t)=>{void 0!==this.completados.ozuna[t]&&this.$set(e,"completado",this.completados.ozuna[t])})},actualizarCompletado(e,t,a){this.completados[e]||this.$set(this.completados,e,{}),this.$set(this.completados[e],t,a),this.$emit("actualizar-completados",this.completados)},obtenerDiaSemana(e){const t=["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],a=new Date(e);return t[a.getDay()]},generarTablaCliente(e,t=16){if(!e||0===e.length)return null;const a=e.length>7,o=a?2:16,i=e.map(e=>[{text:e.kilos?e.esTara?[{text:e.kilos.toString(),fontSize:2*t},{text:"T",fontSize:1.2*t,italics:!0,alignment:"right",margin:[0,-8,0,0]}]:{text:e.kilos.toString(),fontSize:2*t}:"",alignment:"center",margin:[0,-2,0,-2]},{stack:[{text:e.medida||"",fontSize:2*t},e.proveedor?{text:e.proveedor,fontSize:1.1*t,color:"#FFFFFF",background:"#FF0000",margin:[0,2,0,0],padding:[2,1],alignment:"center"}:""],margin:[0,2,0,2]},{stack:[{text:[{text:e.tipo||"",fontSize:2*t,color:"C/H20"===e.tipo||"1.35 y .15"===e.tipo?"#0000FF":void 0,margin:"1.35 y .15"===e.tipo?[0,0,0,0]:[0,2,0,2]}]},e.nota?{text:e.nota,fontSize:1.1*t,margin:[0,1,0,0],padding:[1,1],bold:!0,background:"#FF0000",color:"#FFFFFF"}:""],margin:[0,2,0,2]}]);return{table:{widths:["30%","35%","35%"],body:i},layout:{hLineWidth:()=>0,vLineWidth:()=>0,paddingLeft:()=>8,paddingRight:()=>8,paddingTop:()=>o,paddingBottom:()=>o}}},generarPDF(){this.obtenerDiaSemana(this.fecha);const e=this.pedidoJoselito.length>=5,t=e?.5:30,a=e?22:26,o=e?24:36,i=this.contentScale,s={otilio:48*i,joselito:(e?24:48)*i,inferior:o*i,tabla:26*i,tablaJoselito:a*i},l={pageSize:"letter",pageOrientation:"portrait",pageMargins:[10,10,10,10],content:[{columns:[{text:"OTILIO",style:"clienteHeader",fontSize:s.otilio,width:"*",alignment:"left",background:"#FFEB3B"},{text:this.fecha,fontSize:.75*s.otilio,italics:!0,width:"auto",alignment:"right"}],margin:[0,0,0,10*i]},this.generarTablaCliente(this.pedidoOtilio,s.tabla),{text:"",pageBreak:"after"},{text:"JOSELITO",style:"clienteHeader",fontSize:s.joselito,margin:[0,0,0,e?.5:0],background:"#2196F3"},this.generarTablaCliente(this.pedidoJoselito,s.tablaJoselito),{text:"",margin:[0,t,0,0]},{canvas:[{type:"line",x1:0,y1:0,x2:592,y2:0,lineWidth:e?.3:2}]},{text:"",margin:[0,t,0,0]},{columns:[{stack:[{text:"CATARRO",style:"clienteHeader",fontSize:s.inferior,margin:[0,0,0,e?1:0],background:"#FF5252"},this.generarTablaClienteReducido(this.pedidoCatarro,s.tablaJoselito)],width:"47%"},{stack:[{canvas:[{type:"line",x1:10,y1:0,x2:10,y2:e?30:150,lineWidth:e?.3:1.5}]}],width:"6%",margin:[0,e?2:20,0,0]},{stack:[{text:"OZUNA",style:"clienteHeader",fontSize:s.inferior,margin:[0,0,0,e?1:0],background:"#4CAF50"},this.generarTablaClienteReducido(this.pedidoOzuna,s.tablaJoselito)],width:"47%"}]},{text:"",pageBreak:"after"},...Object.keys(this.clientesTemporales).length>0?[...Object.entries(this.clientesTemporales).map(([e,t])=>[{text:t.nombre.toUpperCase(),style:"clienteHeader",fontSize:36,margin:[0,0,0,10],background:"#95a5a6"},this.generarTablaCliente(t.pedidos,22),{text:"",margin:[0,20,0,20]}]).flat()]:[]],styles:{header:{alignment:"center",margin:[0,0,0,20],bold:!0},clienteHeader:{bold:!0,alignment:"center"},tableHeader:{bold:!0,fontSize:14,color:"black",alignment:"center"}},defaultStyle:{font:"Roboto"}};r.a.createPdf(l).download("Ped-limpio-"+this.fecha+".pdf")},generarTablaClienteReducido(e,t=16){if(!e||0===e.length)return null;const a=e.map(e=>[{text:e.kilos?e.esTara?[{text:e.kilos.toString(),fontSize:2*t},{text:"T",fontSize:1.2*t,italics:!0,alignment:"right",margin:[0,-8,0,0]}]:{text:e.kilos.toString(),fontSize:2*t}:"",alignment:"center",margin:[0,-2,0,-2]},{stack:[{text:e.medida||"",fontSize:2*t},e.proveedor?{text:e.proveedor,fontSize:1.1*t,color:"#FFFFFF",background:"#FF0000",padding:[2,1],alignment:"center"}:"",e.nota?{text:e.nota,fontSize:.9*t,padding:[1,0],bold:!0,background:"#FF0000",color:"#FFFFFF"}:""],margin:[0,1,0,1]}]);return{table:{widths:["45%","55%"],body:a},layout:{hLineWidth:()=>0,vLineWidth:()=>0,paddingLeft:()=>1,paddingRight:()=>1,paddingTop:()=>1,paddingBottom:()=>1}}},obtenerNombreCliente(e){return e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")},calcularTotalesTemporales(e){if(!this.clientesTemporales[e])return{tarasTotal:"0",kilosTotal:"0"};let t=0,a=0,o=0,i=0,s=0;this.clientesTemporales[e].forEach(e=>{e.kilos&&(e.esTara?(t+=Number(e.kilos),"C/H20"===e.tipo?o+=30*Number(e.kilos)*.65:i+=30*Number(e.kilos)):"S/H20"===e.tipo?a+=Number(e.kilos):"C/H20"===e.tipo?o+=Number(e.kilos):".7 y .3"===e.tipo&&(s+=.7*Number(e.kilos)))});const r=a/27,l=Math.round(t+r),n=a+i,d=Math.round(n+o+s);return{tarasTotal:l.toString(),kilosTotal:d.toString()}},calcularTotalesPorMedida(){const e=new Map,t=(t,a=!1)=>{t.forEach(t=>{if(!t.medida)return;const o=t.medida,i=a&&t.esMaquila?o.toLowerCase().trim()+"-maq":o.toLowerCase().trim();e.has(i)||e.set(i,{medida:a&&t.esMaquila?o+" Maq":o,total:0});const s=e.get(i),r=Number(t.kilos)||0;t.esTara?"C/H20"===t.tipo?s.total+=30*r*.65:s.total+=30*r:"C/H20"===t.tipo?s.total+=.65*r:"1.35 y .15"===t.tipo?s.total+=1.35*r:a&&".7 y .3"===t.tipo?s.total+=.7*r:s.total+=r})};return t(this.pedidoOtilio),t(this.pedidoCatarro),t(this.pedidoJoselito),t(this.pedidoOzuna,!0),Object.values(this.clientesTemporales).forEach(e=>{e.pedidos&&Array.isArray(e.pedidos)&&t(e.pedidos)}),Array.from(e.values()).map(e=>({medida:e.medida,total:Math.round(e.total)})).sort((e,t)=>{const a=e.medida.replace(" Maq",""),o=t.medida.replace(" Maq","");return a===o?e.medida.includes("Maq")?1:-1:a.localeCompare(o)})},calcularRendimiento(e){const t=parseFloat(this.rendimientos[e.medida]);isNaN(t)&&(this.rendimientos[e.medida]=""),this.$emit("actualizar-rendimientos",this.rendimientos)},toggleDivisor(e,t){this.divisores[e.medida]===t?this.$set(this.divisores,e.medida,null):this.$set(this.divisores,e.medida,t),this.$emit("actualizar-divisores",this.divisores)},esMedidaGranja(e){return/^\d/.test(e)},calcularTotalKilos(){const e=this.calcularTotalesPorMedida(),t=e.reduce((e,t)=>e+t.total,0);return t.toLocaleString()}},watch:{rendimientosGuardados:{handler(e){this.rendimientos={...e}},deep:!0},divisoresGuardados:{handler(e){this.divisores={...e}},deep:!0},completadosGuardados:{handler(e){this.completados={...e},this.aplicarEstadosCompletado()},deep:!0},pedidoOtilio:{deep:!0,handler(e){e.forEach((e,t)=>{void 0!==e.completado&&this.actualizarCompletado("otilio",t,e.completado)})}},pedidoJoselito:{deep:!0,handler(e){e.forEach((e,t)=>{void 0!==e.completado&&this.actualizarCompletado("joselito",t,e.completado)})}},pedidoCatarro:{deep:!0,handler(e){e.forEach((e,t)=>{void 0!==e.completado&&this.actualizarCompletado("catarro",t,e.completado)})}},pedidoOzuna:{deep:!0,handler(e){e.forEach((e,t)=>{void 0!==e.completado&&this.actualizarCompletado("ozuna",t,e.completado)})}}}},d=n,c=(a("7292"),a("2877")),u=Object(c["a"])(d,o,i,!1,null,"5871d701",null);t["a"]=u.exports},a94c:function(e,t,a){},b1dc:function(e,t,a){},be6e:function(e,t,a){},c5f5:function(e,t,a){"use strict";var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"preparacion-container"},[t("div",{staticClass:"header"},[t("div",{staticClass:"header-left"},[t("h1",[e._v("Preparación")]),t("div",{staticClass:"dias-dropdown"},[t("button",{staticClass:"dropdown-button",on:{click:e.toggleDiasList}},[e._v(" "+e._s(e.diaSeleccionado?e.formatearFecha(e.diaSeleccionado.fecha):"Seleccionar Día")+" "),t("i",{class:["fas",e.diasListOpen?"fa-chevron-up":"fa-chevron-down"]})]),t("transition",{attrs:{name:"slide"}},[e.diasListOpen?t("div",{staticClass:"dias-dropdown-content"},e._l(e.diasOrdenados,(function(a){return t("div",{key:a.id,staticClass:"dia-option",class:{selected:e.diaSeleccionado&&e.diaSeleccionado.id===a.id},on:{click:function(t){return e.seleccionarDia(a)}}},[e._v(" "+e._s(e.formatearFecha(a.fecha))+" ")])})),0):e._e()])],1)]),t("div",{staticClass:"header-actions"},[t("button",{staticClass:"btn-nuevo",on:{click:e.mostrarModalNuevoDia}},[t("i",{staticClass:"fas fa-plus"}),e._v(" Nuevo Día ")]),e.diaSeleccionado?t("button",{staticClass:"btn-eliminar-dia",on:{click:function(t){return e.confirmarBorrarDia(e.diaSeleccionado)}}},[t("i",{staticClass:"fas fa-trash"}),e._v(" Eliminar Día ")]):e._e()])]),e.diaSeleccionado?t("div",{staticClass:"tabla-container"},[t("table",[e._m(0),t("tbody",e._l(e.diaSeleccionado.medidas,(function(a,o){return t("tr",{key:o},[t("td",[t("select",{directives:[{name:"model",rawName:"v-model",value:a.medida,expression:"medida.medida"}],staticClass:"form-control medida-select",on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"medida",t.target.multiple?o:o[0])},function(t){return e.guardarCambios(e.diaSeleccionado)}]}},[t("option",{attrs:{value:""}},[e._v("Seleccionar medida")]),e._l(e.medidasDisponibles,(function(a){return t("option",{key:a,domProps:{value:a}},[e._v(" "+e._s(a)+" ")])}))],2)]),t("td",[t("select",{directives:[{name:"model",rawName:"v-model",value:a.proveedor,expression:"medida.proveedor"}],staticClass:"form-control proveedor-select",on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"proveedor",t.target.multiple?o:o[0])},function(t){return e.guardarCambios(e.diaSeleccionado)}]}},[t("option",{attrs:{value:""}},[e._v("Sin proveedor")]),e._l(e.proveedoresDisponibles,(function(a){return t("option",{key:a,domProps:{value:a}},[e._v(" "+e._s(a)+" ")])}))],2)]),t("td",[t("select",{directives:[{name:"model",rawName:"v-model",value:a.tinas,expression:"medida.tinas"}],staticClass:"form-control",on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"tinas",t.target.multiple?o:o[0])},function(t){return e.guardarCambios(e.diaSeleccionado)}]}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),t("option",{attrs:{value:"Tina"}},[e._v("Tina")]),t("option",{attrs:{value:"Baño"}},[e._v("Baño")])])]),t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:a.cajas,expression:"medida.cajas"}],staticClass:"form-control",attrs:{type:"number",placeholder:""},domProps:{value:a.cajas},on:{change:function(t){return e.guardarCambios(e.diaSeleccionado)},input:function(t){t.target.composing||e.$set(a,"cajas",t.target.value)}}})]),t("td",[t("select",{directives:[{name:"model",rawName:"v-model",value:a.cal,expression:"medida.cal"}],staticClass:"form-control",on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"cal",t.target.multiple?o:o[0])},function(t){return e.guardarCambios(e.diaSeleccionado)}]}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),e._l(e.calDisponible,(function(a){return t("option",{key:a,domProps:{value:a}},[e._v(e._s(a))])}))],2)]),t("td",[t("select",{directives:[{name:"model",rawName:"v-model",value:a.sal,expression:"medida.sal"}],staticClass:"form-control",on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"sal",t.target.multiple?o:o[0])},function(t){return e.guardarCambios(e.diaSeleccionado)}]}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),e._l(e.salDisponible,(function(a){return t("option",{key:a,domProps:{value:a}},[e._v(e._s(a))])}))],2)]),t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:a.porcentaje,expression:"medida.porcentaje"}],staticClass:"form-control porcentaje-input",attrs:{type:"text",placeholder:""},domProps:{value:a.porcentaje},on:{change:function(t){return e.guardarCambios(e.diaSeleccionado)},input:function(t){t.target.composing||e.$set(a,"porcentaje",t.target.value)}}})]),t("td",[e.diaSeleccionado.medidas.length>1?t("button",{staticClass:"btn-delete",on:{click:function(t){return e.eliminarMedidaExistente(e.diaSeleccionado,o)}}},[t("i",{staticClass:"fas fa-trash"})]):e._e()])])})),0)]),t("button",{staticClass:"btn-agregar",on:{click:function(t){return e.agregarMedidaExistente(e.diaSeleccionado)}}},[t("i",{staticClass:"fas fa-plus"}),e._v(" Agregar Medida ")])]):t("div",{staticClass:"no-dia-seleccionado"},[t("p",[e._v("Selecciona un día existente o crea uno nuevo para comenzar.")])]),t("b-modal",{attrs:{title:"Nuevo Día de Preparación",size:"lg"},on:{ok:e.crearNuevoDia,show:e.inicializarNuevoDia},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[t("div",{staticClass:"modal-content"},[t("b-form-group",{attrs:{label:"Fecha:"}},[t("b-form-input",{attrs:{type:"date",required:""},model:{value:e.nuevoDia.fecha,callback:function(t){e.$set(e.nuevoDia,"fecha",t)},expression:"nuevoDia.fecha"}})],1),t("div",{staticClass:"tabla-medidas-container"},[t("table",{staticClass:"tabla-medidas"},[t("thead",[t("tr",[t("th",[e._v("Medida")]),t("th",[e._v("Proveedor")]),t("th",[e._v("Tinas/Baños")]),t("th",[e._v("Cajas")]),t("th",[e._v("Cal")]),t("th",[e._v("Sal")]),t("th",[e._v("%")]),t("th",[e._v("Acciones")])])]),t("tbody",e._l(e.nuevoDia.medidas,(function(a,o){return t("tr",{key:o},[t("td",[t("select",{directives:[{name:"model",rawName:"v-model",value:a.medida,expression:"medida.medida"}],staticClass:"form-control medida-select",attrs:{required:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"medida",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar medida")]),e._l(e.medidasDisponibles,(function(a){return t("option",{key:a,domProps:{value:a}},[e._v(" "+e._s(a)+" ")])}))],2)]),t("td",[t("select",{directives:[{name:"model",rawName:"v-model",value:a.proveedor,expression:"medida.proveedor"}],staticClass:"form-control proveedor-select",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"proveedor",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Sin proveedor")]),e._l(e.proveedoresDisponibles,(function(a){return t("option",{key:a,domProps:{value:a}},[e._v(" "+e._s(a)+" ")])}))],2)]),t("td",[t("select",{directives:[{name:"model",rawName:"v-model",value:a.tinas,expression:"medida.tinas"}],staticClass:"form-control",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"tinas",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),t("option",{attrs:{value:"Tina"}},[e._v("Tina")]),t("option",{attrs:{value:"Baño"}},[e._v("Baño")])])]),t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:a.cajas,expression:"medida.cajas"}],staticClass:"form-control",attrs:{type:"number",placeholder:""},domProps:{value:a.cajas},on:{change:function(t){return e.guardarCambios(e.diaSeleccionado)},input:function(t){t.target.composing||e.$set(a,"cajas",t.target.value)}}})]),t("td",[t("select",{directives:[{name:"model",rawName:"v-model",value:a.cal,expression:"medida.cal"}],staticClass:"form-control",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"cal",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),e._l(e.calDisponible,(function(a){return t("option",{key:a,domProps:{value:a}},[e._v(e._s(a))])}))],2)]),t("td",[t("select",{directives:[{name:"model",rawName:"v-model",value:a.sal,expression:"medida.sal"}],staticClass:"form-control",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"sal",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),e._l(e.salDisponible,(function(a){return t("option",{key:a,domProps:{value:a}},[e._v(e._s(a))])}))],2)]),t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:a.porcentaje,expression:"medida.porcentaje"}],staticClass:"form-control porcentaje-input",attrs:{type:"text",placeholder:""},domProps:{value:a.porcentaje},on:{input:function(t){t.target.composing||e.$set(a,"porcentaje",t.target.value)}}})]),t("td",[e.nuevoDia.medidas.length>1?t("button",{staticClass:"btn-delete",on:{click:function(t){return e.eliminarMedida(o)}}},[t("i",{staticClass:"fas fa-trash"})]):e._e()])])})),0)]),t("button",{staticClass:"btn-agregar",on:{click:e.agregarMedida}},[t("i",{staticClass:"fas fa-plus"}),e._v(" Agregar Medida ")])])],1)])],1)},i=[function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("Medida")]),t("th",[e._v("Proveedor")]),t("th",[e._v("Tinas/Baños")]),t("th",[e._v("Cajas/Kg")]),t("th",[e._v("Cal")]),t("th",[e._v("Sal")]),t("th",[e._v("%")]),t("th",[e._v("Acciones")])])])}],s=(a("14d9"),a("1494")),r={name:"Preparacion",data(){return{dias:[],showModal:!1,nuevoDia:{fecha:"",medidas:[]},diasListOpen:!1,diaSeleccionado:null,medidasDisponibles:["Golfo","Piojo","26/30","36/40","41/50","51/60","61/70","71/90","91/110","21/25","Salmureado"],proveedoresDisponibles:["Ahumada","Selecta","Tirado","Ozuna","Mx"],calDisponible:["1/8","1/4","1/2","3/4","1"],salDisponible:["1/4","1/2","3/4","1"]}},computed:{diasOrdenados(){return[...this.dias].sort((e,t)=>t.timestamp-e.timestamp)}},methods:{formatearFecha(e){const[t,a,o]=e.split("-");return new Date(t,a-1,o).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},inicializarNuevoDia(){const e=new Date,t=e.getTimezoneOffset();e.setMinutes(e.getMinutes()-t),this.nuevoDia={fecha:e.toISOString().split("T")[0],medidas:[{medida:"",proveedor:"",tinas:"",cajas:"",cal:"",sal:"",porcentaje:"",editando:!1}]}},mostrarModalNuevoDia(){this.showModal=!0},agregarMedida(){this.nuevoDia.medidas.push({medida:"",proveedor:"",tinas:"",cajas:"",cal:"",sal:"",porcentaje:"",editando:!1})},eliminarMedida(e){this.nuevoDia.medidas.splice(e,1)},async crearNuevoDia(){try{const e=Object(s["h"])(),[t,a,o]=this.nuevoDia.fecha.split("-"),i=new Date(t,a-1,parseInt(o)),r=await Object(s["b"])(Object(s["c"])(e,"preparacion"),{fecha:this.nuevoDia.fecha,medidas:this.nuevoDia.medidas,createdAt:new Date,timestamp:i.getTime()});this.dias.push({id:r.id,fecha:this.nuevoDia.fecha,medidas:this.nuevoDia.medidas,timestamp:i.getTime()}),this.showModal=!1,console.log("Día creado exitosamente")}catch(e){console.error("Error al crear día:",e)}},async guardarCambios(e){try{const t=Object(s["h"])();await Object(s["r"])(Object(s["e"])(t,"preparacion",e.id),{medidas:e.medidas}),console.log("Cambios guardados exitosamente")}catch(t){console.error("Error al guardar cambios:",t)}},async confirmarBorrarDia(e){if(await this.$bvModal.msgBoxConfirm("¿Estás seguro de que deseas borrar este día?"))try{const t=Object(s["h"])();await Object(s["d"])(Object(s["e"])(t,"preparacion",e.id)),this.dias=this.dias.filter(t=>t.id!==e.id),console.log("Día eliminado exitosamente")}catch(t){console.error("Error al borrar día:",t)}},async eliminarMedidaExistente(e,t){try{e.medidas.splice(t,1),await this.guardarCambios(e),console.log("Medida eliminada exitosamente")}catch(a){console.error("Error al eliminar medida:",a)}},async cargarDias(){try{const e=Object(s["h"])(),t=Object(s["o"])(Object(s["c"])(e,"preparacion"),Object(s["l"])("timestamp","desc")),a=await Object(s["g"])(t);this.dias=a.docs.map(e=>{const t=e.data();if(!t.timestamp){const[e,a,o]=t.fecha.split("-"),i=new Date(e,a-1,parseInt(o));t.timestamp=i.getTime()}return{id:e.id,...t,medidas:t.medidas.map(e=>({...e,editando:!1}))}}),console.log("Días cargados exitosamente")}catch(e){console.error("Error al cargar días:",e)}},async agregarMedidaExistente(e){const t={medida:"",proveedor:"",tinas:"",cajas:"",cal:"",sal:"",porcentaje:""};e.medidas.push(t),await this.guardarCambios(e)},toggleDiasList(){this.diasListOpen=!this.diasListOpen},seleccionarDia(e){this.diaSeleccionado=e,this.diasListOpen=!1}},async mounted(){if(await this.cargarDias(),this.$route.query.fecha){const e=this.dias.find(e=>e.fecha===this.$route.query.fecha);e&&(this.diaSeleccionado=e)}else this.dias.length>0&&(this.diaSeleccionado=this.diasOrdenados[0])}},l=r,n=(a("f817"),a("2877")),d=Object(n["a"])(l,o,i,!1,null,"30ed9ef6",null);t["a"]=d.exports},cc985:function(e,t,a){"use strict";a("14d9");var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pedidos-crudo-container"},[t("h2",[e._v("Pedido de Camarón Crudo")]),t("div",{staticClass:"fecha-container"},[t("label",{attrs:{for:"fecha"}},[e._v("Fecha:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.fecha,expression:"fecha"}],attrs:{type:"date",id:"fecha",required:"",max:e.fechaMaxima},domProps:{value:e.fecha},on:{input:function(t){t.target.composing||(e.fecha=t.target.value)}}})]),t("div",{staticClass:"agregar-columna"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.nuevaColumna,expression:"nuevaColumna"}],staticClass:"input-nueva-columna",attrs:{type:"text",placeholder:"Nombre de nueva columna"},domProps:{value:e.nuevaColumna},on:{input:function(t){t.target.composing||(e.nuevaColumna=t.target.value)}}}),t("button",{staticClass:"btn-agregar-columna",on:{click:e.agregarColumna}},[e._v(" Agregar Columna ")])]),t("div",{staticClass:"tabla-pedidos"},[t("table",[t("thead",[t("tr",[t("th",[e._v("Cliente")]),e._l(e.columnas,(function(a){return t("th",{key:a},[e._v(" "+e._s(a)+" "),e.columnasBase.includes(a)?e._e():t("span",{staticClass:"eliminar-columna",on:{click:function(t){return e.eliminarColumna(a)}}},[e._v(" × ")])])}))],2)]),t("tbody",[e._l(e.clientes,(function(a,o){return t("tr",{key:o},[t("td",{class:"cliente-"+a.toLowerCase()},[e._v(e._s(a))]),e._l(e.columnas,(function(o){return t("td",{key:o},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.pedidos[a][o.toLowerCase()],expression:"pedidos[cliente][columna.toLowerCase()]"}],staticClass:"numero-input",class:"cliente-"+a.toLowerCase(),attrs:{type:"number",placeholder:""},domProps:{value:e.pedidos[a][o.toLowerCase()]},on:{input:function(t){t.target.composing||e.$set(e.pedidos[a],o.toLowerCase(),t.target.value)}}})])}))],2)})),t("tr",{staticClass:"fila-totales"},[e._m(0),e._l(e.columnas,(function(a){return t("td",{key:a+"-total"},[e._v(" "+e._s(e.totalesColumnas[a.toLowerCase()]||0)+" ")])}))],2)],2)])]),t("div",{staticClass:"kilos-info"},[t("h3",[e._v("Total Kilos de Crudo: "),t("span",[e._v(e._s(Math.floor(e.kilosCrudo))+" kg")])]),t("h3",[e._v("Total Taras de Crudo: "),t("span",[e._v(e._s(Math.floor(e.tarasCrudo))+" T")])])]),t("canvas-dibujo",{ref:"canvasDibujo"}),t("div",{staticClass:"buttons-container"},[t("button",{staticClass:"btn-guardar",on:{click:e.guardarPedido}},[e._v("Guardar Pedido")]),t("button",{staticClass:"btn-imprimir",on:{click:e.imprimirPedido}},[e._v("Imprimir")]),t("button",{staticClass:"btn-cancelar",on:{click:function(t){return e.$router.push("/procesos/pedidos")}}},[e._v("Cancelar")])])],1)},i=[function(){var e=this,t=e._self._c;return t("td",[t("strong",[e._v("Total")])])}],s=(a("13d5"),a("dc59")),r=a("1494"),l=a("900f"),n={name:"PedidosCrudo",components:{CanvasDibujo:l["a"]},data(){return{fecha:(new Date).toISOString().split("T")[0],clientes:["8a","Catarro","Otilio","Ozuna","Elizabeth"],columnasBase:["Med","Med-Esp","Med-gde","Gde","Extra"],columnasAdicionales:[],nuevaColumna:"",pedidos:{},barcosPorPedido:{},isEditing:!1,pedidoId:null,dibujoCanvas:null}},computed:{fechaMinima(){const e=new Date;return e.toISOString().split("T")[0]},fechaMaxima(){const e=new Date;return e.setMonth(e.getMonth()+3),e.toISOString().split("T")[0]},columnas(){return[...this.columnasBase,...this.columnasAdicionales]},kilosCrudo(){let e=0;for(const t in this.pedidos)for(const a in this.pedidos[t]){const o=this.pedidos[t][a];o&&!isNaN(o)&&(e+=parseFloat(o))}return 19*e},totalesColumnas(){const e={};return this.columnas.forEach(t=>{const a=t.toLowerCase();e[a]=this.clientes.reduce((e,t)=>{if(!this.pedidos[t]||!this.pedidos[t][a])return e;const o=parseFloat(this.pedidos[t][a])||0;return e+o},0)}),e},tarasCrudo(){return this.kilosCrudo/19}},methods:{normalizarNombreColumna(e){return e.toLowerCase()},agregarColumna(){if(!this.nuevaColumna.trim())return;const e=this.nuevaColumna.trim();if(this.columnas.includes(e))return void alert("Esta columna ya existe");this.columnasAdicionales.push(e);const t=this.normalizarNombreColumna(e);this.clientes.forEach(e=>{this.pedidos[e]||(this.pedidos[e]={}),this.$set(this.pedidos[e],t,null)}),this.nuevaColumna=""},eliminarColumna(e){const t=this.columnasAdicionales.indexOf(e);if(t>-1){this.columnasAdicionales.splice(t,1);const a=this.normalizarNombreColumna(e);this.clientes.forEach(e=>{this.$delete(this.pedidos[e],a)})}},clientesConPedidoPorMedida(e){return this.clientes.filter(t=>{const a=this.pedidos[t][e.toLowerCase()];return a&&a>0})},async guardarPedido(){try{let e=null;if(this.$refs.canvasDibujo&&this.$refs.canvasDibujo.canvas){const t=this.$refs.canvasDibujo.canvas.toJSON();e=JSON.stringify(t),console.log("Canvas guardado como string")}const t={fecha:this.fecha,pedidos:this.pedidos,barcosPorPedido:this.barcosPorPedido,columnas:this.columnas,tipo:"crudo",kilos:this.kilosCrudo,createdAt:r["a"].now(),dibujoCanvas:e};if(this.isEditing&&this.pedidoId){const e=Object(r["e"])(s["a"],"pedidos",this.pedidoId);await Object(r["r"])(e,t),alert("Pedido actualizado exitosamente")}else await Object(r["b"])(Object(r["c"])(s["a"],"pedidos"),t),alert("Pedido guardado exitosamente");this.$router.push("/procesos/pedidos")}catch(e){console.error("Error al guardar el pedido:",e),alert("Error al guardar el pedido. Por favor intente nuevamente.")}},async cargarPedido(e){try{const t=Object(r["e"])(s["a"],"pedidos",e),a=await Object(r["f"])(t);if(a.exists()){const e=a.data();this.fecha=e.fecha,this.pedidos=e.pedidos,this.barcosPorPedido=e.barcosPorPedido||this.initializeBarcosPorPedido(),this.columnasAdicionales=e.columnas.filter(e=>!this.columnasBase.includes(e)),e.dibujoCanvas?(console.log("Dibujo encontrado en el pedido, preparando para cargar"),this.dibujoCanvas=e.dibujoCanvas,this.$nextTick(()=>{console.log("DOM actualizado, intentando cargar el dibujo"),this.cargarDibujoEnCanvas()})):console.log("No hay dibujo guardado en este pedido")}else alert("El pedido no existe"),this.$router.push("/procesos/pedidos")}catch(t){console.error("Error al cargar el pedido:",t),alert("Error al cargar el pedido"),this.$router.push("/procesos/pedidos")}},initializeBarcosPorPedido(){const e={};return this.clientes.forEach(t=>{e[t]={}}),e},imprimirPedido(){this.$router.push({name:"PedidoCrudosImpresion",params:{fecha:this.fecha,pedidos:this.pedidos,columnas:this.columnas}})},cargarDibujoEnCanvas(){try{if(this.$refs.canvasDibujo&&this.$refs.canvasDibujo.canvas&&this.dibujoCanvas){const e=JSON.parse(this.dibujoCanvas);this.$refs.canvasDibujo.canvas.loadFromJSON(e,()=>{this.$refs.canvasDibujo.canvas.renderAll(),console.log("Dibujo cargado correctamente en el canvas")})}else setTimeout(()=>{this.cargarDibujoEnCanvas()},500)}catch(e){console.error("Error al cargar el dibujo en el canvas:",e)}}},created(){this.clientes.forEach(e=>{this.$set(this.pedidos,e,{}),this.columnasBase.forEach(t=>{const a=this.normalizarNombreColumna(t);this.pedidos[e][a]||this.$set(this.pedidos[e],a,null)})}),this.clientes.forEach(e=>{this.$set(this.barcosPorPedido,e,{})});const{edit:e,id:t}=this.$route.query;"true"===e&&t&&(this.isEditing=!0,this.pedidoId=t,this.cargarPedido(t))}},d=n,c=(a("2f5c"),a("2877")),u=Object(c["a"])(d,o,i,!1,null,"71f19492",null);t["a"]=u.exports},d248:function(e,t,a){"use strict";a("be6e")},d918:function(e,t,a){"use strict";a("14d9");var o=function(){var e=this,t=e._self._c;return t("div",[e.mostrarImpresion?t("PedidoLimpioImpresion",{attrs:{fecha:e.fecha,pedidoOtilio:e.pedidoOtilio,pedidoCatarro:e.pedidoCatarro,pedidoJoselito:e.pedidoJoselito,pedidoOzuna:e.pedidoOzuna,clientesTemporales:e.clientesTemporales,rendimientosGuardados:e.rendimientosGuardados,divisoresGuardados:e.divisoresGuardados,completadosGuardados:e.completadosGuardados},on:{"actualizar-rendimientos":e.actualizarRendimientos,"actualizar-divisores":e.actualizarDivisores,"actualizar-completados":e.actualizarCompletados,volver:function(t){e.mostrarImpresion=!1}}}):t("div",{staticClass:"pedidos-limpio-container"},[t("h2",[e._v("Pedido de Camarón Limpio")]),t("div",{staticClass:"header-container"},[t("div",{staticClass:"volver-container"},[t("button",{staticClass:"btn-volver",on:{click:function(t){return e.$router.push("/procesos/pedidos")}}},[t("i",{staticClass:"fas fa-arrow-left"}),e._v(" Volver ")])]),t("div",{staticClass:"fecha-container"},[t("label",{attrs:{for:"fecha"}},[e._v("Fecha:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.fecha,expression:"fecha"}],attrs:{type:"date",id:"fecha",required:"",max:e.fechaMaxima},domProps:{value:e.fecha},on:{input:function(t){t.target.composing||(e.fecha=t.target.value)}}})]),t("div",{staticClass:"totales-generales"},[t("div",{staticClass:"total-item"},[t("span",{staticClass:"total-label"},[e._v("Total Taras:")]),t("span",{staticClass:"total-value"},[e._v(e._s(e.totalesGenerales.tarasTotal)+" T")])]),t("div",{staticClass:"total-item"},[t("span",{staticClass:"total-label"},[e._v("Total Kilos:")]),t("span",{staticClass:"total-value"},[e._v(e._s(e.totalesGenerales.kilosTotal)+" kg")])])]),t("MedidasModal",{on:{"medidas-actualizadas":e.actualizarMedidas}})],1),t("div",{staticClass:"tabs-container"},[e._l(e.clientes,(function(a){return t("div",{key:a.id,staticClass:"tab-wrapper"},[t("button",{class:["tab-button",{active:e.clienteActivo===a.id}],attrs:{"data-cliente":a.id},on:{click:function(t){e.clienteActivo=a.id}}},[e._v(" "+e._s(a.nombre)+" ")]),"otilio"===a.id?t("div",{staticClass:"tab-totales"},[t("div",[e._v("Taras: "+e._s(e.calculosOtilio.tarasTotal)+" T")]),t("div",[e._v("Kilos: "+e._s(e.calculosOtilio.kilosTotal)+" kg")])]):e._e(),"catarro"===a.id?t("div",{staticClass:"tab-totales"},[t("div",[e._v("Taras: "+e._s(e.calculosCatarro.tarasTotal)+" T")]),t("div",[e._v("Kilos: "+e._s(e.calculosCatarro.kilosTotal)+" kg")])]):e._e(),"joselito"===a.id?t("div",{staticClass:"tab-totales"},[t("div",[e._v("Taras: "+e._s(e.calculosJoselito.tarasTotal)+" T")]),t("div",[e._v("Kilos: "+e._s(e.calculosJoselito.kilosTotal)+" kg")])]):e._e(),"ozuna"===a.id?t("div",{staticClass:"tab-totales"},[t("div",[e._v("Taras: "+e._s(e.calculosOzuna.tarasTotal)+" T")]),t("div",[e._v("Kilos: "+e._s(e.calculosOzuna.kilosTotal)+" kg")])]):e._e()])})),e._l(e.clientesTemporales,(function(a,o){return t("div",{key:o,staticClass:"tab-wrapper"},[t("button",{class:["tab-button temporal",{active:e.clienteActivo===a.id}],on:{click:function(t){e.clienteActivo=a.id}}},[e._v(" "+e._s(a.nombre)+" ")]),t("div",{staticClass:"tab-totales"},[t("div",[e._v("Taras: "+e._s(e.calcularTotalesTemporales(a.id).tarasTotal)+" T")]),t("div",[e._v("Kilos: "+e._s(e.calcularTotalesTemporales(a.id).kilosTotal)+" kg")])])])})),t("div",{staticClass:"tab-wrapper"},[t("button",{staticClass:"tab-button nuevo-cliente",on:{click:function(t){e.mostrarModalNuevoCliente=!0}}},[e._v(" + Nuevo Cliente ")])])],2),t("div",{staticClass:"clientes-content"},[t("div",{directives:[{name:"show",rawName:"v-show",value:"otilio"===e.clienteActivo,expression:"clienteActivo === 'otilio'"}],staticClass:"cliente-seccion"},[t("button",{staticClass:"btn-agregar",class:{"bg-otilio":"otilio"===e.clienteActivo,"bg-catarro":"catarro"===e.clienteActivo,"bg-joselito":"joselito"===e.clienteActivo,"bg-ozuna":"ozuna"===e.clienteActivo,"bg-temporal":e.isClienteTemporal(e.clienteActivo)},on:{click:e.agregarFilaOtilio}},[e._v(" + Agregar Fila ")]),t("div",{staticClass:"pedido-grid"},e._l(e.pedidoOtilio,(function(a,o){return t("div",{key:o,staticClass:"pedido-item"},[t("div",{staticClass:"input-row"},[t("div",{staticClass:"input-group-compact kilos"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Kilos:")]),t("div",{staticClass:"tara-checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.esTara,expression:"item.esTara"}],attrs:{type:"checkbox",id:"tara"+o},domProps:{checked:Array.isArray(a.esTara)?e._i(a.esTara,null)>-1:a.esTara},on:{change:function(t){var o=a.esTara,i=t.target,s=!!i.checked;if(Array.isArray(o)){var r=null,l=e._i(o,r);i.checked?l<0&&e.$set(a,"esTara",o.concat([r])):l>-1&&e.$set(a,"esTara",o.slice(0,l).concat(o.slice(l+1)))}else e.$set(a,"esTara",s)}}}),t("label",{attrs:{for:"tara"+o}},[e._v("T")])])]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.kilos,expression:"item.kilos"}],staticClass:"input-field",attrs:{type:"number"},domProps:{value:a.kilos},on:{input:function(t){t.target.composing||e.$set(a,"kilos",t.target.value)}}})]),t("div",{staticClass:"input-group-compact medida"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Medida:")]),t("button",{staticClass:"btn-proveedor",class:{active:a.esProveedor},attrs:{title:a.proveedor||"Agregar proveedor"},on:{click:function(t){return e.abrirModalProveedor(a)}}},[e._v(" P ")])]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.medida,expression:"item.medida"}],staticClass:"input-field",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"medida",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),e._l(e.medidasOrdenadas,(function(a){return t("option",{key:a.id,domProps:{value:a.nombre}},[e._v(" "+e._s(a.nombre)+" ")])}))],2)]),t("div",{staticClass:"input-group-compact tipo"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Tipo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.nota,expression:"item.nota"}],staticClass:"input-field-notas",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"nota",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Notas")]),t("option",{attrs:{value:"Sellado"}},[e._v("Sellado")]),t("option",{attrs:{value:"Kileado"}},[e._v("Kileado")])])]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.tipo,expression:"item.tipo"}],staticClass:"input-field",class:{"text-blue":"C/H20"===a.tipo},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"tipo",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),t("option",{attrs:{value:"S/H20"}},[e._v("S/H20")]),t("option",{staticClass:"text-blue",attrs:{value:"C/H20"}},[e._v("C/H20")])])]),e.pedidoOtilio.length>1?t("button",{staticClass:"btn-eliminar",on:{click:function(t){return e.eliminarPedidoOtilio(o)}}},[t("i",{staticClass:"fas fa-trash"})]):e._e()])])})),0)]),t("div",{directives:[{name:"show",rawName:"v-show",value:"catarro"===e.clienteActivo,expression:"clienteActivo === 'catarro'"}],staticClass:"cliente-seccion"},[t("button",{staticClass:"btn-agregar",class:{"bg-otilio":"otilio"===e.clienteActivo,"bg-catarro":"catarro"===e.clienteActivo,"bg-joselito":"joselito"===e.clienteActivo,"bg-ozuna":"ozuna"===e.clienteActivo,"bg-temporal":e.isClienteTemporal(e.clienteActivo)},on:{click:e.agregarFilaCatarro}},[e._v(" + Agregar Fila ")]),t("div",{staticClass:"pedido-grid"},e._l(e.pedidoCatarro,(function(a,o){return t("div",{key:o,staticClass:"pedido-item"},[t("div",{staticClass:"input-row"},[t("div",{staticClass:"input-group-compact kilos"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Kilos:")]),t("div",{staticClass:"tara-checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.esTara,expression:"item.esTara"}],attrs:{type:"checkbox",id:"tara"+o},domProps:{checked:Array.isArray(a.esTara)?e._i(a.esTara,null)>-1:a.esTara},on:{change:function(t){var o=a.esTara,i=t.target,s=!!i.checked;if(Array.isArray(o)){var r=null,l=e._i(o,r);i.checked?l<0&&e.$set(a,"esTara",o.concat([r])):l>-1&&e.$set(a,"esTara",o.slice(0,l).concat(o.slice(l+1)))}else e.$set(a,"esTara",s)}}}),t("label",{attrs:{for:"tara"+o}},[e._v("T")])])]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.kilos,expression:"item.kilos"}],staticClass:"input-field",attrs:{type:"number"},domProps:{value:a.kilos},on:{input:function(t){t.target.composing||e.$set(a,"kilos",t.target.value)}}})]),t("div",{staticClass:"input-group-compact medida"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Medida:")]),t("button",{staticClass:"btn-proveedor",class:{active:a.esProveedor},attrs:{title:a.proveedor||"Agregar proveedor"},on:{click:function(t){return e.abrirModalProveedor(a)}}},[e._v(" P ")])]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.medida,expression:"item.medida"}],staticClass:"input-field",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"medida",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),e._l(e.medidasOrdenadas,(function(a){return t("option",{key:a.id,domProps:{value:a.nombre}},[e._v(" "+e._s(a.nombre)+" ")])}))],2)]),t("div",{staticClass:"input-group-compact tipo"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Tipo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.nota,expression:"item.nota"}],staticClass:"input-field-notas",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"nota",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Notas")]),t("option",{attrs:{value:"Sellado"}},[e._v("Sellado")]),t("option",{attrs:{value:"Kileado"}},[e._v("Kileado")])])]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.tipo,expression:"item.tipo"}],staticClass:"input-field",class:{"text-blue":"C/H20"===a.tipo},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"tipo",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),t("option",{attrs:{value:"S/H20"}},[e._v("S/H20")]),t("option",{staticClass:"text-blue",attrs:{value:"C/H20"}},[e._v("C/H20")])])]),e.pedidoCatarro.length>1?t("button",{staticClass:"btn-eliminar",on:{click:function(t){return e.eliminarPedidoCatarro(o)}}},[t("i",{staticClass:"fas fa-trash"})]):e._e()])])})),0)]),t("div",{directives:[{name:"show",rawName:"v-show",value:"joselito"===e.clienteActivo,expression:"clienteActivo === 'joselito'"}],staticClass:"cliente-seccion"},[t("button",{staticClass:"btn-agregar",class:{"bg-otilio":"otilio"===e.clienteActivo,"bg-catarro":"catarro"===e.clienteActivo,"bg-joselito":"joselito"===e.clienteActivo,"bg-ozuna":"ozuna"===e.clienteActivo,"bg-temporal":e.isClienteTemporal(e.clienteActivo)},on:{click:e.agregarFilaJoselito}},[e._v(" + Agregar Fila ")]),t("div",{staticClass:"pedido-grid"},e._l(e.pedidoJoselito,(function(a,o){return t("div",{key:o,staticClass:"pedido-item"},[t("div",{staticClass:"input-row"},[t("div",{staticClass:"input-group-compact kilos"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Kilos:")]),t("div",{staticClass:"tara-checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.esTara,expression:"item.esTara"}],attrs:{type:"checkbox",id:"tara"+o},domProps:{checked:Array.isArray(a.esTara)?e._i(a.esTara,null)>-1:a.esTara},on:{change:function(t){var o=a.esTara,i=t.target,s=!!i.checked;if(Array.isArray(o)){var r=null,l=e._i(o,r);i.checked?l<0&&e.$set(a,"esTara",o.concat([r])):l>-1&&e.$set(a,"esTara",o.slice(0,l).concat(o.slice(l+1)))}else e.$set(a,"esTara",s)}}}),t("label",{attrs:{for:"tara"+o}},[e._v("T")])])]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.kilos,expression:"item.kilos"}],staticClass:"input-field",attrs:{type:"number"},domProps:{value:a.kilos},on:{input:function(t){t.target.composing||e.$set(a,"kilos",t.target.value)}}})]),t("div",{staticClass:"input-group-compact medida"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Medida:")]),t("button",{staticClass:"btn-proveedor",class:{active:a.esProveedor},attrs:{title:a.proveedor||"Agregar proveedor"},on:{click:function(t){return e.abrirModalProveedor(a)}}},[e._v(" P ")])]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.medida,expression:"item.medida"}],staticClass:"input-field",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"medida",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),e._l(e.medidasOrdenadas,(function(a){return t("option",{key:a.id,domProps:{value:a.nombre}},[e._v(" "+e._s(a.nombre)+" ")])}))],2)]),t("div",{staticClass:"input-group-compact tipo"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Tipo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.nota,expression:"item.nota"}],staticClass:"input-field-notas",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"nota",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Notas")]),t("option",{attrs:{value:"Sellado"}},[e._v("Sellado")]),t("option",{attrs:{value:"Kileado"}},[e._v("Kileado")])])]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.tipo,expression:"item.tipo"}],staticClass:"input-field",class:{"text-blue":"C/H20"===a.tipo||"1.35 y .15"===a.tipo},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"tipo",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),t("option",{attrs:{value:"S/H20"}},[e._v("S/H20")]),t("option",{staticClass:"text-blue",attrs:{value:"C/H20"}},[e._v("C/H20")]),t("option",{staticClass:"text-blue",attrs:{value:"1.35 y .15"}},[e._v("1.35 y .15")])])]),e.pedidoJoselito.length>1?t("button",{staticClass:"btn-eliminar",on:{click:function(t){return e.eliminarPedidoJoselito(o)}}},[t("i",{staticClass:"fas fa-trash"})]):e._e()])])})),0)]),t("div",{directives:[{name:"show",rawName:"v-show",value:"ozuna"===e.clienteActivo,expression:"clienteActivo === 'ozuna'"}],staticClass:"cliente-seccion"},[t("button",{staticClass:"btn-agregar",class:{"bg-otilio":"otilio"===e.clienteActivo,"bg-catarro":"catarro"===e.clienteActivo,"bg-joselito":"joselito"===e.clienteActivo,"bg-ozuna":"ozuna"===e.clienteActivo,"bg-temporal":e.isClienteTemporal(e.clienteActivo)},on:{click:e.agregarFilaOzuna}},[e._v(" + Agregar Fila ")]),t("div",{staticClass:"pedido-grid"},e._l(e.pedidoOzuna,(function(a,o){return t("div",{key:o,staticClass:"pedido-item"},[t("div",{staticClass:"input-row"},[t("div",{staticClass:"input-group-compact kilos"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Kilos:")]),t("div",{staticClass:"tara-checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.esTara,expression:"item.esTara"}],attrs:{type:"checkbox",id:"tara"+o},domProps:{checked:Array.isArray(a.esTara)?e._i(a.esTara,null)>-1:a.esTara},on:{change:function(t){var o=a.esTara,i=t.target,s=!!i.checked;if(Array.isArray(o)){var r=null,l=e._i(o,r);i.checked?l<0&&e.$set(a,"esTara",o.concat([r])):l>-1&&e.$set(a,"esTara",o.slice(0,l).concat(o.slice(l+1)))}else e.$set(a,"esTara",s)}}}),t("label",{attrs:{for:"tara"+o}},[e._v("T")])])]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.kilos,expression:"item.kilos"}],staticClass:"input-field",attrs:{type:"number"},domProps:{value:a.kilos},on:{input:function(t){t.target.composing||e.$set(a,"kilos",t.target.value)}}})]),t("div",{staticClass:"input-group-compact medida"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Medida:")]),t("button",{staticClass:"btn-proveedor",class:{active:a.esProveedor},attrs:{title:a.proveedor||"Agregar proveedor"},on:{click:function(t){return e.abrirModalProveedor(a)}}},[e._v(" P ")])]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.medida,expression:"item.medida"}],staticClass:"input-field",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"medida",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),e._l(e.medidasOrdenadas,(function(a){return t("option",{key:a.id,domProps:{value:a.nombre}},[e._v(" "+e._s(a.nombre)+" ")])}))],2)]),t("div",{staticClass:"input-group-compact tipo"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Tipo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.nota,expression:"item.nota"}],staticClass:"input-field-notas",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"nota",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Notas")]),t("option",{attrs:{value:"Sellado"}},[e._v("Sellado")]),t("option",{attrs:{value:"Kileado"}},[e._v("Kileado")])])]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.tipo,expression:"item.tipo"}],staticClass:"input-field",class:{"text-blue":"C/H20"===a.tipo},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(a,"tipo",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),t("option",{attrs:{value:"S/H20"}},[e._v("S/H20")]),t("option",{staticClass:"text-blue",attrs:{value:"C/H20"}},[e._v("C/H20")]),t("option",{attrs:{value:".7 y .3"}},[e._v(".7 y .3")])])]),"ozuna"===e.clienteActivo?t("div",{staticClass:"input-group-compact maquila"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Maquila:")]),t("div",{staticClass:"maquila-checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.esMaquila,expression:"item.esMaquila"}],attrs:{type:"checkbox",id:"maquila"+o},domProps:{checked:Array.isArray(a.esMaquila)?e._i(a.esMaquila,null)>-1:a.esMaquila},on:{change:function(t){var o=a.esMaquila,i=t.target,s=!!i.checked;if(Array.isArray(o)){var r=null,l=e._i(o,r);i.checked?l<0&&e.$set(a,"esMaquila",o.concat([r])):l>-1&&e.$set(a,"esMaquila",o.slice(0,l).concat(o.slice(l+1)))}else e.$set(a,"esMaquila",s)}}})])])]):e._e(),e.pedidoOzuna.length>1?t("button",{staticClass:"btn-eliminar",on:{click:function(t){return e.eliminarPedidoOzuna(o)}}},[t("i",{staticClass:"fas fa-trash"})]):e._e()])])})),0)]),e._l(e.clientesTemporales,(function(a,o){return t("div",{directives:[{name:"show",rawName:"v-show",value:e.clienteActivo===a.id,expression:"clienteActivo === cliente.id"}],key:o,staticClass:"cliente-seccion"},[t("button",{staticClass:"btn-agregar",class:{"bg-otilio":"otilio"===e.clienteActivo,"bg-catarro":"catarro"===e.clienteActivo,"bg-joselito":"joselito"===e.clienteActivo,"bg-ozuna":"ozuna"===e.clienteActivo,"bg-temporal":e.isClienteTemporal(e.clienteActivo)},on:{click:function(t){return e.agregarFilaTemporal(a.id)}}},[e._v(" + Agregar Fila ")]),t("div",{staticClass:"pedido-grid"},e._l(a.pedidos,(function(o,i){return t("div",{key:i,staticClass:"pedido-item"},[t("div",{staticClass:"input-row"},[t("div",{staticClass:"input-group-compact kilos"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Kilos:")]),t("div",{staticClass:"tara-checkbox"},[t("input",{directives:[{name:"model",rawName:"v-model",value:o.esTara,expression:"item.esTara"}],attrs:{type:"checkbox",id:"tara"+a.id+i},domProps:{checked:Array.isArray(o.esTara)?e._i(o.esTara,null)>-1:o.esTara},on:{change:function(t){var a=o.esTara,i=t.target,s=!!i.checked;if(Array.isArray(a)){var r=null,l=e._i(a,r);i.checked?l<0&&e.$set(o,"esTara",a.concat([r])):l>-1&&e.$set(o,"esTara",a.slice(0,l).concat(a.slice(l+1)))}else e.$set(o,"esTara",s)}}}),t("label",{attrs:{for:"tara"+a.id+i}},[e._v("T")])])]),t("input",{directives:[{name:"model",rawName:"v-model",value:o.kilos,expression:"item.kilos"}],staticClass:"input-field",attrs:{type:"number"},domProps:{value:o.kilos},on:{input:function(t){t.target.composing||e.$set(o,"kilos",t.target.value)}}})]),t("div",{staticClass:"input-group-compact medida"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Medida:")]),t("button",{staticClass:"btn-proveedor",class:{active:o.esProveedor},attrs:{title:o.proveedor||"Agregar proveedor"},on:{click:function(t){return e.abrirModalProveedor(o)}}},[e._v(" P ")])]),t("select",{directives:[{name:"model",rawName:"v-model",value:o.medida,expression:"item.medida"}],staticClass:"input-field",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(o,"medida",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),e._l(e.medidasOrdenadas,(function(a){return t("option",{key:a.id,domProps:{value:a.nombre}},[e._v(" "+e._s(a.nombre)+" ")])}))],2)]),t("div",{staticClass:"input-group-compact tipo"},[t("div",{staticClass:"label-container"},[t("label",[e._v("Tipo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:o.nota,expression:"item.nota"}],staticClass:"input-field-notas",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(o,"nota",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:""}},[e._v("Notas")]),t("option",{attrs:{value:"Sellado"}},[e._v("Sellado")]),t("option",{attrs:{value:"Kileado"}},[e._v("Kileado")])])]),t("select",{directives:[{name:"model",rawName:"v-model",value:o.tipo,expression:"item.tipo"}],staticClass:"input-field",class:{"text-blue":"C/H20"===o.tipo},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(o,"tipo",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),t("option",{attrs:{value:"S/H20"}},[e._v("S/H20")]),t("option",{attrs:{value:".9 y .1"}},[e._v(".9 y .1")]),t("option",{attrs:{value:".9"}},[e._v(".9")])])]),t("div",{staticClass:"input-group-compact operacion"},[e._m(0,!0),t("select",{directives:[{name:"model",rawName:"v-model",value:o.tipoOperacion,expression:"item.tipoOperacion"}],staticClass:"input-field",on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(o,"tipoOperacion",t.target.multiple?a:a[0])}}},[t("option",{attrs:{value:""}},[e._v("Seleccionar")]),t("option",{attrs:{value:"Venta"}},[e._v("Venta")]),t("option",{attrs:{value:"Maquila"}},[e._v("Maquila")])])]),a.pedidos.length>1?t("button",{staticClass:"btn-eliminar",on:{click:function(t){return e.eliminarPedidoTemporal(a.id,i)}}},[t("i",{staticClass:"fas fa-trash"})]):e._e()])])})),0)])}))],2),t("div",{staticClass:"buttons-container"},[t("button",{staticClass:"btn-guardar",on:{click:e.guardarPedido}},[e._v("Guardar Pedido")]),t("button",{staticClass:"btn-imprimir",on:{click:e.mostrarVistaImpresion}},[t("i",{staticClass:"fas fa-print"}),e._v(" Vista Previa ")]),t("button",{staticClass:"btn-cancelar",on:{click:function(t){return e.$router.push("/procesos/pedidos")}}},[e._v("Cancelar")])])]),t("ProveedorModal",{attrs:{mostrar:e.mostrarModalProveedor,proveedor:e.itemSeleccionado?e.itemSeleccionado.proveedor:""},on:{cerrar:function(t){e.mostrarModalProveedor=!1},guardar:e.guardarProveedor}}),t("NuevoClienteModal",{attrs:{mostrar:e.mostrarModalNuevoCliente},on:{cerrar:function(t){e.mostrarModalNuevoCliente=!1},guardar:e.agregarClienteTemporal}})],1)},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"label-container"},[t("label",[e._v("Operación:")])])}],s=a("dc59"),r=a("1494"),l=a("92c9"),n=a("73bd"),d=a("d1d7"),c=a("0b8c"),u={name:"PedidosLimpio",components:{PedidoLimpioImpresion:l["a"],MedidasModal:n["a"],ProveedorModal:d["a"],NuevoClienteModal:c["a"]},data(){return{fecha:(new Date).toISOString().split("T")[0],pedidoOtilio:[{kilos:null,medida:"",tipo:"",esTara:!0,esProveedor:!1,proveedor:""}],pedidoCatarro:[{kilos:null,medida:"",tipo:"S/H20",esTara:!1,esProveedor:!1,proveedor:""}],pedidoJoselito:[{kilos:null,medida:"",tipo:"",esTara:!1,esProveedor:!1,proveedor:""}],pedidoOzuna:[{kilos:null,medida:"",tipo:"S/H20",esTara:!1,esProveedor:!1,proveedor:"",esMaquila:!0}],clientesTemporales:{},mostrarModalNuevoCliente:!1,mostrarImpresion:!1,mostrarModalProveedor:!1,itemSeleccionado:null,medidas:[],editando:!1,pedidoId:null,clienteActivo:"otilio",clientes:[{id:"otilio",nombre:"Otilio"},{id:"catarro",nombre:"Catarro"},{id:"joselito",nombre:"Joselito"},{id:"ozuna",nombre:"Ozuna"}],itemSeleccionadoNotas:null,rendimientosGuardados:{},divisoresGuardados:{},completadosGuardados:{}}},async created(){await this.cargarMedidas();const{edit:e,id:t,fecha:a}=this.$route.query;"true"===e&&t?(this.editando=!0,this.pedidoId=t,await this.cargarPedido(t)):a&&(this.fecha=a)},computed:{fechaMaxima(){const e=new Date;return e.setMonth(e.getMonth()+3),e.toISOString().split("T")[0]},medidasOrdenadas(){const e=this.medidas.filter(e=>"especial"===e.tipo),t=this.medidas.filter(e=>"granja"===e.tipo);return e.sort((e,t)=>{const a=parseFloat(e.nombre),o=parseFloat(t.nombre);return isNaN(a)||isNaN(o)?e.nombre.localeCompare(t.nombre):a-o}),t.sort((e,t)=>{const a=parseFloat(e.nombre.split("/")[0]),o=parseFloat(t.nombre.split("/")[0]);return isNaN(a)||isNaN(o)?e.nombre.localeCompare(t.nombre):a-o}),[...e,...t]},calculosOtilio(){let e=0,t=0,a=0,o=0;this.pedidoOtilio.forEach(i=>{i.kilos&&(i.esTara?(e+=Number(i.kilos),"C/H20"===i.tipo?a+=30*Number(i.kilos)*.65:o+=30*Number(i.kilos)):"S/H20"===i.tipo?t+=Number(i.kilos):"C/H20"===i.tipo&&(a+=Number(i.kilos)))});const i=t/27,s=Math.round(e+i),r=t+o,l=Math.round(r+a);return{tarasDirectas:e.toFixed(2),tarasPorKilos:i.toFixed(2),tarasTotal:s.toString(),kilosSinH2O:Math.round(r).toString(),kilosConH2O:a.toFixed(2),kilosTotal:l.toString()}},calculosCatarro(){let e=0,t=0,a=0,o=0;this.pedidoCatarro.forEach(i=>{i.kilos&&(i.esTara?(e+=Number(i.kilos),"C/H20"===i.tipo?a+=30*Number(i.kilos)*.65:o+=30*Number(i.kilos)):"S/H20"===i.tipo?t+=Number(i.kilos):"C/H20"===i.tipo&&(a+=Number(i.kilos)))});const i=t/27,s=Math.round(e+i),r=t+o,l=Math.round(r+a);return{tarasDirectas:e.toFixed(2),tarasPorKilos:i.toFixed(2),tarasTotal:s.toString(),kilosSinH2O:Math.round(r).toString(),kilosConH2O:a.toFixed(2),kilosTotal:l.toString()}},calculosJoselito(){let e=0,t=0,a=0,o=0,i=0,s=0;this.pedidoJoselito.forEach(r=>{r.kilos&&(r.esTara?(e+=Number(r.kilos),"C/H20"===r.tipo?a+=30*Number(r.kilos)*.65:"1.35 y .15"===r.tipo?s+=30*Number(r.kilos):o+=30*Number(r.kilos)):"S/H20"===r.tipo?t+=Number(r.kilos):"C/H20"===r.tipo?a+=Number(r.kilos):"1.35 y .15"===r.tipo&&(i+=1.35*Number(r.kilos)))});const r=t/25,l=i/33.75,n=Math.round(e+r+l),d=t+o+s,c=Math.round(d+a+i);return{tarasDirectas:e.toFixed(2),tarasPorKilos:r.toFixed(2),tarasTotal:n.toString(),kilosSinH2O:Math.round(d).toString(),kilosConH2O:a.toFixed(2),kilosTotal:c.toString()}},calculosOzuna(){let e=0,t=0,a=0,o=0,i=0;this.pedidoOzuna.forEach(s=>{s.kilos&&(s.esTara?(e+=Number(s.kilos),"C/H20"===s.tipo?a+=30*Number(s.kilos)*.65:o+=30*Number(s.kilos)):"S/H20"===s.tipo?t+=Number(s.kilos):"C/H20"===s.tipo?a+=Number(s.kilos):".7 y .3"===s.tipo&&(i+=.7*Number(s.kilos)))});const s=t/27,r=Math.round(e+s),l=t+o,n=Math.round(l+a+i);return{tarasDirectas:e.toFixed(2),tarasPorKilos:s.toFixed(2),tarasTotal:r.toString(),kilosSinH2O:Math.round(l).toString(),kilosConH2O:a.toFixed(2),kilos7y3:i.toFixed(2),kilosTotal:n.toString()}},totalesGenerales(){const e=Math.round(Number(this.calculosOtilio.tarasTotal)+Number(this.calculosCatarro.tarasTotal)+Number(this.calculosJoselito.tarasTotal)+Number(this.calculosOzuna.tarasTotal)),t=Math.round(Number(this.calculosOtilio.kilosTotal)+Number(this.calculosCatarro.kilosTotal)+Number(this.calculosJoselito.kilosTotal)+Number(this.calculosOzuna.kilosTotal));return{tarasTotal:e.toString(),kilosTotal:t.toString()}}},methods:{async cargarMedidas(){try{const e=await Object(r["g"])(Object(r["c"])(s["a"],"medidas"));this.medidas=e.docs.map(e=>({id:e.id,...e.data()}))}catch(e){console.error("Error al cargar las medidas:",e)}},async cargarPedido(e){try{const t=Object(r["e"])(s["a"],"pedidos",e),a=await Object(r["f"])(t);if(a.exists()){const e=a.data();this.fecha=e.fecha,this.pedidoOtilio=e.otilio||[],this.pedidoCatarro=e.catarro||[],this.pedidoJoselito=e.joselito||[],this.pedidoOzuna=e.ozuna||[],this.clientesTemporales=e.clientesTemporales||{},this.rendimientosGuardados=e.rendimientos||{},this.divisoresGuardados=e.divisores||{},this.completadosGuardados=e.completados||{}}}catch(t){console.error("Error al cargar el pedido:",t),alert("Error al cargar el pedido")}},agregarFilaOtilio(){this.pedidoOtilio.unshift({kilos:null,medida:"",tipo:"",esTara:!0,esProveedor:!1,proveedor:""})},agregarFilaCatarro(){this.pedidoCatarro.unshift({kilos:null,medida:"",tipo:"S/H20",esTara:!1,esProveedor:!1,proveedor:""})},agregarFilaJoselito(){this.pedidoJoselito.unshift({kilos:null,medida:"",tipo:"",esTara:!1,esProveedor:!1,proveedor:""})},agregarFilaOzuna(){this.pedidoOzuna.unshift({kilos:null,medida:"",tipo:"S/H20",esTara:!1,esProveedor:!1,proveedor:"",esMaquila:!0})},async guardarPedido(){try{const e={fecha:this.fecha,tipo:"limpio",otilio:this.pedidoOtilio,catarro:this.pedidoCatarro,joselito:this.pedidoJoselito,ozuna:this.pedidoOzuna,clientesTemporales:this.clientesTemporales,rendimientos:this.rendimientosGuardados,divisores:this.divisoresGuardados,completados:this.completadosGuardados,createdAt:r["a"].now()};this.editando&&this.pedidoId?await Object(r["r"])(Object(r["e"])(s["a"],"pedidos",this.pedidoId),e):await Object(r["b"])(Object(r["c"])(s["a"],"pedidos"),e),this.$router.push("/procesos/pedidos")}catch(e){console.error("Error al guardar el pedido:",e),alert("Error al guardar el pedido")}},async mostrarVistaImpresion(){try{const e={fecha:this.fecha,otilio:this.pedidoOtilio,catarro:this.pedidoCatarro,joselito:this.pedidoJoselito,ozuna:this.pedidoOzuna,clientesTemporales:this.clientesTemporales,rendimientos:this.rendimientosGuardados,divisores:this.divisoresGuardados,tipo:"limpio",createdAt:this.editando?r["a"].fromDate(new Date(this.fecha)):r["a"].now()};this.editando&&this.pedidoId?await Object(r["r"])(Object(r["e"])(s["a"],"pedidos",this.pedidoId),e):await Object(r["b"])(Object(r["c"])(s["a"],"pedidos"),e),this.mostrarImpresion=!0}catch(e){console.error("Error al guardar el pedido:",e)}},actualizarMedidas(e){this.medidas=e},eliminarPedidoOtilio(e){this.pedidoOtilio.splice(e,1),0===this.pedidoOtilio.length&&this.agregarFilaOtilio()},eliminarPedidoCatarro(e){this.pedidoCatarro.splice(e,1),0===this.pedidoCatarro.length&&this.agregarFilaCatarro()},eliminarPedidoJoselito(e){this.pedidoJoselito.splice(e,1),0===this.pedidoJoselito.length&&this.agregarFilaJoselito()},eliminarPedidoOzuna(e){this.pedidoOzuna.splice(e,1),0===this.pedidoOzuna.length&&this.agregarFilaOzuna()},abrirModalProveedor(e){this.itemSeleccionado=e,this.mostrarModalProveedor=!0},guardarProveedor(e){this.itemSeleccionado&&(this.itemSeleccionado.proveedor=e.trim(),this.itemSeleccionado.esProveedor=""!==e.trim()),this.mostrarModalProveedor=!1,this.itemSeleccionado=null},manejarCheckboxProveedor(e){e.esProveedor?this.abrirModalProveedor(e):e.proveedor=""},abrirMenuNotas(e){this.itemSeleccionadoNotas===e?this.itemSeleccionadoNotas=null:this.itemSeleccionadoNotas=e},seleccionarNota(e,t){e.nota=t,this.itemSeleccionadoNotas=null},ordenarPedidosPorMedida(e){const t=[...e],a=t.filter(e=>e.medida&&e.tipo),o=t.filter(e=>!e.medida||!e.tipo);return a.sort((e,t)=>e.medida===t.medida?e.tipo.localeCompare(t.tipo):e.medida.localeCompare(t.medida)),[...o,...a]},isClienteTemporal(e){return!["otilio","catarro","joselito","ozuna"].includes(e)},calcularTotalesTemporales(e){var t;if(null===(t=this.clientesTemporales[e])||void 0===t||!t.pedidos)return{tarasTotal:"0",kilosTotal:"0"};let a=0,o=0,i=0,s=0;this.clientesTemporales[e].pedidos.forEach(e=>{e.kilos&&(e.esTara?(a+=Number(e.kilos),"C/H20"===e.tipo?i+=30*Number(e.kilos)*.65:s+=30*Number(e.kilos)):"S/H20"===e.tipo?o+=Number(e.kilos):"C/H20"===e.tipo&&(i+=Number(e.kilos)))});const r=o/27,l=Math.round(a+r),n=o+s,d=Math.round(n+i);return{tarasTotal:l.toString(),kilosTotal:d.toString()}},agregarClienteTemporal(e){const t={id:e.id,nombre:e.nombre,pedidos:[{kilos:null,medida:"",tipo:"",esTara:!1,esProveedor:!1,proveedor:""}]};this.$set(this.clientesTemporales,e.id,t),this.clienteActivo=e.id,this.mostrarModalNuevoCliente=!1},agregarFilaTemporal(e){this.clientesTemporales[e]&&this.clientesTemporales[e].pedidos.unshift({kilos:null,medida:"",tipo:"",esTara:!1,esProveedor:!1,proveedor:""})},eliminarPedidoTemporal(e,t){this.clientesTemporales[e]&&(this.clientesTemporales[e].pedidos.splice(t,1),0===this.clientesTemporales[e].pedidos.length&&(this.$delete(this.clientesTemporales,e),this.clienteActivo===e&&(this.clienteActivo="otilio")))},actualizarRendimientos(e){this.rendimientosGuardados={...e},this.editando&&this.pedidoId&&Object(r["r"])(Object(r["e"])(s["a"],"pedidos",this.pedidoId),{rendimientos:this.rendimientosGuardados}).catch(e=>{console.error("Error al actualizar rendimientos:",e)})},actualizarDivisores(e){this.divisoresGuardados={...e},this.editando&&this.pedidoId&&Object(r["r"])(Object(r["e"])(s["a"],"pedidos",this.pedidoId),{divisores:this.divisoresGuardados}).catch(e=>{console.error("Error al actualizar divisores:",e)})},actualizarCompletados(e){if(this.completadosGuardados=e,this.editando&&this.pedidoId)Object(r["r"])(Object(r["e"])(s["a"],"pedidos",this.pedidoId),{completados:e}).catch(e=>{console.error("Error al actualizar estados completados:",e)});else{const t={fecha:this.fecha,tipo:"limpio",otilio:this.pedidoOtilio,catarro:this.pedidoCatarro,joselito:this.pedidoJoselito,ozuna:this.pedidoOzuna,clientesTemporales:this.clientesTemporales,rendimientos:this.rendimientosGuardados,divisores:this.divisoresGuardados,completados:e,createdAt:r["a"].now()};Object(r["b"])(Object(r["c"])(s["a"],"pedidos"),t).then(e=>{this.editando=!0,this.pedidoId=e.id}).catch(e=>{console.error("Error al crear nuevo pedido:",e)})}}},watch:{pedidoOtilio:{deep:!0,handler(e){const t=e.some(e=>e.medida&&e.tipo);if(t){const t=this.ordenarPedidosPorMedida(e);JSON.stringify(t)!==JSON.stringify(e)&&this.$nextTick(()=>{this.pedidoOtilio=t})}}},pedidoCatarro:{deep:!0,handler(e){const t=e.some(e=>e.medida&&e.tipo);if(t){const t=this.ordenarPedidosPorMedida(e);JSON.stringify(t)!==JSON.stringify(e)&&this.$nextTick(()=>{this.pedidoCatarro=t})}}},pedidoJoselito:{deep:!0,handler(e){const t=e.some(e=>e.medida&&e.tipo);if(t){const t=this.ordenarPedidosPorMedida(e);JSON.stringify(t)!==JSON.stringify(e)&&this.$nextTick(()=>{this.pedidoJoselito=t})}}},pedidoOzuna:{deep:!0,handler(e){const t=e.some(e=>e.medida&&e.tipo);if(t){const t=this.ordenarPedidosPorMedida(e);JSON.stringify(t)!==JSON.stringify(e)&&this.$nextTick(()=>{this.pedidoOzuna=t})}}}}},p=u,m=(a("680c"),a("2877")),v=Object(m["a"])(p,o,i,!1,null,"e5190094",null);t["a"]=v.exports},e8eb:function(e,t,a){},f125:function(e,t,a){"use strict";var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pedidos-menu-container"},[t("h1",{staticClass:"menu-title"},[e._v("Menú de Pedidos")]),t("div",{staticClass:"actions-container"},[t("div",{staticClass:"nuevo-pedido-buttons"},[t("router-link",{staticClass:"action-button",attrs:{to:"/procesos/pedidos/crudo"}},[t("button",{staticClass:"btn-nuevo-pedido crudo"},[t("i",{staticClass:"fas fa-plus"}),e._v(" Nuevo Pedido Crudo ")])]),t("router-link",{staticClass:"action-button",attrs:{to:"/procesos/pedidos/limpio"}},[t("button",{staticClass:"btn-nuevo-pedido limpio"},[t("i",{staticClass:"fas fa-plus"}),e._v(" Nuevo Pedido Limpio ")])])],1)]),t("div",{staticClass:"pedidos-list"},[t("div",{staticClass:"filtros"},[t("div",{staticClass:"filtro-tipo"},[t("label",[e._v("Tipo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.filtroTipo,expression:"filtroTipo"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.filtroTipo=t.target.multiple?a:a[0]}}},[t("option",{attrs:{value:"todos"}},[e._v("Todos")]),t("option",{attrs:{value:"crudo"}},[e._v("Crudo")]),t("option",{attrs:{value:"limpio"}},[e._v("Limpio")])])]),t("div",{staticClass:"filtro-fecha"},[t("label",[e._v("Fecha:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.filtroFecha,expression:"filtroFecha"}],attrs:{type:"date"},domProps:{value:e.filtroFecha},on:{input:function(t){t.target.composing||(e.filtroFecha=t.target.value)}}})])]),e.pedidosFiltrados.length>0?t("div",{staticClass:"tabla-pedidos"},[t("table",[e._m(0),t("tbody",e._l(e.pedidosFiltrados,(function(a){return t("tr",{key:a.fecha},[t("td",{staticClass:"fecha-celda"},[t("div",{staticClass:"fecha-container"},[t("div",{staticClass:"fecha-dia"},[e._v(e._s(e.obtenerDia(a.fecha)))]),t("div",{staticClass:"fecha-mes-ano"},[t("span",{staticClass:"mes"},[e._v(e._s(e.obtenerMes(a.fecha)))]),t("span",{staticClass:"ano"},[e._v(e._s(e.obtenerAno(a.fecha)))])]),t("div",{staticClass:"totales-dia"},[t("div",[e._v(e._s(e.calcularTotalesDia(a.pedidos).taras)+" T")]),t("div",[e._v(e._s(e.calcularTotalesDia(a.pedidos).kilos)+" Kg")])])])]),t("td",{staticClass:"detalles-celda"},e._l(a.pedidos,(function(a){return t("div",{key:a.id,staticClass:"tipo-acciones"},[t("span",{staticClass:"tipo-badge",class:a.tipo},[e._v(" "+e._s(e.capitalizarPrimeraLetra(a.tipo))+" ")]),t("span",{class:["kilos-badge",a.tipo]},[t("div",{staticClass:"kilos-taras-container"},[t("div",[e._v(e._s("crudo"===a.tipo?e.formatearNumero(Math.round(e.calcularKilos(a))):e.formatearNumero(Math.round(e.calcularKilosLimpio(a))))+" Kg")]),t("div",[e._v(e._s("crudo"===a.tipo?Math.round(e.calcularTaras(a)):Math.round(e.calcularTarasLimpio(a)))+" T")])])]),t("div",{staticClass:"acciones"},[t("button",{staticClass:"btn-editar",attrs:{title:"Ver"},on:{click:function(t){return e.editarPedido(a)}}},[e._v(" Ver ")]),t("button",{staticClass:"btn-imprimir",attrs:{title:"Imprimir"},on:{click:function(t){return e.imprimirPedido(a)}}},[t("i",{staticClass:"fas fa-print"}),e._v(" Imprimir ")]),t("button",{staticClass:"btn-eliminar",attrs:{title:"Eliminar"},on:{click:function(t){return e.eliminarPedido(a)}}},[t("i",{staticClass:"fas fa-trash"})])])])})),0)])})),0)])]):t("div",{staticClass:"no-pedidos"},[e._v(" No hay pedidos que coincidan con los filtros seleccionados ")])])])},i=[function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("Fecha")]),t("th",[e._v("Detalles")])])])}],s=(a("14d9"),a("13d5"),a("dc59")),r=a("1494"),l={name:"PedidosMenu",data(){return{pedidos:[],filtroTipo:"todos",filtroFecha:""}},computed:{pedidosFiltrados(){const e=this.pedidos.filter(e=>{const t="todos"===this.filtroTipo||e.tipo===this.filtroTipo,a=!this.filtroFecha||e.fecha===this.filtroFecha;return t&&a}),t=e.reduce((e,t)=>(e[t.fecha]||(e[t.fecha]={fecha:t.fecha,pedidos:[]}),e[t.fecha].pedidos.push(t),e),{});return Object.values(t).sort((e,t)=>new Date(t.fecha)-new Date(e.fecha))}},methods:{formatearNumero(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},obtenerDia(e){const t=new Date(e+"T00:00:00");return t.getDate().toString().padStart(2,"0")},obtenerMes(e){const t=new Date(e+"T00:00:00"),a=["ENE","FEB","MAR","ABR","MAY","JUN","JUL","AGO","SEP","OCT","NOV","DIC"];return a[t.getMonth()]},obtenerAno(e){const t=new Date(e+"T00:00:00");return t.getFullYear()},formatearFecha(e){const t=new Date(e);return t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),t.toLocaleDateString("es-ES")},capitalizarPrimeraLetra(e){return e.charAt(0).toUpperCase()+e.slice(1)},calcularKilos(e){let t=0;if(e.pedidos)for(const a in e.pedidos)for(const o in e.pedidos[a]){const i=e.pedidos[a][o];i&&!isNaN(i)&&(t+=parseFloat(i))}return(19*t).toFixed(2)},calcularTaras(e){const t=parseFloat(this.calcularKilos(e));return(t/19).toFixed(2)},calcularKilosLimpio(e){let t=0;return e.otilio&&(t+=this.calcularKilosCliente(e.otilio)),e.catarro&&(t+=this.calcularKilosCliente(e.catarro)),e.joselito&&(t+=this.calcularKilosCliente(e.joselito)),e.ozuna&&(t+=this.calcularKilosCliente(e.ozuna)),t},calcularTarasLimpio(e){let t=0;return e.otilio&&(t+=this.calcularTarasCliente(e.otilio)),e.catarro&&(t+=this.calcularTarasCliente(e.catarro)),e.joselito&&(t+=this.calcularTarasCliente(e.joselito)),e.ozuna&&(t+=this.calcularTarasCliente(e.ozuna)),t},calcularKilosCliente(e){let t=0,a=0,o=0,i=0,s=0,r=0;return e.forEach(e=>{e.kilos&&(e.esTara?"C/H20"===e.tipo?a+=30*Number(e.kilos)*.65:"1.35 y .15"===e.tipo?s+=30*Number(e.kilos):o+=30*Number(e.kilos):"S/H20"===e.tipo?t+=Number(e.kilos):"C/H20"===e.tipo?a+=Number(e.kilos):"1.35 y .15"===e.tipo?i+=1.35*Number(e.kilos):".7 y .3"===e.tipo&&(r+=.7*Number(e.kilos)))}),t+o+s+a+i+r},calcularTarasCliente(e){let t=0,a=0,o=0;e.forEach(e=>{e.kilos&&(e.esTara?t+=Number(e.kilos):"S/H20"===e.tipo?a+=Number(e.kilos):"1.35 y .15"===e.tipo&&(o+=Number(e.kilos)))});const i=a/25,s=o/33.75;return t+i+s},imprimirPedido(e){"crudo"===e.tipo?this.$router.push({name:"PedidoCrudosImpresion",params:{fecha:e.fecha,pedidos:e.pedidos,columnas:e.columnas}}):this.$router.push({name:"PedidoLimpioImpresion",params:{fecha:e.fecha,id:e.id,pedidoOtilio:e.otilio||[],pedidoCatarro:e.catarro||[],pedidoJoselito:e.joselito||[],pedidoOzuna:e.ozuna||[],clientesTemporales:e.clientesTemporales||{},rendimientosGuardados:e.rendimientos||{},divisoresGuardados:e.divisores||{},completadosGuardados:e.completados||{}}})},editarPedido(e){const t="crudo"===e.tipo?"/procesos/pedidos/crudo":"/procesos/pedidos/limpio";this.$router.push({path:t,query:{edit:"true",id:e.id,fecha:e.fecha}})},async eliminarPedido(e){try{const t=window.confirm("¿Está seguro que desea eliminar este pedido? Esta acción no se puede deshacer.");t&&(await Object(r["d"])(Object(r["e"])(s["a"],"pedidos",e.id)),alert("Pedido eliminado exitosamente"))}catch(t){console.error("Error al eliminar el pedido:",t),alert("Error al eliminar el pedido. Por favor intente nuevamente.")}},calcularTotalesDia(e){let t=0,a=0;return e.forEach(e=>{"crudo"===e.tipo?(t+=Math.round(parseFloat(this.calcularKilos(e))),a+=Math.round(parseFloat(this.calcularTaras(e)))):"limpio"===e.tipo&&(t+=Math.round(this.calcularKilosLimpio(e)),a+=Math.round(this.calcularTarasLimpio(e)))}),{kilos:this.formatearNumero(t),taras:a}}},created(){const e=Object(r["o"])(Object(r["c"])(s["a"],"pedidos"),Object(r["l"])("createdAt","desc"));this.unsubscribe=Object(r["k"])(e,e=>{this.pedidos=e.docs.map(e=>({id:e.id,...e.data()}))})},beforeDestroy(){this.unsubscribe&&this.unsubscribe()}},n=l,d=(a("f6e2"),a("2877")),c=Object(d["a"])(n,o,i,!1,null,"5cb25ce5",null);t["a"]=c.exports},f6e2:function(e,t,a){"use strict";a("e8eb")},f817:function(e,t,a){"use strict";a("91a4")}}]);